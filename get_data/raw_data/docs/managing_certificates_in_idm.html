<!DOCTYPE html><html  data-capo=""><head><script type="importmap">
  {
    "imports": {
      "@patternfly/elements/": "/scripts/v1/@patternfly/elements/",
      "@patternfly/pfe-clipboard/": "/scripts/v1/@patternfly/pfe-clipboard/",
      "@rhds/elements/": "/scripts/v1/@rhds/elements/elements/",
      "@cpelements/elements/": "/scripts/v1/@cpelements/elements/elements/"
    },
    "scopes": {
      "/": {
        "@floating-ui/core": "/scripts/v1/@floating-ui/core/dist/floating-ui.core.mjs",
        "@floating-ui/dom": "/scripts/v1/@floating-ui/dom/dist/floating-ui.dom.mjs",
        "@floating-ui/utils": "/scripts/v1/@floating-ui/utils/dist/floating-ui.utils.mjs",
        "@floating-ui/utils/dom": "/scripts/v1/@floating-ui/utils/dom/dist/floating-ui.utils.dom.mjs",
        "@lit/reactive-element": "/scripts/v1/@lit/reactive-element/reactive-element.js",
        "@lit/reactive-element/decorators/": "/scripts/v1/@lit/reactive-element/decorators/",
        "@patternfly/pfe-core": "/scripts/v1/@patternfly/pfe-core/core.js",
        "@patternfly/pfe-core/": "/scripts/v1/@patternfly/pfe-core/",
        "@rhds/tokens/media.js": "/scripts/v1/@rhds/tokens/js/media.js",
        "lit": "/scripts/v1/lit/index.js",
        "lit-element/lit-element.js": "/scripts/v1/lit-element/lit-element.js",
        "lit-html": "/scripts/v1/lit-html/lit-html.js",
        "lit-html/": "/scripts/v1/lit-html/",
        "lit/": "/scripts/v1/lit/",
        "tslib": "/scripts/v1/tslib/tslib.es6.mjs",
        "@cpelements/rh-table/dist/rh-table.js": "/scripts/v1/@cpelements/rh-table/dist/rh-table.js"
      }
    }
  }
</script><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Managing certificates in IdM | Red Hat Product Documentation</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<script type="text/javascript" id="trustarc" src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
<script src="//www.redhat.com/dtm.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@400;500;700&family=Red+Hat+Text:wght@400;500;700&display=swap">
<link rel="stylesheet" href="/styles/rh-table--lightdom.min.css">
<style>.section .titlepage{gap:.75rem}.section .titlepage,div.edit{align-items:center;display:flex}div.edit{font-size:.9rem;margin-bottom:8px}div.edit>a{align-items:center;display:flex}.edit pf-icon{margin-right:4px}</style>
<style>#error[data-v-df31ff14]{align-items:center;display:flex;flex-direction:column;justify-content:center;min-height:80vh}h1[data-v-df31ff14]{font-size:calc(var(--rh-font-size-body-text-md, 1rem)*4);font-weight:700;margin-bottom:0}h1[data-v-df31ff14],h1 span[data-v-df31ff14]{line-height:var(--rh-line-height-heading,1.3)}h1 span[data-v-df31ff14]{color:var(--rh-color-text-brand-on-light,#e00);display:block;text-transform:uppercase}h1 span[data-v-df31ff14],p[data-v-df31ff14]{font-size:var(--rh-font-size-body-text-lg,1.125rem)}aside[data-v-df31ff14]{align-items:center;background:var(--rh-color-surface-lightest,#fff);border:var(--rh-border-width-sm,1px) solid var(--rh-color-border-subtle-on-light,#c7c7c7);border-radius:var(--rh-border-radius-default,3px);border-top:calc(var(--rh-border-width-md, 2px)*2) solid var(--rh-color-text-brand-on-light,#e00);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2));display:flex;flex-direction:column;justify-content:space-between;margin-top:var(--rh-space-2xl,32px);padding:var(--rh-space-xl,24px)}aside[data-v-df31ff14],aside>div[data-v-df31ff14]{width:100%}.text-container[data-v-df31ff14]{margin:auto;max-width:442px;text-align:center}.desktop[data-v-df31ff14]{display:none}.sr-only[data-v-df31ff14]{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;clip-path:inset(50%);white-space:nowrap}form[data-v-df31ff14]{display:flex}button[data-v-df31ff14],input[data-v-df31ff14]{border:1px solid var(--rh-color-black-500,#8a8d90);box-sizing:border-box;height:40px}input[data-v-df31ff14]{border-right:none;flex:1;font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);padding-left:var(--rh-space-md,8px);width:100%}button[data-v-df31ff14]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border-left:none;display:flex;width:var(--rh-size-icon-04,40px)}button[data-v-df31ff14]:before{background:var(--rh-context-light-color-text-link,#06c);content:"";cursor:pointer;display:block;height:28px;margin:auto;width:28px}.search-icon[data-v-df31ff14]{margin:auto}ul[data-v-df31ff14]{max-width:275px;padding:0}ul li[data-v-df31ff14]{display:inline-block;list-style:none;margin-right:var(--rh-space-xl,24px);padding:var(--rh-space-xs,4px) 0}ul li a[data-v-df31ff14]{color:var(--rh-context-light-color-text-link,#06c);text-decoration:none}@media (min-width:992px){aside[data-v-df31ff14]{flex-direction:row}.mobile[data-v-df31ff14]{display:none}.desktop[data-v-df31ff14]{display:block}input[data-v-df31ff14]{width:auto}}</style>
<style>@keyframes fade-in{0%{opacity:0;visibility:hidden}1%{visibility:visible}to{opacity:1;visibility:visible}}@media (min-height:48em){.rhdocs{--rh-table--maxHeight:calc(100vh - 12.5rem)}}*,.rhdocs *,.rhdocs :after,.rhdocs :before,:after,:before{box-sizing:border-box}.rhdocs img,.rhdocs object,.rhdocs svg,img,object,svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs hr{border:0;border-top:.0625rem solid #d2d2d2;clear:both;margin:1rem 0}.rhdocs a{color:#06c;text-decoration:underline}.rhdocs a:focus,.rhdocs a:hover{color:#036}.rhdocs a.anchor-heading{color:#151515;cursor:pointer;text-decoration:none;word-break:break-all}.rhdocs p{margin:1.49963rem 0}.rhdocs li>p{margin:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:500;margin:0 0 .625rem}.rhdocs h1{font-size:2.25rem;margin:2rem 0}.rhdocs h2{font-size:1.625rem;margin:2rem 0}.rhdocs h3{font-size:1.5rem;font-weight:400}.rhdocs h4,.rhdocs h5{font-size:1.25rem}.rhdocs h5{font-weight:400}.rhdocs h6{font-size:1.125rem;font-weight:500;line-height:1.6667}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ol ::marker,.rhdocs ul ::marker{font:inherit}.rhdocs li{margin:0 0 .5em;padding:0}.rhdocs li>p{margin:.5rem 0}.rhdocs li>ol,.rhdocs li>ul{margin:0}.rhdocs dl dd{margin:.5rem 0 .5rem 1rem}.rhdocs dl dd>p{margin:.5rem 0}.rhdocs .informaltable,.rhdocs .table-contents,.rhdocs .table-wrapper{max-height:var(--rh-table--maxHeight);overflow:auto}.rhdocs table{border:0;font-size:1rem;line-height:1.6667;table-layout:fixed}.rhdocs table caption{color:#585858;margin-bottom:.5rem;margin-top:.5rem;text-align:left}.rhdocs table td,.rhdocs table th{border:0;border-bottom:.0625rem solid #d2d2d2;border-bottom:.0625rem solid var(--pfe-table--Border,#d2d2d2);padding:.5em 1rem}.rhdocs table td.halign-left,.rhdocs table th.halign-left{text-align:left}.rhdocs table td.halign-center,.rhdocs table th.halign-center,table td.halign-center,table th.halign-center{text-align:center}.rhdocs table td.halign-right,.rhdocs table th.halign-right{text-align:right}.rhdocs table td.valign-top,.rhdocs table th.valign-top{vertical-align:top}.rhdocs table td.valign-middle,.rhdocs table th.valign-middle{vertical-align:middle}.rhdocs table td.valign-bottom,.rhdocs table th.valign-bottom{vertical-align:bottom}.rhdocs table thead td,.rhdocs table thead th{background:#f5f5f5;font-weight:600}.rhdocs rh-table table,.rhdocs rh-table.rh-table--expanded-vertically{max-height:-moz-max-content;max-height:max-content}.rhdocs pre.nowrap{overflow:auto;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs .codeblock__wrapper pre{background:transparent}.rh-table--full-screen code,.rhdocs .content--md code,.rhdocs .content--sm code,.rhdocs .rh-table--full-screen code{overflow-wrap:normal;word-break:normal}.rhdocs[class] pre code,[class] pre code{background:inherit;color:inherit;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;padding:0}.rhdocs .keycap,.rhdocs kbd{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.keycap strong,.rhdocs .keycap strong{font-weight:inherit}.rhdocs kbd.keyseq,kbd.keyseq{background:transparent;border:0;box-shadow:none;padding:0}.rhdocs kbd.keyseq kbd,kbd.keyseq kbd{display:inline-block;margin:0 .375rem}.rhdocs kbd.keyseq kbd:first-child,kbd.keyseq kbd:first-child{margin-left:0}.rhdocs b.button{font-size:90%;font-weight:700;padding:.1875rem}.rhdocs b.button:before{content:"["}.rhdocs b.button:after{content:"]"}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}.rhdocs audio,.rhdocs canvas,.rhdocs progress,.rhdocs video{display:inline-block;vertical-align:baseline}.rhdocs audio:not([controls]){display:none;height:0}[hidden],template{display:none}.rhdocs a{background:transparent}.rhdocs a:active,.rhdocs a:hover{outline:0}.rhdocs a.anchor-heading:hover:before{color:#151515;content:"#";margin-left:-1.6rem;position:absolute}.rhdocs a.anchor-heading:focus-visible{color:#151515}@media screen and (max-width:990px){.rhdocs a.anchor-heading:hover:before{font-size:16px;margin-left:-1rem;padding-top:8px}.rhdocs h1 a.anchor-heading:hover:before{padding-top:12px}.rhdocs h4 a.anchor-heading:hover:before,.rhdocs h5 a.anchor-heading:hover:before{padding-top:4px}.rhdocs h6 a.anchor-heading:hover:before{padding-top:2px}}.rhdocs abbr[title]{border-bottom:.0625rem dotted}.rhdocs dfn{font-style:italic}.rhdocs h1{font-size:2em;margin:.67em 0}.rhdocs mark{background:#ff0;color:#000}.rhdocs small{font-size:80%}.rhdocs sub,.rhdocs sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}.rhdocs sup{top:-.5em}.rhdocs sub{bottom:-.25em}.rhdocs img{border:0}.rhdocs svg:not(:root){overflow:hidden}.rhdocs figure{margin:1em 2.5rem}.rhdocs hr{box-sizing:content-box;height:0}.rhdocs code,.rhdocs kbd,.rhdocs pre,.rhdocs samp{font-family:monospace,monospace;font-size:1em}.rhdocs button,.rhdocs optgroup,.rhdocs select,.rhdocs textarea,.rhdocsinput{color:inherit;font:inherit;margin:0}.rhdocs button.copy-link-btn{background:none;border:2px solid #fff;font:1px Red Hat Text}.rhdocs button.copy-link-btn:hover{border-bottom:2px solid #06c}.rhdocs button.copy-link-btn .link-icon{padding-bottom:4px}.rhdocs button{overflow:visible}.rhdocs button,.rhdocs select{text-transform:none}.rhdocs button,.rhdocs html input[type=button],.rhdocs input[type=reset],.rhdocs input[type=submit]{-moz-appearance:button;appearance:button;-webkit-appearance:button;cursor:pointer}.rhdocs button[disabled],.rhdocs html input[disabled]{cursor:default}.rhdocs button::-moz-focus-inner,.rhdocs input::-moz-focus-inner{border:0;padding:0}.rhdocs input{line-height:normal}.rhdocs input[type=checkbox],.rhdocs input[type=radio]{box-sizing:border-box;padding:0}.rhdocs input[type=number]::-webkit-inner-spin-button,.rhdocs input[type=number]::-webkit-outer-spin-button{height:auto}.rhdocs input[type=search]{-moz-appearance:textfield;appearance:textfield;-webkit-appearance:textfield;box-sizing:content-box}.rhdocs input[type=search]::-webkit-search-cancel-button,.rhdocs input[type=search]::-webkit-search-decoration{-webkit-appearance:none}.rhdocs fieldset{border:.0625rem solid silver;margin:0 .125rem;padding:.35em .625em .75em}.rhdocs legend{border:0;padding:0}.rhdocs textarea{overflow:auto}.rhdocs optgroup{font-weight:700}.rhdocs table{border-collapse:collapse;border-spacing:0}.rhdocs td,.rhdocs th{padding:0}.rhdocs ._additional-resources[class][class][id]:last-child{margin-top:-2rem}.rhdocs ._additional-resources[class][class]:only-child{grid-column:1/-1}._additional-resources[class][class] .additional-resources__heading,._additional-resources[class][class] .heading,._additional-resources[class][class] h1,._additional-resources[class][class] h2,._additional-resources[class][class] h3,._additional-resources[class][class] h4,._additional-resources[class][class] h5,._additional-resources[class][class] h6,._additional-resources[class][class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper ._additional-resources[class][class] ul{display:block}._additional-resources[class][class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}._additional-resources[class][class] li:only-child{grid-column:1/-1}._additional-resources[class][class] li:last-child{border:0}@media (min-width:1100px){._additional-resources[class][class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}._additional-resources[class][class] li p:only-child{margin:0;padding:0}._additional-resources[class][class] li a{text-decoration:none}._additional-resources[class][class] li a:focus,._additional-resources[class][class] li a:hover{text-decoration:underline}.rhdocs table .admonitionblock>div:nth-child(2),.rhdocs table .caution>div:nth-child(2),.rhdocs table .important>div:nth-child(2),.rhdocs table .note>div:nth-child(2),.rhdocs table .tip>div:nth-child(2),.rhdocs table .warning>div:nth-child(2){margin:.5rem 0}.rhdocs table .admonitionblock>div:nth-child(2)>:first-child,.rhdocs table .caution>div:nth-child(2)>:first-child,.rhdocs table .important>div:nth-child(2)>:first-child,.rhdocs table .note>div:nth-child(2)>:first-child,.rhdocs table .tip>div:nth-child(2)>:first-child,.rhdocs table .warning>div:nth-child(2)>:first-child{margin-top:0}.rhdocs table .admonitionblock>div:nth-child(2)>:last-child,.rhdocs table .caution>div:nth-child(2)>:last-child,.rhdocs table .important>div:nth-child(2)>:last-child,.rhdocs table .note>div:nth-child(2)>:last-child,.rhdocs table .tip>div:nth-child(2)>:last-child,.rhdocs table .warning>div:nth-child(2)>:last-child{margin-bottom:0}.rhdocs .codeblock__wrapper+.codeblock__wrapper,.rhdocs pre+pre,.rhdocs pre[class]+pre[class]{margin-top:2rem}.rhdocs .codeblock__wrapper{background:#f8f8f8;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__wrapper:before{background-repeat:no-repeat;background-size:6.25rem 100%;bottom:var(--scrollbar__height,1px);content:"";display:block;height:7.125rem;max-height:100%;max-height:calc(100% - var(--scrollbar__height, 2px));position:absolute;right:var(--scrollbar__width,6px);top:.0625rem;width:4.0625rem;z-index:1}.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 6.25rem)}@media (min-height:48em){.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 12.5rem)}}.rhdocs .codeblock__inner-wrapper{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs .codeblock__wrapper--expanded .codeblock__inner-wrapper{max-height:-moz-max-content;max-height:max-content}.codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.codeblock__copy:focus{outline:.0625rem dashed currentcolor}.codeblock__copy svg#icon--copy{height:1rem;width:1rem}.codeblock__expand{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;border:0;cursor:pointer;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));position:absolute;text-indent:-9999em;top:3.25rem;width:1.75rem;z-index:2}.codeblock__expand:before{background:#6a6e73;content:"";height:100%;left:0;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");-webkit-mask-position:center center;mask-position:center center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:auto 1rem;mask-size:auto 1rem;position:absolute;top:0;width:100%}.codeblock__wrapper--expanded .codeblock__expand{background:#2b9af3}.codeblock__wrapper--expanded .codeblock__expand:before{background:#fff}.codeblock__expand:focus:before,.codeblock__expand:hover:before{background:#06c}.codeblock__wrapper--expanded .codeblock__expand:focus:before,.codeblock__wrapper--expanded .codeblock__expand:hover:before{background:#fff}.codeblock__expand:focus{outline:.0625rem dashed currentcolor}.rhdocs .calloutlist>ol,.rhdocs .colist>ol{counter-reset:colist;list-style:none;margin:1rem 0 2rem;padding:0}.rhdocs .calloutlist>ol>li,.rhdocs .colist>ol>li{counter-increment:colist;font-size:1rem;margin:.5rem 0;padding-left:1.75rem;position:relative}.rhdocs .calloutlist>ol>li .colist-num,.rhdocs .colist>ol>li .colist-num{display:none}.calloutlist>ol>li:before,.colist>ol>li:before{content:counter(colist);left:0;position:absolute;top:.1875rem}.calloutlist dt{clear:left;float:left;margin:0;padding:0 .5rem 0 0}.included-in-guides[class],.included-in-guides[class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.included-in-guides[class][id]:last-child{margin-top:-2rem}.included-in-guides[class]:only-child{grid-column:1/-1}.included-in-guides[class] .additional-resources__heading,.included-in-guides[class] .heading,.included-in-guides[class] h1,.included-in-guides[class] h2,.included-in-guides[class] h3,.included-in-guides[class] h4,.included-in-guides[class] h5,.included-in-guides[class] h6,.included-in-guides[class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.included-in-guides[class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper .included-in-guides[class] ul{display:block}.included-in-guides[class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}.included-in-guides[class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.included-in-guides[class] li:only-child{grid-column:1/-1}.included-in-guides[class] li:last-child{border:0}@media (min-width:1100px){.included-in-guides[class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}.included-in-guides[class] li p:only-child{margin:0;padding:0}.included-in-guides[class] li a{text-decoration:none}.included-in-guides[class] li a:focus,.included-in-guides[class] li a:hover{text-decoration:underline}.menuseq{display:inline-flex;overflow:hidden;text-indent:-9999em}.menuseq .menu,.menuseq .menuitem,.menuseq .submenu{display:block;position:relative;text-indent:0}.menuseq .menu+.menu:before,.menuseq .menu+.menuitem:before,.menuseq .menu+.submenu:before,.menuseq .menuitem+.menu:before,.menuseq .menuitem+.menuitem:before,.menuseq .menuitem+.submenu:before,.menuseq .submenu+.menu:before,.menuseq .submenu+.menuitem:before,.menuseq .submenu+.submenu:before{content:">";display:inline-block;font-weight:700;padding:0 .25em}.related-topic-content__wrapper{margin:2em 0}.related-topic-content__wrapper--for-guide{margin-bottom:-2.5rem;padding-bottom:.0625rem;position:relative;z-index:1}.related-topic-content__wrapper--for-guide:before{background:#f0f0f0;content:"";display:block;height:100%;left:-3rem;position:absolute;right:-4.5rem;top:0;width:auto;z-index:-1}@media (min-width:1100px){.related-topic-content__wrapper--for-guide:before{left:-2.5rem;right:-3.625rem}}.related-topic-content__wrapper--for-guide summary{padding:1em 2em 1em 2.1875rem}@media (min-width:950px){.related-topic-content__inner-wrapper{display:grid;gap:2em;grid-template-columns:repeat(2,minmax(0,1fr))}}.local-render .rhdocs-content{margin:0 auto}.rhdocs cp-documentation{display:block;padding-bottom:2.5rem}.rhdocs cp-documentation.PFElement,.rhdocs cp-documentation[pfelement]{padding:0}rh-table{display:block}::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar{height:.625rem;width:.625rem}::-webkit-scrollbar,::-webkit-scrollbar-track,:host .rhdocs ::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar-track{background-color:#d6d6d6}::-webkit-scrollbar-thumb,:host .rhdocs ::-webkit-scrollbar-thumb{background-color:#8e8e8e}*,:host .rhdocs *{scrollbar-color:#8e8e8e #d6d6d6}.rhdocs p:empty,p:empty{display:none}.rhdocs[class] h1 code,.rhdocs[class] h2 code,.rhdocs[class] h3 code,.rhdocs[class] h4 code,.rhdocs[class] h5 code,.rhdocs[class] h6 code,[class] h1 code,[class] h2 code,[class] h3 code,[class] h4 code,[class] h5 code,[class] h6 code{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.pane-page-title h1,.rhdocs__header__primary-wrapper h1{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:2.25rem;line-height:1.333}.rhdocs details[class]{list-style:none;margin:1rem 0 3rem;padding:0}.rhdocs-toc[class]{background:#f2f2f2;margin:1rem 0 2rem;padding:1rem}.rhdocs-toc[class]>:last-child{margin-bottom:0}.rhdocs-toc[class] .rhdocs-toctitle{font-size:1.25rem;font-weight:400;line-height:1.6667;margin-top:0;text-transform:none}.rhdocs-toc[class] li{margin-bottom:.25em;padding-left:.5em}.preamble{margin:0 0 2rem}.sect1{margin:2rem 0 1rem}:host .sect1,cp-documentation .sect1{margin:0 0 2rem;padding:.0625rem 0 0}:host(.cp-documentation--has-external-header) .sect1:first-child>h2:first-child,:host(.cp-documentation--has-external-header) .sect1:first-child>h3:first-child{margin-top:0}.listingblock,.literalblock{margin:1rem 0}.quoteblock,.verseblock{border-left:.25rem solid #d2d2d2;margin:1rem 0;padding:1rem 1rem 1rem 2rem}.quoteblock.pullleft,.verseblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.quoteblock.pullleft,.verseblock.pullleft{margin-left:-1rem}}.quoteblock.pullright,.verseblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.quoteblock.pullright,.verseblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.quoteblock.pullright,.verseblock.pullright{margin-right:-10rem}}.quoteblock>:first-child,.verseblock>:first-child{margin-top:0}.quoteblock .content,.verseblock .content{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.25rem;line-height:1.6667}.quoteblock .attribution,.verseblock .attribution{font-size:.875rem;font-style:italic;font-weight:600;line-height:1.6667;text-transform:uppercase}.quoteblock .attribution .citetitle,.verseblock .attribution .citetitle{color:#585858}.quoteblock .attribution cite,.verseblock .attribution cite{font-size:1em}.quoteblock blockquote{font-style:italic;margin:0;padding:0}.quoteblock blockquote .content>:first-child{margin-top:0}.quoteblock blockquote .content>:first-child:before{color:#e00;content:"â€œ";display:block;float:left;font-size:2.75rem;font-style:normal;line-height:1.125em;margin-right:.5rem}.quoteblock blockquote .content>:first-child .content>:first-child:before{content:none}.imageblock{margin:1rem 0}.imageblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.imageblock.pullleft{margin-left:-1rem}}.imageblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.imageblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.imageblock.pullright{margin-right:-10rem}}.imageblock.interrupter{margin:2rem 0}@media (min-width:768px){.imageblock.interrupter{margin-left:-1rem;margin-right:-2rem}.imageblock.interrupter .caption{margin-left:1rem;margin-right:2rem}}@media (min-width:1100px){.imageblock.interrupter{margin-right:-10rem}.imageblock.interrupter .caption{margin-right:10rem}}.imageblock.interrupter img{max-width:100%}.imageblock .caption{color:#585858;display:block;font-size:.875rem;line-height:1.6667;margin:.5rem 0 0}.rhdocs-footnotes{border-top:.0625rem solid #d2d2d2;margin:3rem 0 1rem;padding:1rem 0 0}.rhdocs-footnotes>ol{margin:0;padding:0 0 0 1.5rem}@supports (counter-reset:footnotenum){.rhdocs-footnotes>ol{counter-reset:footnotenum;list-style:none;padding:0}.rhdocs-footnotes>ol>li{counter-increment:footnotenum}.rhdocs-footnotes>ol>li:before{color:#585858;content:"[" counter(footnotenum) "]";display:inline-block;margin-right:.25rem}}.rhdocs-footer{background:#ededed;color:#151515;font-size:.875rem;line-height:1.6667;margin:3rem 0 0;padding:1rem}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.visually-hidden{overflow:hidden;position:absolute;clip:rect(0,0,0,0);border:0;height:.0625rem;margin:-.0625rem;padding:0;width:.0625rem}.rh-docs-legal-notice{margin-top:4em}pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}code.language-none,code.language-text,code.language-txt,pre.language-none,pre.language-text,pre.language-txt{color:#151515}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#cceae7;color:#263238}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#cceae7;color:#263238}:not(pre)>code[class*=language-]{border-radius:.2em;padding:.1em;white-space:normal}.token.atrule{color:#40199a}.token.attr-name{color:#06c}.token.attr-value,.token.attribute{color:#b300b3}.token.boolean{color:#40199a}.token.builtin,.token.cdata,.token.char,.token.class,.token.class-name{color:#06c}.token.comment{color:#6a6e73}.token.constant{color:#40199a}.token.deleted{color:#c9190b}.token.doctype{color:#6a6e73}.token.entity{color:#c9190b}.token.function{color:#40199a}.token.hexcode{color:#b300b3}.token.id,.token.important{color:#40199a;font-weight:700}.token.inserted{color:#06c}.token.keyword{color:#40199a}.token.number{color:#b300b3}.token.operator{color:#06c}.token.prolog{color:#6a6e73}.token.property{color:#06c}.token.pseudo-class,.token.pseudo-element{color:#b300b3}.token.punctuation,.token.regex{color:#06c}.token.selector{color:#c9190b}.token.string{color:#b300b3}.token.symbol{color:#40199a}.token.unit{color:#b300b3}.token.url,.token.variable{color:#c9190b}.rhdocs.local-render{margin:0 auto;max-width:45.8125rem;padding:0 1.5rem}@media print{.field code,.field pre,code[class*=language-],pre,pre[class*=language-]{white-space:pre-wrap!important;word-wrap:break-word!important;overflow-wrap:break-word!important;word-break:break-word!important}}.book-nav__list[class]{display:flex;justify-content:space-between;line-height:var(--jupiter__lineHeight--xs,1.3333);list-style:none;margin:5rem 0 0;padding:0}@media (min-width:1200px){.book-nav__list[class]{display:grid;gap:2rem;grid-template-columns:repeat(2,minmax(0,1fr))}}.book-nav__item a{display:inline-block;font-size:.875rem;font-weight:500;padding-left:1.25rem;position:relative;text-transform:uppercase}.book-nav__item a:before{background:url(/sites/dxp-docs/penumbra-dist/jupiter/images/arrow-down-solid.svg) no-repeat;background-size:contain;content:"";display:block;height:.875rem;left:0;position:absolute;top:.125rem;transform:rotate(90deg);width:.875rem}.book>.titlepage:not(:last-child),.rhdocs .chapter,section[id]{padding-bottom:3.75rem}.book>.titlepage .chapter:last-child,.book>.titlepage section[id]:last-child,.chapter .chapter:last-child,.chapter section[id]:last-child,section[id] .chapter:last-child,section[id] section[id]:last-child{margin-bottom:-3.75rem}.rhdocs .codeblock__wrapper+section[id],pre+section[id]{padding-top:3.75rem}.rhdocs .cta-link{font-size:inherit}.rhdocs a{word-wrap:break-word;overflow-wrap:break-word}.rhdocs .caution,.rhdocs .important,.rhdocs .note,.rhdocs .tip,.rhdocs .warning{padding:.8888888889em;position:relative}.rhdocs .QSIPopOver{bottom:18.75rem!important;top:auto!important}.rhdocs .alert{position:relative}.rhdocs button.dismiss-button{background:none;border:0;cursor:pointer;height:2.5rem;margin-top:-1.25rem;padding:0;position:absolute;right:.3125rem;text-align:center;top:50%;width:2.5rem;z-index:50}.rhdocs button.dismiss-button:after{content:"\f109";display:inline-block;filter:alpha(opacity=30);font-family:rh-web-iconfont;font-size:1.3125rem;font-style:normal;font-variant:normal;font-weight:400;line-height:1;line-height:2.5rem;opacity:.3;text-decoration:inherit;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs .book>.titlepage,.rhdocs .chapter,.rhdocs section[id]{padding-bottom:var(--rh-space-4xl,64px)}.rhdocs .alert{border:0;border-radius:0}.rhdocs .alert>h2:first-child,.rhdocs .alert>h3:first-child,.rhdocs .alert>h4:first-child,.rhdocs .alert>h5:first-child,.rhdocs .alert>h6:first-child,.rhdocs .alert>p:first-child{margin-top:0!important}.rhdocs .alert>p:last-child{margin-bottom:0!important}.rhdocs .alert-w-icon[class]{padding-left:2.8125rem}.rhdocs .alert-w-icon .alert-icon{float:left;font-size:1.125rem;margin-left:-1.875rem;margin-right:.625rem}.rhdocs .alert-w-icon .alert-icon[class*=" rh-icon-"],.rhdocs .alert-w-icon .alert-icon[class^=rh-icon-]{font-size:2.25rem;line-height:1em;margin-left:-2.5rem;margin-top:-.375rem}.rhdocs .alert-w-icon .alert-icon[class*=" icon-innov-prev"],.rhdocs .alert-w-icon .alert-icon[class^=icon-innov-prev]{font-size:1.3125rem;margin-top:.25rem}.rhdocs .alert-w-icon.alert-plain{background:none;color:#151515;padding-left:5rem}.rhdocs .alert-w-icon.alert-plain .alert-icon{font-size:3rem;margin-left:-4.375rem;margin-right:0}.rhdocs .alert-w-icon.alert-plain.alert-success .alert-icon{color:#3f9c35}.rhdocs .alert-w-icon.alert-plain.alert-info .alert-icon{color:#0088ce}.rhdocs .alert-w-icon.alert-plain.alert-warning .alert-icon{color:#f0ab00}.rhdocs .alert-w-icon.alert-plain.alert-danger .alert-icon{color:#e00}#target_banner .copy-url{float:right;margin-top:0}#target_banner .dropdown-menu{font-size:inherit}.titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.para{margin:1.49963rem 0}.para[class]{margin-bottom:1.49963rem}dd{margin-bottom:2.5rem}.rhdocs .card-light,.rhdocs .card-light-gray,.rhdocs .card-light-grey{background:#f0f0f0;border:.0625rem solid #f0f0f0;color:#151515}.rhdocs .card-light-gray.push-bottom:first-child,.rhdocs .card-light-grey.push-bottom:first-child,.rhdocs .card-light.push-bottom:first-child{margin-bottom:3.125rem!important}.rhdocs .card-light a.card-link,.rhdocs .card-light h1,.rhdocs .card-light h2,.rhdocs .card-light h3,.rhdocs .card-light h4,.rhdocs .card-light h5,.rhdocs .card-light h6,.rhdocs .card-light-gray a.card-link,.rhdocs .card-light-gray h1,.rhdocs .card-light-gray h2,.rhdocs .card-light-gray h3,.rhdocs .card-light-gray h4,.rhdocs .card-light-gray h5,.rhdocs .card-light-gray h6,.rhdocs .card-light-grey a.card-link,.rhdocs .card-light-grey h1,.rhdocs .card-light-grey h2,.rhdocs .card-light-grey h3,.rhdocs .card-light-grey h4,.rhdocs .card-light-grey h5,.rhdocs .card-light-grey h6{color:#151515}.rhdocs .card-light-gray.card-active:after,.rhdocs .card-light-grey.card-active:after,.rhdocs .card-light.card-active:after{border-top-color:#f0f0f0}.rhdocs .card-md,.rhdocs .card-narrow{display:block;padding:1.1875rem;white-space:normal;word-wrap:break-word}.rhdocs .card .card-heading.card-heading-sm,.rhdocs .card-sm .card .card-heading{font-size:1.0625em;font-weight:500;line-height:1.5}.rhdocs .card .card-heading.card-heading-flush{margin-bottom:.25rem}.rhdocs .card .card-heading.card-heading-red{color:#d10000}.rhdocs .card>p{margin-top:0}.rhdocs .card>p:last-child{margin-bottom:0}.rhdocs .new-experience{background-color:#e7f1fa;border:.0625rem solid #bee1f4;font-size:1rem;margin:1.5rem;padding:1.5rem;position:relative;z-index:1}@media (min-width:48rem){.new-experience{display:flex}.new-experience--contained{left:50%;position:relative;transform:translateX(-50%);width:calc(100vw - 2.5rem)}}.new-experience__primary-content{flex-grow:1}@media (min-width:48rem){.new-experience__primary-content{margin-right:1.25rem}}.new-experience__title{font-size:inherit;font-weight:inherit;line-height:1.6;margin:0;padding:0}.new-experience__title+a,.new-experience__title+pfe-cta{display:inline-block;margin-top:1.5em}.new-experience__secondary-content{min-width:12.5rem}@media (min-width:48rem){.new-experience__secondary-content{text-align:right}}.example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:min-content 1fr}dl.calloutlist[class] dt{float:none;margin:0;padding:0}dl.calloutlist[class] dd{margin:0;padding:0}dl.calloutlist[class] dd>:first-child{margin-top:0}dl.calloutlist[class] dd>:last-child{margin-bottom:0}.toast{background-color:#000;background-color:rgba(0,0,0,.9);bottom:.9375rem;box-shadow:0 .125rem .3125rem 0 rgba(0,0,0,.26);color:#fff;left:.9375rem;max-width:32.8125rem;min-width:6.25rem;padding:.9375rem;position:fixed;right:.9375rem;transform:translate3d(0,150%,0);transition:transform .2s cubic-bezier(.465,.183,.153,.946);will-change:transform;z-index:999}.toast.show{transform:translateZ(0)}.toast a{color:#fff;text-decoration:underline}.toast a:focus,.toast a:hover{color:#2b9af3}.toast a.btn{text-decoration:none}.toast .btn.btn-link{color:#fff}.toast .close{color:#fff;opacity:.3;text-decoration:none}.toast .close:focus,.toast .close:hover{color:#fff;opacity:.5}.no-csstransforms3d.csstransitions .toast{transition:all .2s cubic-bezier(.465,.183,.153,.946)}.no-csstransforms3d .toast{opacity:0;visibility:hidden}.no-csstransforms3d .toast.show{opacity:1;visibility:visible}.annotator-outer[class][class]{display:none;flex-direction:column;flex-grow:1;height:auto;margin:0;position:static;width:auto}@media (min-width:1400px){.annotator-outer[class][class]{display:flex}}.annotator-frame[class] *{height:auto}@media (min-width:1400px){.annotator-frame .h-sidebar-iframe[class]{position:static;width:calc(100% + 1.5rem)}}.annotator-toolbar[class][class]{position:static;width:auto}.annotator-toolbar>ul,.annotator-toolbar>ul>li{display:block;height:auto;list-style:none;margin:0;padding:0;width:auto}.annotator-toolbar>ul>li{display:flex;justify-content:flex-end}.annotator-frame[class] .annotator-frame-button--sidebar_toggle,.annotator-outer .annotator-frame-button[class][class],.app-content-wrapper *{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif!important}.annotator-outer .annotator-frame-button[class][class]{font-size:.9375rem;font-weight:500;height:auto;line-height:1.333;margin-right:1.875rem;padding:.75em 1em;position:static}@media (min-width:1400px){.annotator-outer .annotator-frame-button[class][class]{margin-right:0}}.annotator-outer iframe{flex-grow:1;margin-bottom:1.25rem}@media (min-width:1400px){.annotator-outer iframe{min-height:37.5rem}}.producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.producttitle .productnumber{color:var(--jupiter__palette__red--50,#e00)}.cp-modal-open,.zoom-open{overflow:hidden}.cp-modal,.cp-video-modal,.zoom-modal{bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;outline:0;overflow:hidden;position:fixed;right:0;top:0;transition:all .2s cubic-bezier(.465,.183,.153,.946);z-index:1040;z-index:1050;-webkit-overflow-scrolling:touch}.rhdocs .in.cp-modal,.rhdocs .in.cp-video-modal,.rhdocs .in.zoom-modal{display:block;filter:alpha(opacity=100);opacity:1;overflow-x:hidden;overflow-y:auto}.rhdocs .cp-modal .close,.rhdocs .cp-video-modal .close,.rhdocs .zoom-modal .close{background-color:#fff;border-radius:50%;color:#1a1a1a;font-size:1.75rem;height:28px;height:1.75rem;line-height:1.75rem;margin-bottom:.375rem;margin-top:0;opacity:.9;position:absolute;right:-.5rem;text-shadow:none;top:0;width:28px;width:1.75rem}.cp-modal .close:after,.cp-video-modal .close:after,.zoom-modal .close:after{line-height:1.75rem}.cp-modal-wrap,.zoom-wrap{margin:.625rem;padding-top:.5rem;position:relative}@media (min-width:48rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{margin:2.8125rem auto;width:38.4375rem}}@media (min-width:62rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:49.8958rem}}@media (min-width:75rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:60.3125rem}}.rhdocs .cp-modal-body :last-child{margin-bottom:0}.rhdocs .cp-modal-backdrop,.rhdocs .zoom-backdrop{background-color:#000;bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;position:fixed;right:0;top:0;transition:opacity .2s cubic-bezier(.465,.183,.153,.946);z-index:1040}.rhdocs .in.cp-modal-backdrop,.rhdocs .in.zoom-backdrop{display:block;filter:alpha(opacity=80);opacity:.8}.rhdocs .cp-modal-body{background:#fff;padding:1.875rem}.rhdocs .cp-modal[data-cp-modal-video=true] .cp-modal-body,.rhdocs .cp-video-modal .cp-modal-body{padding:0}.rhdocs [data-action=zoom]{position:relative}.rhdocs [data-action=zoom]:after{background:rgba(0,0,0,.4);bottom:0;color:#fff;display:inline-block;font-family:rh-web-iconfont;font-style:normal;font-variant:normal;font-weight:400;line-height:1;padding:.375rem;position:absolute;right:0;text-decoration:inherit;text-decoration:none!important;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs [data-action=zoom]:focus:after,.rhdocs [data-action=zoom]:hover:after{background:rgba(0,0,0,.9)}.rhdocs .zoom-wrap .zoom-larger{text-align:center}.rhdocs .zoom-wrap .zoom-larger a{color:#fff}.rhdocs .zoom-wrap .zoom-larger a:focus,.rhdocs .zoom-wrap .zoom-larger a:hover{color:#fff;text-decoration:underline}.rhdocs .zoom-wrap .zoom-larger a:after{content:"â¿»";display:inline-block;margin-left:.25rem}.rhdocs .zoom-body{background:#fff;border-radius:.5rem;margin:0 0 1rem;padding:1rem;text-align:center}.rhdocs .zoom-body .video-wrapper{height:0;overflow:hidden;padding-bottom:56.25%;position:relative}.rhdocs .zoom-body .video-wrapper[data-aspect-ratio="4:3"]{padding-bottom:75%}.rhdocs .zoom-body iframe{height:100%;left:0;position:absolute;top:0;width:100%}.rhdocs .para>.title[class],.rhdocs p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0;text-transform:none}.rhdocs .para>.title[class]+.content>:first-child,.rhdocs .para>.title[class]+p,.rhdocs p.title[class]+.content>:first-child,.rhdocs p.title[class]+p{margin-top:0}.rhdocs [class] pre .caution,.rhdocs [class] pre .important,.rhdocs [class] pre .note,.rhdocs [class] pre .tip,.rhdocs [class] pre .warning{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.rhdocs [class] pre .caution:after,.rhdocs [class] pre .important:after,.rhdocs [class] pre .note:after,.rhdocs [class] pre .tip:after,.rhdocs [class] pre .warning:after{content:none}.rhdocs [class] code.email{background-color:transparent;font:inherit;padding:0}.rhdocs [class] .author{margin-bottom:1.5rem}.rhdocs [class] .author .author{margin-bottom:0}.rhdocs table{margin:2rem 0}.rhdocs [class] table{width:auto}.rhdocs table .table-contents table{max-width:100%;overflow:auto}.rhdocs rh-table table{margin:0;max-width:9999em;overflow:visible}.rhdocs td,.rhdocs th{border-left:0;padding:.5em 1rem;transition:background .25s ease-out}.rhdocs td.content--md[class][class],.rhdocs th.content--md[class][class]{min-width:13em}.rhdocs td.content--lg[class][class],.rhdocs th.content--lg[class][class]{min-width:20em}.rhdocs thead th{padding-top:1.5em}.rhdocs caption{color:currentColor;color:var(--pfe-table__caption--Color,currentColor);font-weight:700;margin-bottom:.5rem;margin-top:.5rem;text-align:center}.rhdocs .revhistory table td,.rhdocs .revhistory table th{border-color:transparent}.rhdocs .revhistory table td{padding:.625rem .875rem}.rhdocs .revhistory table.simplelist{margin:0}@media print{#masthead{display:none!important}}.rh-table--is-full-screen #to-top{display:none}.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:var(--rh-font-family-body-text,RedHatText,"Red Hat Text","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-body-copy-lage,1.125rem);line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs rh-codeblock::slotted(#content){border-radius:.25rem;padding:var (--rh-space-lg,16px)}.rhdocs rh-codeblock .screen{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs rh-codeblock[class][class][class][class][class]{max-width:99999em}.rhdocs .codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.rhdocs .codeblock__copy:focus{outline:.0625rem dashed currentcolor}.rhdocs .codeblock__copy svg#icon--copy{height:1rem;width:1rem}.rhdocs pre{border:0;max-height:-moz-max-content;max-height:max-content}.rhdocs pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre,.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre[class]{margin:0;padding:0;position:relative}.rhdocs code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs code.literal{background:#eee;border-radius:.25rem;color:#000;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs code.literal,.rhdocs kbd,.rhdocs span.keycap{font-family:RedHatMono,Red Hat Mono,Consolas,monospace}.rhdocs kbd,.rhdocs span.keycap{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ._additional-resources[class][class],.rhdocs ._additional-resources[class][class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.rhdocs ._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.rhdocs ._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.rhdocs ._additional-resources[class][class] li:last-child{border:0}.rhdocs section.section#additional_resource .additional-resources__heading,.rhdocs section.section#additional_resource .heading,.rhdocs section.section#additional_resource h1,.rhdocs section.section#additional_resource h2,.rhdocs section.section#additional_resource h3,.rhdocs section.section#additional_resource h4,.rhdocs section.section#additional_resource h5,.rhdocs section.section#additional_resource h6,.rhdocs section.section#additional_resource p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.rhdocs section.section:first-of-type{margin-top:var(--rh-space-4xl,64px)}.rhdocs section.section p{margin-bottom:var(--rh-space-lg,16px);margin-top:0;word-wrap:break-word}.rhdocs .section.section h1,.rhdocs .section.section h2,.rhdocs .section.section h3,.rhdocs .section.section h4,.rhdocs .section.section h5,.rhdocs .section.section h6,.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h1:first-of-type,.rhdocs h2:first-of-type,.rhdocs h3:first-of-type,.rhdocs h4:first-of-type,.rhdocs h5:first-of-type,.rhdocs h6:first-of-type{margin-top:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h2,.rhdocs section.section h2{font-size:var(--rh-font-size-heading-md,1.75rem)}.rhdocs h3,.rhdocs section.section h3{font-size:1.5rem;font-weight:400}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs dl{display:block;margin-block-end:1em;margin-block-start:1em;margin-inline-end:0;margin-inline-start:0}.rhdocs .para{margin:1.49963rem 0}.rhdocs dl.calloutlist[class] dt{float:none;margin:0;padding:0}.rhdocs dl.calloutlist[class] dd>:last-child{margin-bottom:0}.rhdocs dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:fit-content(40%) 1fr}.rhdocs .calloutlist dt{clear:left;display:flex;flex-wrap:wrap;float:left;margin:0;padding:0 .5rem 0 0}.rhdocs .calloutlist dt a:not(:first-child){padding-left:4px}.rhdocs dl.calloutlist[class] dd{margin:0;padding:0}.rhdocs .callout,.rhdocs .colist>ol>li:before,.rhdocs .conum{background:#06c;border-radius:50%;color:#fff;display:inline-block;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:.75rem;font-style:normal;font-weight:600;height:1.25rem;line-height:1.35rem;padding:0;position:relative;text-align:center;top:-.125em;vertical-align:middle;width:1.25rem}.rhdocs img,.rhdocs object,.rhdocs svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs .titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.rhdocs[class] .author{margin-bottom:1.5rem}.rhdocs[class] .author .author{margin-bottom:0}.rhdocs .para>.title[class],p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0}.rhdocs .example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}.rhdocs code{background:#eee;color:#000;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs .para[class]{margin-bottom:1.49963rem}.rhdocs[class] code.email{background-color:transparent;font:inherit;padding:0}rh-alert.admonition #description,rh-alert.admonition p{font-size:var(--rh-font-size-body-text-md,1rem)}rh-alert{width:-moz-fit-content;width:fit-content}.rhdocs .producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.rhdocs dl{margin:1rem 0}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs ol ol{list-style:lower-roman}.rhdocs .codeblock--processed pf-clipboard-copy::part(input),.rhdocs .codeblock--processed pf-clipboard-copy::part(span){display:none}.token.tag{color:#c9190b}.calloutlist div.para{margin:0}rh-alert.admonition{margin-bottom:var(--rh-space-lg,1rem)}.guibutton,.guimenu,.guimenuitem{font-weight:700}.guibutton{font-size:90%;padding:.1875rem}.guibutton:before{content:"["}.guibutton:after{content:"]"}.docs-content-container,.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}pre[hidden]{display:none}.codeblock[class][class][class][class][class]{max-width:99999em}.codeblock__wrapper{background:var(--rh-color-surface-lighter,#f2f2f2);margin:1rem 0;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__inner-wrapper:after{content:"";display:block;min-height:.625rem;width:4.375rem}.codeblock__copy{--pfe-clipboard--icon--Color--hover:#06c;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));padding:.3125rem .375rem;position:absolute;top:1rem;width:1.75rem;z-index:2}.codeblock__inner-wrapper pre{border:0;max-height:-moz-max-content;max-height:max-content}.pfe-clipboard:not([copied]) .pfe-clipboard__text--success,:host(:not([copied])) .pfe-clipboard__text--success{display:none!important}.codeblock[class]{margin:0;overflow:visible;padding-right:0}pre{display:block;font-size:.8125rem;line-height:1.42857;margin:0 0 .625rem;word-break:break-all;word-wrap:break-word;background-color:var(--rh-color-surface-lighter,#f2f2f2);border:.0625rem solid #ccc;border-radius:.25rem;color:#333}.docs-content-container pre,.rhdocs pre{background:var(--rh-color-surface-lighter,#f2f2f2);color:#151515;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs pre[class]{line-height:1.6667;overflow-x:auto}rh-codeblock pre[class][class]{overflow-x:auto}.pfe-clipboard__text--success{background-color:#ddd;border:1px solid #000;border-radius:2px}*,:after,:before{box-sizing:border-box}:root{--rh-space-xs:4px;--rh-space-sm:6px;--rh-space-md:8px;--rh-space-lg:16px;--rh-space-xl:24px;--rh-space-2xl:32px;--rh-space-3xl:48px;--rh-space-4xl:64px;--rh-space-5xl:80px;--rh-space-6xl:96px;--rh-space-7xl:128px;--rh-font-size-body-text-xs:.75rem;--rh-font-size-body-text-sm:.875rem;--rh-font-size-body-text-md:1rem;--rh-font-size-body-text-lg:1.125rem;--rh-font-size-body-text-xl:1.25rem;--rh-font-size-body-text-2xl:1.5rem;--rh-font-size-heading-xs:1.25rem;--rh-font-size-heading-sm:1.5rem;--rh-font-size-heading-md:1.75rem;--rh-font-size-heading-lg:2.25rem;--rh-font-size-heading-xl:2.5rem;--rh-font-size-heading-2xl:3rem;--pfe-navigation--logo--maxWidth:200px;--pfe-navigation__logo--height:40px;--pfe-navigation--fade-transition-delay:500ms;--pfe-navigation__nav-bar--highlight-color:var(--rh-color-brand-red-on-dark,#e00);--pf-global--icon--FontSize--sm:.75rem}body,html{font-family:Red Hat Text,sans-serif;font-size:var(--rh-font-size-body-text-md,1rem);line-height:var(--rh-line-height-body-text,1.5);margin:0}h1,h2,h3,h4,h5,h6{font-family:Red Hat Display,sans-serif;font-weight:400;line-height:var(--rh-line-height-heading,1.3)}h1{font-size:var(--rh-font-size-heading-2xl,3rem);line-height:62px}h2{font-size:var(--rh-font-size-heading-xl,2.5rem);line-height:48px}h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}h4{font-size:var(--rh-font-size-heading-md,2.25rem)}h5{font-size:var(--rh-font-size-heading-sm,2.25rem)}h6{font-size:var(--rh-font-size-heading-xs,2.25rem)}main{line-height:30px}section{padding-bottom:3rem;padding-top:3rem}img{height:auto;max-width:100%}a{color:var(--rh-color-interactive-blue-darker,#06c);text-decoration:none}a:hover{color:var(--rh-color-interactive-blue-darkest,#004080)}rh-alert.html-container a{text-decoration:underline}.container{padding-left:12px;padding-right:12px}.container,.container-fluid{margin-left:auto;margin-right:auto;width:100%}.container-fluid{padding:12px}@media (min-width:576px){.container{max-width:540px}}@media (min-width:768px){.container{max-width:720px}}@media (min-width:992px){.container{max-width:960px}}@media (min-width:1200px){.container{min-width:1140px}}@media (min-width:1400px){.container{min-width:1320px}}.grid{display:grid;gap:var(--rh-space-xl,24px)}.grid-center{margin:auto}.grid.grid-col-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-12{grid-template-columns:repeat(12,1fr)}@media (min-width:768px){.grid.grid-col-md-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-md-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-md-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-md-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-md-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-md-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-md-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-md-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-md-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-md-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-md-12{grid-template-columns:repeat(12,1fr)}}@media (min-width:992px){.grid.grid-col-lg-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-lg-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-lg-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-lg-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-lg-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-lg-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-lg-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-lg-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-lg-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-lg-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-lg-12{grid-template-columns:repeat(12,1fr)}}.span-1{grid-column:span 1}.span-2{grid-column:span 2}.span-3{grid-column:span 3}.span-4{grid-column:span 4}.span-5{grid-column:span 5}.span-6{grid-column:span 6}.span-7{grid-column:span 7}.span-8{grid-column:span 8}.span-9{grid-column:span 9}.span-10{grid-column:span 10}.span-11{grid-column:span 11}.span-12{grid-column:span 12}@media (min-width:399px){.span-xs-1{grid-column:span 1}.span-xs-2{grid-column:span 2}.span-xs-3{grid-column:span 3}.span-xs-4{grid-column:span 4}.span-xs-5{grid-column:span 5}.span-xs-6{grid-column:span 6}.span-xs-7{grid-column:span 7}.span-xs-8{grid-column:span 8}.span-xs-9{grid-column:span 9}.span-xs-10{grid-column:span 10}.span-xs-11{grid-column:span 11}.span-xs-12{grid-column:span 12}}@media (min-width:768px){.span-md-1{grid-column:span 1}.span-md-2{grid-column:span 2}.span-md-3{grid-column:span 3}.span-md-4{grid-column:span 4}.span-md-5{grid-column:span 5}.span-md-6{grid-column:span 6}.span-md-7{grid-column:span 7}.span-md-8{grid-column:span 8}.span-md-9{grid-column:span 9}.span-md-10{grid-column:span 10}.span-md-11{grid-column:span 11}.span-md-12{grid-column:span 12}}@media (min-width:992px){.span-lg-1{grid-column:span 1}.span-lg-2{grid-column:span 2}.span-lg-3{grid-column:span 3}.span-lg-4{grid-column:span 4}.span-lg-5{grid-column:span 5}.span-lg-6{grid-column:span 6}.span-lg-7{grid-column:span 7}.span-lg-8{grid-column:span 8}.span-lg-9{grid-column:span 9}.span-lg-10{grid-column:span 10}.span-lg-11{grid-column:span 11}.span-lg-12{grid-column:span 12}}@media (min-width:1025px){.span-xl-1{grid-column:span 1}.span-xl-2{grid-column:span 2}.span-xl-3{grid-column:span 3}.span-xl-4{grid-column:span 4}.span-xl-5{grid-column:span 5}.span-xl-6{grid-column:span 6}.span-xl-7{grid-column:span 7}.span-xl-8{grid-column:span 8}.span-xl-9{grid-column:span 9}.span-xl-10{grid-column:span 10}.span-xl-11{grid-column:span 11}.span-xl-12{grid-column:span 12}}@media (min-width:1200px){.span-2xl-1{grid-column:span 1}.span-2xl-2{grid-column:span 2}.span-2xl-3{grid-column:span 3}.span-2xl-4{grid-column:span 4}.span-2xl-5{grid-column:span 5}.span-2xl-6{grid-column:span 6}.span-2xl-7{grid-column:span 7}.span-2xl-8{grid-column:span 8}.span-2xl-9{grid-column:span 9}.span-2xl-10{grid-column:span 10}.span-2xl-11{grid-column:span 11}.span-2xl-12{grid-column:span 12}}.flex{display:flex;flex-direction:column;gap:var(--rh-space-lg,16px)}.flex-row{flex-direction:row}.flex-column{flex-direction:column}@media (min-width:768px){.flex-md-row{flex-direction:row}.flex-md-column{flex-direction:column}}.typography-h1{font-size:var(--rh-font-size-heading-2xl,3rem)}.typography-h2{font-size:var(--rh-font-size-heading-xl,2.5rem)}.typography-h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}.typography-h4{font-size:var(--rh-font-size-heading-md,1.75rem)}.typography-h5{font-size:var(--rh-font-size-heading-sm,1.5rem)}.typography-h6{font-size:var(--rh-font-size-heading-xs,1.25rem)}.content section{padding:0}.content h1,.content h2,.content h3,.content h4,.content h5,.content h6{margin:var(--rh-space-lg,16px) 0}.sr-only{height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0}.list-unstyled{list-style:none;padding-left:0}.tooltip-content{align-items:center;display:flex;font-family:Red Hat Text;justify-content:center;text-transform:none}.tooltip-content .check-icon{margin-left:var(--rh-space-md,8px)}.doc-image-link{display:inline-block;text-decoration:none}.modal-img{display:block;width:100%}.modal-helper-text{margin-top:.5rem;text-align:center}.modal-helper-text a{color:#000;cursor:pointer}.modal-helper-text a:hover{text-decoration:underline}.modal-helper-text a:after{content:"⿻";margin-left:.25rem}pf-modal.pf-img-modal{--pf-c-modal-box--MaxHeight:90vh;overflow-y:scroll}pf-modal.pf-img-modal::part(close-button){background-color:#fff;border-radius:50%;color:#000;margin-right:-2rem;margin-top:-2rem}pf-modal.pf-img-modal::part(close-button):hover{opacity:.7}h2.truste-title{line-height:normal;margin-top:0}rh-alert p[slot=header]{color:#002952}@media (width < 992px){html:has(nav.mobile-nav .mobile-nav-wrapper){scroll-behavior:smooth;scroll-padding-top:4rem}html:has(nav.mobile-nav .mobile-jump-links){scroll-padding-top:7rem}html:has(nav.mobile-nav.hide-mobile-nav){scroll-padding-top:2rem}}.highlight{background:#fff4cc;color:#000}</style>
<style>rh-alert[data-v-84359384]{width:100%}</style>
<style>.search-btn[data-v-edc0d12c]{align-items:center;background-color:var(--rh-color-canvas-black,#151515);border:3px solid var(--rh-color-canvas-black,#151515);cursor:pointer;display:flex;flex-direction:column;height:100%;justify-content:center;outline:none;padding:14px var(--rh-space-md,8px)}.search-btn[data-v-edc0d12c]:focus{border-top:3px solid var(--rh-color-accent-brand-on-light,#e00);outline:2px dotted var(--rh-color-white,#fff)}.search-btn .search-icon[data-v-edc0d12c]{height:26px;padding:2px 0 var(--rh-space-xs,4px);width:20px}.search-btn .search-icon[data-v-edc0d12c],.search-icon-helper-text[data-v-edc0d12c]{color:var(--rh-color-white,#fff)}.search-mobile[data-v-edc0d12c]{margin-bottom:var(--rh-space-2xl,32px)}.search-mobile form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto}.search-box[data-v-edc0d12c]{width:35rem}nav[data-v-edc0d12c]{background-color:#151515;justify-content:space-between;width:100%}a[data-v-edc0d12c],a[data-v-edc0d12c]:visited{color:#fff;display:inline-block;font-size:var(--rh-font-size-body-text-md,1rem)}.skip-link[class][class][data-v-edc0d12c]{font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class][data-v-edc0d12c]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}.visually-hidden[data-v-edc0d12c]{border:1px solid #06c;height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);white-space:nowrap}h3[data-v-edc0d12c]{color:#464646;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-lg,1.125rem)}.language-picker[data-v-edc0d12c]{align-items:center;background-color:#fff;display:flex;flex-direction:column;padding:var(--rh-space-xl,24px);width:100%}.language-picker h3[data-v-edc0d12c]{margin:0;padding:0 1rem 1rem}.language-picker ul[data-v-edc0d12c]{margin:0;padding:0}.language-picker a[data-v-edc0d12c]{color:#06c}.language-picker li[data-v-edc0d12c]{list-style:none}.language-dropdown[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:block!important;position:absolute;right:0;width:100%;z-index:104}.pfe-navigation.pfe-navigation--processed>[slot=secondary-links][data-v-edc0d12c]{height:auto;overflow:visible;visibility:visible;width:auto}.upper-navigation[data-v-edc0d12c]{padding:0 var(--rh-space-2xl,32px)}.upper-nav-container[data-v-edc0d12c]{border-bottom:1px solid #404040;margin:0}.upper-nav-hidden[data-v-edc0d12c]:not(:focus):not(:active){clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.upper-nav-menu[data-v-edc0d12c]{align-items:center;display:flex;justify-content:flex-end;line-height:1.444;list-style:none;margin-bottom:0;margin-top:0;padding-left:0}.upper-nav-menu[data-v-edc0d12c],.upper-nav-menu>li[data-v-edc0d12c]{position:relative}.upper-nav-menu>li:not(:first-child)>a[data-v-edc0d12c]:before,.upper-nav-menu>li:not(:first-child)>button[data-v-edc0d12c]:before{background-color:#404040;content:"";height:40%;left:0;position:absolute;top:30%;width:1px}li[data-v-edc0d12c]{display:list-item;margin:0;padding:0;text-align:-webkit-match-parent}.upper-nav-menu button.upper-nav-links[data-v-edc0d12c]{border:0;border-top:3px solid transparent;cursor:pointer;line-height:1.444}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]{outline-color:#151515}.upper-nav-menu button.upper-nav-links[aria-expanded=true] .upper-nav-arrow[data-v-edc0d12c]{filter:invert(0) sepia(2%) saturate(21%) hue-rotate(257deg) brightness(108%) contrast(100%);transform:rotate(270deg)}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]:before{display:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]{background-color:var(--pfe-navigation--BackgroundColor,var(--pfe-theme--color--surface--darkest,#151515));border-top:3px solid transparent;color:#fff;display:block;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);outline:none;padding:12px 12px 14px;text-decoration:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:hover{border-top-color:#b8bbbe}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within{outline:1px dashed var(--rh-color-white,#fff);outline-offset:-1px}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within:before{display:none}.upper-nav-dropdown-container[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:none;padding:5px 30px 24px;position:absolute;right:0;top:100%;width:500px;z-index:105}.upper-nav-dropdown-container>ul[data-v-edc0d12c]{-moz-column-count:2;column-count:2;list-style-type:none;padding:0;width:auto}.upper-nav-dropdown-container>ul li[data-v-edc0d12c]{color:#151515;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);list-style-type:none;margin-bottom:0}.upper-nav-dropdown-container>ul li span[data-v-edc0d12c]{font-weight:var(--rh-font-weight-body-text-medium,500)}.upper-nav-dropdown-container>ul ul[data-v-edc0d12c]{padding-left:0;padding-top:9px}.upper-nav-dropdown-container>ul>li[data-v-edc0d12c]{padding-top:19px;-moz-column-break-inside:avoid;break-inside:avoid}.upper-nav-dropdown-container>ul>li>ul>li[data-v-edc0d12c]{line-height:1.45;padding:4px 0}.upper-nav-menu .upper-nav-arrow[data-v-edc0d12c]{display:inline-block;filter:invert(100%) sepia(8%) saturate(7%) hue-rotate(1turn) brightness(100%) contrast(93%);height:18px;margin-left:5px;transform:rotate(90deg);vertical-align:middle;width:8px}#pfe-navigation__secondary-links .show[data-v-edc0d12c],.upper-navigation .show[data-v-edc0d12c]{display:block}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:active,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:focus,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:hover{background-color:#fff;color:#151515}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]{background-color:#fff;border-top-color:#b8bbbe;color:#000;position:relative;z-index:1}.upper-nav-dropdown-container>ul a[data-v-edc0d12c]{color:var(--rh-color-accent-base-on-light,#06c);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;text-decoration:none}.pfe-navigation__search[data-v-edc0d12c]{background-color:var(--rh-color-white,#fff)}.pfe-navigation__search form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto;max-width:992px}pfe-navigation [slot=secondary-links] .buttons[data-v-edc0d12c]{display:flex;flex-wrap:wrap;gap:var(--rh-space-md,8px);margin-top:4px}pfe-navigation [slot=secondary-links] .buttons a[data-v-edc0d12c]{border:1px solid #d2d2d2;border-radius:3px;color:#06c;cursor:pointer;flex-basis:calc(50% - 5px);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-weight:var(--rh-font-weight-code-regular,400);padding:1em;text-align:center;text-decoration:none}pfe-navigation [slot=secondary-links] .mobile-lang-select[data-v-edc0d12c]{border:1px solid #d2d2d2;border-bottom-color:#3c3f42;cursor:pointer;display:flex;margin:3rem 0;position:relative}pfe-navigation [slot=secondary-links] .mobile-lang-select label[data-v-edc0d12c]{bottom:100%;color:#000;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;font-weight:500;margin-bottom:5px;position:absolute}pfe-navigation [slot=secondary-links] .mobile-lang-select select[data-v-edc0d12c]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border-style:none;color:#000;flex-basis:100%;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:16px;line-height:24px;padding:6px 24px 6px 8px}select[data-v-edc0d12c]{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position:98% 50%;background-repeat:no-repeat}#inputLabel[data-v-edc0d12c]{align-items:center;display:flex;position:relative}#inputLabel form[data-v-edc0d12c]{width:100%}.input-box[data-v-edc0d12c]{font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 8px;width:100%}.input-box[data-v-edc0d12c]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-box[data-v-edc0d12c]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}@media(max-width:960px){.search-box[data-v-edc0d12c]{width:28rem}}@media (max-width:768px){.right-navigation[data-v-edc0d12c],.upper-navigation[data-v-edc0d12c]{display:none}}@media (min-width:767px){.pfe-navigation__search form[data-v-edc0d12c]{padding:var(--rh-space-2xl,32px) 0}}</style>
<style>.element-invisible,.sr-only,.visually-hidden{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;white-space:nowrap}@keyframes reveal-nav{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@keyframes reveal-nav-parts{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}1%{visibility:visible}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@media print{.pfe-navigation__menu,pfe-navigation [slot]{display:none!important}}pfe-navigation{--pfe-broadcasted--text:var(--pfe-theme--color--text,#151515);--pfe-broadcasted--text--muted:var(--pfe-theme--color--text--muted,#6a6e73);--pfe-broadcasted--link:var(--pfe-theme--color--link,#06c);--pfe-broadcasted--link--hover:var(--pfe-theme--color--link--hover,#004080);--pfe-broadcasted--link--focus:var(--pfe-theme--color--link--focus,#004080);--pfe-broadcasted--link--visited:var(--pfe-theme--color--link--visited,#6753ac);--pfe-broadcasted--link-decoration:var(--pfe-theme--link-decoration,none);--pfe-broadcasted--link-decoration--hover:var(--pfe-theme--link-decoration--hover,underline);--pfe-broadcasted--link-decoration--focus:var(--pfe-theme--link-decoration--focus,underline);--pfe-broadcasted--link-decoration--visited:var(--pfe-theme--link-decoration--visited,none)}@supports (display:grid){pfe-navigation{animation:reveal-nav .1618s 4s 1 forwards;max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}pfe-navigation>*{animation:reveal-nav-parts .1618s 4s 1 forwards;opacity:0;transition:opacity .1618s ease-in-out;transition:opacity var(--pfe-reveal-duration,.1618s) ease-in-out;visibility:hidden}}pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed>*{animation:none;opacity:1;visibility:visible}pfe-navigation pfe-primary-detail{display:none}pfe-navigation[pfelement]{display:block}pfe-navigation-dropdown{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515)}#pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],#pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],#pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class],pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class]{display:none}#pfe-navigation,#pfe-navigation *,pfe-navigation,pfe-navigation *{box-sizing:border-box}#pfe-navigation [pfelement] .pfe-navigation__log-in-link,pfe-navigation [pfelement] .pfe-navigation__log-in-link{display:none}#pfe-navigation,pfe-navigation{align-items:stretch;background:#151515;background:var(--pfe-navigation__nav-bar--Background,#151515);color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;font-family:Red Hat Text,RedHatText,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamily,Red Hat Text,RedHatText,Arial,Helvetica,sans-serif);font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);height:auto;line-height:1.5;margin:0;max-width:9999em;min-height:72px;min-height:var(--pfe-navigation__nav-bar--Height,72px);padding:0 16px;position:relative;z-index:95;z-index:var(--pfe-navigation--ZIndex,var(--pfe-theme--zindex--navigation,95))}@media (min-width:768px){#pfe-navigation,pfe-navigation{flex-wrap:wrap;margin:0;max-width:9999em;padding:0 16px}}@media (min-width:1200px){#pfe-navigation,pfe-navigation{margin:0 auto;padding:0 32px}}#pfe-navigation .pfe-navigation__dropdown,#pfe-navigation pfe-navigation-dropdown,pfe-navigation .pfe-navigation__dropdown,pfe-navigation pfe-navigation-dropdown{display:none}#pfe-navigation>[slot=account],#pfe-navigation>[slot=search],#pfe-navigation>[slot=secondary-links],pfe-navigation>[slot=account],pfe-navigation>[slot=search],pfe-navigation>[slot=secondary-links]{height:0;overflow:hidden;visibility:hidden;width:0}@media (min-width:768px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{align-items:stretch;display:flex;flex-wrap:wrap}}@media (min-width:992px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{flex-wrap:nowrap}}#pfe-navigation .pfe-navigation__logo-wrapper,pfe-navigation .pfe-navigation__logo-wrapper{align-items:center;display:flex;justify-content:flex-start;margin:0;min-width:150px;padding:10px 16px 10px 0}@media (min-width:768px){.pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:auto}}.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:0}#pfe-navigation .pfe-navigation__logo-link,pfe-navigation .pfe-navigation__logo-link{border-radius:3px;display:block;margin-left:-8px;outline:0;padding:6px 8px;position:relative}#pfe-navigation .pfe-navigation__logo-link:focus,pfe-navigation .pfe-navigation__logo-link:focus{outline:0}#pfe-navigation .pfe-navigation__logo-link:focus:after,pfe-navigation .pfe-navigation__logo-link:focus:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:block;height:auto;width:100%}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{height:40px;height:var(--pfe-navigation__logo--height,40px);width:auto}}@media print{#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:none}}#pfe-navigation .pfe-navigation__logo-image:only-child,pfe-navigation .pfe-navigation__logo-image:only-child{display:block}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small{height:32px;height:var(--pfe-navigation__logo--height,32px)}}@media print{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen{display:none!important}}@media screen{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print{display:none!important}}#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print{display:inline-block!important}#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;justify-content:center;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{display:none!important}}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__fallback-links a[class]:focus,#pfe-navigation .pfe-navigation__fallback-links a[class]:hover,#pfe-navigation .pfe-navigation__log-in-link[class]:focus,#pfe-navigation .pfe-navigation__log-in-link[class]:hover,#pfe-navigation .pfe-navigation__menu-link[class]:focus,#pfe-navigation .pfe-navigation__menu-link[class]:hover,#pfe-navigation .pfe-navigation__secondary-link[class]:focus,#pfe-navigation .pfe-navigation__secondary-link[class]:hover,pfe-navigation .pfe-navigation__fallback-links a[class]:focus,pfe-navigation .pfe-navigation__fallback-links a[class]:hover,pfe-navigation .pfe-navigation__log-in-link[class]:focus,pfe-navigation .pfe-navigation__log-in-link[class]:hover,pfe-navigation .pfe-navigation__menu-link[class]:focus,pfe-navigation .pfe-navigation__menu-link[class]:hover,pfe-navigation .pfe-navigation__secondary-link[class]:focus,pfe-navigation .pfe-navigation__secondary-link[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__secondary-link:focus{outline:0}#pfe-navigation .pfe-navigation__fallback-links a:focus:after,#pfe-navigation .pfe-navigation__log-in-link:focus:after,#pfe-navigation .pfe-navigation__menu-link:focus:after,#pfe-navigation .pfe-navigation__secondary-link:focus:after,pfe-navigation .pfe-navigation__fallback-links a:focus:after,pfe-navigation .pfe-navigation__log-in-link:focus:after,pfe-navigation .pfe-navigation__menu-link:focus:after,pfe-navigation .pfe-navigation__secondary-link:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{pointer-events:none}#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding:0 16px 0 0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{display:block;height:18px}#pfe-navigation .pfe-navigation__fallback-links a[class],#pfe-navigation .pfe-navigation__fallback-links a[href],#pfe-navigation .pfe-navigation__log-in-link[class],#pfe-navigation .pfe-navigation__log-in-link[href],#pfe-navigation .pfe-navigation__menu-link[class],#pfe-navigation .pfe-navigation__menu-link[href],#pfe-navigation .pfe-navigation__secondary-link[class],#pfe-navigation .pfe-navigation__secondary-link[href],pfe-navigation .pfe-navigation__fallback-links a[class],pfe-navigation .pfe-navigation__fallback-links a[href],pfe-navigation .pfe-navigation__log-in-link[class],pfe-navigation .pfe-navigation__log-in-link[href],pfe-navigation .pfe-navigation__menu-link[class],pfe-navigation .pfe-navigation__menu-link[href],pfe-navigation .pfe-navigation__secondary-link[class],pfe-navigation .pfe-navigation__secondary-link[href]{align-items:center;justify-content:center}#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%;--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none!important}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation [slot=account]>a[href]:focus,#pfe-navigation [slot=account]>a[href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation [slot=account]>a[href]:focus,pfe-navigation [slot=account]>a[href]:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation [slot=account]>a[href]:focus,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation [slot=account]>a[href]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle:focus:after,#pfe-navigation [slot=account]>a[href]:focus:after,pfe-navigation .pfe-navigation__account-toggle:focus:after,pfe-navigation [slot=account]>a[href]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{pointer-events:none}@supports (display:grid){#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__account-toggle[class]:focus,#pfe-navigation .pfe-navigation__account-toggle[class]:hover,#pfe-navigation [slot=account]>a[href][class]:focus,#pfe-navigation [slot=account]>a[href][class]:hover,pfe-navigation .pfe-navigation__account-toggle[class]:focus,pfe-navigation .pfe-navigation__account-toggle[class]:hover,pfe-navigation [slot=account]>a[href][class]:focus,pfe-navigation [slot=account]>a[href][class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none}}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{--pfe-icon--size:18px;padding:2px 0 4px}@media (min-width:768px){#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{padding-right:0}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],#pfe-navigation [slot=account]>a[href][href]:focus,#pfe-navigation [slot=account]>a[href][href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation [slot=account]>a[href][href]:focus,pfe-navigation [slot=account]>a[href][href]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after{border:1px dashed #151515;border:1px dashed var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{font-size:inherit;list-style:none;margin:0;padding:0}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{align-items:stretch;display:flex}}#pfe-navigation .pfe-navigation__fallback-links li,#pfe-navigation .pfe-navigation__menu li,pfe-navigation .pfe-navigation__fallback-links li,pfe-navigation .pfe-navigation__menu li{font-size:inherit;margin:0;padding:0}#pfe-navigation .pfe-navigation__fallback-links li:before,#pfe-navigation .pfe-navigation__menu li:before,pfe-navigation .pfe-navigation__fallback-links li:before,pfe-navigation .pfe-navigation__menu li:before{content:none}#pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__fallback-links{margin-left:auto}#pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__menu-link{display:flex;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);white-space:nowrap}#pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed{display:block;padding:0}#pfe-navigation.pfe-navigation--processed:before,pfe-navigation.pfe-navigation--processed:before{content:none}#pfe-navigation.pfe-navigation--processed>[slot=account],#pfe-navigation.pfe-navigation--processed>[slot=search],#pfe-navigation.pfe-navigation--processed>[slot=secondary-links],pfe-navigation.pfe-navigation--processed>[slot=account],pfe-navigation.pfe-navigation--processed>[slot=search],pfe-navigation.pfe-navigation--processed>[slot=secondary-links]{height:auto;overflow:visible;visibility:visible;width:auto}#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,#pfe-navigation.pfe-navigation--processed>[slot],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed>[slot]{animation:none;opacity:1}#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{display:block;height:auto;list-style:none;margin:0 0 8px;padding:0;width:auto}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0 0 8px}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{display:none!important}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{pointer-events:none}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding:0 16px 0 0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{display:block;height:18px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed #fff;border:1px dashed var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{box-shadow:none}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{background:0 0;box-shadow:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column{position:relative}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper{display:block}#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{height:0;transition:height .25s ease-in-out;transition:var(--pfe-navigation--accordion-transition,height .25s ease-in-out)}@media (prefers-reduced-motion){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{transition:none}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:absolute;right:0;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:auto}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:0}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper{left:100vw;left:calc(100vw - 32px);left:calc(100vw - var(--pfe-navigation__mobile-dropdown--PaddingHorizontal,32px));position:absolute;top:0;width:100vw}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false],pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false]{height:100vh;height:calc(100vh - 72px);height:calc(100vh - var(--pfe-navigation__nav-bar--Height,72px));overflow-y:scroll}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 64px24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px) var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a{border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));display:inline-block}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6{margin:32px 0 .75em;margin:var(--pfe-navigation--gutter,32px) 0 .75em;padding:0;-moz-column-break-inside:avoid;break-inside:avoid;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);font-family:Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamilyHeadline,Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif);font-size:1.125rem;font-size:var(--pf-global--FontSize--lg,1.125rem);font-weight:500}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a{border:1px solid transparent;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li{margin:0 0 16px;-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--BackgroundColor,#e00);--pfe-cta--BackgroundColor--hover:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00);--pfe-theme--ui--border-width:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00)}pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul{list-style:none;margin:0;padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515);-moz-column-count:auto;column-count:auto;display:block;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);gap:0;margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:flex;flex-wrap:wrap;padding-bottom:32px;padding-top:32px}@supports (display:grid){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{display:grid;gap:32px;gap:var(--pfe-navigation--gutter,32px);grid-auto-flow:row;grid-template-columns:repeat(4,minmax(0,1fr))}}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:block;gap:0;margin-left:-16px;margin-right:-16px;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{transition-delay:0s;visibility:visible}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px;-moz-column-break-inside:avoid;break-inside:avoid}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid{max-width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown{background:#fff}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:32px 64px;padding:32px var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px)}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container{margin:0;padding:0;width:auto}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class]{padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown{visibility:hidden}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{padding:0}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:0 1px 2px rgba(0,0,0,.12);box-shadow:var(--pfe-navigation__dropdown--BoxShadow,0 1px 2px rgba(0,0,0,.12));max-width:100%;min-width:13em;padding:0 32px;position:absolute;top:100%}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:none;max-width:100%;position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{right:0}}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{width:100%}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{left:0;position:absolute;right:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{position:static}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown{width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles{padding-left:16px;padding-right:16px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form{align-items:center;display:flex}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{padding:10px;transition:box-shadow .2s}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{border:1px solid #f0f0f0;border-bottom-color:#8b8e91;color:#717579;flex-basis:0%;flex-grow:1;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);margin-right:8px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button{background-color:#e00;border:1px solid #e00;border-radius:2px;color:#fff;flex-basis:auto;flex-grow:0;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after{border:1px dashed #000;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{border-bottom:1px solid #d2d2d2;border-bottom:var(--pfe-navigation__dropdown--separator--Border,1px solid var(--pfe-theme--color--ui--border--lighter,#d2d2d2));display:block}@media (min-width:768px){#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:none}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__site-switcher__back-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:block}#pfe-navigation .pfe-navigation__site-switcher__back-button,pfe-navigation .pfe-navigation__site-switcher__back-button{background-color:transparent;border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);padding:21px 21px 21px 45px;position:relative;text-align:left;width:100%}#pfe-navigation .pfe-navigation__site-switcher__back-button:before,pfe-navigation .pfe-navigation__site-switcher__back-button:before{border:2px solid #06c;border:2px solid var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));border-right:0;border-top:0;content:"";display:block;height:8px;left:35px;position:absolute;right:auto;top:27px;transform:rotate(45deg);transform-origin:left top;width:8px}#pfe-navigation .pfe-navigation__site-switcher__back-button:focus,#pfe-navigation .pfe-navigation__site-switcher__back-button:hover,pfe-navigation .pfe-navigation__site-switcher__back-button:focus,pfe-navigation .pfe-navigation__site-switcher__back-button:hover{border:1px dashed #151515;border-top:1px dashed #151515;border:1px dashed var(--pfe-navigation__dropdown--Color,#151515);color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);outline:0}#pfe-navigation.pfe-navigation--processed site-switcher,pfe-navigation.pfe-navigation--processed site-switcher{-moz-columns:auto;columns:auto;display:block}#pfe-navigation.pfe-navigation--stuck,pfe-navigation.pfe-navigation--stuck{left:0;position:fixed;top:0;width:100%;z-index:95;z-index:var(--pfe-theme--zindex--navigation,95)}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner{opacity:1!important}#pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown{display:none!important}#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown{display:block!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item{display:block}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus{outline:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown{display:flex;flex-wrap:wrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope{flex-basis:25%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope{flex-basis:100%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope{margin-right:16px}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{display:flex;flex-direction:column;flex-wrap:nowrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{flex-basis:auto}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a{color:#fff!important;justify-content:center!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true]{color:#151515!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon{display:none!important}[id=pfe-navigation__account-dropdown][class][class]{display:block;height:auto;left:0;padding:0;position:absolute;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px);width:100%}[id=pfe-navigation__account-dropdown].pfe-navigation__dropdown-wrapper--invisible[class]{display:none}.pfe-navigation__dropdown-wrapper{overflow:hidden}@media (min-width:768px){.pfe-navigation__custom-dropdown--single-column{min-width:25em}}.pfe-navigation--collapse-secondary-links .pfe-navigation__custom-dropdown--single-column{min-width:0}.secondary-link__icon-wrapper{align-items:center;display:flex;justify-content:center}.secondary-link__alert-count{background:#06c;background:var(--pfe-navigation__nav-bar--alert-color,var(--pfe-theme--color--link,#06c));border-radius:20px;color:#fff;color:var(--pfe-navigation__nav-bar--Color--on-highlight,var(--pfe-theme--color--text--on-saturated,#fff));display:block;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);line-height:20px;margin:0 4px 0 2px;min-width:23px;overflow:hidden;padding:0 8px}.secondary-link__alert-count:empty{display:none}#pfe-navigation__1x-skip-links{left:0;position:absolute;top:0}#pfe-navigation__1x-skip-links,#pfe-navigation__1x-skip-links li{height:0;list-style:none;margin:0;padding:0;width:0}.skip-link[class][class]{font-size:.875rem;font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}pfe-navigation pfe-navigation-account[slot=account]{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));width:100%}</style>
<style>:host([size=sm]) #container[data-v-8589d091]{--_size:var(--pf-global--icon--FontSize--sm,12px)}.content-wrapper[data-v-8589d091]{height:auto;margin:0 auto;min-height:46vh}.content[data-v-8589d091]{max-width:1000px}#left-content[data-v-8589d091]{max-width:330px;z-index:1}.line-below-chp[data-v-8589d091]{margin:var(--rh-space-xl,24px) 0 var(--rh-space-3xl,48px)}.toc-container[data-v-8589d091]{border-right:1px solid var(--rh-color-gray-30,#c7c7c7);min-height:100vh;position:sticky;top:0;transition:transform .3s ease-in-out}nav#toc[data-v-8589d091]{height:auto;overflow-y:auto;padding-bottom:var(--rh-space-2xl,32px)}.max-height-85[data-v-8589d091]{max-height:85vh}.max-height-75[data-v-8589d091]{max-height:75vh}.toc-filter[data-v-8589d091]{background-color:#fff;padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px);position:sticky;top:-1px;width:100%;z-index:1}#text[data-v-8589d091],.toc-filter[data-v-8589d091]{align-items:center;display:flex}#text[data-v-8589d091]{flex:1;flex-direction:row}#search-icon[data-v-8589d091]{color:#151515;left:2.5rem;position:absolute;top:55%;transform:translateY(-50%)}pf-icon[data-v-8589d091]{--pf-icon--size:16px}#text:focus-within #icon[data-v-8589d091],#text:hover #icon[data-v-8589d091]{color:#151515}#text[data-v-8589d091]:after,#text[data-v-8589d091]:before{content:"";inset:0;pointer-events:none;position:absolute}#text-input[data-v-8589d091]:focus,#text-input:focus+#utilities[data-v-8589d091]{border-bottom:2px solid #06c;outline:none}#text-input[data-v-8589d091]{background-color:transparent;border:1px solid #f0f0f0;border-bottom-color:#8a8d90;color:#151515;font-family:inherit;font-size:100%;grid-area:text-input;line-height:1.5;overflow:hidden;padding:.375rem .25rem .375rem 2rem;position:relative;text-overflow:ellipsis;white-space:nowrap;width:100%}#utilities[data-v-8589d091]{align-items:center;border:1px solid #f0f0f0;border-bottom:1px solid #8a8d90;border-left:0;display:flex}#utilities rh-badge[data-v-8589d091]{border-radius:80px;font-weight:var(--rh-font-weight-heading-medium,500);--_background-color:#e0e0e0;margin-right:8px}#clear-button[data-v-8589d091]{--pf-c-button--PaddingTop:0.625rem;--pf-c-button--PaddingRight:.25rem;--pf-c-button--PaddingBottom:0.625rem;--pf-c-button--PaddingLeft:.25rem;margin-right:8px}#text-input.no-right-border[data-v-8589d091]{border-right:0}.btn-container[data-v-8589d091]{bottom:0;display:flex;justify-content:flex-end;padding:1rem;pointer-events:none;position:fixed;right:0;z-index:2}.top-scroll-btn[data-v-8589d091]{--pf-c-button--BorderRadius:64px;pointer-events:all}.focusable[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-interactive-blue,#06c)}.mobile-nav-wrapper[data-v-8589d091]{align-items:center;border-bottom:1px solid #c7c7c7;display:flex;height:auto;justify-content:space-between;padding:var(--rh-space-sm,.5rem)}.mobile-nav[data-v-8589d091]{align-items:center;background-color:var(--rh-color-bg-page,#fff);min-height:51px;position:sticky;top:0;z-index:5}.active-mobile-menu[data-v-8589d091]{color:#151515;padding-left:.5rem}.hidden[data-v-8589d091]{display:none}.mobile-nav-btn[data-v-8589d091]{background-color:transparent;border:none;font-family:inherit;font-size:.875rem;font-weight:500;margin:0;min-height:40px;min-width:40px}.border-right[data-v-8589d091]{border-right:1px solid #c7c7c7}.toc-focus-container[data-v-8589d091]{position:sticky;top:0;z-index:2}.toc-focus-btn[data-v-8589d091]{align-items:center;background-color:var(--rh-color-white,#fff);border:1px solid var(--rh-color-blue-50,#06c);border-radius:50%;cursor:pointer;display:flex;height:40px;justify-content:center;position:absolute;right:-20px;top:15px;width:40px}.toc-focus-btn[data-v-8589d091]:focus-visible,.toc-focus-btn[data-v-8589d091]:hover{background-color:var(--rh-color-blue-10,#e0f0ff);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2))}.toc-focus-btn[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-blue-50,#06c)}.toc-focus-btn-icon[data-v-8589d091]{color:var(--rh-color-blue-50,#06c)}.toc-wrapper[data-v-8589d091]{padding:0}.product-container[data-v-8589d091]{border-bottom:1px solid var(--rh-color-gray-30,#c7c7c7);padding:var(--rh-space-xl,24px) var(--rh-space-2xl,32px)}.product-container h1.product-title[data-v-8589d091]{font-size:var(--rh-font-size-code-xl,1.25rem);line-height:30px;margin-bottom:0;margin-top:0}.product-container .product-version[data-v-8589d091]{align-items:center;display:flex;flex-wrap:wrap;margin-top:var(--rh-space-lg,16px)}.product-version .version-label[data-v-8589d091]{color:var(--rh-color-canvas-black,#151515);font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:500}.product-version .version-select-dropdown[data-v-8589d091]{margin:var(--rh-space-md,8px) var(--rh-space-sm,6px);max-width:9.75rem;min-height:2rem;min-width:3rem;overflow:hidden;width:-moz-min-content;width:min-content;word-wrap:nowrap;-webkit-appearance:none;-moz-appearance:none;background:var(--rh-color-white,#fff);background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position-x:85%;background-position-y:50%;background-repeat:no-repeat;border:1px solid var(--rh-color-gray-30,#c7c7c7);border-bottom:0;box-shadow:0 -1px 0 0 var(--rh-color-gray-60,#4d4d4d) inset;cursor:pointer;font-size:var(--rh-font-size-body-text-md,1rem);padding:var(--rh-space-md,8px);padding-right:24px;text-overflow:ellipsis}pf-popover[data-v-8589d091]{margin-top:var(--rh-space-md,8px);--pf-c-popover__arrow--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover__content--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover--BoxShadow:0px 4px 8px 0px #15151540;--pf-c-popover__title-text--Color:var(--rh-color-white,#fff);--pf-c-popover--MaxWidth:300px;--pf-c-popover--MinWidth:300px;--pf-c-popover--c-button--Top:20px;--pf-c-popover--c-button--Right:4px;--pf-c-button--m-plain--hover--Color:var(--rh-color-white,#fff)}pf-popover[data-v-8589d091]::part(content){padding:var(--rh-space-2xl,32px)}pf-popover[data-v-8589d091]::part(body){margin-top:var(--rh-space-lg,16px)}pf-popover[data-v-8589d091]::part(close-button){--pf-c-button--m-plain--focus--Color:var(--rh-color-gray-30,#c7c7c7);--pf-c-button--m-plain--Color:var(--rh-color-gray-30,#c7c7c7)}.popover-header-text[data-v-8589d091]{color:var(--rh-color-white,#fff);font-size:var(--rh-font-size-code-md,1rem);margin:0;max-width:80%;padding:0}.popover-body-link[data-v-8589d091]{color:var(--rh-color-blue-30,#92c5f9);text-decoration:none}.popover-trigger-btn[data-v-8589d091]{align-items:center;background:none;border:none;cursor:pointer;display:flex;justify-content:center}#first-button[data-v-8589d091]{width:80%}#second-button[data-v-8589d091]{text-align:right;width:20%}#toc-btn[data-v-8589d091]{text-align:left;width:100%}.toc-error[data-v-8589d091]{margin:0;max-width:100%}#layout label[data-v-8589d091]{font-weight:500}.page-layout-options[data-v-8589d091]{background-color:#fff;display:flex;flex-direction:column;padding-bottom:var(--rh-space-lg,16px)}.sticky-top[data-v-8589d091]{position:sticky;top:0}summary[data-v-8589d091]{cursor:pointer;list-style:none;position:relative}summary[data-v-8589d091]::-webkit-details-marker{display:none}details#jump-links-details .jump-links-heading[data-v-8589d091]{background-color:var(--rh-color-white,#fff);display:block;margin-top:var(--rh-space-lg,16px);padding:var(--rh-space-lg,16px) 0 0 var(--rh-space-xl,24px);position:sticky;top:0}details#jump-links-details .jump-links-heading[data-v-8589d091]:before{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;height:9px;left:2px;position:absolute;top:26px;transform:rotate(-135deg);width:9px}details#jump-links-details[open] .jump-links-heading[data-v-8589d091]:before{transform:rotate(135deg)}.table-of-contents>ol[data-v-8589d091]{list-style:none;margin:0;padding:0}nav.table-of-contents[data-v-8589d091]{z-index:1}nav.table-of-contents ol[data-v-8589d091]{list-style:none;margin:0;padding:0}#mobile-browse-docs[data-v-8589d091]{font-weight:var(--rh-font-weight-body-text-medium,500);padding-left:var(--rh-space-2xl,32px)}.docs-content-container[data-v-8589d091]{font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:1.6667;padding-left:6rem;padding-right:6rem;padding-top:var(--rh-space-3xl,4rem)}.chapter-title[data-v-8589d091]{font-family:Red Hat Display}h1.chapter-title[data-v-8589d091]{font-size:var(--rh-fontsize-heading-xl,2.25rem);line-height:46.8px;margin:0;padding:0}.chapter .section h4[data-v-8589d091]{font-size:24px;font-weight:400}.banner-wrapper[data-v-8589d091]{padding:3rem 6rem 0}.page-format-dropdown[data-v-8589d091]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#fff;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABtSURBVHgBhc4xCoAwDAXQxE6li0K76w0cPZqjHsEb6AlcHb2BR9ADdG7GmIKTWv0QSOAFPjrndgAo4TtHxszTD4JoVAhh1VoXiNgkUO+971Q8iGgxxlSy1jc3CGof39baWTrzNSOkkksEbG/oBGEJIn6gD3jAAAAAAElFTkSuQmCC");background-position:8.5rem;background-repeat:no-repeat;background-size:auto;border:1px solid #c7c7c7;box-shadow:inset 0 -1px 0 0 #4d4d4d;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-md,1rem);margin-top:var(--rh-space-xs,4px);max-width:168px;min-height:36px;min-width:168px;overflow:hidden;padding:0 var(--rh-space-xl,24px) 0 var(--rh-space-md,8px);text-overflow:ellipsis;white-space:nowrap}.content-format-selectors[data-v-8589d091]{color:#151515;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:var(--rh-font-weight-body-text-medium,500);margin-right:var(--rh-space-2xl,32px);max-width:250px;min-width:250px;padding-top:var(--rh-space-2xl,32px)}.chapter .section .simpara[data-v-8589d091],.chapter .section p[data-v-8589d091]{font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:30px}#toggle-focus-mode[data-v-8589d091]{padding-right:var(--rh-space-lg,1rem)}@keyframes slideaway-left-8589d091{0%{display:block}to{opacity:0;transform:translateX(-40px)}}@keyframes slideaway-right-8589d091{0%{display:block}to{opacity:0;transform:translateX(40px)}}@keyframes enter-left-8589d091{0%{display:none;transform:translateX(-40px)}to{opacity:1}}@keyframes enter-right-8589d091{0%{display:none;transform:translateX(40px)}to{opacity:1}}.hide-left[data-v-8589d091]{animation:slideaway-left-8589d091 .2s;display:none}.enter-left[data-v-8589d091]{animation:enter-left-8589d091 .3s;border-right:none;display:block}.enter-right[data-v-8589d091]{animation:enter-right-8589d091 .3s;display:block}.hide-right[data-v-8589d091]{animation:slideaway-right-8589d091 .2s;display:none}.toc-container.enter-toc-container-left[data-v-8589d091]{transform:translateX(-85%)}.alert-section[data-v-8589d091]{padding-bottom:3rem}rh-alert[data-v-8589d091]{width:auto}@media (min-width:992px){#mobile-nav[data-v-8589d091],#toc-list-mobile[data-v-8589d091]{display:none}}@media (min-width:992px) and (max-width:1400px){.docs-ocp-content-container[data-v-8589d091]{padding:var(--rh-space-4xl,64px) var(--rh-space-lg,16px) 0}}@media (width < 992px){#breadcrumbs[data-v-8589d091],.content-format-selectors[data-v-8589d091],.toc-container[data-v-8589d091]{display:none}#mobile-nav-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7}#toc-wrapper-mobile[data-v-8589d091]{padding:var(--rh-space-md,1.5rem)}.product-container[data-v-8589d091]{padding:var(--rh-space-2xl,32px) var(--rh-space-lg,16px)}.product-container.shrink-product-padding[data-v-8589d091]{padding:var(--rh-space-lg,16px)}.product-version .version-select-dropdown[data-v-8589d091]{margin:0 var(--rh-space-lg,16px)}#page-content-options-mobile[data-v-8589d091]{padding:var(--rh-space-lg,2rem)}label[for=page-format][data-v-8589d091],label[for=toggle-focus-mode][data-v-8589d091]{display:block}.page-format-dropdown[data-v-8589d091]{background-position:97%;max-width:100%}nav#mobile-toc-menu[data-v-8589d091]{max-height:50vh;overflow-y:scroll}.mobile-jump-links #first-button[data-v-8589d091]{width:100%}#jump-links-btn[data-v-8589d091]{text-align:left;width:100%}#mobile-jump-links-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7;padding:0 var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}.table-of-contents #browse-docs[data-v-8589d091]{margin-top:1rem;padding-top:var(--rh-space-md,1.5rem)}.mobile-nav[data-v-8589d091]{display:block}.hide-mobile-nav[data-v-8589d091],.mobile-nav[data-v-8589d091]{transition:transform .3s ease-in-out}.hide-mobile-nav[data-v-8589d091]{transform:translateY(-100%)}.docs-content-container[data-v-8589d091]{padding-left:1.25rem;padding-right:1.25rem;padding-top:var(--rh-space-xl,24px)}.banner-wrapper[data-v-8589d091]{padding:0 1rem}.toc-filter-mobile[data-v-8589d091]{align-items:center;display:flex;padding:var(--rh-space-lg,16px);width:100%}#text-input[data-v-8589d091]{padding-left:.5rem}.toc-filter[data-v-8589d091]{display:none}}@media (width <=576px){.content-format-selectors[data-v-8589d091]{display:none}}.informaltable[data-v-8589d091],.rhdocs .informaltable[data-v-8589d091],.rhdocs .table-contents[data-v-8589d091],.rhdocs .table-wrapper[data-v-8589d091],.table-contents[data-v-8589d091],.table-wrapper[data-v-8589d091]{max-height:var(--rh-table--maxHeight);overflow:auto}rh-table[data-v-8589d091]{display:block;margin:2rem 0;max-width:100%}.pvof-doc__wrapper[data-v-8589d091],.rhdocs[data-v-8589d091]{--rh-table--maxHeight:calc(100vh - 12.5rem)}</style>
<style>:is(rh-footer-block) a[data-v-97dd2752]{text-decoration:underline}</style>
<style>:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a{color:var(--rh-color-link-inline-on-dark,var(--rh-color-interactive-blue-lighter,#92c5f9));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:hover{color:var(--rh-color-link-inline-hover-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:is(:focus,:focus-within){color:var(--rh-color-link-inline-focus-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:visited{color:var(--rh-color-link-inline-visited-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a[slot^=logo]{display:block}:is(rh-footer) a[slot^=logo]>img{display:block;height:100%;height:var(--rh-size-icon-04,40px);width:auto}:is(rh-footer,rh-footer-universal,rh-global-footer) :is(h1,h2,h3,h4,h5,h6){font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);line-height:var(--rh-line-height-heading,1.3)}rh-footer [slot=links]:is(h1,h2,h3,h4,h5):nth-of-type(n+5){--_link-header-margin:calc(var(--rh-space-2xl, 32px) - var(--rh-space-lg, 16px))}rh-footer [slot^=links] a{gap:var(--rh-footer-links-gap,var(--rh-space-md,8px))}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] li{display:contents;margin:0;padding:0}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] a{color:var(--rh-color-text-primary-on-dark,#fff)!important;display:block;font-size:var(--rh-footer-link-font-size,var(--rh-font-size-body-text-sm,.875rem));width:-moz-fit-content;width:fit-content}:is(rh-footer-universal,rh-global-footer) [slot^=links] a{font-size:inherit}:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-lg,16px)}@media screen and (min-width:768px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-2xl,32px)}}@media screen and (min-width:1440px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-4xl,64px)}}rh-footer:not(:defined){background-color:var(--rh-color-surface-darker,#1f1f1f);display:grid;grid-template-areas:"footer" "global";grid-template-rows:1fr auto;min-height:var(--rh-footer-nojs-min-height,750px);width:100%}:is(rh-footer-universal,rh-global-footer):not(:defined):before{grid-area:global}rh-footer:not(:defined)>[slot=logo]{padding:var(--rh-space-2xl,32px) var(--_section-side-gap)}:is(rh-footer-universal,rh-global-footer):not(:defined)>*,rh-footer:not(:defined)>:not([slot=logo],:is(rh-footer-universal,rh-global-footer)){border:0;clip:rect(1px,1px,1px,1px);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}:is(rh-footer-universal,rh-global-footer):not(:defined){background-color:var(--rh-color-surface-darkest,#151515);display:block;min-height:176px;width:100%}rh-footer-universal rh-footer-copyright{grid-column:-1/1}</style>
<style>.status-legal .status-page-widget[data-v-5f538988]{display:block;margin:.5rem 0;width:11.3125rem;width:-moz-max-content;width:max-content}.status-page-widget[data-v-5f538988]{align-items:center;display:flex;flex-direction:row}.status-legal .status-page-widget .status-description[data-v-5f538988]{color:#ccc;font-weight:600;letter-spacing:.0125rem;line-height:1.5;margin-right:.5rem}.status-good[data-v-5f538988]{background-color:#3e8536}.status-critical[data-v-5f538988]{background-color:#a30100}.status-partial[data-v-5f538988]{background-color:#f5c12d}.status-maintentance[data-v-5f538988]{background-color:#316dc1}.status-minor[data-v-5f538988]{background-color:#b85c00}.status-description[data-v-5f538988]{color:#ccc;font-weight:500;letter-spacing:.2px;line-height:1.5}.current-status-indicator[data-v-5f538988]{border-radius:6px;display:inline-block;height:12px;margin:0 0 0 5px;width:12px}.current-status-indicator.small[data-v-5f538988]{border-radius:4px;display:inline-block;height:8px;margin:0 0 0 5px;width:8px}</style>
<style>.breadcrumbs[data-v-798f280c]{align-items:center;background-color:#f6f6f6;display:flex;gap:var(--rh-space-xl,24px);padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}nav[data-v-798f280c]{flex:1}ol[data-v-798f280c]{background-color:#f6f6f6;font-size:.875rem;list-style:none;margin:0;padding:0}li[data-v-798f280c]{color:#151515;display:inline}a[data-v-798f280c]:after{border-bottom-color:transparent;border-left-color:transparent;box-shadow:inset .25rem .25rem 0 .0625rem #8a8d8d;content:"";display:inline-block;height:1.07143em;margin:0 .5em;position:relative;right:0;top:.75em;transform:translateY(-.5em) rotate(135deg) scale(.5);width:1.07143em}</style>
<style>ol[data-v-fa0dae77]{margin:0;padding:0}li[data-v-fa0dae77],ol[data-v-fa0dae77],ul[data-v-fa0dae77]{list-style:none;margin:0}.chapter-title[data-v-fa0dae77]{font-size:1em}.sub-chapter-title[data-v-fa0dae77],.sub-chapter-title a[data-v-fa0dae77]{font-size:.875rem}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77],.heading[data-v-fa0dae77],.sub-nav .link[data-v-fa0dae77],.sub-nav .link .link[data-v-fa0dae77]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-fa0dae77]:hover,.link[data-v-fa0dae77]:hover,.sub-nav .link[data-v-fa0dae77]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}details[open]:first-of-type>.heading[data-v-fa0dae77]:after{transform:rotate(135deg)}.item[data-v-fa0dae77]{line-height:22px}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77]{color:var(--rh-color-text-primary-on-light,#151515)}.sub-nav[data-v-fa0dae77],.toc-wrapper[data-v-fa0dae77]{list-style:none;margin:0}.toc-wrapper[data-v-fa0dae77]{min-width:100%;padding:0}.sub-nav[data-v-fa0dae77]{font-size:1em;line-height:24px;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-fa0dae77]:hover{color:#151515}.active[data-v-fa0dae77]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.chapter-landing-page[data-v-fa0dae77]{font-weight:500}summary[data-v-fa0dae77]{cursor:pointer;list-style:none;position:relative}summary[data-v-fa0dae77]::-webkit-details-marker{display:none}@keyframes slideDown-fa0dae77{0%{height:0;opacity:0}to{height:var(--details-height-open,"100%");opacity:1}}html[data-v-fa0dae77]{--details-transition-time:400ms}details[data-v-fa0dae77]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-fa0dae77]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-fa0dae77]:after,details .heading[data-v-fa0dae77]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-fa0dae77]:after{height:8px;width:8px}</style>
<style>.item[data-v-b883c74f]{line-height:22px}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f]{color:var(--rh-color-text-primary-on-light,#151515)}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f],.heading[data-v-b883c74f],.sub-nav .link[data-v-b883c74f],.sub-nav .link .link[data-v-b883c74f]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-b883c74f]:hover,.link[data-v-b883c74f]:hover,.sub-nav .link[data-v-b883c74f]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}ol[data-v-b883c74f]{margin:0;padding:0}li[data-v-b883c74f],ol[data-v-b883c74f],ul[data-v-b883c74f]{list-style:none;margin:0}.chapter-title[data-v-b883c74f]{font-size:1em}.sub-nav[data-v-b883c74f]{font-size:1em;line-height:24px;list-style:none;margin:0;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-b883c74f]:hover{color:#151515}.active[data-v-b883c74f]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.sub-chapter-title[data-v-b883c74f],.sub-chapter-title a[data-v-b883c74f]{font-size:.875rem}summary[data-v-b883c74f]{cursor:pointer;list-style:none;position:relative}summary[data-v-b883c74f]::-webkit-details-marker{display:none}html[data-v-b883c74f]{--details-transition-time:400ms}.chapter-landing-page[data-v-b883c74f]{font-weight:500}details[open]:first-of-type>.heading[data-v-b883c74f]:after{transform:rotate(135deg)}details[data-v-b883c74f]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-b883c74f]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-b883c74f]:after,details .heading[data-v-b883c74f]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-b883c74f]:after{height:8px;width:8px}</style>
<style>.html-container[data-v-9c2a9ddb]{padding:2rem 1.5rem 0}rh-alert[data-v-9c2a9ddb]{color:#151515}@media (max-width:772px){.html-container[data-v-9c2a9ddb]{padding:3rem 1rem 0}}</style>
<style>.search-container[data-v-69710f44]{height:100%}.form-box[data-v-69710f44],.search-container[data-v-69710f44]{justify-content:center}.form-box[data-v-69710f44],.search-box[data-v-69710f44],.search-container[data-v-69710f44]{align-items:center;display:flex;width:100%}.search-box[data-v-69710f44]{justify-content:space-between;position:relative}ul[data-v-69710f44]{list-style-type:none}#search-list[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;box-shadow:0 4px 4px 0 #00000040;color:#151515;display:block;left:0;margin:0;padding:0;position:absolute;top:37px;width:100%;z-index:200}#search-list li[data-v-69710f44]{align-items:center;display:flex;justify-content:space-between;padding:.75rem}#search-list .active[data-v-69710f44],#search-list li[data-v-69710f44]:hover{background:#f0f0f0}.group-title[data-v-69710f44]{border-top:1px solid #4d4d4d;color:#4d4d4d;cursor:default;font-size:12px;font-weight:400;pointer-events:none}.group-title[data-v-69710f44],.group-title[data-v-69710f44]:hover{background:#fff}.search-item-text-elipsis[data-v-69710f44]{display:inline-block;max-width:48%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.search-item-text[data-v-69710f44]{padding-left:1.75rem}.search-item-chip[data-v-69710f44]{float:right}.search-product-version[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;border-radius:3px;font-size:1rem;font-weight:400;line-height:24px}.search-icon-form[data-v-69710f44]{color:var(--rh-color-gray-50,#707070);left:12px;position:absolute}.input-search-box[data-v-69710f44]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 40px;width:100%}.input-clear-btn[data-v-69710f44]{align-items:center;background-color:transparent;border:none;display:flex;height:36px;justify-content:center;margin-right:-30px;outline:none;transform:translateX(-30px)}.input-clear-btn[data-v-69710f44]:focus{border:1px solid var(--rh-color-accent-base-on-light,#06c)}.input-clear-btn:focus .input-clear-icon[data-v-69710f44]{color:var(--rh-color-canvas-black,#151515)}.input-clear-icon[data-v-69710f44]{color:#6b6e72;cursor:pointer}.input-clear-icon[data-v-69710f44]:hover{color:var(--rh-color-canvas-black,#151515)}.form-submit-btn[data-v-69710f44]::part(button){align-items:center;background-color:var(--rh-color-gray-20,#e0e0e0);border-radius:0;display:flex;height:36px;justify-content:center;--_default-border-color:var(--rh-color-gray-20,#e0e0e0)}.input-close-btn[data-v-69710f44]{background:none;border:none;cursor:pointer;margin:0 var(--rh-space-lg,16px)}.input-close-icon[data-v-69710f44]{color:var(--rh-color-white,#fff)}@media (max-width:992px){.form-box[data-v-69710f44]{gap:var(--rh-space-md,8px);margin:auto;width:100%}.input-search-box[data-v-69710f44]{border:1px solid var(--rh-color-gray-30,#c7c7c7)}.input-search-box[data-v-69710f44]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-search-box[data-v-69710f44]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.search-item-text-elipsis[data-v-69710f44]{max-width:60%}}@media (max-width:767px){.input-close-btn[data-v-69710f44]{display:none}.search-container[data-v-69710f44]{border:1px solid #f0f0f0}}</style>
<link rel="stylesheet" href="/_nuxt/entry.DNAluCmw.css" integrity="sha384-FnrZajt9k3u4tri3ClqikI96k+jP7kyrvgKKgdzBr5Y8CQEi3gusKE0+eMSLvGxm">
<link rel="stylesheet" href="/_nuxt/SearchAutocomplete.DkrJaF8R.css" integrity="sha384-Zw8gf6w7SrpWDmknvrab5QanIN+DSJRS/bPB9/lgDkhR7JhDmG/VF++MTMKU8mKB">
<link rel="stylesheet" href="/_nuxt/Breadcrumbs.BLkLxUMB.css" integrity="sha384-f6iEfCywVoZB0/hIKTRaxywtS21KzhBx2JOI/uVjjU9aqFcP7X9cqLH29w2HQvLe">
<link rel="stylesheet" href="/_nuxt/Alert.fTkXFs3h.css" integrity="sha384-yFMpT5E64LAQi3qJ10AJJ1oOH3DrI68OvLSjSivjNCQXZ25pmFxlPavPQ0TEyEpq">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C3PvZR0C.js" integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Ds9UYxCD.js" integrity="sha384-PFyBx6Pvk48yXM+prD4CDErW/3HFtPEqORVyAch5qDvJSyubA93+vR4jsWGRQKZs">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BUXK7nH-.js" integrity="sha384-Kqf3r1QrD7+NOn9EuK/ba9sTBZjn7vLAjnCoRtq7IKz+QV0JUUBFf1Snf1yVkkgr">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BxBriHwM.js" integrity="sha384-bejD6BN5N1iVRo5Ymn+LdVN0jvrnJTzgqgFD9xQ5+Yi46U6ff+s5W2AISzRWvJaM">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DB5Lt3x5.js" integrity="sha384-Ae/gV/4Dt4jnJApC0CWbckKJ7omq+W9Hb4jjdMyhxGJpwk6FlO7pGYMD3bPO/h1y">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D8BFaW0S.js" integrity="sha384-/m09v/yYk14L9Hra6/9jYtMTn2IdkKQvzpFPRQ5P/baRKwdZQN98873hqvwuYXFS">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/_58Q44fW.js" integrity="sha384-EdSd8jpnetO/BWDAc8C4SpQExZ7pYjMygNPvbLmiA1TaYsNUdVOqIIyOIzaErEeU">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DOCUiUcq.js" integrity="sha384-9H868K5q7MLzC8TSRXT3pVqDzsOVxZLYvUQ8cLGpHPZCFEyEJjnwSHE+/7FWrJPV">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CiTVMRA7.js" integrity="sha384-xBIJ2xO0t62/oREKqSxPtW1tRxKY+5YYXbGcJ0QR9IRM28JhL+53NOiAvVFn3rmF">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CR3F0y4K.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Bn-QuJwp.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/T_zvNmZe.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Ciddaed-.js">
<link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/Footer_Cloud.DpSdW8MR.svg">
<script type="module">
      import "@rhds/elements/rh-cta/rh-cta.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@cpelements/pfe-navigation/dist/pfe-navigation.min.js";
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">import "@rhds/elements/rh-footer/rh-footer.js"</script>
<link rel="canonical" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/managing_certificates_in_idm/index">
<script type="module">
      import "@rhds/elements/rh-alert/rh-alert.js";
      import "@rhds/elements/rh-code-block/rh-code-block.js";
      import '@rhds/elements/rh-cta/rh-cta.js';
      import '@patternfly/elements/pf-switch/pf-switch.js';
      import '@cpelements/rh-table/dist/rh-table.js';
      import '@patternfly/pfe-clipboard/dist/pfe-clipboard.min.js';
      import '@patternfly/elements/pf-button/pf-button.js';
      import '@patternfly/elements/pf-modal/pf-modal.js';
      import '@patternfly/elements/pf-icon/pf-icon.js';
      import '@patternfly/elements/pf-popover/pf-popover.js';
      import '@patternfly/elements/pf-tooltip/pf-tooltip.js';
      import '@rhds/elements/rh-badge/rh-badge.js';
      </script>
<meta name="description" content="Managing certificates in IdM | Red Hat Documentation">
<meta name="app-version" content="v0.0.1">
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
        import "@patternfly/elements/pf-badge/pf-badge.js";
      </script>
<script type="module" src="/_nuxt/C3PvZR0C.js" crossorigin integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c"></script></head><body><div id="__nuxt"><!--[--><!--[--><!----><header data-v-edc0d12c><a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden" data-v-edc0d12c>Skip to navigation</a><a href="#main-content" class="skip-link visually-hidden" data-v-edc0d12c>Skip to content</a><nav id="upper-navigation" class="upper-navigation" aria-labelledby="upper-navigation-label" data-analytics-region="upper-navigation" data-v-edc0d12c><p id="upper-navigation-label" class="upper-nav-hidden" data-v-edc0d12c>Featured links</p><div class="upper-nav-container" data-v-edc0d12c><ul class="upper-nav-menu" data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/" class="upper-nav-links" data-analytics-text="Support" data-analytics-category="Featured Links" data-v-edc0d12c>Support</a></li><li data-v-edc0d12c><a href="https://console.redhat.com/" class="upper-nav-links" data-analytics-text="Console" data-analytics-category="Featured Links" data-v-edc0d12c>Console</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" class="upper-nav-links" data-analytics-text="Developers" data-analytics-category="Featured Links" data-v-edc0d12c>Developers</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" class="upper-nav-links" data-analytics-text="Start a trial" data-analytics-category="Featured Links" data-v-edc0d12c>Start a trial</a></li><li data-v-edc0d12c><button id="all-red-hat" class="upper-nav-links" data-analytics-text="All Red Hat" data-analytics-category="Featured Links" aria-expanded="false" data-analytics-linktype="tab" data-v-edc0d12c>All Red Hat<svg class="upper-nav-arrow" xmlns="http://www.w3.org/2000/svg" width="1024" height="1024" viewBox="0 0 1024 1024" aria-hidden="true" data-v-edc0d12c=""><path d="M810.642 511.557c0 8.905-3.447 16.776-10.284 23.613L322.31 1013.216c-6.835 6.837-14.706 10.284-23.61 10.284s-16.776-3.447-23.613-10.284l-51.303-51.303c-6.837-6.837-10.284-14.707-10.284-23.612s3.447-16.775 10.284-23.61L626.972 511.5 223.784 108.31c-6.837-6.835-10.284-14.706-10.284-23.61s3.447-16.776 10.284-23.613l51.303-51.303C281.924 2.947 289.794-.5 298.7-.5s16.775 3.447 23.61 10.284L800.36 487.83c6.837 6.837 10.284 14.708 10.284 23.613v.114" data-v-edc0d12c=""/></svg></button><div class="upper-nav-dropdown-container" data-v-edc0d12c><ul data-v-edc0d12c><li data-v-edc0d12c><span data-v-edc0d12c>For customers</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/support" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Customer support" data-v-edc0d12c>Customer support</a></li><li data-v-edc0d12c><a href="/products" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Documentation" data-v-edc0d12c>Documentation</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/support/cases" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Support cases" data-v-edc0d12c>Support Cases</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/management" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Subscription management" data-v-edc0d12c>Subscription management</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/" data-analytics-category="All Red Hat|For customers" data-analytics-text="Red Hat Ecosystem Catalog" data-v-edc0d12c>Red Hat Ecosystem Catalog</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/partners" data-analytics-category="All Red Hat|For customers" data-analytics-text="Find a partner" data-v-edc0d12c>Find a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>For partners</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://connect.redhat.com/login" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner login" data-v-edc0d12c>Partner login</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/en/support" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner support" data-v-edc0d12c>Partner support</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Become a partner " data-v-edc0d12c>Become a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Try, buy, &amp; sell</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://marketplace.redhat.com/en-us" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Marketplace" data-v-edc0d12c>Red Hat Marketplace</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/store" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Store" data-v-edc0d12c>Red Hat Store</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/contact" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Contact sales" data-v-edc0d12c>Contact Sales</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Learning resources</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.redhat.com/en/services/training-and-certification" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Training and certification " data-v-edc0d12c>Training and certification</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" data-pzn-audience="developers|community" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="For developers" data-v-edc0d12c>For developers</a></li><li data-v-edc0d12c><a href="https://cloud.redhat.com/learn" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Hybrid cloud learning hub" data-v-edc0d12c>Hybrid cloud learning hub</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Interactive labs" data-v-edc0d12c>Interactive labs</a></li><li data-v-edc0d12c><a href="https://learn.redhat.com/" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Learning community" data-v-edc0d12c>Learning community</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/tv" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Red Hat TV" data-v-edc0d12c>Red Hat TV</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Open source communities</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.ansible.com/community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="Ansible" data-v-edc0d12c>Ansible</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/sysadmin/" id="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For system administrators" data-v-edc0d12c>For system administrators</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/architect/" data-pzn-audience="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For architects" data-v-edc0d12c>For architects</a></li></ul></li></ul></div></li></ul></div></nav><pfe-navigation full-width id="pfe-navigation" pf-sticky="true" lang="en" data-v-edc0d12c><nav class="pfe-navigation" aria-label="Main Navigation" data-v-edc0d12c><div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper" data-v-edc0d12c><a href="/en" class="pfe-navigation__logo-link" data-v-edc0d12c><img class="pfe-navigation__logo-image pfe-navigation__logo-image--screen pfe-navigation__logo-image--small" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" width="240" height="40" alt="Red Hat Documentation" data-v-edc0d12c></a></div></nav><span data-v-edc0d12c></span><div slot="secondary-links" data-v-edc0d12c><div class="hidden-at-desktop hidden-at-tablet search-mobile" data-v-edc0d12c><div id="search-form" class="search-container" opensearchbox="true" data-v-edc0d12c data-v-69710f44><form role="search" class="form-box" autocomplete="off" data-v-69710f44><div class="search-box" data-v-69710f44><pf-icon icon="search" size="md" class="search-icon-form" data-v-69710f44></pf-icon><input type="text" id="input-search" class="input-search-box" placeholder="Search documentation" value aria-autocomplete="list" data-v-69710f44><!----><!----><!----><rh-button disabled variant="tertiary" class="form-submit-btn" data-v-69710f44><img src="data:image/svg+xml,%3csvg%20width=&#39;14&#39;%20height=&#39;14&#39;%20viewBox=&#39;0%200%2014%2014&#39;%20fill=&#39;none&#39;%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%3e%3cpath%20d=&#39;M7%200L5.6%201.4L10.3%206H0V8H10.3L5.6%2012.6L7%2014L14%207L7%200Z&#39;%20fill=&#39;%23707070&#39;/%3e%3c/svg%3e" alt="Submit button" data-v-69710f44></rh-button></div></form><!----></div></div><div class="hidden-at-desktop hidden-at-tablet buttons" data-v-edc0d12c><a href="https://access.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Support" data-v-edc0d12c>Support</a><a href="https://console.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Console" data-v-edc0d12c>Console</a><a href="https://developers.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Developers" data-v-edc0d12c>Developers</a><a href="https://www.redhat.com/en/products/trials" data-analytics-category="More Red Hat" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a><a href="https://www.redhat.com/en/contact" data-analytics-category="More Red Hat" data-analytics-text="Contact" data-v-edc0d12c>Contact</a></div><div class="hidden-at-desktop hidden-at-tablet mobile-lang-select" data-v-edc0d12c><label for="lang_selection" data-v-edc0d12c>Select your language</label><select id="lang_selection" data-v-edc0d12c><!--[--><option value="en" xml:lang="en" hreflang="en" data-v-edc0d12c>English</option><option value="fr" xml:lang="fr" hreflang="fr" data-v-edc0d12c>Français</option><option value="ko" xml:lang="ko" hreflang="ko" data-v-edc0d12c>한국어</option><option value="ja" xml:lang="ja" hreflang="ja" data-v-edc0d12c>日本語</option><option value="zh-cn" xml:lang="zh-cn" hreflang="zh-cn" data-v-edc0d12c>中文 (中国)</option><option value="de" xml:lang="de" hreflang="de" data-v-edc0d12c>Deutsch</option><option value="it" xml:lang="it" hreflang="it" data-v-edc0d12c>Italiano</option><option value="pt-br" xml:lang="pt-br" hreflang="pt-br" data-v-edc0d12c>Português</option><option value="es" xml:lang="es" hreflang="es" data-v-edc0d12c>Español</option><!--]--></select></div></div></pfe-navigation></header><main id="main-content"><!--[--><!--[--><!--[--><!----><!----><!--]--><div class="breadcrumbs" id="breadcrumbs" data-v-8589d091 data-v-798f280c><nav aria-label="Breadcrumb" class="breadcrumb" data-v-798f280c><ol data-v-798f280c><li data-v-798f280c><a href="/" data-v-798f280c>Home</a></li><li data-v-798f280c><a href="/en/products" data-v-798f280c>Products</a></li><!--[--><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/" data-v-798f280c>Red Hat Enterprise Linux</a></li><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/9/" data-v-798f280c>9</a></li><li data-v-798f280c><!--[-->Managing certificates in IdM<!--]--></li><!--]--></ol></nav><span data-v-798f280c></span></div><!----><nav id="mobile-nav" class="mobile-nav" aria-label="mobile menu" data-v-8589d091><div class="mobile-nav-wrapper" data-v-8589d091><div id="first-button" data-v-8589d091><button id="toc-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><span class="sr-only" data-v-8589d091>Open </span>Table of contents</button></div><div id="second-button" data-v-8589d091><button id="settings-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><pf-icon icon="cog" size="md" data-v-8589d091></pf-icon><span class="sr-only" data-v-8589d091>Open page settings</span></button></div></div><div id="mobile-nav-content-wrapper" class="hidden" role="navigation" tabindex="0" data-v-8589d091><div id="toc-mobile" class="hidden" aria-labelledby="toc-btn" data-v-8589d091><div class="shrink-product-padding product-container" id="product-container-mobile" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter-mobile" data-v-8589d091><span id="text" part="text" data-v-8589d091><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper-mobile" class="span-xs-12 span-sm-4 span-md-3" lang="en" data-v-8589d091><nav id="mobile-toc-menu" class="table-of-contents" aria-label="table of content - mobile" data-v-8589d091><!----></nav></div><!----></div><div id="page-content-options-mobile" class="hidden" aria-labelledby="settings-btn" data-v-8589d091><div class="page-layout-options" data-v-8589d091><label for="page-format-mobile" data-v-8589d091>Format</label><select id="page-format-mobile" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div></div></div><!----><!----></nav><div class="grid grid-col-12 content-wrapper" data-v-8589d091><aside id="left-content" class="span-xs-12 span-sm-4 span-md-3" lang="en-us" aria-label="left navigation" xml:lang="en-us" data-v-8589d091><div class="toc-container" id="toc-container" visible="true" data-v-8589d091><div class="toc-focus-container" id="toc-focus-container" data-v-8589d091><button class="toc-focus-btn" aria-label="toggle left menu" aria-controls="toc-container" aria-expanded="true" data-v-8589d091><pf-icon size="md" icon="angle-left" class="toc-focus-btn-icon" data-v-8589d091></pf-icon></button></div><div class="product-container" id="product-container-desktop" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter" id="toc-filter" data-v-8589d091><span id="text" part="text" data-v-8589d091><span id="search-icon" part="search-icon" data-v-8589d091><pf-icon icon="filter" size="md" data-v-8589d091></pf-icon></span><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper" class="toc-wrapper" data-v-8589d091><nav id="toc" class="max-height-85 table-of-contents" aria-label="Table of contents" data-v-8589d091><ol id="toc-list" data-v-8589d091><!--[--><li class="item chapter" data-v-fa0dae77><a class="link active" href id="chapter-index" data-v-fa0dae77>Managing certificates in IdM</a></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#proc_providing-feedback-on-red-hat-documentation_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-proc_providing-feedback-on-red-hat-documentation_managing-certificates-in-idm" data-v-fa0dae77>Providing feedback on Red Hat documentation</a></li><li class="item chapter" data-v-fa0dae77><details id="toc--cert-intro_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="cert-intro_managing-certificates-in-idm--summary" data-v-fa0dae77>1. Public key certificates in Identity Management</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#cert-intro_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-cert-intro_managing-certificates-in-idm" data-v-fa0dae77>Public key certificates in Identity Management</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#certificate_authorities_in_idm" id="sub-link-to-managing_certificates_in_idm-certificate_authorities_in_idm" data-v-b883c74f>1.1. Certificate authorities in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#comparison_of_certificates_and_kerberos" id="sub-link-to-managing_certificates_in_idm-comparison_of_certificates_and_kerberos" data-v-b883c74f>1.2. Comparison of certificates and Kerberos</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-certs-to-authenticate-users_cert-intro" id="sub-link-to-managing_certificates_in_idm-using-certs-to-authenticate-users_cert-intro" data-v-b883c74f>1.3. The pros and cons of using certificates to authenticate users in IdM</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm--summary" data-v-fa0dae77>2. Managing certificates for users, hosts, and services using the integrated IdM CA</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm" data-v-fa0dae77>Managing certificates for users, hosts, and services using the integrated IdM CA</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#requesting-new-certificates-for-a-user-host-or-service-using-idm-web-ui_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca" id="sub-link-to-managing_certificates_in_idm-requesting-new-certificates-for-a-user-host-or-service-using-idm-web-ui_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca" data-v-b883c74f>2.1. Requesting new certificates for a user, host, or service using IdM Web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-certutil_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca" id="sub-link-to-managing_certificates_in_idm-requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-certutil_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca" data-v-b883c74f>2.2. Requesting new certificates for a user, host, or service from IdM CA using certutil</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-openssl_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca" id="sub-link-to-managing_certificates_in_idm-requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-openssl_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca" data-v-b883c74f>2.3. Requesting new certificates for a user, host, or service from IdM CA using openssl</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources" id="sub-link-to-managing_certificates_in_idm-additional_resources" data-v-b883c74f>2.4. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-idm-certificates-using-ansible_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="managing-idm-certificates-using-ansible_managing-certificates-in-idm--summary" data-v-fa0dae77>3. Managing IdM certificates using Ansible</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-idm-certificates-using-ansible_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-managing-idm-certificates-using-ansible_managing-certificates-in-idm" data-v-fa0dae77>Managing IdM certificates using Ansible</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible" id="sub-link-to-managing_certificates_in_idm-using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible" data-v-b883c74f>3.1. Using Ansible to request SSL certificates for IdM hosts, services and users</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible" id="sub-link-to-managing_certificates_in_idm-using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible" data-v-b883c74f>3.2. Using Ansible to revoke SSL certificates for IdM hosts, services and users</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible" id="sub-link-to-managing_certificates_in_idm-using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible" data-v-b883c74f>3.3. Using Ansible to restore SSL certificates for IdM users, hosts, and services</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible" id="sub-link-to-managing_certificates_in_idm-using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible" data-v-b883c74f>3.4. Using Ansible to retrieve SSL certificates for IdM users, hosts, and services</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-externally-signed-certificates-for-idm-users-hosts-and-services_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="managing-externally-signed-certificates-for-idm-users-hosts-and-services_managing-certificates-in-idm--summary" data-v-fa0dae77>4. Managing externally signed certificates for IdM users, hosts, and services</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-externally-signed-certificates-for-idm-users-hosts-and-services_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-managing-externally-signed-certificates-for-idm-users-hosts-and-services_managing-certificates-in-idm" data-v-fa0dae77>Managing externally signed certificates for IdM users, hosts, and services</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services" id="sub-link-to-managing_certificates_in_idm-adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services" data-v-b883c74f>4.1. Adding a certificate issued by an external CA to an IdM user, host, or service by using the IdM CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services" id="sub-link-to-managing_certificates_in_idm-adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services" data-v-b883c74f>4.2. Adding a certificate issued by an external CA to an IdM user, host, or service by using the IdM Web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services" id="sub-link-to-managing_certificates_in_idm-removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services" data-v-b883c74f>4.3. Removing a certificate issued by an external CA from an IdM user, host, or service account by using the IdM CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services" id="sub-link-to-managing_certificates_in_idm-removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services" data-v-b883c74f>4.4. Removing a certificate issued by an external CA from an IdM user, host, or service account by using the IdM Web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_2" id="sub-link-to-managing_certificates_in_idm-additional_resources_2" data-v-b883c74f>4.5. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--convert-cert-formats-idm_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="convert-cert-formats-idm_managing-certificates-in-idm--summary" data-v-fa0dae77>5. Converting certificate formats to work with IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#convert-cert-formats-idm_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-convert-cert-formats-idm_managing-certificates-in-idm" data-v-fa0dae77>Converting certificate formats to work with IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#cert-types-idm_convert-cert-formats-idm" id="sub-link-to-managing_certificates_in_idm-cert-types-idm_convert-cert-formats-idm" data-v-b883c74f>5.1. Certificate formats and encodings in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--assembly_converting-an-external-certificate-to-load-into-an-idm-user-account_convert-cert-formats-idm" data-v-b883c74f><summary class="heading sub-chapter-title" id="assembly_converting-an-external-certificate-to-load-into-an-idm-user-account_convert-cert-formats-idm--summary" data-v-b883c74f>5.2. Converting an external certificate to load into an IdM user account</summary><ol id="sub-nav--assembly_converting-an-external-certificate-to-load-into-an-idm-user-account_convert-cert-formats-idm" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#assembly_converting-an-external-certificate-to-load-into-an-idm-user-account_convert-cert-formats-idm" id="chapter-landing--managing_certificates_in_idm-assembly_converting-an-external-certificate-to-load-into-an-idm-user-account_convert-cert-formats-idm" data-v-b883c74f>Converting an external certificate to load into an IdM user account</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#prerequisites" id="sub-link-to-managing_certificates_in_idm-prerequisites" data-v-b883c74f>5.2.1. Prerequisites</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_converting-an-external-certificate-in-the-idm-cli-and-loading-it-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account" id="sub-link-to-managing_certificates_in_idm-proc_converting-an-external-certificate-in-the-idm-cli-and-loading-it-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account" data-v-b883c74f>5.2.2. Converting an external certificate in the IdM CLI and loading it into an IdM user account</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_converting-an-external-certificate-in-the-idm-web-ui-for-loading-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account" id="sub-link-to-managing_certificates_in_idm-proc_converting-an-external-certificate-in-the-idm-web-ui-for-loading-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account" data-v-b883c74f>5.2.3. Converting an external certificate in the IdM web UI for loading into an IdM user account</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--assembly_preparing-to-load-a-certificate-into-the-browser_convert-cert-formats-idm" data-v-b883c74f><summary class="heading sub-chapter-title" id="assembly_preparing-to-load-a-certificate-into-the-browser_convert-cert-formats-idm--summary" data-v-b883c74f>5.3. Preparing to load a certificate into the browser</summary><ol id="sub-nav--assembly_preparing-to-load-a-certificate-into-the-browser_convert-cert-formats-idm" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#assembly_preparing-to-load-a-certificate-into-the-browser_convert-cert-formats-idm" id="chapter-landing--managing_certificates_in_idm-assembly_preparing-to-load-a-certificate-into-the-browser_convert-cert-formats-idm" data-v-b883c74f>Preparing to load a certificate into the browser</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_exporting-a-certificate-and-private-key-from-an-nss-database-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser" id="sub-link-to-managing_certificates_in_idm-proc_exporting-a-certificate-and-private-key-from-an-nss-database-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser" data-v-b883c74f>5.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_combining-certificate-and-private-key-pem-files-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser" id="sub-link-to-managing_certificates_in_idm-proc_combining-certificate-and-private-key-pem-files-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser" data-v-b883c74f>5.3.2. Combining certificate and private key PEM files into a PKCS #12 file</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#other-cert-commands_convert-cert-formats-idm" id="sub-link-to-managing_certificates_in_idm-other-cert-commands_convert-cert-formats-idm" data-v-b883c74f>5.4. Certificate-related commands and formats in IdM</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm--summary" data-v-fa0dae77>6. Creating and managing certificate profiles in Identity Management</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm" data-v-fa0dae77>Creating and managing certificate profiles in Identity Management</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#what-is-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management" id="sub-link-to-managing_certificates_in_idm-what-is-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management" data-v-b883c74f>6.1. What is a certificate profile?</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management" id="sub-link-to-managing_certificates_in_idm-creating-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management" data-v-b883c74f>6.2. Creating a certificate profile</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#what-is-a-ca-access-control-list_creating-and-managing-certificate-profiles-in-identity-management" id="sub-link-to-managing_certificates_in_idm-what-is-a-ca-access-control-list_creating-and-managing-certificate-profiles-in-identity-management" data-v-b883c74f>6.3. What is a CA access control list?</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#defining-a-ca-acl-to-control-access-to-certificate-profiles_creating-and-managing-certificate-profiles-in-identity-management" id="sub-link-to-managing_certificates_in_idm-defining-a-ca-acl-to-control-access-to-certificate-profiles_creating-and-managing-certificate-profiles-in-identity-management" data-v-b883c74f>6.4. Defining a CA ACL to control access to certificate profiles</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-certificate-profiles-and-ca-acls-to-issue-certificates_creating-and-managing-certificate-profiles-in-identity-management" id="sub-link-to-managing_certificates_in_idm-using-certificate-profiles-and-ca-acls-to-issue-certificates_creating-and-managing-certificate-profiles-in-identity-management" data-v-b883c74f>6.5. Using certificate profiles and CA ACLs to issue certificates</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#modifying-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management" id="sub-link-to-managing_certificates_in_idm-modifying-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management" data-v-b883c74f>6.6. Modifying a certificate profile</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#certificate-profile-configuration-parameters_creating-and-managing-certificate-profiles-in-identity-management" id="sub-link-to-managing_certificates_in_idm-certificate-profile-configuration-parameters_creating-and-managing-certificate-profiles-in-identity-management" data-v-b883c74f>6.7. Certificate profile configuration parameters</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-the-validity-of-certificates-in-idm_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="managing-the-validity-of-certificates-in-idm_managing-certificates-in-idm--summary" data-v-fa0dae77>7. Managing the validity of certificates in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-the-validity-of-certificates-in-idm_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-managing-the-validity-of-certificates-in-idm_managing-certificates-in-idm" data-v-fa0dae77>Managing the validity of certificates in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_managing-the-validity-of-an-existing-certificate-that-was-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm" id="sub-link-to-managing_certificates_in_idm-proc_managing-the-validity-of-an-existing-certificate-that-was-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm" data-v-b883c74f>7.1. Managing the validity of an existing certificate that was issued by IdM CA</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_managing-the-validity-of-future-certificates-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm" id="sub-link-to-managing_certificates_in_idm-proc_managing-the-validity-of-future-certificates-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm" data-v-b883c74f>7.2. Managing the validity of future certificates issued by IdM CA</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#viewing-the-expiry-date-of-a-certificate-in-IdM-WebUI_managing-the-validity-of-certificates-in-idm" id="sub-link-to-managing_certificates_in_idm-viewing-the-expiry-date-of-a-certificate-in-IdM-WebUI_managing-the-validity-of-certificates-in-idm" data-v-b883c74f>7.3. Viewing the expiry date of a certificate in IdM WebUI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#viewing-the-expiry-date-of-a-certificate-in-the-CLI_managing-the-validity-of-certificates-in-idm" id="sub-link-to-managing_certificates_in_idm-viewing-the-expiry-date-of-a-certificate-in-the-CLI_managing-the-validity-of-certificates-in-idm" data-v-b883c74f>7.4. Viewing the expiry date of a certificate in the CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm" data-v-b883c74f><summary class="heading sub-chapter-title" id="revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm--summary" data-v-b883c74f>7.5. Revoking certificates with the integrated IdM CAs</summary><ol id="sub-nav--revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm" data-v-b883c74f>Revoking certificates with the integrated IdM CAs</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#certificate-revocation-reasons_revoking-certificates" id="sub-link-to-managing_certificates_in_idm-certificate-revocation-reasons_revoking-certificates" data-v-b883c74f>7.5.1. Certificate revocation reasons</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_revoking-certificates" id="sub-link-to-managing_certificates_in_idm-revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_revoking-certificates" data-v-b883c74f>7.5.2. Revoking certificates with the integrated IdM CAs using IdM WebUI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_revoking-certificates" id="sub-link-to-managing_certificates_in_idm-revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_revoking-certificates" data-v-b883c74f>7.5.3. Revoking certificates with the integrated IdM CAs using IdM CLI</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--restoring-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm" data-v-b883c74f><summary class="heading sub-chapter-title" id="restoring-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm--summary" data-v-b883c74f>7.6. Restoring certificates with the integrated IdM CAs</summary><ol id="sub-nav--restoring-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#restoring-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-restoring-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm" data-v-b883c74f>Restoring certificates with the integrated IdM CAs</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates" id="sub-link-to-managing_certificates_in_idm-restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates" data-v-b883c74f>7.6.1. Restoring certificates with the integrated IdM CAs using IdM WebUI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_restoring-certificates" id="sub-link-to-managing_certificates_in_idm-restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_restoring-certificates" data-v-b883c74f>7.6.2. Restoring certificates with the integrated IdM CAs using IdM CLI</a></li><!--]--><!--]--></ol></details></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-idm-for-smart-card-auth_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-idm-for-smart-card-auth_managing-certificates-in-idm--summary" data-v-fa0dae77>8. Configuring Identity Management for smart card authentication</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-idm-for-smart-card-auth_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-configuring-idm-for-smart-card-auth_managing-certificates-in-idm" data-v-fa0dae77>Configuring Identity Management for smart card authentication</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth" id="sub-link-to-managing_certificates_in_idm-conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth" data-v-b883c74f>8.1. Configuring the IdM server for smart card authentication</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-ansible-to-configure-the-idm-server-for-smart-card-authentication_configuring-idm-for-smart-card-auth" id="sub-link-to-managing_certificates_in_idm-proc_using-ansible-to-configure-the-idm-server-for-smart-card-authentication_configuring-idm-for-smart-card-auth" data-v-b883c74f>8.2. Using Ansible to configure the IdM server for smart card authentication</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth" id="sub-link-to-managing_certificates_in_idm-conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth" data-v-b883c74f>8.3. Configuring the IdM client for smart card authentication</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-ansible-to-configure-idm-clients-for-smart-card-authentication_configuring-idm-for-smart-card-auth" id="sub-link-to-managing_certificates_in_idm-proc_using-ansible-to-configure-idm-clients-for-smart-card-authentication_configuring-idm-for-smart-card-auth" data-v-b883c74f>8.4. Using Ansible to configure IdM clients for smart card authentication</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-cert-idm-user-webui_configuring-idm-for-smart-card-auth" id="sub-link-to-managing_certificates_in_idm-proc-add-cert-idm-user-webui_configuring-idm-for-smart-card-auth" data-v-b883c74f>8.5. Adding a certificate to a user entry in the IdM Web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-cert-idm-user-cli_configuring-idm-for-smart-card-auth" id="sub-link-to-managing_certificates_in_idm-proc-add-cert-idm-user-cli_configuring-idm-for-smart-card-auth" data-v-b883c74f>8.6. Adding a certificate to a user entry in the IdM CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth" id="sub-link-to-managing_certificates_in_idm-installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth" data-v-b883c74f>8.7. Installing tools for managing and using smart cards</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth" id="sub-link-to-managing_certificates_in_idm-storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth" data-v-b883c74f>8.8. Preparing your smart card and uploading your certificates and keys to your smart card</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth" id="sub-link-to-managing_certificates_in_idm-logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth" data-v-b883c74f>8.9. Logging in to IdM with smart cards</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-gdm-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth" id="sub-link-to-managing_certificates_in_idm-configuring-gdm-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth" data-v-b883c74f>8.10. Logging in to GDM using smart card authentication on an IdM client</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-su-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth" id="sub-link-to-managing_certificates_in_idm-configuring-su-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth" data-v-b883c74f>8.11. Using smart card authentication with the su command</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-certificates-in-idm--summary" data-v-fa0dae77>9. Configuring certificates issued by ADCS for smart card authentication in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-certificates-in-idm" data-v-fa0dae77>Configuring certificates issued by ADCS for smart card authentication in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#windows-server-settings-required-for-trust-configuration-and-certificate-usage_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" id="sub-link-to-managing_certificates_in_idm-windows-server-settings-required-for-trust-configuration-and-certificate-usage_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" data-v-b883c74f>9.1. Windows Server settings required for trust configuration and certificate usage</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#copying-certificates-from-active-directory-using-sftp_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" id="sub-link-to-managing_certificates_in_idm-copying-certificates-from-active-directory-using-sftp_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" data-v-b883c74f>9.2. Copying certificates from Active Directory using sftp</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-the-idm-server-and-clients-for-smart-card-authentication-using-adcs-certificates_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" id="sub-link-to-managing_certificates_in_idm-configuring-the-idm-server-and-clients-for-smart-card-authentication-using-adcs-certificates_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" data-v-b883c74f>9.3. Configuring the IdM server and clients for smart card authentication using ADCS certificates</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#converting-the-pfx-file_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" id="sub-link-to-managing_certificates_in_idm-converting-the-pfx-file_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" data-v-b883c74f>9.4. Converting the PFX file</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#installing-tools-for-managing-and-using-smart-cards_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" id="sub-link-to-managing_certificates_in_idm-installing-tools-for-managing-and-using-smart-cards_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" data-v-b883c74f>9.5. Installing tools for managing and using smart cards</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#storing-a-certificate-on-the-smart-card_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" id="sub-link-to-managing_certificates_in_idm-storing-a-certificate-on-the-smart-card_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" data-v-b883c74f>9.6. Preparing your smart card and uploading your certificates and keys to your smart card</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-timeouts-in-sssd-conf_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" id="sub-link-to-managing_certificates_in_idm-configuring-timeouts-in-sssd-conf_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" data-v-b883c74f>9.7. Configuring timeouts in sssd.conf</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#certificate-mapping-rules-for-smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" id="sub-link-to-managing_certificates_in_idm-certificate-mapping-rules-for-smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm" data-v-b883c74f>9.8. Creating certificate mapping rules for smart card authentication</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--conf-certmap-idm_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="conf-certmap-idm_managing-certificates-in-idm--summary" data-v-fa0dae77>10. Configuring certificate mapping rules in Identity Management</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#conf-certmap-idm_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-conf-certmap-idm_managing-certificates-in-idm" data-v-fa0dae77>Configuring certificate mapping rules in Identity Management</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con-idm-certmapdata_conf-certmap-idm" id="sub-link-to-managing_certificates_in_idm-con-idm-certmapdata_conf-certmap-idm" data-v-b883c74f>10.1. Certificate mapping rules for configuring authentication</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#sc-id-mapping_conf-certmap-idm" id="sub-link-to-managing_certificates_in_idm-sc-id-mapping_conf-certmap-idm" data-v-b883c74f>10.2. Components of an identity mapping rule in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#sc-id-issuer-obtain-example_conf-certmap-idm" id="sub-link-to-managing_certificates_in_idm-sc-id-issuer-obtain-example_conf-certmap-idm" data-v-b883c74f>10.3. Obtaining data from a certificate for use in a matching rule</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--conf-certmap-for-users-in-idm_conf-certmap-idm" data-v-b883c74f><summary class="heading sub-chapter-title" id="conf-certmap-for-users-in-idm_conf-certmap-idm--summary" data-v-b883c74f>10.4. Configuring certificate mapping for users stored in IdM</summary><ol id="sub-nav--conf-certmap-for-users-in-idm_conf-certmap-idm" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#conf-certmap-for-users-in-idm_conf-certmap-idm" id="chapter-landing--managing_certificates_in_idm-conf-certmap-for-users-in-idm_conf-certmap-idm" data-v-b883c74f>Configuring certificate mapping for users stored in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-maprule-webui_conf-certmap-for-users-in-idm" id="sub-link-to-managing_certificates_in_idm-proc-add-maprule-webui_conf-certmap-for-users-in-idm" data-v-b883c74f>10.4.1. Adding a certificate mapping rule in the IdM web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-maprule-cli_conf-certmap-for-users-in-idm" id="sub-link-to-managing_certificates_in_idm-proc-add-maprule-cli_conf-certmap-for-users-in-idm" data-v-b883c74f>10.4.2. Adding a certificate mapping rule in the IdM CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-certmapdata-to-user-webui_conf-certmap-for-users-in-idm" id="sub-link-to-managing_certificates_in_idm-proc-add-certmapdata-to-user-webui_conf-certmap-for-users-in-idm" data-v-b883c74f>10.4.3. Adding certificate mapping data to a user entry in the IdM web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-certmapdata-to-user-cli_conf-certmap-for-users-in-idm" id="sub-link-to-managing_certificates_in_idm-proc-add-certmapdata-to-user-cli_conf-certmap-for-users-in-idm" data-v-b883c74f>10.4.4. Adding certificate mapping data to a user entry in the IdM CLI</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con-idm-ad-certmapdata_conf-certmap-idm" id="sub-link-to-managing_certificates_in_idm-con-idm-ad-certmapdata_conf-certmap-idm" data-v-b883c74f>10.5. Certificate mapping rules for trusts with Active Directory domains</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--conf-certmap-for-ad-certs_conf-certmap-idm" data-v-b883c74f><summary class="heading sub-chapter-title" id="conf-certmap-for-ad-certs_conf-certmap-idm--summary" data-v-b883c74f>10.6. Configuring certificate mapping for users whose AD user entry contains the whole certificate</summary><ol id="sub-nav--conf-certmap-for-ad-certs_conf-certmap-idm" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#conf-certmap-for-ad-certs_conf-certmap-idm" id="chapter-landing--managing_certificates_in_idm-conf-certmap-for-ad-certs_conf-certmap-idm" data-v-b883c74f>Configuring certificate mapping for users whose AD user entry contains the whole certificate</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-maprule-webui-ad-cert_conf-certmap-for-ad-certs" id="sub-link-to-managing_certificates_in_idm-proc-add-maprule-webui-ad-cert_conf-certmap-for-ad-certs" data-v-b883c74f>10.6.1. Adding a certificate mapping rule in the IdM web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-maprule-cli-ad-cert_conf-certmap-for-ad-certs" id="sub-link-to-managing_certificates_in_idm-proc-add-maprule-cli-ad-cert_conf-certmap-for-ad-certs" data-v-b883c74f>10.6.2. Adding a certificate mapping rule in the IdM CLI</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--conf-certmap-for-ad-map_conf-certmap-idm" data-v-b883c74f><summary class="heading sub-chapter-title" id="conf-certmap-for-ad-map_conf-certmap-idm--summary" data-v-b883c74f>10.7. Configuring certificate mapping if AD is configured to map user certificates to user accounts</summary><ol id="sub-nav--conf-certmap-for-ad-map_conf-certmap-idm" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#conf-certmap-for-ad-map_conf-certmap-idm" id="chapter-landing--managing_certificates_in_idm-conf-certmap-for-ad-map_conf-certmap-idm" data-v-b883c74f>Configuring certificate mapping if AD is configured to map user certificates to user accounts</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-ad-maprule-webui_conf-certmap-for-ad-map" id="sub-link-to-managing_certificates_in_idm-proc-add-ad-maprule-webui_conf-certmap-for-ad-map" data-v-b883c74f>10.7.1. Adding a certificate mapping rule in the IdM web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-ad-maprule-cli_conf-certmap-for-ad-map" id="sub-link-to-managing_certificates_in_idm-proc-add-ad-maprule-cli_conf-certmap-for-ad-map" data-v-b883c74f>10.7.2. Adding a certificate mapping rule in the IdM CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#check-if-ad-maprule-exists_conf-certmap-for-ad-map" id="sub-link-to-managing_certificates_in_idm-check-if-ad-maprule-exists_conf-certmap-for-ad-map" data-v-b883c74f>10.7.3. Checking certificate mapping data on the AD side</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map" data-v-b883c74f><summary class="heading sub-chapter-title" id="conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map--summary" data-v-b883c74f>10.8. Configuring certificate mapping if AD user entry contains no certificate or mapping data</summary><ol id="sub-nav--conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map" id="chapter-landing--managing_certificates_in_idm-conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map" data-v-b883c74f>Configuring certificate mapping if AD user entry contains no certificate or mapping data</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-certmaprule-ad-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map" id="sub-link-to-managing_certificates_in_idm-proc-add-certmaprule-ad-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map" data-v-b883c74f>10.8.1. Adding a certificate mapping rule in the IdM web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-certmaprule-ad-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map" id="sub-link-to-managing_certificates_in_idm-proc-add-certmaprule-ad-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map" data-v-b883c74f>10.8.2. Adding a certificate mapping rule in the IdM CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-certmapdata-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map" id="sub-link-to-managing_certificates_in_idm-proc-add-certmapdata-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map" data-v-b883c74f>10.8.3. Adding a certificate to an AD user’s ID override in the IdM web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc-add-certmapdata-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map" id="sub-link-to-managing_certificates_in_idm-proc-add-certmapdata-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map" data-v-b883c74f>10.8.4. Adding a certificate to an AD user’s ID override in the IdM CLI</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#sc-cert-mapping-rule-examples_conf-certmap-for-ad-map" id="sub-link-to-managing_certificates_in_idm-sc-cert-mapping-rule-examples_conf-certmap-for-ad-map" data-v-b883c74f>10.9. Combining several identity mapping rules into one</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_3" id="sub-link-to-managing_certificates_in_idm-additional_resources_3" data-v-b883c74f>10.10. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--dc-web-ui-auth_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="dc-web-ui-auth_managing-certificates-in-idm--summary" data-v-fa0dae77>11. Configuring authentication with a certificate stored on the desktop of an IdM client</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#dc-web-ui-auth_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-dc-web-ui-auth_managing-certificates-in-idm" data-v-fa0dae77>Configuring authentication with a certificate stored on the desktop of an IdM client</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#cert-idm-users-auth-preparing-the-server_dc-web-ui-auth" id="sub-link-to-managing_certificates_in_idm-cert-idm-users-auth-preparing-the-server_dc-web-ui-auth" data-v-b883c74f>11.1. Configuring the Identity Management Server for Certificate Authentication in the Web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#requesting-and-exporting-a-user-certificate_dc-web-ui-auth" id="sub-link-to-managing_certificates_in_idm-requesting-and-exporting-a-user-certificate_dc-web-ui-auth" data-v-b883c74f>11.2. Requesting a new user certificate and exporting it to the client</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_making-sure-the-certificate-and-user-are-linked-together_dc-web-ui-auth" id="sub-link-to-managing_certificates_in_idm-proc_making-sure-the-certificate-and-user-are-linked-together_dc-web-ui-auth" data-v-b883c74f>11.3. Making sure the certificate and user are linked together</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-browser-for-cert-auth_dc-web-ui-auth" id="sub-link-to-managing_certificates_in_idm-configuring-browser-for-cert-auth_dc-web-ui-auth" data-v-b883c74f>11.4. Configuring a browser to enable certificate authentication</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#cert-idm-users-auth-procedure_dc-web-ui-auth" id="sub-link-to-managing_certificates_in_idm-cert-idm-users-auth-procedure_dc-web-ui-auth" data-v-b883c74f>11.5. Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#authenticating-idm-cli-user-certificate_dc-web-ui-auth" id="sub-link-to-managing_certificates_in_idm-authenticating-idm-cli-user-certificate_dc-web-ui-auth" data-v-b883c74f>11.6. Configuring an IdM client to enable authenticating to the CLI using a certificate</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--ipa-ca-renewal_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="ipa-ca-renewal_managing-certificates-in-idm--summary" data-v-fa0dae77>12. Using IdM CA renewal server</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#ipa-ca-renewal_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-ipa-ca-renewal_managing-certificates-in-idm" data-v-fa0dae77>Using IdM CA renewal server</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ca-renewal-server_ipa-ca-renewal" id="sub-link-to-managing_certificates_in_idm-ca-renewal-server_ipa-ca-renewal" data-v-b883c74f>12.1. Explanation of IdM CA renewal server</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#changing-ca-renewal_ipa-ca-renewal" id="sub-link-to-managing_certificates_in_idm-changing-ca-renewal_ipa-ca-renewal" data-v-b883c74f>12.2. Changing and resetting IdM CA renewal server</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-externally-signed-ca-certificates_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="managing-externally-signed-ca-certificates_managing-certificates-in-idm--summary" data-v-fa0dae77>13. Managing externally-signed CA certificates</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-externally-signed-ca-certificates_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-managing-externally-signed-ca-certificates_managing-certificates-in-idm" data-v-fa0dae77>Managing externally-signed CA certificates</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#switch-from-externally-to-self-signed-ca_managing-externally-signed-ca-certificates" id="sub-link-to-managing_certificates_in_idm-switch-from-externally-to-self-signed-ca_managing-externally-signed-ca-certificates" data-v-b883c74f>13.1. Switching from an externally-signed to a self-signed CA in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#switching-from-a-self-signed-to-an-externally-signed-ca-in-idm_managing-externally-signed-ca-certificates" id="sub-link-to-managing_certificates_in_idm-switching-from-a-self-signed-to-an-externally-signed-ca-in-idm_managing-externally-signed-ca-certificates" data-v-b883c74f>13.2. Switching from a self-signed to an externally-signed CA in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#renew-with-externally-signed-CA_managing-externally-signed-ca-certificates" id="sub-link-to-managing_certificates_in_idm-renew-with-externally-signed-CA_managing-externally-signed-ca-certificates" data-v-b883c74f>13.3. Renewing the IdM CA renewal server certificate using an external CA</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--renewing-expired-system-certificates-when-idm-is-offline_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="renewing-expired-system-certificates-when-idm-is-offline_managing-certificates-in-idm--summary" data-v-fa0dae77>14. Renewing expired system certificates when IdM is offline</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#renewing-expired-system-certificates-when-idm-is-offline_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-renewing-expired-system-certificates-when-idm-is-offline_managing-certificates-in-idm" data-v-fa0dae77>Renewing expired system certificates when IdM is offline</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#renewing-expired-system-certificates-on-a-ca_renewing-expired-system-certificates-when-idm-is-offline" id="sub-link-to-managing_certificates_in_idm-renewing-expired-system-certificates-on-a-ca_renewing-expired-system-certificates-when-idm-is-offline" data-v-b883c74f>14.1. Renewing expired system certificates on a CA renewal server</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#verifying-other-idm-servers-in-the-domain-after-renewal_renewing-expired-system-certificates-when-idm-is-offline" id="sub-link-to-managing_certificates_in_idm-verifying-other-idm-servers-in-the-domain-after-renewal_renewing-expired-system-certificates-when-idm-is-offline" data-v-b883c74f>14.2. Verifying other IdM servers in the IdM domain after renewal</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-not-yet-expired-on-an-idm-replica_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-not-yet-expired-on-an-idm-replica_managing-certificates-in-idm" data-v-fa0dae77>15. Replacing the web server and LDAP server certificates if they have not yet expired on an IdM replica</a></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-expired-in-the-whole-idm-deployment_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-expired-in-the-whole-idm-deployment_managing-certificates-in-idm" data-v-fa0dae77>16. Replacing the web server and LDAP server certificates if they have expired in the whole IdM deployment</a></li><li class="item chapter" data-v-fa0dae77><details id="toc--generating-crl-on-the-idm-ca-server_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="generating-crl-on-the-idm-ca-server_managing-certificates-in-idm--summary" data-v-fa0dae77>17. Generating CRL on the IdM CA server</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#generating-crl-on-the-idm-ca-server_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-generating-crl-on-the-idm-ca-server_managing-certificates-in-idm" data-v-fa0dae77>Generating CRL on the IdM CA server</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#stopping-crl-generation-on-idm-server_generating-crl-on-the-idm-ca-server" id="sub-link-to-managing_certificates_in_idm-stopping-crl-generation-on-idm-server_generating-crl-on-the-idm-ca-server" data-v-b883c74f>17.1. Stopping CRL generation on an IdM server</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#starting-crl-generation-on-idm-replica-server_generating-crl-on-the-idm-ca-server" id="sub-link-to-managing_certificates_in_idm-starting-crl-generation-on-idm-replica-server_generating-crl-on-the-idm-ca-server" data-v-b883c74f>17.2. Starting CRL generation on an IdM replica server</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#changing-the-crl-update-interval_generating-crl-on-the-idm-ca-server" id="sub-link-to-managing_certificates_in_idm-changing-the-crl-update-interval_generating-crl-on-the-idm-ca-server" data-v-b883c74f>17.3. Changing the CRL update interval</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#proc_decommissioning-a-server-that-performs-the-ca-renewal-server-and-crl-publisher-roles_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-proc_decommissioning-a-server-that-performs-the-ca-renewal-server-and-crl-publisher-roles_managing-certificates-in-idm" data-v-fa0dae77>18. Decommissioning a server that performs the CA renewal server and CRL publisher roles</a></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-certmonger_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="using-certmonger_managing-certificates-in-idm--summary" data-v-fa0dae77>19. Obtaining an IdM certificate for a service using certmonger</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-certmonger_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-using-certmonger_managing-certificates-in-idm" data-v-fa0dae77>Obtaining an IdM certificate for a service using certmonger</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#certmonger_certmonger-for-issuing-renewing-service-certs" id="sub-link-to-managing_certificates_in_idm-certmonger_certmonger-for-issuing-renewing-service-certs" data-v-b883c74f>19.1. Certmonger overview</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs" id="sub-link-to-managing_certificates_in_idm-obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs" data-v-b883c74f>19.2. Obtaining an IdM certificate for a service using certmonger</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#communication-flow-certmonger-requesting-service-cert_certmonger-for-issuing-renewing-service-certs" id="sub-link-to-managing_certificates_in_idm-communication-flow-certmonger-requesting-service-cert_certmonger-for-issuing-renewing-service-certs" data-v-b883c74f>19.3. Communication flow for certmonger requesting a service certificate</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#viewing-cert-tracked-by-certmonger_certmonger-for-issuing-renewing-service-certs" id="sub-link-to-managing_certificates_in_idm-viewing-cert-tracked-by-certmonger_certmonger-for-issuing-renewing-service-certs" data-v-b883c74f>19.4. Viewing the details of a certificate request tracked by certmonger</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#start-stop-cert-tracking_certmonger-for-issuing-renewing-service-certs" id="sub-link-to-managing_certificates_in_idm-start-stop-cert-tracking_certmonger-for-issuing-renewing-service-certs" data-v-b883c74f>19.5. Starting and stopping certificate tracking</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#renew-cert_certmonger-for-issuing-renewing-service-certs" id="sub-link-to-managing_certificates_in_idm-renew-cert_certmonger-for-issuing-renewing-service-certs" data-v-b883c74f>19.6. Renewing a certificate manually</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#add-tracking-back-to-idm-certs_certmonger-for-issuing-renewing-service-certs" id="sub-link-to-managing_certificates_in_idm-add-tracking-back-to-idm-certs_certmonger-for-issuing-renewing-service-certs" data-v-b883c74f>19.7. Making certmonger resume tracking of IdM certificates on a CA replica</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--assembly_using-scep-with-certmonger_certmonger-for-issuing-renewing-service-certs" data-v-b883c74f><summary class="heading sub-chapter-title" id="assembly_using-scep-with-certmonger_certmonger-for-issuing-renewing-service-certs--summary" data-v-b883c74f>19.8. Using SCEP with certmonger</summary><ol id="sub-nav--assembly_using-scep-with-certmonger_certmonger-for-issuing-renewing-service-certs" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#assembly_using-scep-with-certmonger_certmonger-for-issuing-renewing-service-certs" id="chapter-landing--managing_certificates_in_idm-assembly_using-scep-with-certmonger_certmonger-for-issuing-renewing-service-certs" data-v-b883c74f>Using SCEP with certmonger</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con_scep-overview_assembly_using-scep-with-certmonger" id="sub-link-to-managing_certificates_in_idm-con_scep-overview_assembly_using-scep-with-certmonger" data-v-b883c74f>19.8.1. SCEP overview</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_requesting-an-idm-ca-signed-certificate-through-scep_assembly_using-scep-with-certmonger" id="sub-link-to-managing_certificates_in_idm-proc_requesting-an-idm-ca-signed-certificate-through-scep_assembly_using-scep-with-certmonger" data-v-b883c74f>19.8.2. Requesting an IdM CA-signed certificate through SCEP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_automatically-renewing-ad-scep-certificates-with-certmonger_assembly_using-scep-with-certmonger" id="sub-link-to-managing_certificates_in_idm-proc_automatically-renewing-ad-scep-certificates-with-certmonger_assembly_using-scep-with-certmonger" data-v-b883c74f>19.8.3. Automatically renewing AD SCEP certificates with certmonger</a></li><!--]--><!--]--></ol></details></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--deploying-and-managing-the-acme-service-in-idm_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="deploying-and-managing-the-acme-service-in-idm_managing-certificates-in-idm--summary" data-v-fa0dae77>20. Deploying and managing the ACME service in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#deploying-and-managing-the-acme-service-in-idm_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-deploying-and-managing-the-acme-service-in-idm_managing-certificates-in-idm" data-v-fa0dae77>Deploying and managing the ACME service in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm" id="sub-link-to-managing_certificates_in_idm-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm" data-v-b883c74f>20.1. The ACME service in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#enabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm" id="sub-link-to-managing_certificates_in_idm-enabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm" data-v-b883c74f>20.2. Enabling the ACME service in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#disabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm" id="sub-link-to-managing_certificates_in_idm-disabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm" data-v-b883c74f>20.3. Disabling the ACME service in IdM</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--requesting-certificates-using-rhel-system-roles_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="requesting-certificates-using-rhel-system-roles_managing-certificates-in-idm--summary" data-v-fa0dae77>21. Requesting certificates by using the RHEL system role</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#requesting-certificates-using-rhel-system-roles_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-requesting-certificates-using-rhel-system-roles_managing-certificates-in-idm" data-v-fa0dae77>Requesting certificates by using the RHEL system role</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#the-certificate-system-role_requesting-certificates-using-rhel-system-roles" id="sub-link-to-managing_certificates_in_idm-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" data-v-b883c74f>21.1. The certificate RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" id="sub-link-to-managing_certificates_in_idm-requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" data-v-b883c74f>21.2. Requesting a new self-signed certificate by using the certificate RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" id="sub-link-to-managing_certificates_in_idm-requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" data-v-b883c74f>21.3. Requesting a new certificate from IdM CA by using the certificate RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#specifying-commands-to-run-before-or-after-certificate-issuance-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" id="sub-link-to-managing_certificates_in_idm-specifying-commands-to-run-before-or-after-certificate-issuance-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" data-v-b883c74f>21.4. Specifying commands to run before or after certificate issuance by using the certificate RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm--summary" data-v-fa0dae77>22. Restricting an application to trust only a subset of certificates</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm" data-v-fa0dae77>Restricting an application to trust only a subset of certificates</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f><summary class="heading sub-chapter-title" id="creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs--summary" data-v-b883c74f>22.1. Managing lightweight sub-CAs</summary><ol id="sub-nav--creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs" id="chapter-landing--managing_certificates_in_idm-creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>Managing lightweight sub-CAs</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-sub-CA-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-creating-a-sub-CA-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.1.1. Creating a sub-CA from the IdM WebUI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_deleting-a-sub-ca-from-the-idm-webui_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-proc_deleting-a-sub-ca-from-the-idm-webui_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.1.2. Deleting a sub-CA from the IdM WebUI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-sub-CA-from-IdM-CLI_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-creating-a-sub-CA-from-IdM-CLI_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.1.3. Creating a sub-CA from the IdM CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_disabling-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-proc_disabling-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.1.4. Disabling a sub-CA from the IdM CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_deleting-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-proc_deleting-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.1.5. Deleting a sub-CA from the IdM CLI</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.2. Downloading the sub-CA certificate from IdM WebUI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f><summary class="heading sub-chapter-title" id="creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs--summary" data-v-b883c74f>22.3. Creating CA ACLs for web server and client authentication</summary><ol id="sub-nav--creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs" id="chapter-landing--managing_certificates_in_idm-creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>Creating CA ACLs for web server and client authentication</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.3.1. Viewing CA ACLs in IdM CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-CA-ACL-for-web-servers-authenticating-to-web-clients-using-certificates-issued-by-webserver-ca_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-creating-a-CA-ACL-for-web-servers-authenticating-to-web-clients-using-certificates-issued-by-webserver-ca_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.3.2. Creating a CA ACL for web servers authenticating to web clients using certificates issued by webserver-ca</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-CA-ACL-for-user-web-browsers-authenticating-to-web-servers-using-certificates-issued-by-webclient-ca_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-creating-a-CA-ACL-for-user-web-browsers-authenticating-to-web-servers-using-certificates-issued-by-webclient-ca_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.3.3. Creating a CA ACL for user web browsers authenticating to web servers using certificates issued by webclient-ca</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.4. Obtaining an IdM certificate for a service using certmonger</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#communication-flow-certmonger-requesting-service-cert_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-communication-flow-certmonger-requesting-service-cert_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.5. Communication flow for certmonger requesting a service certificate</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.6. Setting up a single-instance Apache HTTP Server</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.7. Adding TLS encryption to an Apache HTTP Server</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-the-supported-tls-protocol-versions-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-setting-the-supported-tls-protocol-versions-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.8. Setting the supported TLS protocol versions on an Apache HTTP Server</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-the-supported-ciphers-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-setting-the-supported-ciphers-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.9. Setting the supported ciphers on an Apache HTTP Server</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-tls-client-certificate-authentication_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-configuring-tls-client-certificate-authentication_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.10. Configuring TLS client certificate authentication</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.11. Requesting a new user certificate and exporting it to the client</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs" id="sub-link-to-managing_certificates_in_idm-configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs" data-v-b883c74f>22.12. Configuring a browser to enable certificate authentication</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--invalidating-a-specific-group-of-related-certificates-quickly_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="invalidating-a-specific-group-of-related-certificates-quickly_managing-certificates-in-idm--summary" data-v-fa0dae77>23. Invalidating a specific group of related certificates quickly</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#invalidating-a-specific-group-of-related-certificates-quickly_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-invalidating-a-specific-group-of-related-certificates-quickly_managing-certificates-in-idm" data-v-fa0dae77>Invalidating a specific group of related certificates quickly</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#disabling-CA-ACLs-in-IdM-CLI_invalidating-a-specific-group-of-related-certificates-quickly" id="sub-link-to-managing_certificates_in_idm-disabling-CA-ACLs-in-IdM-CLI_invalidating-a-specific-group-of-related-certificates-quickly" data-v-b883c74f>23.1. Disabling CA ACLs in IdM CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#disabling-an-IdM-sub-CA_invalidating-a-specific-group-of-related-certificates-quickly" id="sub-link-to-managing_certificates_in_idm-disabling-an-IdM-sub-CA_invalidating-a-specific-group-of-related-certificates-quickly" data-v-b883c74f>23.2. Disabling an IdM sub-CA</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--verifying-certificates-using-idm-healthcheck_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="verifying-certificates-using-idm-healthcheck_managing-certificates-in-idm--summary" data-v-fa0dae77>24. Verifying certificates using IdM Healthcheck</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#verifying-certificates-using-idm-healthcheck_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-verifying-certificates-using-idm-healthcheck_managing-certificates-in-idm" data-v-fa0dae77>Verifying certificates using IdM Healthcheck</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#idm-certificates-healthcheck-tests_verifying-certificates-using-idm-healthcheck" id="sub-link-to-managing_certificates_in_idm-idm-certificates-healthcheck-tests_verifying-certificates-using-idm-healthcheck" data-v-b883c74f>24.1. IdM certificates Healthcheck tests</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#screening-certificates-using-the-healthcheck-tool_verifying-certificates-using-idm-healthcheck" id="sub-link-to-managing_certificates_in_idm-screening-certificates-using-the-healthcheck-tool_verifying-certificates-using-idm-healthcheck" data-v-b883c74f>24.2. Screening certificates using the Healthcheck tool</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--verifying-system-certificates-using-idm-healthcheck_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="verifying-system-certificates-using-idm-healthcheck_managing-certificates-in-idm--summary" data-v-fa0dae77>25. Verifying system certificates using IdM Healthcheck</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#verifying-system-certificates-using-idm-healthcheck_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-verifying-system-certificates-using-idm-healthcheck_managing-certificates-in-idm" data-v-fa0dae77>Verifying system certificates using IdM Healthcheck</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#system-certificates-healthcheck-tests_verifying-dogtag-certificates-using-healthcheck" id="sub-link-to-managing_certificates_in_idm-system-certificates-healthcheck-tests_verifying-dogtag-certificates-using-healthcheck" data-v-b883c74f>25.1. System certificates Healthcheck tests</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#screening-system-certificates-using-healthcheck_verifying-dogtag-certificates-using-healthcheck" id="sub-link-to-managing_certificates_in_idm-screening-system-certificates-using-healthcheck_verifying-dogtag-certificates-using-healthcheck" data-v-b883c74f>25.2. Screening system certificates using Healthcheck</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--understanding-what-certificates-are-used-by-idm_managing-certificates-in-idm" data-v-fa0dae77><summary class="heading chapter-title" id="understanding-what-certificates-are-used-by-idm_managing-certificates-in-idm--summary" data-v-fa0dae77>26. Understanding the certificates used internally by IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#understanding-what-certificates-are-used-by-idm_managing-certificates-in-idm" id="chapter-landing--managing_certificates_in_idm-understanding-what-certificates-are-used-by-idm_managing-certificates-in-idm" data-v-fa0dae77>Understanding the certificates used internally by IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#about-the-internal-certificates-in-idm_understanding-what-certificates-are-used-by-idm" id="sub-link-to-managing_certificates_in_idm-about-the-internal-certificates-in-idm_understanding-what-certificates-are-used-by-idm" data-v-b883c74f>26.1. About the internal certificates in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#certificates-internal-to-idm_understanding-what-certificates-are-used-by-idm" id="sub-link-to-managing_certificates_in_idm-certificates-internal-to-idm_understanding-what-certificates-are-used-by-idm" data-v-b883c74f>26.2. Certificates internal to IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#idm-internal-certificate-renewal-process_understanding-what-certificates-are-used-by-idm" id="sub-link-to-managing_certificates_in_idm-idm-internal-certificate-renewal-process_understanding-what-certificates-are-used-by-idm" data-v-b883c74f>26.3. IdM internal certificate renewal process</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_4" id="sub-link-to-managing_certificates_in_idm-additional_resources_4" data-v-b883c74f>26.4. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#idm140333367899040" id="chapter-landing--managing_certificates_in_idm-idm140333367899040" data-v-fa0dae77>Legal Notice</a></li><!--]--></ol></nav><!----></div></div></aside><article class="content span-xs-12 span-sm-6 span-md-12 span-lg-7" aria-live="polite" data-v-8589d091><!----><div lang="en-us" xml:lang="en-us" class="docs-content-container" data-v-8589d091><!----><!----><h1 data-id="content_chapter" class="chapter-title" data-v-8589d091>Managing certificates in IdM</h1><hr class="line-below-chp" data-v-8589d091><section class="rhdocs" data-v-8589d091><body><div xml:lang="en-US" class="book" id="idm140333374276784"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Enterprise Linux</span> <span class="productnumber">9</span></div><div><h3 class="subtitle">Issuing certificates, configuring certificate-based authentication, and controlling certificate validity</h3></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="#idm140333367899040">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				Administrators use X.509 certificates to authenticate users, hosts, and services, and to enable digital signing and encryption. In Red Hat Identity Management (IdM), you can manage certificates by using the integrated or an external Certificate Authority (CA).
			</div><div class="para">
				You can request and renew certificates by using the <code class="literal">certmonger</code> service, the <code class="literal">certutil</code> tool, or Ansible Playbooks. To replace the web server and LDAP server certificates of IdM servers, you must perform manual actions.
			</div><div class="para">
				Administrators can create lightweight sub-CAs to issue certificates for a specific purpose, such as user certificates for a VPN gateway. The administrator can then invalidate all certificates for this service by revoking the sub-CA's certificate when this VPN gateway is no longer needed.
			</div></div></div></div><hr></div><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Providing feedback on Red Hat documentation</h2></div></div></div><p class="_abstract _abstract">
			We appreciate your feedback on our documentation. Let us know how we can improve it.
		</p><div class="orderedlist"><p class="title"><strong>Submitting feedback through Jira (account required)</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					Log in to the <a class="link" href="https://issues.redhat.com/projects/RHELDOCS/issues">Jira</a> website.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> in the top navigation bar
				</li><li class="listitem">
					Enter a descriptive title in the <span class="strong strong"><strong>Summary</strong></span> field.
				</li><li class="listitem">
					Enter your suggestion for improvement in the <span class="strong strong"><strong>Description</strong></span> field. Include links to the relevant parts of the documentation.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> at the bottom of the dialogue.
				</li></ol></div></section><section class="chapter" id="cert-intro_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Public key certificates in Identity Management</h2></div></div></div><p class="_abstract _abstract">
			X.509 public key certificates are used to authenticate users, hosts and services in Identity Management (IdM). In addition to authentication, X.509 certificates also enable digital signing and encryption to provide privacy, integrity and non-repudiation.
		</p><p>
			A certificate contains the following information:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					The subject that the certificate authenticates.
				</li><li class="listitem">
					The issuer, that is the CA that has signed the certificate.
				</li><li class="listitem">
					The start and end date of the validity of the certificate.
				</li><li class="listitem">
					The valid uses of the certificate.
				</li><li class="listitem">
					The public key of the subject.
				</li></ul></div><p>
			A message encrypted by the public key can only be decrypted by a corresponding private key. While a certificate and the public key it includes can be made publicly available, the user, host or service must keep their private key secret.
		</p><p>
			<span id="con-cert-authority-idm_cert-intro"><!--Empty--></span>
		</p><section class="section" id="certificate_authorities_in_idm"><div class="titlepage"><div><div><h3 class="title">1.1. Certificate authorities in IdM</h3></div></div></div><p class="_abstract _abstract">
				Certificate authorities operate in a hierarchy of trust. In an IdM environment with an internal Certificate Authority (CA), all the IdM hosts, users and services trust certificates that have been signed by the CA. Apart from this root CA, IdM supports sub-CAs to which the root CA has granted the ability to sign certificates in their turn. Frequently, the certificates that such sub-CAs are able to sign are certificates of a specific kind, for example VPN certificates. Finally, IdM supports using external CAs. The table <a class="link" href="#tab-comparison-of-using-integrated-and-external-cas-in-idm_cert-intro" title="Table 1.1. Comparison of using integrated and external CAs in IdM">below</a> presents the specifics of using the individual types of CA in IdM.
			</p><rh-table id="tab-comparison-of-using-integrated-and-external-cas-in-idm_cert-intro"><table class="gt-4-cols lt-7-rows"><caption>Table 1.1. Comparison of using integrated and external CAs in IdM</caption><colgroup><col style="width: 11%; " class="col_1"><!--Empty--><col style="width: 22%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--><col style="width: 33%; " class="col_4"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333373583600" scope="col">Name of CA</th><th align="left" valign="top" id="idm140333373054000" scope="col">Description</th><th align="left" valign="top" id="idm140333373052912" scope="col">Use</th><th align="left" valign="top" id="idm140333373051824" scope="col">Useful links</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333373583600"> <p>
								The <code class="literal">ipa</code> CA
							</p>
							 </td><td align="left" valign="top" headers="idm140333373054000"> <p>
								An integrated CA based on the Dogtag upstream project
							</p>
							 </td><td align="left" valign="top" headers="idm140333373052912"> <p>
								Integrated CAs can create, revoke, and issue certificates for users, hosts, and services.
							</p>
							 </td><td align="left" valign="top" headers="idm140333373051824"> <p>
								<a class="link" href="#requesting-and-exporting-a-user-certificate_dc-web-ui-auth" title="11.2. Requesting a new user certificate and exporting it to the client">Using the ipa CA to request a new user certificate and exporting it to the client</a>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333373583600"> <p>
								IdM sub-CAs
							</p>
							 </td><td align="left" valign="top" headers="idm140333373054000"> <p>
								An integrated CA that is subordinate to the <code class="literal">ipa</code> CA
							</p>
							 </td><td align="left" valign="top" headers="idm140333373052912"> <p>
								IdM sub-CAs are CAs to which the <code class="literal">ipa</code> CA has granted the ability to sign certificates. Frequently, these certificates are of a specific kind, for example VPN certificates.
							</p>
							 </td><td align="left" valign="top" headers="idm140333373051824"> <p>
								<a class="link" href="#restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm" title="Chapter 22. Restricting an application to trust only a subset of certificates">Restricting an application to trust only a subset of certificates</a>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333373583600"> <p>
								External CAs
							</p>
							 </td><td align="left" valign="top" headers="idm140333373054000"> <p>
								An external CA is a CA other than the integrated IdM CA or its sub-CAs.
							</p>
							 </td><td align="left" valign="top" headers="idm140333373052912"> <p>
								Using IdM tools, you add certificates issued by these CAs to users, services, or hosts as well as remove them.
							</p>
							 </td><td align="left" valign="top" headers="idm140333373051824"> <p>
								<a class="link" href="#managing-externally-signed-certificates-for-idm-users-hosts-and-services_managing-certificates-in-idm" title="Chapter 4. Managing externally signed certificates for IdM users, hosts, and services">Managing externally signed certificates for IdM users, hosts, and services</a>
							</p>
							 </td></tr></tbody></table></rh-table><p>
				From the certificate point of view, there is no difference between being signed by a self-signed IdM CA and being signed externally.
			</p><p>
				The role of the CA includes the following purposes:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						It issues digital certificates.
					</li><li class="listitem">
						By signing a certificate, it certifies that the subject named in the certificate owns a public key. The subject can be a user, host or service.
					</li><li class="listitem">
						It can revoke certificates, and provides revocation status via Certificate Revocation Lists (CRLs) and Online Certificate Status Protocol (OCSP).
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-your-ca-services_planning-identity-management">Planning your CA services</a>
					</li></ul></div><p>
				<span id="compare-certs-kerberos_cert-intro"><!--Empty--></span>
			</p></section><section class="section" id="comparison_of_certificates_and_kerberos"><div class="titlepage"><div><div><h3 class="title">1.2. Comparison of certificates and Kerberos</h3></div></div></div><p class="_abstract _abstract">
				Certificates perform a similar function to that performed by Kerberos tickets. Kerberos is a computer network authentication protocol that works on the basis of tickets to allow nodes communicating over a non-secure network to prove their identity to one another in a secure manner. The following table shows a comparison of Kerberos and X.509 certificates:
			</p><rh-table id="tab-compare-cert-kerberos_cert-intro"><table class="lt-4-cols lt-7-rows"><caption>Table 1.2. Comparison of certificates and Kerberos</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								<span class="strong strong"><strong>Characteristic</strong></span>
							</p>
							 </td><td align="left" valign="top"> <p>
								<span class="strong strong"><strong>Kerberos</strong></span>
							</p>
							 </td><td align="left" valign="top"> <p>
								<span class="strong strong"><strong>X.509</strong></span>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">Authentication</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								Yes
							</p>
							 </td><td align="left" valign="top"> <p>
								Yes
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">Privacy</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								Optional
							</p>
							 </td><td align="left" valign="top"> <p>
								Yes
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">Integrity</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								Optional
							</p>
							 </td><td align="left" valign="top"> <p>
								Yes
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">Type of cryptography involved</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								Symmetrical
							</p>
							 </td><td align="left" valign="top"> <p>
								Asymmetrical
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">Default validity</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								Short (1 day)
							</p>
							 </td><td align="left" valign="top"> <p>
								Long(2 years)
							</p>
							 </td></tr></tbody></table></rh-table><p>
				By default, Kerberos in Identity Management only ensures the identity of the communicating parties.
			</p></section><section class="section" id="using-certs-to-authenticate-users_cert-intro"><div class="titlepage"><div><div><h3 class="title">1.3. The pros and cons of using certificates to authenticate users in IdM</h3></div></div></div><p class="_abstract _abstract">
				The advantages of using certificates to authenticate users in IdM include the following points:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A PIN that protects the private key on a smart card is typically less complex and easier to remember than a regular password.
					</li><li class="listitem">
						Depending on the device, a private key stored on a smart card cannot be exported. This provides additional security.
					</li><li class="listitem">
						Smart cards can make logout automatic: IdM can be configured to log out users when they remove the smart card from the reader.
					</li><li class="listitem">
						Stealing the private key requires actual physical access to a smart card, making smart cards secure against hacking attacks.
					</li><li class="listitem">
						Smart card authentication is an example of two-factor authentication: it requires both something you have (the card) and something you know (the PIN).
					</li><li class="listitem">
						Smart cards are more flexible than passwords because they provide the keys that can be used for other purposes, such as encrypting email.
					</li><li class="listitem">
						Using smart cards use on shared machines that are IdM clients does not typically pose additional configuration problems for system administrators. In fact, smart card authentication is an ideal choice for shared machines.
					</li></ul></div><p>
				The disadvantages of using certificates to authenticate users in IdM include the following points:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Users might lose or forget to bring their smart card or certificate and be effectively locked out.
					</li><li class="listitem">
						Mistyping a PIN multiple times might result in a card becoming locked.
					</li><li class="listitem">
						There is generally an intermediate step between request and authorization by some sort of security officer or approver. In IdM, the security officer or administrator must run the <span class="strong strong"><strong>ipa cert-request</strong></span> command.
					</li><li class="listitem">
						Smart cards and readers tend to be vendor and driver specific: although a lot of readers can be used for different cards, a smart card of a specific vendor might not work in the reader of another vendor or in the type of a reader for which it was not designed.
					</li><li class="listitem">
						Certificates and smart cards have a steep learning curve for administrators.
					</li></ul></div></section></section><section class="chapter" id="managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 2. Managing certificates for users, hosts, and services using the integrated IdM CA</h2></div></div></div><p class="_abstract _abstract">
			To learn more about how to manage certificates in Identity Management (IdM) using the integrated CA, the <code class="literal">ipa</code> CA, and its sub-CAs, see the following sections:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#requesting-new-certificates-for-a-user-host-or-service-using-idm-web-ui_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca" title="2.1. Requesting new certificates for a user, host, or service using IdM Web UI">Requesting new certificates for a user, host, or service using the IdM Web UI</a>.
				</li><li class="listitem"><p class="simpara">
					Requesting new certificates for a user, host, or service from the IdM CA using the IdM CLI:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
							<a class="link" href="#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-certutil_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca" title="2.2. Requesting new certificates for a user, host, or service from IdM CA using certutil">Requesting new certificates for a user, host, or service from IdM CA using certutil</a>
						</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
									For a specific example of requesting a new user certificate from the IdM CA using the <code class="literal">certutil</code> utility and exporting it to an IdM client, see <a class="link" href="#requesting-and-exporting-a-user-certificate_dc-web-ui-auth" title="11.2. Requesting a new user certificate and exporting it to the client">Requesting a new user certificate and exporting it to the client</a>.
								</li></ul></div></li><li class="listitem">
							<a class="link" href="#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-openssl_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca" title="2.3. Requesting new certificates for a user, host, or service from IdM CA using openssl">Requesting new certificates for a user, host, or service from IdM CA using openssl</a>
						</li></ul></div></li></ul></div><p>
			You can also request new certificates for a service from the IdM CA using the <code class="literal">certmonger</code> utility. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/using-certmonger_managing-certificates-in-idm#obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs">Requesting new certificates for a service from IdM CA using certmonger</a>.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					Your IdM deployment contains an integrated CA:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							For information about how to plan your CA services in IdM, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-your-ca-services_planning-identity-management">Planning your CA services</a>.
						</li><li class="listitem">
							For information about how to install an IdM server with integrated DNS and integrated CA as the root CA, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-with-integrated-dns_installing-identity-management">Installing an IdM server: With integrated DNS, with an integrated CA as the root CA</a>
						</li><li class="listitem">
							For information about how to install an IdM server with integrated DNS and an external CA as the root CA, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-with-external-ca_installing-identity-management">Installing an IdM server: With integrated DNS, with an external CA as the root CA</a>
						</li><li class="listitem">
							For information about how to install an IdM server without integrated DNS and with an integrated CA as the root CA, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-without-integrated-dns_installing-identity-management">Installing an IdM server: Without integrated DNS, with an integrated CA as the root CA</a>.
						</li><li class="listitem"><p class="simpara">
							Optional: Your IdM deployment supports users authenticating with a certificate:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
									For information about how to configure your IdM deployment to support user authentication with a certificate stored in the IdM client filesystem, see <a class="link" href="#dc-web-ui-auth_managing-certificates-in-idm" title="Chapter 11. Configuring authentication with a certificate stored on the desktop of an IdM client">Configuring authentication with a certificate stored on the desktop of an IdM client</a>.
								</li><li class="listitem">
									For information about how to configure your IdM deployment to support user authentication with a certificate stored on a smart card inserted into an IdM client, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication">Configuring Identity Management for smart card authentication</a>.
								</li><li class="listitem">
									For information about how to configure your IdM deployment to support user authentication with smart cards issued by an Active Directory certificate system, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication">Configuring certificates issued by ADCS for smart card authentication in IdM</a>.
								</li></ul></div></li></ul></div></li></ul></div><section class="section" id="requesting-new-certificates-for-a-user-host-or-service-using-idm-web-ui_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca"><div class="titlepage"><div><div><h3 class="title">2.1. Requesting new certificates for a user, host, or service using IdM Web UI</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use the Identity Management (IdM) Web UI to request a new certificate for any IdM entity from the integrated IdM certificate authorities (CAs): the <code class="literal">ipa</code> CA or any of its sub-CAs.
			</p><p>
				IdM entities include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Users
					</li><li class="listitem">
						Hosts
					</li><li class="listitem">
						Services
					</li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Services typically run on dedicated service nodes on which the private keys are stored. Copying a service’s private key to the IdM server is considered insecure. Therefore, when requesting a certificate for a service, create the certificate signing request (CSR) on the service node.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your IdM deployment contains an integrated CA.
					</li><li class="listitem">
						You are logged into the IdM Web UI as the IdM administrator.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Under the <code class="literal">Identity</code> tab, select the <code class="literal">Users</code>, <code class="literal">Hosts</code>, or <code class="literal">Services</code> subtab.
					</li><li class="listitem"><p class="simpara">
						Click the name of the user, host, or service to open its configuration page.
					</p><div class="figure" id="host-list-cert-request"><p class="title"><strong>Figure 2.1. List of Hosts</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/873e3f03a7cab246c4fce6a1ae267599/hosts_list.png" alt="A screenshot of the &quot;Hosts&quot; page displaying a table of hosts and their attributes: &quot;Host name&quot; - &quot;Description&quot; - &quot;Enrolled.&quot; The hostname for the first entry is highlighted."></div></div></div></li><li class="listitem">
						Click <span class="guimenu">Actions</span> → <span class="guimenuitem">New Certificate</span>.
					</li><li class="listitem">
						Optional: Select the issuing CA and profile ID.
					</li><li class="listitem">
						Follow the instructions for using the <code class="literal">certutil</code> command-line (CLI) utility on the screen.
					</li><li class="listitem">
						Click <span class="guibutton">Issue</span>.
					</li></ol></div></section><section class="section" id="requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-certutil_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca"><div class="titlepage"><div><div><h3 class="title">2.2. Requesting new certificates for a user, host, or service from IdM CA using certutil</h3></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">certutil</code> utility to request a certificate for an Identity Management (IdM) user, host or service in standard IdM situations. To ensure that a host or service Kerberos alias can use a certificate, <a class="link" href="#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-openssl_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca" title="2.3. Requesting new certificates for a user, host, or service from IdM CA using openssl">use the openssl utility to request a certificate</a> instead.
			</p><p>
				Follow this procedure to request a certificate for an IdM user, host, or service from <code class="literal">ipa</code>, the IdM certificate authority (CA), using <code class="literal">certutil</code>.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Services typically run on dedicated service nodes on which the private keys are stored. Copying a service’s private key to the IdM server is considered insecure. Therefore, when requesting a certificate for a service, create the certificate signing request (CSR) on the service node.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your IdM deployment contains an integrated CA.
					</li><li class="listitem">
						You are logged into the IdM command-line interface (CLI) as the IdM administrator.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a temporary directory for the certificate database:
					</p><pre class="literallayout"># mkdir ~/certdb/</pre></li><li class="listitem"><p class="simpara">
						Create a new temporary certificate database, for example:
					</p><pre class="literallayout"># certutil -N -d <span class="emphasis"><em>~/certdb/</em></span></pre></li><li class="listitem"><p class="simpara">
						Create the CSR and redirect the output to a file. For example, to create a CSR for a 4096 bit certificate and to set the subject to <span class="emphasis"><em>CN=server.example.com,O=EXAMPLE.COM</em></span>:
					</p><pre class="literallayout"># certutil -R -d <span class="emphasis"><em>~/certdb/</em></span> -a -g <span class="emphasis"><em>4096</em></span> -s "<span class="emphasis"><em>CN=server.example.com,O=EXAMPLE.COM</em></span>" -8 <span class="emphasis"><em>server.example.com</em></span> &gt; <span class="emphasis"><em>certificate_request.csr</em></span></pre></li><li class="listitem"><p class="simpara">
						Submit the certificate request file to the CA running on the IdM server. Specify the Kerberos principal to associate with the newly-issued certificate:
					</p><pre class="literallayout"># ipa cert-request <span class="emphasis"><em>certificate_request.csr</em></span> --principal=<span class="emphasis"><em>host/server.example.com</em></span></pre><p class="simpara">
						The <code class="literal command">ipa cert-request</code> command in IdM uses the following defaults:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The <code class="literal">caIPAserviceCert</code> certificate profile
							</p><p class="simpara">
								To select a custom profile, use the <code class="literal option">--profile-id</code> option.
							</p></li><li class="listitem"><p class="simpara">
								The integrated IdM root CA, <code class="literal">ipa</code>
							</p><p class="simpara">
								To select a sub-CA, use the <code class="literal option">--ca</code> option.
							</p></li></ul></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the output of the <code class="literal command">ipa cert-request --help</code> command.
					</li><li class="listitem">
						See <a class="link" href="#creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm" title="Chapter 6. Creating and managing certificate profiles in Identity Management">Creating and managing certificate profiles in Identity Management</a>.
					</li></ul></div></section><section class="section" id="requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-openssl_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca"><div class="titlepage"><div><div><h3 class="title">2.3. Requesting new certificates for a user, host, or service from IdM CA using openssl</h3></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">openssl</code> utility to request a certificate for an Identity Management (IdM) host or service if you want to ensure that the Kerberos alias of the host or service can use the certificate. In standard situations, consider <a class="link" href="#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-certutil_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca" title="2.2. Requesting new certificates for a user, host, or service from IdM CA using certutil">requesting a new certificate using the certutil utility</a> instead.
			</p><p>
				Follow this procedure to request a certificate for an IdM host, or service from <code class="literal">ipa</code>, the IdM certificate authority, using <code class="literal">openssl</code>.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Services typically run on dedicated service nodes on which the private keys are stored. Copying a service’s private key to the IdM server is considered insecure. Therefore, when requesting a certificate for a service, create the certificate signing request (CSR) on the service node.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your IdM deployment contains an integrated CA.
					</li><li class="listitem">
						You are logged into the IdM command-line interface (CLI) as the IdM administrator.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Create one or more aliases for your Kerberos principal <span class="emphasis"><em>test/server.example.com</em></span>. For example, <span class="emphasis"><em>test1/server.example.com</em></span> and <span class="emphasis"><em>test2/server.example.com</em></span>.
					</li><li class="listitem"><p class="simpara">
						In the CSR, add a subjectAltName for dnsName (<span class="emphasis"><em>server.example.com</em></span>) and otherName (<span class="emphasis"><em>test2/server.example.com</em></span>). To do this, configure the <code class="literal">openssl.conf</code> file to include the following line specifying the UPN otherName and subjectAltName:
					</p><pre class="literallayout">otherName=<span class="emphasis"><em>1.3.6.1.4.1.311.20.2.3</em></span>;UTF8:<span class="emphasis"><em>test2/server.example.com@EXAMPLE.COM</em></span>
DNS.1 = <span class="emphasis"><em>server.example.com</em></span></pre></li><li class="listitem"><p class="simpara">
						Create a certificate request using <code class="literal">openssl</code>:
					</p><pre class="literallayout">openssl req -new -newkey rsa:<span class="emphasis"><em>2048</em></span> -keyout test2service.key -sha256 -nodes -out <span class="emphasis"><em>certificate_request.csr</em></span> -config openssl.conf</pre></li><li class="listitem"><p class="simpara">
						Submit the certificate request file to the CA running on the IdM server. Specify the Kerberos principal to associate with the newly-issued certificate:
					</p><pre class="literallayout"># ipa cert-request <span class="emphasis"><em>certificate_request.csr</em></span> --principal=<span class="emphasis"><em>host/server.example.com</em></span></pre><p class="simpara">
						The <code class="literal command">ipa cert-request</code> command in IdM uses the following defaults:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The <code class="literal">caIPAserviceCert</code> certificate profile
							</p><p class="simpara">
								To select a custom profile, use the <code class="literal option">--profile-id</code> option.
							</p></li><li class="listitem"><p class="simpara">
								The integrated IdM root CA, <code class="literal">ipa</code>
							</p><p class="simpara">
								To select a sub-CA, use the <code class="literal option">--ca</code> option.
							</p></li></ul></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the output of the <code class="literal command">ipa cert-request --help</code> command.
					</li><li class="listitem">
						See <a class="link" href="#creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm" title="Chapter 6. Creating and managing certificate profiles in Identity Management">Creating and managing certificate profiles in Identity Management</a>.
					</li></ul></div></section><section class="section _additional-resources" id="additional_resources"><div class="titlepage"><div><div><h3 class="title">2.4. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See <a class="link" href="#revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm" title="7.5. Revoking certificates with the integrated IdM CAs">Revoking certificates with the integrated IdM CAs</a>.
					</li><li class="listitem">
						See <a class="link" href="#restoring-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm" title="7.6. Restoring certificates with the integrated IdM CAs">Restoring certificates with the integrated IdM CAs</a>.
					</li><li class="listitem">
						See <a class="link" href="#restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm" title="Chapter 22. Restricting an application to trust only a subset of certificates">Restricting an application to trust only a subset of certificates</a>.
					</li></ul></div></section></section><section class="chapter" id="managing-idm-certificates-using-ansible_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 3. Managing IdM certificates using Ansible</h2></div></div></div><p>
			You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipacert</code> module to request, revoke, and retrieve SSL certificates for Identity Management (IdM) users, hosts and services. You can also restore a certificate that has been put on hold.
		</p><section class="section" id="using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible"><div class="titlepage"><div><div><h3 class="title">3.1. Using Ansible to request SSL certificates for IdM hosts, services and users</h3></div></div></div><p>
				You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipacert</code> module to request SSL certificates for Identity Management (IdM) users, hosts and services. They can then use these certificates to authenticate to IdM.
			</p><p>
				Complete this procedure to request a certificate for an HTTP server from an IdM certificate authority (CA) using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.14 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li><li class="listitem">
						Your IdM deployment has an integrated CA.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate a certificate-signing request (CSR) for your user, host or service. For example, to use the <code class="literal">openssl</code> utility to generate a CSR for the <code class="literal">HTTP</code> service running on client.idm.example.com, enter:
					</p><pre class="literallayout"># <span class="strong strong"><strong>openssl req -new -newkey rsa:2048 -days 365 -nodes -keyout new.key -out new.csr -subj '/CN=client.idm.example.com,O=IDM.EXAMPLE.COM'</strong></span></pre><p class="simpara">
						As a result, the CSR is stored in <span class="strong strong"><strong>new.csr</strong></span>.
					</p></li><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>request-certificate.yml</strong></span> with the following content:
					</p><pre class="screen">---
- name: Playbook to request a certificate
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  - name: Request a certificate for a web server
    ipacert:
      ipaadmin_password: "{{ ipaadmin_password }}"
      state: requested
      csr: |
        -----BEGIN CERTIFICATE REQUEST-----
        MIGYMEwCAQAwGTEXMBUGA1UEAwwOZnJlZWlwYSBydWxlcyEwKjAFBgMrZXADIQBs
        HlqIr4b/XNK+K8QLJKIzfvuNK0buBhLz3LAzY7QDEqAAMAUGAytlcANBAF4oSCbA
        5aIPukCidnZJdr491G4LBE+URecYXsPknwYb+V+ONnf5ycZHyaFv+jkUBFGFeDgU
        SYaXm/gF8cDYjQI=
        -----END CERTIFICATE REQUEST-----
      principal: HTTP/client.idm.example.com
    register: cert</pre><p class="simpara">
						Replace the certificate request with the CSR from <span class="strong strong"><strong>new.csr</strong></span>.
					</p></li><li class="listitem"><p class="simpara">
						Request the certificate:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/request-certificate.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md">The cert module in <code class="literal">ansible-freeipa</code> upstream docs</a>
					</li></ul></div></section><section class="section" id="using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible"><div class="titlepage"><div><div><h3 class="title">3.2. Using Ansible to revoke SSL certificates for IdM hosts, services and users</h3></div></div></div><p>
				You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipacert</code> module to revoke SSL certificates used by Identity Management (IdM) users, hosts and services to authenticate to IdM.
			</p><p>
				Complete this procedure to revoke a certificate for an HTTP server using an Ansible playbook. The reason for revoking the certificate is “keyCompromise”.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.14 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li><li class="listitem">
								You have obtained the serial number of the certificate, for example by entering the <code class="literal">openssl x509 -noout -text -in &lt;path_to_certificate&gt;</code> command. In this example, the serial number of the certificate is 123456789.
							</li></ul></div></li><li class="listitem">
						Your IdM deployment has an integrated CA.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>revoke-certificate.yml</strong></span> with the following content:
					</p><pre class="screen">---
- name: Playbook to revoke a certificate
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  - name: Revoke a certificate for a web server
    ipacert:
      ipaadmin_password: "{{ ipaadmin_password }}"
      serial_number: 123456789
      revocation_reason: "keyCompromise"
      state: revoked</pre></li><li class="listitem"><p class="simpara">
						Revoke the certificate:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/revoke-certificate.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md">The cert module in <code class="literal">ansible-freeipa</code> upstream docs</a>
					</li><li class="listitem">
						<a class="link" href="https://datatracker.ietf.org/doc/html/rfc5280#section-5.3.1">Reason Code</a> in RFC 5280
					</li></ul></div></section><section class="section" id="using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible"><div class="titlepage"><div><div><h3 class="title">3.3. Using Ansible to restore SSL certificates for IdM users, hosts, and services</h3></div></div></div><p>
				You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipacert</code> module to restore a revoked SSL certificate previously used by an Identity Management (IdM) user, host or a service to authenticate to IdM.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You can only restore a certificate that was put on hold. You may have put it on hold because, for example, you were not sure if the private key had been lost. However, now you have recovered the key and as you are certain that no-one has accessed it in the meantime, you want to reinstate the certificate.
				</p></div></rh-alert><p>
				Complete this procedure to use an Ansible playbook to release a certificate for a service enrolled into IdM from hold. This example describes how to release a certificate for an HTTP service from hold.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.14 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li><li class="listitem">
						Your IdM deployment has an integrated CA.
					</li><li class="listitem">
						You have obtained the serial number of the certificate, for example by entering the <code class="literal">openssl x509 -noout -text -in path/to/certificate</code> command. In this example, the certificate serial number is <span class="strong strong"><strong>123456789</strong></span>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>restore-certificate.yml</strong></span> with the following content:
					</p><pre class="literallayout">---
- name: Playbook to restore a certificate
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  - name: Restore a certificate for a web service
    ipacert:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>serial_number: 123456789</strong></span>
      <span class="strong strong"><strong>state: released</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/restore-certificate.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md">The cert module in <code class="literal">ansible-freeipa</code> upstream docs</a>
					</li></ul></div></section><section class="section" id="using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible"><div class="titlepage"><div><div><h3 class="title">3.4. Using Ansible to retrieve SSL certificates for IdM users, hosts, and services</h3></div></div></div><p>
				You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipacert</code> module to retrieve an SSL certificate issued for an Identity Management (IdM) user, host or a service, and store it in a file on the managed node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.14 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li><li class="listitem">
						You have obtained the serial number of the certificate, for example by entering the <code class="literal">openssl x509 -noout -text -in &lt;path_to_certificate&gt;</code> command. In this example, the serial number of the certificate is 123456789, and the file in which you store the retrieved certificate is <span class="strong strong"><strong>cert.pem</strong></span>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>retrieve-certificate.yml</strong></span> with the following content:
					</p><pre class="literallayout">---
- name: Playbook to retrieve a certificate and store it locally on the managed node
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  - name: Retrieve a certificate and save it to file 'cert.pem'
    ipacert:
      ipaadmin_password: "{{ ipaadmin_password }}"
      serial_number: 123456789
      certificate_out: cert.pem
      state: retrieved</pre></li><li class="listitem"><p class="simpara">
						Retrieve the certificate:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/retrieve-certificate.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md">The cert module in <code class="literal">ansible-freeipa</code> upstream docs</a>
					</li></ul></div></section></section><section class="chapter" id="managing-externally-signed-certificates-for-idm-users-hosts-and-services_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 4. Managing externally signed certificates for IdM users, hosts, and services</h2></div></div></div><p>
			This chapter describes how to use the Identity Management (IdM) command-line interface (CLI) and the IdM Web UI to add or remove user, host, or service certificates that were issued by an external certificate authority (CA).
		</p><section class="section" id="adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services"><div class="titlepage"><div><div><h3 class="title">4.1. Adding a certificate issued by an external CA to an IdM user, host, or service by using the IdM CLI</h3></div></div></div><p>
				As an Identity Management (IdM) administrator, you can add an externally signed certificate to the account of an IdM user, host, or service by using the Identity Management (IdM) CLI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have obtained the ticket-granting ticket of an administrative user.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To add a certificate to an IdM user, enter:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add-cert <span class="emphasis"><em>user</em></span> --certificate=<span class="emphasis"><em>MIQTPrajQAwg...</em></span></strong></span></pre><p class="simpara">
						The command requires you to specify the following information:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The name of the user
							</li><li class="listitem">
								The Base64-encoded DER certificate
							</li></ul></div></li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Instead of copying and pasting the certificate contents into the command line, you can convert the certificate to the DER format and then re-encode it to Base64. For example, to add the <code class="literal">user_cert.pem</code> certificate to <code class="literal">user</code>, enter:
				</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add-cert <span class="emphasis"><em>user</em></span> --certificate="$(openssl x509 -outform der -in <span class="emphasis"><em>user_cert.pem</em></span> | base64 -w 0)"</strong></span></pre></div></rh-alert><p>
				You can run the <code class="literal">ipa user-add-cert</code> command interactively by executing it without adding any options.
			</p><p>
				To add a certificate to an IdM host, enter:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal command">ipa host-add-cert</code>
					</li></ul></div><p>
				To add a certificate to an IdM service, enter:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal command">ipa service-add-cert</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm" title="Chapter 2. Managing certificates for users, hosts, and services using the integrated IdM CA">Managing certificates for users, hosts, and services using the integrated IdM CA</a>
					</li></ul></div></section><section class="section" id="adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services"><div class="titlepage"><div><div><h3 class="title">4.2. Adding a certificate issued by an external CA to an IdM user, host, or service by using the IdM Web UI</h3></div></div></div><p>
				As an Identity Management (IdM) administrator, you can add an externally signed certificate to the account of an IdM user, host, or service by using the Identity Management (IdM) Web UI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in to the Identity Management (IdM) Web UI as an administrative user.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open the <code class="literal">Identity</code> tab, and select the <code class="literal">Users</code>, <code class="literal">Hosts</code>, or <code class="literal">Services</code> subtab.
					</li><li class="listitem">
						Click the name of the user, host, or service to open its configuration page.
					</li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">Add</span> next to the <code class="literal">Certificates</code> entry.
					</p><div class="figure" id="idm140333367931440"><p class="title"><strong>Figure 4.1. Adding a certificate to a user account</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/e379f8fc7f76ae285ab18d034ee34b47/user-add-cert.png" alt="user add cert"></div></div></div></li><li class="listitem">
						Paste the certificate in Base64 or PEM encoded format into the text field, and click <span class="guibutton">Add</span>.
					</li><li class="listitem">
						Click <span class="guibutton">Save</span> to store the changes.
					</li></ol></div></section><section class="section" id="removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services"><div class="titlepage"><div><div><h3 class="title">4.3. Removing a certificate issued by an external CA from an IdM user, host, or service account by using the IdM CLI</h3></div></div></div><p>
				As an Identity Management (IdM) administrator, you can remove an externally signed certificate from the account of an IdM user, host, or service by using the Identity Management (IdM) CLI .
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have obtained the ticket-granting ticket of an administrative user.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To remove a certificate from an IdM user, enter:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-remove-cert <span class="emphasis"><em>user</em></span> --certificate=<span class="emphasis"><em>MIQTPrajQAwg...</em></span></strong></span></pre><p class="simpara">
						The command requires you to specify the following information:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The name of the user
							</li><li class="listitem">
								The Base64-encoded DER certificate
							</li></ul></div></li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Instead of copying and pasting the certificate contents into the command line, you can convert the certificate to the DER format and then re-encode it to Base64. For example, to remove the <code class="literal">user_cert.pem</code> certificate from <code class="literal">user</code>, enter:
				</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-remove-cert <span class="emphasis"><em>user</em></span> --certificate="$(openssl x509 -outform der -in <span class="emphasis"><em>user_cert.pem</em></span> | base64 -w 0)"</strong></span></pre></div></rh-alert><p>
				You can run the <code class="literal">ipa user-remove-cert</code> command interactively by executing it without adding any options.
			</p><p>
				To remove a certificate from an IdM host, enter:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal command">ipa host-remove-cert</code>
					</li></ul></div><p>
				To remove a certificate from an IdM service, enter:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal command">ipa service-remove-cert</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm" title="Chapter 2. Managing certificates for users, hosts, and services using the integrated IdM CA">Managing certificates for users, hosts, and services using the integrated IdM CA</a>
					</li></ul></div></section><section class="section" id="removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services"><div class="titlepage"><div><div><h3 class="title">4.4. Removing a certificate issued by an external CA from an IdM user, host, or service account by using the IdM Web UI</h3></div></div></div><p>
				As an Identity Management (IdM) administrator, you can remove an externally signed certificate from the account of an IdM user, host, or service by using the Identity Management (IdM) Web UI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in to the Identity Management (IdM) Web UI as an administrative user.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open the <code class="literal">Identity</code> tab, and select the <code class="literal">Users</code>, <code class="literal">Hosts</code>, or <code class="literal">Services</code> subtab.
					</li><li class="listitem">
						Click the name of the user, host, or service to open its configuration page.
					</li><li class="listitem">
						Click the <span class="guibutton">Actions</span> next to the certificate to delete, and select <span class="guibutton">Delete</span>.
					</li><li class="listitem">
						Click <span class="guibutton">Save</span> to store the changes.
					</li></ol></div></section><section class="section _additional-resources" id="additional_resources_2"><div class="titlepage"><div><div><h3 class="title">4.5. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/using_ansible_to_install_and_manage_identity_management/index#ensuring-the-presence-of-an-externally-signed-certificate-in-an-idm-service-entry-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">Ensuring the presence of an externally signed certificate in an IdM service entry using an Ansible playbook</a>
					</li></ul></div></section></section><section class="chapter" id="convert-cert-formats-idm_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 5. Converting certificate formats to work with IdM</h2></div></div></div><p class="_abstract _abstract">
			This user story describes how to make sure that you as an IdM system administrator are using the correct format of a certificate with specific IdM commands. This is useful, for example, in the following situations:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					You are loading an external certificate into a user profile. For details, see <a class="link" href="#assembly_converting-an-external-certificate-to-load-into-an-idm-user-account_convert-cert-formats-idm" title="5.2. Converting an external certificate to load into an IdM user account">Converting an external certificate to load into an IdM user account</a>.
				</li><li class="listitem">
					You are using an external CA certificate when <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth">configuring the IdM server for smart card authentication</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth">configuring the IdM client for smart card authentication</a> so that users can authenticate to IdM using smart cards with certificates on them that have been issued by the external certificate authority.
				</li><li class="listitem">
					You are exporting a certificate from an NSS database into a pkcs #12 format that includes both the certificate and the private key. For details, see <a class="link" href="#proc_exporting-a-certificate-and-private-key-from-an-nss-database-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser" title="5.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file">Exporting a certificate and private key from an NSS database into a PKCS #12 file</a>.
				</li></ul></div><section class="section" id="cert-types-idm_convert-cert-formats-idm"><div class="titlepage"><div><div><h3 class="title">5.1. Certificate formats and encodings in IdM</h3></div></div></div><p class="_abstract _abstract">
				Certificate authentication including smart card authentication in IdM proceeds by comparing the certificate that the user presents with the certificate, or certificate data, that are stored in the user’s IdM profile.
			</p><div class="formalpara"><p class="title"><strong>System configuration</strong></p><p>
					What is stored in the IdM profile is only the certificate, not the corresponding private key. During authentication, the user must also show that he is in possession of the corresponding private key. The user does that by either presenting a PKCS #12 file that contains both the certificate and the private key or by presenting two files: one that contains the certificate and the other containing the private key.
				</p></div><p>
				Therefore, processes such as loading a certificate into a user profile only accept certificate files that do not contain the private key.
			</p><p>
				Similarly, when a system administrator provides you with an external CA certificate, he will provide only the public data: the certificate without the private key. The <code class="literal">ipa-advise</code> utility for configuring the IdM server or the IdM client for smart card authentication expects the input file to contain the certificate of the external CA but not the private key.
			</p><div class="formalpara"><p class="title"><strong>Certificate encodings</strong></p><p>
					There are two common certificate encodings: Privacy-enhanced Electronic Mail (<code class="literal">PEM</code>) and Distinguished Encoding Rules (<code class="literal">DER</code>). The <code class="literal">base64</code> format is almost identical to the <code class="literal">PEM</code> format but it does not contain the <code class="literal">-----BEGIN CERTIFICATE-----/-----END CERTIFICATE-----</code> header and footer.
				</p></div><p>
				A certificate that has been encoded using <code class="literal">DER</code> is a binary X509 digital certificate file. As a binary file, the certificate is not human-readable. <code class="literal">DER</code> files sometimes use the <code class="literal">.der</code> filename extension, but files with the <code class="literal">.crt</code> and <code class="literal">.cer</code> filename extensions also sometimes contain <code class="literal">DER</code> certificates. <code class="literal">DER</code> files containing keys can be named <code class="literal">.key</code>.
			</p><p>
				A certificate that has been encoded using <code class="literal">PEM</code> Base64 is a human-readable file. The file contains ASCII (Base64) armored data prefixed with a “-----BEGIN …” line. <code class="literal">PEM</code> files sometimes use the <code class="literal">.pem</code> filename extension, but files with the <code class="literal">.crt</code> and <code class="literal">.cer</code> filename extensions also sometimes contain <code class="literal">PEM</code> certificates. <code class="literal">PEM</code> files containing keys can be named <code class="literal">.key</code>.
			</p><p>
				Different <code class="literal">ipa</code> commands have different limitations regarding the types of certificates that they accept. For example, the <code class="literal">ipa user-add-cert</code> command only accepts certificates encoded in the <code class="literal">base64</code> format but <code class="literal">ipa-server-certinstall</code> accepts <code class="literal">PEM, DER, PKCS #7, PKCS #8</code> and <code class="literal">PKCS #12</code> certificates.
			</p><rh-table id="idm140333368040032"><table class="gt-4-cols lt-7-rows"><caption>Table 5.1. Certificate encodings</caption><colgroup><col style="width: 25%; " class="col_1"><!--Empty--><col style="width: 25%; " class="col_2"><!--Empty--><col style="width: 25%; " class="col_3"><!--Empty--><col style="width: 25%; " class="col_4"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333368603184" scope="col">Encoding format</th><th align="left" valign="top" id="idm140333368602096" scope="col">Human-readable</th><th align="left" valign="top" id="idm140333368601008" scope="col">Common filename extensions</th><th align="left" valign="top" id="idm140333368599952" scope="col">Sample IdM commands accepting the encoding format</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333368603184"> <p>
								PEM/base64
							</p>
							 </td><td align="left" valign="top" headers="idm140333368602096"> <p>
								Yes
							</p>
							 </td><td align="left" valign="top" headers="idm140333368601008"> <p>
								.pem, .crt, .cer
							</p>
							 </td><td align="left" valign="top" headers="idm140333368599952"> <p>
								ipa user-add-cert, ipa-server-certinstall, …​
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333368603184"> <p>
								DER
							</p>
							 </td><td align="left" valign="top" headers="idm140333368602096"> <p>
								No
							</p>
							 </td><td align="left" valign="top" headers="idm140333368601008"> <p>
								.der, .crt, .cer
							</p>
							 </td><td align="left" valign="top" headers="idm140333368599952"> <p>
								ipa-server-certinstall, …​
							</p>
							 </td></tr></tbody></table></rh-table><p>
				<a class="link" href="#other-cert-commands_convert-cert-formats-idm" title="5.4. Certificate-related commands and formats in IdM">Certificate-related commands and formats in IdM</a> lists further <code class="literal">ipa</code> commands with the certificate formats that the commands accept.
			</p><div class="formalpara"><p class="title"><strong>User authentication</strong></p><p>
					When using the web UI to access IdM, the user proves that he is in possession of the private key corresponding to the certificate by having both stored in the browser’s database.
				</p></div><p>
				When using the CLI to access IdM, the user proves that he is in possession of the private key corresponding to the certificate by one of the following methods:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The user adds, as the value of the <code class="literal">X509_user_identity</code> parameter of the <code class="literal">kinit -X</code> command, the path to the smart card module that is connected to the smart card that contains both the certificate and the key:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit -X X509_user_identity='PKCS11:opensc-pkcs11.so' <code class="literal">idm_user</code></strong></span></pre></li><li class="listitem"><p class="simpara">
						The user adds two files as the values of the <code class="literal">X509_user_identity</code> parameter of the <code class="literal">kinit -X</code> command, one containing the certificate and the other the private key:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit -X X509_user_identity='FILE:`/path/to/cert.pem,/path/to/cert.key`' <code class="literal">idm_user</code></strong></span></pre></li></ul></div><div class="formalpara"><p class="title"><strong>Useful certificate commands</strong></p><p>
					To view the certificate data, such as the subject and the issuer:
				</p></div><pre class="literallayout">$ <span class="strong strong"><strong>openssl x509 -noout -text -in ca.pem</strong></span></pre><p>
				To compare in which lines two certificates differ:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>diff cert1.crt cert2.crt</strong></span></pre><p>
				To compare in which lines two certificates differ with the output displayed in two columns:
			</p><pre class="literallayout">$ <span class="strong strong"><strong>diff cert1.crt cert2.crt -y</strong></span></pre></section><section class="section" id="assembly_converting-an-external-certificate-to-load-into-an-idm-user-account_convert-cert-formats-idm"><div class="titlepage"><div><div><h3 class="title">5.2. Converting an external certificate to load into an IdM user account</h3></div></div></div><p class="_abstract _abstract">
				This section describes how to make sure that an external certificate is correctly encoded and formatted before adding it to a user entry.
			</p><section class="section" id="prerequisites"><div class="titlepage"><div><div><h4 class="title">5.2.1. Prerequisites</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If your certificate was issued by an Active Directory certificate authority and uses the <code class="literal">PEM</code> encoding, make sure that the <code class="literal">PEM</code> file has been converted into the <code class="literal">UNIX</code> format. To convert a file, use the <code class="literal">dos2unix</code> utility provided by the eponymous package.
						</li></ul></div></section><section class="section" id="proc_converting-an-external-certificate-in-the-idm-cli-and-loading-it-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account"><div class="titlepage"><div><div><h4 class="title">5.2.2. Converting an external certificate in the IdM CLI and loading it into an IdM user account</h4></div></div></div><p>
					The <code class="literal">IdM CLI</code> only accepts a <code class="literal">PEM</code> certificate from which the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----) have been removed.
				</p><p>
					Follow this procedure to convert an external certificate to <code class="literal">PEM</code> format and add it to an IdM user account using the IdM CLI.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Convert the certificate to the <code class="literal">PEM</code> format:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If your certificate is in the <code class="literal">DER</code> format:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl x509 -in cert.crt -inform der -outform pem -out cert.pem</strong></span></pre></li><li class="listitem"><p class="simpara">
									If your file is in the <code class="literal">PKCS #12</code> format, whose common filename extensions are <code class="literal">.pfx</code> and <code class="literal">.p12</code>, and contains a certificate, a private key, and possibly other data, extract the certificate using the <code class="literal">openssl pkcs12</code> utility. When prompted, enter the password protecting the private key stored in the file:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl pkcs12 -in cert_and_key.p12 -clcerts -nokeys -out cert.pem</strong></span>
Enter Import Password:</pre></li></ul></div></li><li class="listitem"><p class="simpara">
							Obtain the administrator’s credentials:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
							Add the certificate to the user account using the <code class="literal">IdM CLI</code> following one of the following methods:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									Remove the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----) of the <code class="literal">PEM</code> file using the <code class="literal">sed</code> utility before adding the string to the <code class="literal">ipa user-add-cert</code> command:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add-cert some_user --certificate="$(sed -e '/BEGIN CERTIFICATE/d;/END CERTIFICATE/d' cert.pem)"</strong></span></pre></li><li class="listitem"><p class="simpara">
									Copy and paste the contents of the certificate file without the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----) into the <code class="literal">ipa user-add-cert</code> command:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add-cert some_user --certificate=MIIDlzCCAn+gAwIBAgIBATANBgkqhki...</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
										You cannot pass a <code class="literal">PEM</code> file containing the certificate as input to the <code class="literal">ipa user-add-cert</code> command directly, without first removing the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----):
									</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add-cert some_user --cert=some_user_cert.pem</strong></span></pre><p>
										This command results in the "ipa: ERROR: Base64 decoding failed: Incorrect padding" error message.
									</p></div></rh-alert></li></ul></div></li><li class="listitem"><p class="simpara">
							To check if the certificate was accepted by the system:
						</p><pre class="literallayout">[idm_user@r8server]$ <span class="strong strong"><strong>ipa user-show some_user</strong></span></pre></li></ol></div></section><section class="section" id="proc_converting-an-external-certificate-in-the-idm-web-ui-for-loading-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account"><div class="titlepage"><div><div><h4 class="title">5.2.3. Converting an external certificate in the IdM web UI for loading into an IdM user account</h4></div></div></div><p>
					Follow this procedure to convert an external certificate to <code class="literal">PEM</code> format and add it to an IdM user account in the IdM web UI.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Using the <code class="literal">CLI</code>, convert the certificate to the <code class="literal">PEM</code> format:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If your certificate is in the <code class="literal">DER</code> format:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl x509 -in cert.crt -inform der -outform pem -out cert.pem</strong></span></pre></li><li class="listitem"><p class="simpara">
									If your file is in the <code class="literal">PKCS #12</code> format, whose common filename extensions are <code class="literal">.pfx</code> and <code class="literal">.p12</code>, and contains a certificate, a private key, and possibly other data, extract the certificate using the <code class="literal">openssl pkcs12</code> utility. When prompted, enter the password protecting the private key stored in the file:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl pkcs12 -in cert_and_key.p12 -clcerts -nokeys -out cert.pem</strong></span>
Enter Import Password:</pre></li></ul></div></li><li class="listitem">
							Open the certificate in an editor and copy the contents. You can include the "-----BEGIN CERTIFICATE-----" and "-----END CERTIFICATE-----" header and footer lines but you do not have to, as both the <code class="literal">PEM</code> and <code class="literal">base64</code> formats are accepted by the IdM web UI.
						</li><li class="listitem">
							In the IdM web UI, log in as security officer.
						</li><li class="listitem">
							Go to <code class="literal">Identity</code> → <code class="literal">Users</code> → <code class="literal">some_user</code>.
						</li><li class="listitem">
							Click <code class="literal">Add</code> next to <code class="literal">Certificates</code>.
						</li><li class="listitem">
							Paste the PEM-formatted contents of the certificate into the window that opens.
						</li><li class="listitem">
							Click <code class="literal">Add</code>.
						</li></ol></div><p>
					If the certificate was accepted by the system, you can see it listed among the <code class="literal">Certificates</code> in the user profile.
				</p></section></section><section class="section" id="assembly_preparing-to-load-a-certificate-into-the-browser_convert-cert-formats-idm"><div class="titlepage"><div><div><h3 class="title">5.3. Preparing to load a certificate into the browser</h3></div></div></div><p class="_abstract _abstract">
				Before importing a user certificate into the browser, make sure that the certificate and the corresponding private key are in a <code class="literal">PKCS #12</code> format. There are two common situations requiring extra preparatory work:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The certificate is located in an NSS database. For details how to proceed in this situation, see <a class="link" href="#proc_exporting-a-certificate-and-private-key-from-an-nss-database-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser" title="5.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file">Exporting a certificate and private key from an NSS database into a PKCS #12 file</a>.
					</li><li class="listitem">
						The certificate and the private key are in two separate <code class="literal">PEM</code> files. For details how to proceed in this situation, see <a class="link" href="#proc_combining-certificate-and-private-key-pem-files-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser" title="5.3.2. Combining certificate and private key PEM files into a PKCS #12 file">Combining certificate and private key PEM files into a PKCS #12 file</a>.
					</li></ul></div><p>
				Afterwards, to import both the CA certificate in the <code class="literal">PEM</code> format and the user certificate in the <code class="literal">PKCS #12</code> format into the browser, follow the procedures in <a class="link" href="#configuring-browser-for-cert-auth_dc-web-ui-auth" title="11.4. Configuring a browser to enable certificate authentication">Configuring a browser to enable certificate authentication</a> and <a class="link" href="#cert-idm-users-auth-procedure_dc-web-ui-auth" title="11.5. Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User">Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User</a>.
			</p><section class="section" id="proc_exporting-a-certificate-and-private-key-from-an-nss-database-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser"><div class="titlepage"><div><div><h4 class="title">5.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file</h4></div></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Use the <code class="literal command">pk12util</code> command to export the certificate from the NSS database to the <code class="literal">PKCS12</code> format. For example, to export the certificate with the <code class="literal replaceable">some_user</code> nickname from the NSS database stored in the <code class="literal filename">~/certdb</code> directory into the <code class="literal replaceable">~/some_user.p12</code> file:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>pk12util -d <code class="literal filename">~/certdb</code> -o <code class="literal replaceable">~/some_user.p12</code> -n some_user</strong></span>
Enter Password or Pin for "NSS Certificate DB":
Enter password for PKCS12 file:
Re-enter password:
pk12util: PKCS12 EXPORT SUCCESSFUL</pre></li><li class="listitem"><p class="simpara">
							Set appropriate permissions for the <code class="literal">.p12</code> file:
						</p><pre class="literallayout"># <span class="strong strong"><strong>chmod 600 ~/some_user.p12</strong></span></pre><p class="simpara">
							Because the <code class="literal">PKCS #12</code> file also contains the private key, it must be protected to prevent other users from using the file. Otherwise, they would be able to impersonate the user.
						</p></li></ol></div></section><section class="section" id="proc_combining-certificate-and-private-key-pem-files-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser"><div class="titlepage"><div><div><h4 class="title">5.3.2. Combining certificate and private key PEM files into a PKCS #12 file</h4></div></div></div><p>
					Follow this procedure to combine a certificate and the corresponding key stored in separate <code class="literal">PEM</code> files into a <code class="literal">PKCS #12</code> file.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To combine a certificate stored in <code class="literal">certfile.cer</code> and a key stored in <code class="literal">certfile.key</code> into a <code class="literal">certfile.p12</code> file that contains both the certificate and the key:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl pkcs12 -export -in certfile.cer -inkey certfile.key -out certfile.p12</strong></span></pre></li></ul></div></section></section><section class="section" id="other-cert-commands_convert-cert-formats-idm"><div class="titlepage"><div><div><h3 class="title">5.4. Certificate-related commands and formats in IdM</h3></div></div></div><p class="_abstract _abstract">
				The following table displays certificate-related commands in IdM with acceptable formats.
			</p><rh-table id="idm140333367914768"><table class="lt-4-cols lt-7-rows"><caption>Table 5.2. IdM certificate commands and formats</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333367909040" scope="col">Command</th><th align="left" valign="top" id="idm140333373910832" scope="col">Acceptable formats</th><th align="left" valign="top" id="idm140333373909744" scope="col">Notes</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333367909040"> <p>
								<code class="literal">ipa user-add-cert some_user --certificate</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140333373910832"> <p>
								base64 PEM certificate
							</p>
							 </td><td align="left" valign="top" headers="idm140333373909744"> </td></tr><tr><td align="left" valign="top" headers="idm140333367909040"> <p>
								<code class="literal">ipa-server-certinstall</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140333373910832"> <p>
								PEM and DER certificate; PKCS#7 certificate chain; PKCS#8 and raw private key; PKCS#12 certificate and private key
							</p>
							 </td><td align="left" valign="top" headers="idm140333373909744"> </td></tr><tr><td align="left" valign="top" headers="idm140333367909040"> <p>
								<code class="literal">ipa-cacert-manage install</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140333373910832"> <p>
								DER; PEM; PKCS#7
							</p>
							 </td><td align="left" valign="top" headers="idm140333373909744"> </td></tr><tr><td align="left" valign="top" headers="idm140333367909040"> <p>
								<code class="literal">ipa-cacert-manage renew --external-cert-file</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140333373910832"> <p>
								PEM and DER certificate; PKCS#7 certificate chain
							</p>
							 </td><td align="left" valign="top" headers="idm140333373909744"> </td></tr><tr><td align="left" valign="top" headers="idm140333367909040"> <p>
								<code class="literal">ipa-ca-install --external-cert-file</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140333373910832"> <p>
								PEM and DER certificate; PKCS#7 certificate chain
							</p>
							 </td><td align="left" valign="top" headers="idm140333373909744"> </td></tr><tr><td align="left" valign="top" headers="idm140333367909040"> <p>
								<code class="literal">ipa cert-show &lt;cert serial&gt; --certificate-out /path/to/file.pem</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140333373910832"> <p>
								N/A
							</p>
							 </td><td align="left" valign="top" headers="idm140333373909744"> <p>
								Creates the PEM-encoded <code class="literal">file.pem</code> file with the certificate having the <code class="literal">&lt;cert_serial&gt;</code> serial number.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333367909040"> <p>
								<code class="literal">ipa cert-show &lt;cert serial&gt; --certificate-out /path/to/file.pem</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140333373910832"> <p>
								N/A
							</p>
							 </td><td align="left" valign="top" headers="idm140333373909744"> <p>
								Creates the PEM-encoded <code class="literal">file.pem</code> file with the certificate having the <code class="literal">&lt;cert_serial&gt;</code> serial number. If the <code class="literal">--chain</code> option is used, the PEM file contains the certificate including the certificate chain.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333367909040"> <p>
								<code class="literal">ipa cert-request --certificate-out=FILE /path/to/req.csr</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140333373910832"> <p>
								N/A
							</p>
							 </td><td align="left" valign="top" headers="idm140333373909744"> <p>
								Creates the <code class="literal">req.csr</code> file in the PEM format with the new certificate.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333367909040"> <p>
								<code class="literal">ipa cert-request --certificate-out=FILE /path/to/req.csr</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140333373910832"> <p>
								N/A
							</p>
							 </td><td align="left" valign="top" headers="idm140333373909744"> <p>
								Creates the <code class="literal">req.csr</code> file in the PEM format with the new certificate. If the <code class="literal">--chain</code> option is used, the PEM file contains the certificate including the certificate chain.
							</p>
							 </td></tr></tbody></table></rh-table></section></section><section class="chapter" id="creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 6. Creating and managing certificate profiles in Identity Management</h2></div></div></div><p class="_abstract _abstract">
			Certificate profiles are used by the Certificate Authority (CA) when signing certificates to determine if a certificate signing request (CSR) is acceptable, and if so what features and extensions are present on the certificate. A certificate profile is associated with issuing a particular type of certificate. By combining certificate profiles and CA access control lists (ACLs), you can define and control access to custom certificate profiles.
		</p><p>
			In describing how to create certificate profiles, the procedures use S/MIME certificates as an example. Some email programs support digitally signed and encrypted email using the Secure Multipurpose Internet Mail Extension (S/MIME) protocol. Using S/MIME to sign or encrypt email messages requires the sender of the message to have an S/MIME certificate.
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#what-is-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management" title="6.1. What is a certificate profile?">What is a certificate profile</a>
				</li><li class="listitem">
					<a class="link" href="#creating-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management" title="6.2. Creating a certificate profile">Creating a certificate profile</a>
				</li><li class="listitem">
					<a class="link" href="#what-is-a-ca-access-control-list_creating-and-managing-certificate-profiles-in-identity-management" title="6.3. What is a CA access control list?">What is a CA access control list</a>
				</li><li class="listitem">
					<a class="link" href="#defining-a-ca-acl-to-control-access-to-certificate-profiles_creating-and-managing-certificate-profiles-in-identity-management" title="6.4. Defining a CA ACL to control access to certificate profiles">Defining a CA ACL to control access to certificate profiles</a>
				</li><li class="listitem">
					<a class="link" href="#using-certificate-profiles-and-ca-acls-to-issue-certificates_creating-and-managing-certificate-profiles-in-identity-management" title="6.5. Using certificate profiles and CA ACLs to issue certificates">Using certificate profiles and CA ACLs to issue certificates</a>
				</li><li class="listitem">
					<a class="link" href="#modifying-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management" title="6.6. Modifying a certificate profile">Modifying a certificate profile</a>
				</li><li class="listitem">
					<a class="link" href="#certificate-profile-configuration-parameters_creating-and-managing-certificate-profiles-in-identity-management" title="6.7. Certificate profile configuration parameters">Certificate profile configuration parameters</a>
				</li></ul></div><section class="section" id="what-is-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management"><div class="titlepage"><div><div><h3 class="title">6.1. What is a certificate profile?</h3></div></div></div><p class="_abstract _abstract">
				You can use certificate profiles to determine the content of certificates, as well as constraints for issuing the certificates, such as the following:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The signing algorithm to use to encipher the certificate signing request.
					</li><li class="listitem">
						The default validity of the certificate.
					</li><li class="listitem">
						The revocation reasons that can be used to revoke a certificate.
					</li><li class="listitem">
						If the common name of the principal is copied to the subject alternative name field.
					</li><li class="listitem">
						The features and extensions that should be present on the certificate.
					</li></ul></div><p>
				A single certificate profile is associated with issuing a particular type of certificate. You can define different certificate profiles for users, services, and hosts in IdM. IdM includes the following certificate profiles by default:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">caIPAserviceCert</code>
					</li><li class="listitem">
						<code class="literal">IECUserRoles</code>
					</li><li class="listitem">
						<code class="literal">KDCs_PKINIT_Certs</code> (used internally)
					</li></ul></div><p>
				In addition, you can create and import custom profiles, which allow you to issue certificates for specific purposes. For example, you can restrict the use of a particular profile to only one user or one group, preventing other users and groups from using that profile to issue a certificate for authentication. To create custom certificate profiles, use the <code class="literal">ipa certprofile</code> command.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">ipa help certprofile</code> command.
					</li></ul></div></section><section class="section" id="creating-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management"><div class="titlepage"><div><div><h3 class="title">6.2. Creating a certificate profile</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to create a certificate profile through the command line by creating a profile configuration file for requesting S/MIME certificates.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a custom profile by copying an existing default profile:
					</p><pre class="literallayout">$ ipa certprofile-show --out smime.cfg caIPAserviceCert
------------------------------------------------
Profile configuration stored in file 'smime.cfg'
------------------------------------------------
  Profile ID: caIPAserviceCert
  Profile description: Standard profile for network services
  Store issued certificates: TRUE</pre></li><li class="listitem"><p class="simpara">
						Open the newly created profile configuration file in a text editor.
					</p><pre class="literallayout">$ vi  smime.cfg</pre></li><li class="listitem"><p class="simpara">
						Change the <code class="literal">Profile ID</code> to a name that reflects the usage of the profile, for example <code class="literal">smime</code>.
					</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							When you are importing a newly created profile, the <code class="literal">profileId</code> field, if present, must match the ID specified on the command line.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Update the Extended Key Usage configuration. The default Extended Key Usage extension configuration is for TLS server and client authentication. For example for S/MIME, the Extended Key Usage must be configured for email protection:
					</p><pre class="literallayout">policyset.serverCertSet.7.default.params.exKeyUsageOIDs=1.3.6.1.5.5.7.3.4</pre></li><li class="listitem"><p class="simpara">
						Import the new profile:
					</p><pre class="literallayout">$ ipa certprofile-import smime --file smime.cfg \
  --desc "S/MIME certificates" --store TRUE

------------------------
Imported profile "smime"
------------------------
  Profile ID: smime
  Profile description: S/MIME certificates
  Store issued certificates: TRUE</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify the new certificate profile has been imported:
					</p><pre class="literallayout">$ ipa certprofile-find

------------------
4 profiles matched
------------------
  Profile ID: caIPAserviceCert
  Profile description: Standard profile for network services
  Store issued certificates: TRUE

  Profile ID: IECUserRoles
  Profile description: User profile that includes IECUserRoles extension from request
  Store issued certificates: TRUE

  Profile ID: KDCs_PKINIT_Certs
  Profile description: Profile for PKINIT support by KDCs
  Store issued certificates: TRUE

  Profile ID: smime
  Profile description: S/MIME certificates
  Store issued certificates: TRUE
----------------------------
Number of entries returned 4
----------------------------</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <code class="literal">ipa help certprofile</code>.
					</li><li class="listitem">
						See <a class="link" href="https://tools.ietf.org/html/rfc5280#section-4.2.1.12">RFC 5280, section 4.2.1.12</a>.
					</li></ul></div></section><section class="section" id="what-is-a-ca-access-control-list_creating-and-managing-certificate-profiles-in-identity-management"><div class="titlepage"><div><div><h3 class="title">6.3. What is a CA access control list?</h3></div></div></div><p class="_abstract _abstract">
				Certificate Authority access control list (CA ACL) rules define which profiles can be used to issue certificates to which principals. You can use CA ACLs to do this, for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Determine which user, host, or service can be issued a certificate with a particular profile
					</li><li class="listitem">
						Determine which IdM certificate authority or sub-CA is permitted to issue the certificate
					</li></ul></div><p>
				For example, using CA ACLs, you can restrict use of a profile intended for employees working from an office located in London only to users that are members of the London office-related IdM user group.
			</p><p>
				The <code class="literal">ipa caacl</code> utility for management of CA ACL rules allows privileged users to add, display, modify, or delete a specified CA ACL.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <code class="literal">ipa help caacl</code>.
					</li></ul></div></section><section class="section" id="defining-a-ca-acl-to-control-access-to-certificate-profiles_creating-and-managing-certificate-profiles-in-identity-management"><div class="titlepage"><div><div><h3 class="title">6.4. Defining a CA ACL to control access to certificate profiles</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use the <code class="literal">caacl</code> utility to define a CA Access Control List (ACL) rule to allow users in a group access to a custom certificate profile. In this case, the procedure describes how to create an S/MIME user’s group and a CA ACL to allow users in that group access to the <code class="literal">smime</code> certificate profile.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Make sure that you have obtained IdM administrator’s credentials.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new group for the users of the certificate profile:
					</p><pre class="literallayout">$ ipa group-add smime_users_group
---------------------------------
Added group "smime users group"
---------------------------------
  Group name: smime_users_group
  GID: 75400001</pre></li><li class="listitem"><p class="simpara">
						Create a new user to add to the <code class="literal">smime_user_group</code> group:
					</p><pre class="literallayout">$ ipa user-add smime_user
First name: smime
Last name: user
----------------------
Added user "smime_user"
----------------------
  User login: smime_user
  First name: smime
  Last name: user
  Full name: smime user
  Display name: smime user
  Initials: TU
  Home directory: /home/smime_user
  GECOS: smime user
  Login shell: /bin/sh
  Principal name: smime_user@IDM.EXAMPLE.COM
  Principal alias: smime_user@IDM.EXAMPLE.COM
  Email address: smime_user@idm.example.com
  UID: 1505000004
  GID: 1505000004
  Password: False
  Member of groups: ipausers
  Kerberos keys available: False</pre></li><li class="listitem"><p class="simpara">
						Add the <code class="literal">smime_user</code> to the <code class="literal">smime_users_group</code> group:
					</p><pre class="literallayout">$ ipa group-add-member smime_users_group --users=smime_user
  Group name: smime_users_group
  GID: 1505000003
  Member users: smime_user
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
						Create the CA ACL to allow users in the group to access the certificate profile:
					</p><pre class="literallayout">$ ipa caacl-add smime_acl
------------------------
Added CA ACL "smime_acl"
------------------------
  ACL name: smime_acl
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
						Add the user group to the CA ACL:
					</p><pre class="literallayout">$ ipa caacl-add-user smime_acl --group smime_users_group
  ACL name: smime_acl
  Enabled: TRUE
  User Groups: smime_users_group
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
						Add the certificate profile to the CA ACL:
					</p><pre class="literallayout">$ ipa caacl-add-profile smime_acl --certprofile smime
  ACL name: smime_acl
  Enabled: TRUE
  Profiles: smime
  User Groups: smime_users_group
-------------------------
Number of members added 1
-------------------------</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						View the details of the CA ACL you created:
					</p><pre class="literallayout">$ ipa caacl-show smime_acl
  ACL name: smime_acl
  Enabled: TRUE
  Profiles: smime
  User Groups: smime_users_group
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <code class="literal">ipa</code> man page on your system.
					</li><li class="listitem">
						See <code class="literal">ipa help caacl</code>.
					</li></ul></div></section><section class="section" id="using-certificate-profiles-and-ca-acls-to-issue-certificates_creating-and-managing-certificate-profiles-in-identity-management"><div class="titlepage"><div><div><h3 class="title">6.5. Using certificate profiles and CA ACLs to issue certificates</h3></div></div></div><p class="_abstract _abstract">
				You can request certificates using a certificate profile when permitted by the Certificate Authority access control lists (CA ACLs). Follow this procedure to request an S/MIME certificate for a user using a custom certificate profile which has been granted access through a CA ACL.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your certificate profile has been created.
					</li><li class="listitem">
						An CA ACL has been created which permits the user to use the required certificate profile to request a certificate.
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You can bypass the CA ACL check if the user performing the <code class="literal">cert-request</code> command:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Is the <code class="literal">admin</code> user.
						</li><li class="listitem">
							Has the <code class="literal">Request Certificate ignoring CA ACLs</code> permission.
						</li></ul></div></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate a certificate request for the user. For example, using OpenSSL:
					</p><pre class="literallayout">$ openssl req -new -newkey rsa:2048 -days 365 -nodes -keyout <span class="emphasis"><em>private.key</em></span> -out <span class="emphasis"><em>cert.csr</em></span> -subj '/CN=<span class="emphasis"><em>smime_user</em></span>'</pre></li><li class="listitem"><p class="simpara">
						Request a new certificate for the user from the IdM CA:
					</p><pre class="literallayout">$ ipa cert-request <span class="emphasis"><em>cert.csr</em></span> --principal=<span class="emphasis"><em>smime_user</em></span> --profile-id=<span class="emphasis"><em>smime</em></span></pre><p class="simpara">
						Optionally pass the --ca <span class="emphasis"><em>sub-CA_name</em></span> option to the command to request the certificate from a sub-CA instead of the root CA.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify the newly-issued certificate is assigned to the user:
					</p><pre class="literallayout">$ ipa user-show <span class="emphasis"><em>user</em></span>
  User login: <span class="emphasis"><em>user</em></span>
  ...
  Certificate: MIICfzCCAWcCAQA...
  ...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">ipa(a)</code> and <code class="literal">openssl(lssl)</code> man pages on your system
					</li><li class="listitem">
						<code class="literal">ipa help user-show</code> command
					</li><li class="listitem">
						<code class="literal">ipa help cert-request</code> command
					</li></ul></div></section><section class="section" id="modifying-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management"><div class="titlepage"><div><div><h3 class="title">6.6. Modifying a certificate profile</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to modify certificate profiles directly through the command line using the <code class="literal">ipa certprofile-mod</code> command.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Determine the certificate profile ID for the certificate profile you are modifying. To display all certificate profiles currently stored in IdM:
					</p><pre class="literallayout"># ipa certprofile-find

------------------
4 profiles matched
------------------
  Profile ID: caIPAserviceCert
  Profile description: Standard profile for network services
  Store issued certificates: TRUE

  Profile ID: IECUserRoles
  ...

  Profile ID: smime
  Profile description: S/MIME certificates
  Store issued certificates: TRUE
--------------------------
Number of entries returned
--------------------------</pre></li><li class="listitem"><p class="simpara">
						Modify the certificate profile description. For example, if you created a custom certificate profile for S/MIME certificates using an existing profile, change the description in line with the new usage:
					</p><pre class="literallayout"># ipa certprofile-mod smime --desc "New certificate profile description"
------------------------------------
Modified Certificate Profile "smime"
------------------------------------
    Profile ID: smime
    Profile description: New certificate profile description
    Store issued certificates: TRUE</pre></li><li class="listitem"><p class="simpara">
						Open your customer certificate profile file in a text editor and modify to suit your requirements:
					</p><pre class="literallayout"># vi smime.cfg</pre><p class="simpara">
						For details on the options which can be configured in the certificate profile configuration file, see <a class="link" href="#certificate-profile-configuration-parameters_creating-and-managing-certificate-profiles-in-identity-management" title="6.7. Certificate profile configuration parameters">Certificate profile configuration parameters</a>.
					</p></li><li class="listitem"><p class="simpara">
						Update the existing certificate profile configuration file:
					</p><pre class="literallayout"># ipa certprofile-mod _profile_ID_ --file=smime.cfg</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify the certificate profile has been updated:
					</p><pre class="literallayout">$ ipa certprofile-show smime
  Profile ID: smime
  Profile description: New certificate profile description
  Store issued certificates: TRUE</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <code class="literal">ipa(a)</code> man page on your system.
					</li><li class="listitem">
						See <code class="literal">ipa help certprofile-mod</code>.
					</li></ul></div></section><section class="section" id="certificate-profile-configuration-parameters_creating-and-managing-certificate-profiles-in-identity-management"><div class="titlepage"><div><div><h3 class="title">6.7. Certificate profile configuration parameters</h3></div></div></div><p class="_abstract _abstract">
				Certificate profile configuration parameters are stored in a <span class="emphasis"><em>profile_name</em></span>.cfg file in the CA profile directory, <code class="literal">/var/lib/pki/pki-tomcat/ca/profiles/ca</code>. All of the parameters for a profile - defaults, inputs, outputs, and constraints - are configured within a single policy set. A policy set for a certificate profile has the name <code class="literal">policyset.<span class="emphasis"><em>policyName.policyNumber</em></span>.</code> For example, for policy set <code class="literal">serverCertSet</code>:
			</p><pre class="literallayout">policyset.list=serverCertSet
policyset.serverCertSet.list=1,2,3,4,5,6,7,8
policyset.serverCertSet.1.constraint.class_id=subjectNameConstraintImpl
policyset.serverCertSet.1.constraint.name=Subject Name Constraint
policyset.serverCertSet.1.constraint.params.pattern=CN=[^,]+,.+
policyset.serverCertSet.1.constraint.params.accept=true
policyset.serverCertSet.1.default.class_id=subjectNameDefaultImpl
policyset.serverCertSet.1.default.name=Subject Name Default
policyset.serverCertSet.1.default.params.name=CN=$request.req_subject_name.cn$, OU=pki-ipa, O=IPA
policyset.serverCertSet.2.constraint.class_id=validityConstraintImpl
policyset.serverCertSet.2.constraint.name=Validity Constraint
policyset.serverCertSet.2.constraint.params.range=740
policyset.serverCertSet.2.constraint.params.notBeforeCheck=false
policyset.serverCertSet.2.constraint.params.notAfterCheck=false
policyset.serverCertSet.2.default.class_id=validityDefaultImpl
policyset.serverCertSet.2.default.name=Validity Default
policyset.serverCertSet.2.default.params.range=731
policyset.serverCertSet.2.default.params.startTime=0</pre><p>
				Each policy set contains a list of policies configured for the certificate profile by policy ID number in the order in which they should be evaluated. The server evaluates each policy set for each request it receives. When a single certificate request is received, one set is evaluated, and any other sets in the profile are ignored. When dual key pairs are issued, the first policy set is evaluated for the first certificate request, and the second set is evaluated for the second certificate request. You do not need more than one policy set when issuing single certificates or more than two sets when issuing dual key pairs.
			</p><rh-table id="idm140333373746528"><table class="lt-4-cols lt-7-rows"><caption>Table 6.1. Certificate profile configuration file parameters</caption><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333366583296" scope="col">Parameter</th><th align="left" valign="top" id="idm140333366582208" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								desc
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								A free text description of the certificate profile, which is shown on the end-entities page. For example, <code class="literal">desc=This certificate profile is for enrolling server certificates with agent authentication</code>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								enable
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Enables the profile so it is accessible through the end-entities page. For example, <code class="literal">enable=true</code>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								auth.instance_id
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Sets the authentication manager plug-in to use to authenticate the certificate request. For automatic enrollment, the CA issues a certificate immediately if the authentication is successful. If authentication fails or there is no authentication plug-in specified, the request is queued to be manually approved by an agent. For example, <code class="literal">auth.instance_id=AgentCertAuth</code>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								authz.acl
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Specifies the authorization constraint. This is predominantly used to set the group evaluation Access Control List (ACL). For example, the <code class="literal">caCMCUserCert</code> parameter requires that the signer of the CMC request belongs to the Certificate Manager Agents group:
							</p>
							 <p>
								<code class="literal">authz.acl=group="Certificate Manager Agents</code>
							</p>
							 <p>
								In directory-based user certificate renewal, this option is used to ensure that the original requester and the currently-authenticated user are the same. An entity must authenticate (bind or, essentially, log into the system) before authorization can be evaluated.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								name
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								The name of the certificate profile. For example, <code class="literal">name=Agent-Authenticated Server Certificate Enrollment</code>. This name is displayed on the end users enrollment or renewal page.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								input.list
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Lists the allowed inputs for the certificate profile by name. For example, <code class="literal">input.list=i1,i2</code>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								input.input_id.class_id
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Indicates the java class name for the input by input ID (the name of the input listed in input.list). For example, <code class="literal">input.i1.class_id=certReqInputImpl</code>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								output.list
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Lists the possible output formats for the certificate profile by name. For example, <code class="literal">output.list=o1</code>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								output.output_id.class_id
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Specifies the java class name for the output format named in output.list. For example, <code class="literal">output.o1.class_id=certOutputImpl</code>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								policyset.list
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Lists the configured certificate profile rules. For dual certificates, one set of rules applies to the signing key and the other to the encryption key. Single certificates use only one set of certificate profile rules. For example, <code class="literal">policyset.list=serverCertSet</code>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								policyset.policyset_id.list
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Lists the policies within the policy set configured for the certificate profile by policy ID number in the order in which they should be evaluated. For example, <code class="literal">policyset.serverCertSet.list=1,2,3,4,5,6,7,8</code>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								policyset.policyset_id.policy_number.constraint.class_id
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Indicates the java class name of the constraint plug-in set for the default configured in the profile rule. For example, policyset.serverCertSet.1.constraint.class_id=subjectNameConstraintImpl.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								policyset.policyset_id.policy_number.constraint.name
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Gives the user-defined name of the constraint. For example, policyset.serverCertSet.1.constraint.name=Subject Name Constraint.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								policyset.policyset_id.policy_number.constraint.params.attribute
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Specifies a value for an allowed attribute for the constraint. The possible attributes vary depending on the type of constraint. For example, policyset.serverCertSet.1.constraint.params.pattern=CN=.*.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								policyset.policyset_id.policy_number.default.class_id
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Gives the java class name for the default set in the profile rule. For example, policyset.serverCertSet.1.default.class_id=userSubjectNameDefaultImpl
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								policyset.policyset_id.policy_number.default.name
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Gives the user-defined name of the default. For example, policyset.serverCertSet.1.default.name=Subject Name Default
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333366583296"> <p>
								policyset.policyset_id.policy_number.default.params.attribute
							</p>
							 </td><td align="left" valign="top" headers="idm140333366582208"> <p>
								Specifies a value for an allowed attribute for the default. The possible attributes vary depending on the type of default. For example, policyset.serverCertSet.1.default.params.name=CN=(Name)$request.requestor_name$.
							</p>
							 </td></tr></tbody></table></rh-table></section></section><section class="chapter" id="managing-the-validity-of-certificates-in-idm_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 7. Managing the validity of certificates in IdM</h2></div></div></div><p class="_abstract _abstract">
			In Identity Management (IdM), you can manage the validity of both already existing certificates and certificates you want to issue in the future, but the methods are different.
		</p><section class="section" id="proc_managing-the-validity-of-an-existing-certificate-that-was-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm"><div class="titlepage"><div><div><h3 class="title">7.1. Managing the validity of an existing certificate that was issued by IdM CA</h3></div></div></div><p class="_abstract _abstract">
				In IdM, the following methods of viewing the expiry date of a certificate are available:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#viewing-the-expiry-date-of-a-certificate-in-IdM-WebUI_managing-the-validity-of-certificates-in-idm" title="7.3. Viewing the expiry date of a certificate in IdM WebUI">Viewing the expiry date in IdM WebUI</a>.
					</li><li class="listitem">
						<a class="link" href="#viewing-the-expiry-date-of-a-certificate-in-the-CLI_managing-the-validity-of-certificates-in-idm" title="7.4. Viewing the expiry date of a certificate in the CLI">Viewing the expiry date in the CLI</a>.
					</li></ul></div><p>
				You can manage the validity of an already existing certificate that was issued by IdM CA in the following ways:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Renew a certificate by requesting a new certificate using either the original certificate signing request (CSR) or a new CSR generated from the private key. You can request a new certificate using the following utilities:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">certmonger</span></dt><dd>
									You can use <code class="literal">certmonger</code> to request a service certificate. Before the certificate is due to expire, <code class="literal">certmonger</code> will automatically renew the certificate, thereby ensuring a continuing validity of the service certificate. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/using-certmonger_managing-certificates-in-idm">Obtaining an IdM certificate for a service using certmonger</a>;
								</dd><dt><span class="term">certutil</span></dt><dd>
									You can use <code class="literal">certutil</code> to renew user, host, and service certificates. For details on requesting a user certificate, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/dc-web-ui-auth_managing-certificates-in-idm#requesting-and-exporting-a-user-certificate_dc-web-ui-auth">Requesting a new user certificate and exporting it to the client</a>;
								</dd><dt><span class="term">openssl</span></dt><dd>
									You can use <code class="literal">openssl</code> to renew user, host, and service certificates.
								</dd></dl></div></li><li class="listitem"><p class="simpara">
						Revoke a certificate. For details, see:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<a class="link" href="#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_revoking-certificates" title="7.5.2. Revoking certificates with the integrated IdM CAs using IdM WebUI">Revoking certificates with the integrated IdM CAs using IdM WebUI</a>;
							</li><li class="listitem">
								<a class="link" href="#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_revoking-certificates" title="7.5.3. Revoking certificates with the integrated IdM CAs using IdM CLI">Revoking certificates with the integrated IdM CAs using IdM CLI</a>;
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Restore a certificate if it has been temporarily revoked. For details, see:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<a class="link" href="#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates" title="7.6.1. Restoring certificates with the integrated IdM CAs using IdM WebUI">Restoring certificates with the integrated IdM CAs using IdM WebUI</a>;
							</li><li class="listitem">
								<a class="link" href="#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates" title="7.6.1. Restoring certificates with the integrated IdM CAs using IdM WebUI">Restoring certificates with the integrated IdM CAs using IdM CLI</a>.
							</li></ul></div></li></ul></div></section><section class="section" id="proc_managing-the-validity-of-future-certificates-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm"><div class="titlepage"><div><div><h3 class="title">7.2. Managing the validity of future certificates issued by IdM CA</h3></div></div></div><p class="_abstract _abstract">
				To manage the validity of future certificates issued by IdM CA, modify, import, or create a certificate profile. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/creating-and-managing-certificate-profiles-in-identity-management_configuring-and-managing-idm">Creating and managing certificate profiles in Identity Management</a>.
			</p></section><section class="section" id="viewing-the-expiry-date-of-a-certificate-in-IdM-WebUI_managing-the-validity-of-certificates-in-idm"><div class="titlepage"><div><div><h3 class="title">7.3. Viewing the expiry date of a certificate in IdM WebUI</h3></div></div></div><p class="_abstract _abstract">
				You can use IdM WebUI to view the expiry date of all the certificates that have been issued by IdM CA.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Ensure that you have obtained the administrator’s credentials.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the <code class="literal">Authentication</code> menu, click <code class="literal">Certificates</code> &gt; <code class="literal">Certificates</code>.
					</li><li class="listitem"><p class="simpara">
						Click the serial number of the certificate to open the certificate information page.
					</p><div class="figure" id="list-of-certificates_managing-the-validity-of-certificates-in-idm"><p class="title"><strong>Figure 7.1. List of Certificates</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/640df33ed730c373f7dc773dd02b9e93/host_cert_list.png" alt="A screenshot of the &quot;Certificates&quot; page of the IdM Web UI displaying a table of certificates. The certificates are organized by their Serial Numbers and their Subject. The Serial Number &quot;3&quot; is highlighted for the third certificate in the table."></div></div></div></li><li class="listitem">
						In the certificate information page, locate the <code class="literal">Expires On</code> information.
					</li></ol></div></section><section class="section" id="viewing-the-expiry-date-of-a-certificate-in-the-CLI_managing-the-validity-of-certificates-in-idm"><div class="titlepage"><div><div><h3 class="title">7.4. Viewing the expiry date of a certificate in the CLI</h3></div></div></div><p class="_abstract _abstract">
				You can use the command-line interface (CLI) to view the expiry date of a certificate.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Use the <code class="literal">openssl</code> utility to open the file in a human-readable format:
					</p><pre class="literallayout">$ openssl x509 -noout -text -in ca.pem
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 1 (0x1)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: O = IDM.EXAMPLE.COM, CN = Certificate Authority
        Validity
            Not Before: Oct 30 19:39:14 2017 GMT
            Not After : Oct 30 19:39:14 2037 GMT</pre></li></ul></div></section><section class="section" id="revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm"><div class="titlepage"><div><div><h3 class="title">7.5. Revoking certificates with the integrated IdM CAs</h3></div></div></div><section class="section _abstract" id="certificate-revocation-reasons_revoking-certificates"><div class="titlepage"><div><div><h4 class="title">7.5.1. Certificate revocation reasons</h4></div></div></div><p class="_abstract _abstract">
					A revoked certificate is invalid and cannot be used for authentication. All revocations are permanent, except for reason 6: <code class="literal">Certificate Hold</code>.
				</p><p>
					The default revocation reason is 0: <code class="literal">unspecified</code>.
				</p><rh-table id="idm140333368779536"><table class="lt-4-cols lt-7-rows"><caption>Table 7.1. Revocation Reasons</caption><colgroup><col style="width: 8%; " class="col_1"><!--Empty--><col style="width: 31%; " class="col_2"><!--Empty--><col style="width: 61%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333368824288" scope="col">ID</th><th align="left" valign="top" id="idm140333368823200" scope="col">Reason</th><th align="left" valign="top" id="idm140333368822112" scope="col">Explanation</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333368824288"> <p>
									0
								</p>
								 </td><td align="left" valign="top" headers="idm140333368823200"> <p>
									Unspecified
								</p>
								 </td><td align="left" valign="top" headers="idm140333368822112"> </td></tr><tr><td align="left" valign="top" headers="idm140333368824288"> <p>
									1
								</p>
								 </td><td align="left" valign="top" headers="idm140333368823200"> <p>
									Key Compromised
								</p>
								 </td><td align="left" valign="top" headers="idm140333368822112"> <p>
									The key that issued the certificate is no longer trusted.
								</p>
								 <p>
									Possible causes: lost token, improperly accessed file.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140333368824288"> <p>
									2
								</p>
								 </td><td align="left" valign="top" headers="idm140333368823200"> <p>
									CA Compromised
								</p>
								 </td><td align="left" valign="top" headers="idm140333368822112"> <p>
									The CA that issued the certificate is no longer trusted.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140333368824288"> <p>
									3
								</p>
								 </td><td align="left" valign="top" headers="idm140333368823200"> <p>
									Affiliation Changed
								</p>
								 </td><td align="left" valign="top" headers="idm140333368822112"> <p>
									Possible causes:
								</p>
								 <p>
									* A person has left the company or moved to another department.
								</p>
								 <p>
									* A host or service is being retired.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140333368824288"> <p>
									4
								</p>
								 </td><td align="left" valign="top" headers="idm140333368823200"> <p>
									Superseded
								</p>
								 </td><td align="left" valign="top" headers="idm140333368822112"> <p>
									A newer certificate has replaced the current certificate.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140333368824288"> <p>
									5
								</p>
								 </td><td align="left" valign="top" headers="idm140333368823200"> <p>
									Cessation of Operation
								</p>
								 </td><td align="left" valign="top" headers="idm140333368822112"> <p>
									The host or service is being decommissioned.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140333368824288"> <p>
									6
								</p>
								 </td><td align="left" valign="top" headers="idm140333368823200"> <p>
									Certificate Hold
								</p>
								 </td><td align="left" valign="top" headers="idm140333368822112"> <p>
									The certificate is temporarily revoked. You can restore the certificate later.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140333368824288"> <p>
									8
								</p>
								 </td><td align="left" valign="top" headers="idm140333368823200"> <p>
									Remove from CRL
								</p>
								 </td><td align="left" valign="top" headers="idm140333368822112"> <p>
									The certificate is not included in the certificate revocation list (CRL).
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140333368824288"> <p>
									9
								</p>
								 </td><td align="left" valign="top" headers="idm140333368823200"> <p>
									Privilege Withdrawn
								</p>
								 </td><td align="left" valign="top" headers="idm140333368822112"> <p>
									The user, host, or service is no longer permitted to use the certificate.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm140333368824288"> <p>
									10
								</p>
								 </td><td align="left" valign="top" headers="idm140333368823200"> <p>
									Attribute Authority (AA) Compromise
								</p>
								 </td><td align="left" valign="top" headers="idm140333368822112"> <p>
									The AA certificate is no longer trusted.
								</p>
								 </td></tr></tbody></table></rh-table></section><section class="section" id="revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_revoking-certificates"><div class="titlepage"><div><div><h4 class="title">7.5.2. Revoking certificates with the integrated IdM CAs using IdM WebUI</h4></div></div></div><p class="_abstract _abstract">
					If you know you have lost the private key for your certificate, you must revoke the certificate to prevent its abuse. Complete this procedure to use the IdM WebUI to revoke a certificate issued by the IdM CA.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Click <code class="literal">Authentication</code> &gt; <code class="literal">Certificates</code> &gt; <code class="literal">Certificates</code>.
						</li><li class="listitem"><p class="simpara">
							Click the serial number of the certificate to open the certificate information page.
						</p><div class="figure" id="host-cert-list-revoke_revoking-certificates"><p class="title"><strong>Figure 7.2. List of Certificates</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/640df33ed730c373f7dc773dd02b9e93/host_cert_list.png" alt="A screenshot of the &quot;Certificates&quot; page of the IdM Web UI displaying a table of certificates. The certificates are organized by their Serial Numbers and their Subject. The Serial Number &quot;3&quot; is highlighted for the third certificate in the table."></div></div></div></li><li class="listitem">
							In the certificate information page, click <span class="guimenu">Actions</span> → <span class="guimenuitem">Revoke Certificate</span>.
						</li><li class="listitem">
							Select the reason for revoking and click <span class="guibutton">Revoke</span>. See <a class="link" href="#certificate-revocation-reasons_revoking-certificates" title="7.5.1. Certificate revocation reasons">Certificate revocation reasons</a> for details.
						</li></ol></div></section><section class="section" id="revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_revoking-certificates"><div class="titlepage"><div><div><h4 class="title">7.5.3. Revoking certificates with the integrated IdM CAs using IdM CLI</h4></div></div></div><p class="_abstract _abstract">
					If you know you have lost the private key for your certificate, you must revoke the certificate to prevent its abuse. Complete this procedure to use the IdM CLI to revoke a certificate issued by the IdM CA.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Use the <code class="literal command">ipa cert-revoke</code> command, and specify:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									the certificate serial number
								</li><li class="listitem">
									the ID number for the revocation reason; see <a class="link" href="#certificate-revocation-reasons_revoking-certificates" title="7.5.1. Certificate revocation reasons">Certificate revocation reasons</a> for details
								</li></ul></div></li></ul></div><p>
					For example, to revoke the certificate with serial number <code class="literal">1032</code> because of reason 1: <code class="literal">Key Compromised</code>, enter:
				</p><pre class="literallayout">$ ipa cert-revoke 1032 --revocation-reason=1</pre><p>
					For details on requesting a new certificate, see the following documentation:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/dc-web-ui-auth_managing-certificates-in-idm#requesting-and-exporting-a-user-certificate_dc-web-ui-auth">Requesting a new user certificate and exporting it to the client</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/using-certmonger_managing-certificates-in-idm">Obtaining an IdM certificate for a service using certmonger</a>.
						</li></ul></div></section></section><section class="section" id="restoring-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm"><div class="titlepage"><div><div><h3 class="title">7.6. Restoring certificates with the integrated IdM CAs</h3></div></div></div><p class="_abstract _abstract">
				If you have revoked a certificate because of reason 6: <code class="literal">Certificate Hold</code>, you can restore it again if the private key for the certificate has not been compromised. To restore a certificate, use one of the following procedures:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates" title="7.6.1. Restoring certificates with the integrated IdM CAs using IdM WebUI">Restore certificates with the integrated IdM CAs using IdM WebUI</a>;
					</li><li class="listitem">
						<a class="link" href="#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_restoring-certificates" title="7.6.2. Restoring certificates with the integrated IdM CAs using IdM CLI">Restore certificates with the integrated IdM CAs using IdM CLI</a>.
					</li></ul></div><section class="section" id="restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates"><div class="titlepage"><div><div><h4 class="title">7.6.1. Restoring certificates with the integrated IdM CAs using IdM WebUI</h4></div></div></div><p class="_abstract _abstract">
					Complete this procedure to use the IdM WebUI to restore an IdM certificate that has been revoked because of Reason 6: <code class="literal">Certificate Hold</code>.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <code class="literal">Authentication</code> menu, click <code class="literal">Certificates</code> &gt; <code class="literal">Certificates</code>.
						</li><li class="listitem"><p class="simpara">
							Click the serial number of the certificate to open the certificate information page.
						</p><div class="figure" id="list-of-certificates_restoring-certificates"><p class="title"><strong>Figure 7.3. List of Certificates</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/640df33ed730c373f7dc773dd02b9e93/host_cert_list.png" alt="A screenshot of the &quot;Certificates&quot; page of the IdM Web UI displaying a table of certificates. The certificates are organized by their Serial Numbers and their Subject. The Serial Number &quot;3&quot; is highlighted for the third certificate in the table."></div></div></div></li><li class="listitem">
							In the certificate information page, click <span class="guimenu">Actions</span> → <span class="guimenuitem">Restore Certificate</span>.
						</li></ol></div></section><section class="section" id="restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_restoring-certificates"><div class="titlepage"><div><div><h4 class="title">7.6.2. Restoring certificates with the integrated IdM CAs using IdM CLI</h4></div></div></div><p class="_abstract _abstract">
					Complete this procedure to use the IdM CLI to restore an IdM certificate that has been revoked because of Reason 6: <code class="literal">Certificate Hold</code>.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Use the <code class="literal command">ipa cert-remove-hold</code> command and specify the certificate serial number. For example:
						</p><pre class="literallayout">$ ipa cert-remove-hold 1032</pre></li></ul></div></section></section></section><section class="chapter" id="configuring-idm-for-smart-card-auth_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 8. Configuring Identity Management for smart card authentication</h2></div></div></div><p class="_abstract _abstract">
			Identity Management (IdM) supports smart card authentication with:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					User certificates issued by the IdM certificate authority
				</li><li class="listitem">
					User certificates issued by an external certificate authority
				</li></ul></div><p>
			You can configure smart card authentication in IdM for both types of certificates. In this scenario, the <code class="literal">rootca.pem</code> CA certificate is the file containing the certificate of a trusted external certificate authority.
		</p><p>
			For information about smart card authentication in IdM, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/assembly_understanding-smart-card-authentication_managing-smart-card-authentication">Understanding smart card authentication</a>.
		</p><p>
			For more details on configuring smart card authentication:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth">Configuring the IdM server for smart card authentication</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth">Configuring the IdM client for smart card authentication</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#proc-add-cert-idm-user-webui_configuring-idm-for-smart-card-auth">Adding a certificate to a user entry in the IdM Web UI</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#proc-add-cert-idm-user-cli_configuring-idm-for-smart-card-auth">Adding a certificate to a user entry in the IdM CLI</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth">Installing tools for managing and using smart cards</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth">Storing a certificate on a smart card</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth">Logging in to IdM with smart cards</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#configuring-gdm-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth">Configuring GDM access using smart card authentication</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#configuring-su-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth">Configuring su access using smart card authentication</a>
				</li></ul></div><section class="section" id="conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h3 class="title">8.1. Configuring the IdM server for smart card authentication</h3></div></div></div><p class="_abstract _abstract">
				If you want to enable smart card authentication for users whose certificates have been issued by the certificate authority (CA) of the &lt;EXAMPLE.ORG&gt; domain that your Identity Management (IdM) CA trusts, you must obtain the following certificates so that you can add them when running the <code class="literal">ipa-advise</code> script that configures the IdM server:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The certificate of the root CA that has either issued the certificate for the &lt;EXAMPLE.ORG&gt; CA directly, or through one or more of its sub-CAs. You can download the certificate chain from a web page whose certificate has been issued by the authority. For details, see Steps 1 - 4a in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/dc-web-ui-auth_managing-certificates-in-idm#configuring-browser-for-cert-auth_dc-web-ui-auth">Configuring a browser to enable certificate authentication</a>.
					</li><li class="listitem">
						The IdM CA certificate. You can obtain the CA certificate from the <code class="literal">/etc/ipa/ca.crt</code> file on the IdM server on which an IdM CA instance is running.
					</li><li class="listitem">
						The certificates of all of the intermediate CAs; that is, intermediate between the &lt;EXAMPLE.ORG&gt; CA and the IdM CA.
					</li></ul></div><p>
				To configure an IdM server for smart card authentication:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Obtain files with the CA certificates in the PEM format.
					</li><li class="listitem">
						Run the built-in <code class="literal">ipa-advise</code> script.
					</li><li class="listitem">
						Reload the system configuration.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root access to the IdM server.
					</li><li class="listitem">
						You have the root CA certificate and all the intermediate CA certificates.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a directory in which you will do the configuration:
					</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>mkdir ~/SmartCard/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Navigate to the directory:
					</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>cd ~/SmartCard/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Obtain the relevant CA certificates stored in files in PEM format. If your CA certificate is stored in a file of a different format, such as DER, convert it to PEM format. The IdM Certificate Authority certificate is in PEM format and is located in the <code class="literal">/etc/ipa/ca.crt</code> file.
					</p><p class="simpara">
						Convert a DER file to a PEM file:
					</p><pre class="literallayout"># openssl x509 -in &lt;filename&gt;.der -inform DER -out &lt;filename&gt;.pem -outform PEM</pre></li><li class="listitem"><p class="simpara">
						For convenience, copy the certificates to the directory in which you want to do the configuration:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>cp /tmp/rootca.pem ~/SmartCard/</strong></span>
[root@server SmartCard]# <span class="strong strong"><strong>cp /tmp/subca.pem ~/SmartCard/</strong></span>
[root@server SmartCard]# <span class="strong strong"><strong>cp /tmp/issuingca.pem ~/SmartCard/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: If you use certificates of external certificate authorities, use the <code class="literal">openssl x509</code> utility to view the contents of the files in the <code class="literal">PEM</code> format to check that the <code class="literal">Issuer</code> and <code class="literal">Subject</code> values are correct:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>openssl x509 -noout -text -in rootca.pem | more</strong></span></pre></li><li class="listitem"><p class="simpara">
						Generate a configuration script with the in-built <code class="literal">ipa-advise</code> utility, using the administrator’s privileges:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>kinit admin</strong></span>
[root@server SmartCard]# <span class="strong strong"><strong>ipa-advise config-server-for-smart-card-auth &gt; config-server-for-smart-card-auth.sh</strong></span></pre><p class="simpara">
						The <code class="literal">config-server-for-smart-card-auth.sh</code> script performs the following actions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								It configures the IdM Apache HTTP Server.
							</li><li class="listitem">
								It enables Public Key Cryptography for Initial Authentication in Kerberos (PKINIT) on the Key Distribution Center (KDC).
							</li><li class="listitem">
								It configures the IdM Web UI to accept smart card authorization requests.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Execute the script, adding the PEM files containing the root CA and sub CA certificates as arguments:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>chmod +x config-server-for-smart-card-auth.sh</strong></span>
[root@server SmartCard]# <span class="strong strong"><strong>./config-server-for-smart-card-auth.sh rootca.pem subca.pem issuingca.pem</strong></span>
Ticket cache:KEYRING:persistent:0:0
Default principal: admin@IDM.EXAMPLE.COM
[...]
Systemwide CA database updated.
The ipa-certupdate command was successful</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Ensure that you add the root CA’s certificate as an argument before any sub CA certificates and that the CA or sub CA certificates have not expired.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Optional: If the certificate authority that issued the user certificate does not provide any Online Certificate Status Protocol (OCSP) responder, you may need to disable OCSP check for authentication to the IdM Web UI:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Set the <code class="literal">SSLOCSPEnable</code> parameter to <code class="literal">off</code> in the <code class="literal">/etc/httpd/conf.d/ssl.conf</code> file:
							</p><pre class="literallayout"><span class="strong strong"><strong>SSLOCSPEnable off</strong></span></pre></li><li class="listitem"><p class="simpara">
								Restart the Apache daemon (httpd) for the changes to take effect immediately:
							</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>systemctl restart httpd</strong></span></pre></li></ol></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
							Do not disable the OCSP check if you only use user certificates issued by the IdM CA. OCSP responders are part of IdM.
						</p></div></rh-alert><p class="simpara">
						For instructions on how to keep the OCSP check enabled, and yet prevent a user certificate from being rejected by the IdM server if it does not contain the information about the location at which the CA that issued the user certificate listens for OCSP service requests, see the <code class="literal">SSLOCSPDefaultResponder</code> directive in <a class="link" href="http://httpd.apache.org/docs/trunk/en/mod/mod_ssl.html">Apache mod_ssl configuration options</a>.
					</p></li></ol></div><p>
				The server is now configured for smart card authentication.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					To enable smart card authentication in the whole topology, run the procedure on each IdM server.
				</p></div></rh-alert></section><section class="section" id="proc_using-ansible-to-configure-the-idm-server-for-smart-card-authentication_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h3 class="title">8.2. Using Ansible to configure the IdM server for smart card authentication</h3></div></div></div><p class="_abstract _abstract">
				You can use Ansible to enable smart card authentication for users whose certificates have been issued by the certificate authority (CA) of the &lt;EXAMPLE.ORG&gt; domain that your Identity Management (IdM) CA trusts. To do that, you must obtain the following certificates so that you can use them when running an Ansible playbook with the <code class="literal">ipasmartcard_server</code> <code class="literal">ansible-freeipa</code> role script:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The certificate of the root CA that has either issued the certificate for the &lt;EXAMPLE.ORG&gt; CA directly, or through one or more of its sub-CAs. You can download the certificate chain from a web page whose certificate has been issued by the authority. For details, see Step 4 in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/dc-web-ui-auth_managing-certificates-in-idm#configuring-browser-for-cert-auth_dc-web-ui-auth">Configuring a browser to enable certificate authentication</a>.
					</li><li class="listitem">
						The IdM CA certificate. You can obtain the CA certificate from the <code class="literal">/etc/ipa/ca.crt</code> file on any IdM CA server.
					</li><li class="listitem">
						The certificates of all of the CAs that are intermediate between the &lt;EXAMPLE.ORG&gt; CA and the IdM CA.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> access to the IdM server.
					</li><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem">
						You have the root CA certificate, the IdM CA certificate, and all the intermediate CA certificates.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.14 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						If your CA certificates are stored in files of a different format, such as <code class="literal">DER</code>, convert them to <code class="literal">PEM</code> format:
					</p><pre class="literallayout"># <span class="strong strong"><strong>openssl x509 -in &lt;filename&gt;.der -inform DER -out &lt;filename&gt;.pem -outform PEM</strong></span></pre><p class="simpara">
						The IdM Certificate Authority certificate is in <code class="literal">PEM</code> format and is located in the <code class="literal">/etc/ipa/ca.crt</code> file.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Use the <code class="literal">openssl x509</code> utility to view the contents of the files in the <code class="literal">PEM</code> format to check that the <code class="literal">Issuer</code> and <code class="literal">Subject</code> values are correct:
					</p><pre class="literallayout"># <span class="strong strong"><strong>openssl x509 -noout -text -in root-ca.pem | more</strong></span></pre></li><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create a subdirectory dedicated to the CA certificates:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>mkdir SmartCard/</strong></span></pre></li><li class="listitem"><p class="simpara">
						For convenience, copy all the required certificates to the <span class="strong strong"><strong>~/MyPlaybooks/SmartCard/</strong></span> directory:
					</p><pre class="literallayout"># <span class="strong strong"><strong>cp /tmp/root-ca.pem ~/MyPlaybooks/SmartCard/</strong></span>
# <span class="strong strong"><strong>cp /tmp/intermediate-ca.pem ~/MyPlaybooks/SmartCard/</strong></span>
# <span class="strong strong"><strong>cp /etc/ipa/ca.crt ~/MyPlaybooks/SmartCard/ipa-ca.crt</strong></span></pre></li><li class="listitem"><p class="simpara">
						In your Ansible inventory file, specify the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The IdM servers that you want to configure for smart card authentication.
							</li><li class="listitem">
								The IdM administrator password.
							</li><li class="listitem"><p class="simpara">
								The paths to the certificates of the CAs in the following order:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										The root CA certificate file
									</li><li class="listitem">
										The intermediate CA certificates files
									</li><li class="listitem">
										The IdM CA certificate file
									</li></ul></div></li></ul></div><p class="simpara">
						The file can look as follows:
					</p><pre class="literallayout"><span class="strong strong"><strong>[ipaserver]</strong></span>
<span class="strong strong"><strong>ipaserver.idm.example.com</strong></span>

[ipareplicas]
ipareplica1.idm.example.com
ipareplica2.idm.example.com

[ipacluster:children]
ipaserver
ipareplicas

[ipacluster:vars]
<span class="strong strong"><strong>ipaadmin_password= "{{ ipaadmin_password }}"</strong></span>
<span class="strong strong"><strong>ipasmartcard_server_ca_certs=/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/root-ca.pem,/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/intermediate-ca.pem,/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/ipa-ca.crt</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create an <code class="literal">install-smartcard-server.yml</code> playbook with the following content:
					</p><pre class="literallayout">---
- name: Playbook to set up smart card authentication for an IdM server
  <span class="strong strong"><strong>hosts: ipaserver</strong></span>
  become: true

  roles:
  - <span class="strong strong"><strong>role: ipasmartcard_server</strong></span>
    state: present</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory install-smartcard-server.yml</strong></span></pre><p class="simpara">
						The <code class="literal">ipasmartcard_server</code> Ansible role performs the following actions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								It configures the IdM Apache HTTP Server.
							</li><li class="listitem">
								It enables Public Key Cryptography for Initial Authentication in Kerberos (PKINIT) on the Key Distribution Center (KDC).
							</li><li class="listitem">
								It configures the IdM Web UI to accept smart card authorization requests.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: If the certificate authority that issued the user certificate does not provide any Online Certificate Status Protocol (OCSP) responder, you may need to disable OCSP check for authentication to the IdM Web UI:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Connect to the IdM server as <code class="literal">root</code>:
							</p><pre class="literallayout"><span class="strong strong"><strong>ssh root@ipaserver.idm.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
								Set the <code class="literal">SSLOCSPEnable</code> parameter to <code class="literal">off</code> in the <code class="literal">/etc/httpd/conf.d/ssl.conf</code> file:
							</p><pre class="literallayout"><span class="strong strong"><strong>SSLOCSPEnable off</strong></span></pre></li><li class="listitem"><p class="simpara">
								Restart the Apache daemon (httpd) for the changes to take effect immediately:
							</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart httpd</strong></span></pre></li></ol></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
							Do not disable the OCSP check if you only use user certificates issued by the IdM CA. OCSP responders are part of IdM.
						</p></div></rh-alert><p class="simpara">
						For instructions on how to keep the OCSP check enabled, and yet prevent a user certificate from being rejected by the IdM server if it does not contain the information about the location at which the CA that issued the user certificate listens for OCSP service requests, see the <code class="literal">SSLOCSPDefaultResponder</code> directive in <a class="link" href="http://httpd.apache.org/docs/trunk/en/mod/mod_ssl.html">Apache mod_ssl configuration options</a>.
					</p></li></ol></div><p>
				The server listed in the inventory file is now configured for smart card authentication.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					To enable smart card authentication in the whole topology, set the <code class="literal">hosts</code> variable in the Ansible playbook to <code class="literal">ipacluster</code>:
				</p><pre class="literallayout">---
- name: Playbook to setup smartcard for IPA server and replicas
  <span class="strong strong"><strong>hosts: ipacluster</strong></span>
[...]</pre></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						Sample playbooks using the <code class="literal">ipasmartcard_server</code> role in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/</code> directory
					</li></ul></div></section><section class="section" id="conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h3 class="title">8.3. Configuring the IdM client for smart card authentication</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to configure IdM clients for smart card authentication. The procedure needs to be run on each IdM system, a client or a server, to which you want to connect while using a smart card for authentication. For example, to enable an <code class="literal">ssh</code> connection from host A to host B, the script needs to be run on host B.
			</p><p>
				As an administrator, run this procedure to enable smart card authentication using
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">ssh</code> protocol
					</p><p class="simpara">
						For details see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-and-importing-local-certificates-to-a-smart-card_managing-smart-card-authentication#configuring-ssh-access-using-smart-card-authentication_configuring-and-importing-local-certificates-to-a-smart-card">Configuring SSH access using smart card authentication</a>.
					</p></li><li class="listitem">
						The console login
					</li><li class="listitem">
						The GNOME Display Manager (GDM)
					</li><li class="listitem">
						The <code class="literal">su</code> command
					</li></ul></div><p>
				This procedure is not required for authenticating to the IdM Web UI. Authenticating to the IdM Web UI involves two hosts, neither of which needs to be an IdM client:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The machine on which the browser is running. The machine can be outside of the IdM domain.
					</li><li class="listitem">
						The IdM server on which <code class="literal">httpd</code> is running.
					</li></ul></div><p>
				The following procedure assumes that you are configuring smart card authentication on an IdM client, not an IdM server. For this reason you need two computers: an IdM server to generate the configuration script, and the IdM client on which to run the script.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your IdM server has been configured for smart card authentication, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth">Configuring the IdM server for smart card authentication</a>.
					</li><li class="listitem">
						You have root access to the IdM server and the IdM client.
					</li><li class="listitem">
						You have the root CA certificate and all the intermediate CA certificates.
					</li><li class="listitem">
						You installed the IdM client with the <code class="literal">--mkhomedir</code> option to ensure remote users can log in successfully. If you do not create a home directory, the default login location is the root of the directory structure, <code class="literal">/</code>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On an IdM server, generate a configuration script with <code class="literal">ipa-advise</code> using the administrator’s privileges:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>kinit admin</strong></span>
[root@server SmartCard]# <span class="strong strong"><strong>ipa-advise config-client-for-smart-card-auth &gt; config-client-for-smart-card-auth.sh</strong></span></pre><p class="simpara">
						The <code class="literal">config-client-for-smart-card-auth.sh</code> script performs the following actions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								It configures the smart card daemon.
							</li><li class="listitem">
								It sets the system-wide truststore.
							</li><li class="listitem">
								It configures the System Security Services Daemon (SSSD) to allow users to authenticate with either their user name and password or with their smart card. For more details on SSSD profile options for smart card authentication, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/assembly_understanding-smart-card-authentication_managing-smart-card-authentication#con_smart-card-authentication-options-in-rhel_assembly_understanding-smart-card-authentication">Smart card authentication options in RHEL</a>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						From the IdM server, copy the script to a directory of your choice on the IdM client machine:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>scp config-client-for-smart-card-auth.sh root<span class="strong strong"><strong>@</strong></span>client.idm.example.com:/root/SmartCard/</strong></span>
Password:
config-client-for-smart-card-auth.sh        100%   2419       3.5MB/s   00:00</pre></li><li class="listitem"><p class="simpara">
						From the IdM server, copy the CA certificate files in PEM format for convenience to the same directory on the IdM client machine as used in the previous step:
					</p><pre class="literallayout">[root@server SmartCard]# <span class="strong strong"><strong>scp {rootca.pem,subca.pem,issuingca.pem} root<span class="strong strong"><strong>@</strong></span>client.idm.example.com:/root/SmartCard/</strong></span>
Password:
rootca.pem                          100%   1237     9.6KB/s   00:00
subca.pem                           100%   2514    19.6KB/s   00:00
issuingca.pem                       100%   2514    19.6KB/s   00:00</pre></li><li class="listitem"><p class="simpara">
						On the client machine, execute the script, adding the PEM files containing the CA certificates as arguments:
					</p><pre class="literallayout">[root@client SmartCard]# <span class="strong strong"><strong>kinit admin</strong></span>
[root@client SmartCard]# <span class="strong strong"><strong>chmod +x config-client-for-smart-card-auth.sh</strong></span>
[root@client SmartCard]# <span class="strong strong"><strong>./config-client-for-smart-card-auth.sh rootca.pem subca.pem issuingca.pem</strong></span>
Ticket cache:KEYRING:persistent:0:0
Default principal: admin@IDM.EXAMPLE.COM
[...]
Systemwide CA database updated.
The ipa-certupdate command was successful</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Ensure that you add the root CA’s certificate as an argument before any sub CA certificates and that the CA or sub CA certificates have not expired.
						</p></div></rh-alert></li></ol></div><p>
				The client is now configured for smart card authentication.
			</p></section><section class="section" id="proc_using-ansible-to-configure-idm-clients-for-smart-card-authentication_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h3 class="title">8.4. Using Ansible to configure IdM clients for smart card authentication</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use the <code class="literal">ansible-freeipa</code> <code class="literal">ipasmartcard_client</code> module to configure specific Identity Management (IdM) clients to permit IdM users to authenticate with a smart card. Run this procedure to enable smart card authentication for IdM users that use any of the following to access IdM:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">ssh</code> protocol
					</p><p class="simpara">
						For details see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-and-importing-local-certificates-to-a-smart-card_managing-smart-card-authentication#configuring-ssh-access-using-smart-card-authentication_configuring-and-importing-local-certificates-to-a-smart-card">Configuring SSH access using smart card authentication</a>.
					</p></li><li class="listitem">
						The console login
					</li><li class="listitem">
						The GNOME Display Manager (GDM)
					</li><li class="listitem">
						The <code class="literal">su</code> command
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					This procedure is not required for authenticating to the IdM Web UI. Authenticating to the IdM Web UI involves two hosts, neither of which needs to be an IdM client:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The machine on which the browser is running. The machine can be outside of the IdM domain.
						</li><li class="listitem">
							The IdM server on which <code class="literal">httpd</code> is running.
						</li></ul></div></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your IdM server has been configured for smart card authentication, as described in <a class="link" href="#proc_using-ansible-to-configure-the-idm-server-for-smart-card-authentication_configuring-idm-for-smart-card-auth" title="8.2. Using Ansible to configure the IdM server for smart card authentication">Using Ansible to configure the IdM server for smart card authentication</a>.
					</li><li class="listitem">
						You have root access to the IdM server and the IdM client.
					</li><li class="listitem">
						You have the root CA certificate, the IdM CA certificate, and all the intermediate CA certificates.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.14 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						If your CA certificates are stored in files of a different format, such as <code class="literal">DER</code>, convert them to <code class="literal">PEM</code> format:
					</p><pre class="literallayout"># <span class="strong strong"><strong>openssl x509 -in &lt;filename&gt;.der -inform DER -out &lt;filename&gt;.pem -outform PEM</strong></span></pre><p class="simpara">
						The IdM CA certificate is in <code class="literal">PEM</code> format and is located in the <code class="literal">/etc/ipa/ca.crt</code> file.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Use the <code class="literal">openssl x509</code> utility to view the contents of the files in the <code class="literal">PEM</code> format to check that the <code class="literal">Issuer</code> and <code class="literal">Subject</code> values are correct:
					</p><pre class="literallayout"># <span class="strong strong"><strong>openssl x509 -noout -text -in root-ca.pem | more</strong></span></pre></li><li class="listitem"><p class="simpara">
						On your Ansible control node, navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create a subdirectory dedicated to the CA certificates:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>mkdir SmartCard/</strong></span></pre></li><li class="listitem"><p class="simpara">
						For convenience, copy all the required certificates to the <span class="strong strong"><strong>~/MyPlaybooks/SmartCard/</strong></span> directory, for example:
					</p><pre class="literallayout"># <span class="strong strong"><strong>cp /tmp/root-ca.pem ~/MyPlaybooks/SmartCard/</strong></span>
# <span class="strong strong"><strong>cp /tmp/intermediate-ca.pem ~/MyPlaybooks/SmartCard/</strong></span>
# <span class="strong strong"><strong>cp /etc/ipa/ca.crt ~/MyPlaybooks/SmartCard/ipa-ca.crt</strong></span></pre></li><li class="listitem"><p class="simpara">
						In your Ansible inventory file, specify the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The IdM clients that you want to configure for smart card authentication.
							</li><li class="listitem">
								The IdM administrator password.
							</li><li class="listitem"><p class="simpara">
								The paths to the certificates of the CAs in the following order:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										The root CA certificate file
									</li><li class="listitem">
										The intermediate CA certificates files
									</li><li class="listitem">
										The IdM CA certificate file
									</li></ul></div></li></ul></div><p class="simpara">
						The file can look as follows:
					</p><pre class="literallayout"><span class="strong strong"><strong>[ipaclients]</strong></span>
ipaclient1.example.com
ipaclient2.example.com

[ipaclients:vars]
<span class="strong strong"><strong>ipaadmin_password=SomeADMINpassword</strong></span>
<span class="strong strong"><strong>ipasmartcard_client_ca_certs=/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/root-ca.pem,/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/intermediate-ca.pem,/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/ipa-ca.crt</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create an <code class="literal">install-smartcard-clients.yml</code> playbook with the following content:
					</p><pre class="literallayout">---
- name: Playbook to set up smart card authentication for an IdM client
  <span class="strong strong"><strong>hosts: ipaclients</strong></span>
  become: true

  roles:
  - <span class="strong strong"><strong>role: ipasmartcard_client</strong></span>
    state: present</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook and inventory files:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory install-smartcard-clients.yml</strong></span></pre><p class="simpara">
						The <code class="literal">ipasmartcard_client</code> Ansible role performs the following actions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								It configures the smart card daemon.
							</li><li class="listitem">
								It sets the system-wide truststore.
							</li><li class="listitem">
								It configures the System Security Services Daemon (SSSD) to allow users to authenticate with either their user name and password or their smart card. For more details on SSSD profile options for smart card authentication, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/assembly_understanding-smart-card-authentication_managing-smart-card-authentication#con_smart-card-authentication-options-in-rhel_assembly_understanding-smart-card-authentication">Smart card authentication options in RHEL</a>.
							</li></ul></div></li></ol></div><p>
				The clients listed in the <span class="strong strong"><strong>ipaclients</strong></span> section of the inventory file are now configured for smart card authentication.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If you have installed the IdM clients with the <code class="literal">--mkhomedir</code> option, remote users will be able to log in to their home directories. Otherwise, the default login location is the root of the directory structure, <code class="literal">/</code>.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						Sample playbooks using the <code class="literal">ipasmartcard_server</code> role in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/</code> directory
					</li></ul></div></section><section class="section" id="proc-add-cert-idm-user-webui_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h3 class="title">8.5. Adding a certificate to a user entry in the IdM Web UI</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to add an external certificate to a user entry in IdM Web UI.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Instead of uploading the whole certificate, it is also possible to upload certificate mapping data to a user entry in IdM. User entries containing either full certificates or certificate mapping data can be used in conjunction with corresponding certificate mapping rules to facilitate the configuration of smart card authentication for system administrators. For details, see
				</p><p>
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#con-idm-certmapdata_conf-certmap-idm">Certificate mapping rules for configuring authentication</a>.
				</p></div></rh-alert><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If the user’s certificate has been issued by the IdM Certificate Authority, the certificate is already stored in the user entry, and you do not need to follow this procedure.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the certificate that you want to add to the user entry at your disposal.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log into the IdM Web UI as an administrator if you want to add a certificate to another user. For adding a certificate to your own profile, you do not need the administrator’s credentials.
					</li><li class="listitem">
						Navigate to <code class="literal">Users</code> → <code class="literal">Active users</code> → <code class="literal">sc_user</code>.
					</li><li class="listitem">
						Find the <code class="literal">Certificate</code> option and click <code class="literal">Add</code>.
					</li><li class="listitem"><p class="simpara">
						In the command-line interface, display the certificate in the <code class="literal">PEM</code> format using the <code class="literal">cat</code> utility or a text editor:
					</p><pre class="literallayout">[user@client SmartCard]$ <span class="strong strong"><strong>cat testuser.crt</strong></span></pre></li><li class="listitem">
						Copy and paste the certificate from the CLI into the window that has opened in the Web UI.
					</li><li class="listitem"><p class="simpara">
						Click <code class="literal">Add</code>.
					</p><div class="figure" id="configuring-idm-for-smart-card-auth-new-certmaprule-add"><p class="title"><strong>Figure 8.1. Adding a new certificate in the IdM Web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/1f589affb4e3eb5c0a47755352e5bcd6/idm-add-cert.png" alt="Screenshot of the &quot;New Certificate&quot; pop-up window with one large field for the Certificate in base64 of PEM format. The &quot;Add&quot; button at the bottom right is highlighted."></div></div></div></li></ol></div><p>
				The <code class="literal">sc_user</code> entry now contains an external certificate.
			</p></section><section class="section" id="proc-add-cert-idm-user-cli_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h3 class="title">8.6. Adding a certificate to a user entry in the IdM CLI</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to add an external certificate to a user entry in IdM CLI.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Instead of uploading the whole certificate, it is also possible to upload certificate mapping data to a user entry in IdM. User entries containing either full certificates or certificate mapping data can be used in conjunction with corresponding certificate mapping rules to facilitate the configuration of smart card authentication for system administrators. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#con-idm-certmapdata_conf-certmap-idm">Certificate mapping rules for configuring authentication</a>.
				</p></div></rh-alert><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If the user’s certificate has been issued by the IdM Certificate Authority, the certificate is already stored in the user entry, and you do not need to follow this procedure.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the certificate that you want to add to the user entry at your disposal.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into the IdM CLI as an administrator if you want to add a certificate to another user:
					</p><pre class="literallayout">[user@client SmartCard]$ <span class="strong strong"><strong>kinit admin</strong></span></pre><p class="simpara">
						For adding a certificate to your own profile, you do not need the administrator’s credentials:
					</p><pre class="literallayout">[user@client SmartCard]$ <span class="strong strong"><strong>kinit sc_user</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create an environment variable containing the certificate with the header and footer removed and concatenated into a single line, which is the format expected by the <code class="literal">ipa user-add-cert</code> command:
					</p><pre class="literallayout">[user@client SmartCard]$ <span class="strong strong"><strong>export CERT=`openssl x509 -outform der -in testuser.crt | base64 -w0 -`</strong></span></pre><p class="simpara">
						Note that certificate in the <code class="literal">testuser.crt</code> file must be in the <code class="literal">PEM</code> format.
					</p></li><li class="listitem"><p class="simpara">
						Add the certificate to the profile of sc_user using the <code class="literal">ipa user-add-cert</code> command:
					</p><pre class="literallayout">[user@client SmartCard]$ <span class="strong strong"><strong>ipa user-add-cert sc_user --certificate=$CERT</strong></span></pre></li></ol></div><p>
				The <code class="literal">sc_user</code> entry now contains an external certificate.
			</p></section><section class="section" id="installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h3 class="title">8.7. Installing tools for managing and using smart cards</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">gnutls-utils</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">opensc</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">pcscd</code> service is running.
					</li></ul></div><p class="_abstract _abstract">
				Before you can configure your smart card, you must install the corresponding tools, which can generate certificates and start the <code class="literal">pscd</code> service.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">opensc</code> and <code class="literal">gnutls-utils</code> packages:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf -y install opensc gnutls-utils</strong></span></pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">pcscd</code> service.
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl start pcscd</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the <code class="literal">pcscd</code> service is up and running
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status pcscd</strong></span></pre></li></ul></div></section><section class="section" id="storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h3 class="title">8.8. Preparing your smart card and uploading your certificates and keys to your smart card</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to configure your smart card with the <code class="literal">pkcs15-init</code> tool, which helps you to configure:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Erasing your smart card
					</li><li class="listitem">
						Setting new PINs and optional PIN Unblocking Keys (PUKs)
					</li><li class="listitem">
						Creating a new slot on the smart card
					</li><li class="listitem">
						Storing the certificate, private key, and public key in the slot
					</li><li class="listitem">
						If required, locking the smart card settings as certain smart cards require this type of finalization
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The <code class="literal">pkcs15-init</code> tool may not work with all smart cards. You must use the tools that work with the smart card you are using.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">opensc</code> package, which includes the <code class="literal">pkcs15-init</code> tool, is installed.
					</p><p class="simpara">
						For more details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth">Installing tools for managing and using smart cards</a>.
					</p></li><li class="listitem">
						The card is inserted in the reader and connected to the computer.
					</li><li class="listitem">
						You have a private key, a public key, and a certificate to store on the smart card. In this procedure, <code class="literal">testuser.key</code>, <code class="literal">testuserpublic.key</code>, and <code class="literal">testuser.crt</code> are the names used for the private key, public key, and the certificate.
					</li><li class="listitem">
						You have your current smart card user PIN and Security Officer PIN (SO-PIN).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Erase your smart card and authenticate yourself with your PIN:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>pkcs15-init --erase-card --use-default-transport-keys</strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span>
PIN [Security Officer PIN] required.
Please enter PIN [Security Officer PIN]:</pre><p class="simpara">
						The card has been erased.
					</p></li><li class="listitem"><p class="simpara">
						Initialize your smart card, set your user PIN and PUK, and your Security Officer PIN and PUK:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init --create-pkcs15 --use-default-transport-keys \ --pin <span class="emphasis"><em>963214</em></span> --puk <span class="emphasis"><em>321478</em></span> --so-pin <span class="emphasis"><em>65498714</em></span> --so-puk <span class="emphasis"><em>784123</em></span></strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span></pre><p class="simpara">
						The <code class="literal">pcks15-init</code> tool creates a new slot on the smart card.
					</p></li><li class="listitem"><p class="simpara">
						Set a label and the authentication ID for the slot:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init --store-pin --label testuser \ --auth-id 01 --so-pin <span class="emphasis"><em>65498714</em></span> --pin <span class="emphasis"><em>963214</em></span> --puk <span class="emphasis"><em>321478</em></span></strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span></pre><p class="simpara">
						The label is set to a human-readable value, in this case, <code class="literal">testuser</code>. The <code class="literal">auth-id</code> must be two hexadecimal values, in this case it is set to <code class="literal">01</code>.
					</p></li><li class="listitem"><p class="simpara">
						Store and label the private key in the new slot on the smart card:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init --store-private-key testuser.key --label testuser_key \ --auth-id 01 --id 01 --pin <span class="emphasis"><em>963214</em></span></strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							The value you specify for <code class="literal">--id</code> must be the same when storing your private key and storing your certificate in the next step. Specifying your own value for <code class="literal">--id</code> is recommended as otherwise a more complicated value is calculated by the tool.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Store and label the certificate in the new slot on the smart card:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init --store-certificate testuser.crt --label testuser_crt \ --auth-id 01 --id 01 --format pem --pin <span class="emphasis"><em>963214</em></span></strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Store and label the public key in the new slot on the smart card:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init --store-public-key testuserpublic.key --label testuserpublic_key --auth-id 01 --id 01 --pin <span class="emphasis"><em>963214</em></span></strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							If the public key corresponds to a private key or certificate, specify the same ID as the ID of the private key or certificate.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Optional: Certain smart cards require you to finalize the card by locking the settings:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init -F</strong></span></pre><p class="simpara">
						At this stage, your smart card includes the certificate, private key, and public key in the newly created slot. You have also created your user PIN and PUK and the Security Officer PIN and PUK.
					</p></li></ol></div></section><section class="section" id="logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h3 class="title">8.9. Logging in to IdM with smart cards</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use smart cards for logging in to the IdM Web UI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The web browser is configured for using smart card authentication.
					</li><li class="listitem">
						The IdM server is configured for smart card authentication.
					</li><li class="listitem">
						The certificate installed on your smart card is either issued by the IdM server or has been added to the user entry in IdM.
					</li><li class="listitem">
						You know the PIN required to unlock the smart card.
					</li><li class="listitem">
						The smart card has been inserted into the reader.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open the IdM Web UI in the browser.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Log In Using Certificate</strong></span>.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/e2df8c824273dc927cde799f821b8c6c/ipa-login-smart-card.png" alt="A screenshot of the IdM Web UI displaying an empty &quot;Username&quot; field and an empty &quot;Password&quot; field. Below those two fields the &quot;Log in using a Certificate&quot; option has been highlighted."></span>

					</p></li><li class="listitem"><p class="simpara">
						If the <span class="strong strong"><strong>Password Required</strong></span> dialog box opens, add the PIN to unlock the smart card and click the <span class="strong strong"><strong>OK</strong></span> button.
					</p><p class="simpara">
						The <span class="strong strong"><strong>User Identification Request</strong></span> dialog box opens.
					</p><p class="simpara">
						If the smart card contains more than one certificate, select the certificate you want to use for authentication in the drop down list below <span class="strong strong"><strong>Choose a certificate to present as identification</strong></span>.
					</p></li><li class="listitem">
						Click the <span class="strong strong"><strong>OK</strong></span> button.
					</li></ol></div><p>
				Now you are successfully logged in to the IdM Web UI.
			</p><p>
				<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/62db8da1055ce6a2efadfd397d26a6fe/web_ui_users.png" alt="A screenshot of the first screen visible after logging in to the IdM Web UI. There are 5 tabs listed along the top of the screen: Identity - Policy - Authentication - Network Services - IPA Server. The Identity tab has been selected and it is displaying the Users page which is the first menu item among 6 choices just below the tabs: Users - Hosts - Services - Groups - ID Views - Automember. The Active users page displays a table of user logins and their information: First name - Last name - Status - UID - Email address - Telephone number - Job Title."></span>

			</p></section><section class="section" id="configuring-gdm-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h3 class="title">8.10. Logging in to GDM using smart card authentication on an IdM client</h3></div></div></div><p class="_abstract _abstract">
				The GNOME Desktop Manager (GDM) requires authentication. You can use your password; however, you can also use a smart card for authentication.
			</p><p>
				Follow this procedure to use smart card authentication to access GDM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The system has been configured for smart card authentication. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth">Configuring the IdM client for smart card authentication</a>.
					</li><li class="listitem">
						The smart card contains your certificate and private key.
					</li><li class="listitem">
						The user account is a member of the IdM domain.
					</li><li class="listitem"><p class="simpara">
						The certificate on the smart card maps to the user entry through:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Assigning the certificate to a particular user entry. For details, see, <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#proc-add-cert-idm-user-webui_configuring-idm-for-smart-card-auth">Adding a certificate to a user entry in the IdM Web UI</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#proc-add-cert-idm-user-cli_configuring-idm-for-smart-card-auth">Adding a certificate to a user entry in the IdM CLI</a>.
							</li><li class="listitem">
								The certificate mapping data being applied to the account. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/con-idm-certmapdata_managing-smart-card-authentication">Certificate mapping rules for configuring authentication on smart cards</a>.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Insert the smart card in the reader.
					</li><li class="listitem">
						Enter the smart card PIN.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Sign In</strong></span>.
					</li></ol></div><p>
				You are successfully logged in to the RHEL system and you have a TGT provided by the IdM server.
			</p><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong>Terminal</strong></span> window, enter <code class="literal">klist</code> and check the result:
					</p><pre class="literallayout">$ klist
Ticket cache: KEYRING:persistent:1358900015:krb_cache_TObtNMd
Default principal: example.user@REDHAT.COM

Valid starting       Expires              Service principal
04/20/2020 13:58:24  04/20/2020 23:58:24  krbtgt/EXAMPLE.COM@EXAMPLE.COM
	renew until 04/27/2020 08:58:15</pre></li></ul></div></section><section class="section" id="configuring-su-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth"><div class="titlepage"><div><div><h3 class="title">8.11. Using smart card authentication with the su command</h3></div></div></div><p class="_abstract _abstract">
				Changing to a different user requires authentication. You can use a password or a certificate. Follow this procedure to use your smart card with the <code class="literal">su</code> command. It means that after entering the <code class="literal">su</code> command, you are prompted for the smart card PIN.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Your IdM server and client have been configured for smart card authentication.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth">Configuring the IdM server for smart card authentication</a>
							</li><li class="listitem">
								See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth">Configuring the IdM client for smart card authentication</a>
							</li></ul></div></li><li class="listitem">
						The smart card contains your certificate and private key. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth">Storing a certificate on a smart card</a>
					</li><li class="listitem">
						The card is inserted in the reader and connected to the computer.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						In a terminal window, change to a different user with the <code class="literal">su</code> command:
					</p><pre class="literallayout">$ su - example.user
PIN for smart_card</pre><p class="simpara">
						If the configuration is correct, you are prompted to enter the smart card PIN.
					</p></li></ul></div></section></section><section class="chapter" id="configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 9. Configuring certificates issued by ADCS for smart card authentication in IdM</h2></div></div></div><p class="_abstract _abstract">
			To configure smart card authentication in IdM for users whose certificates are issued by Active Directory (AD) certificate services:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Your deployment is based on cross-forest trust between Identity Management (IdM) and Active Directory (AD).
				</li><li class="listitem">
					You want to allow smart card authentication for users whose accounts are stored in AD.
				</li><li class="listitem">
					Certificates are created and stored in Active Directory Certificate Services (ADCS).
				</li></ul></div><p>
			For an overview of smart card authentication, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/assembly_understanding-smart-card-authentication_managing-smart-card-authentication">Understanding smart card authentication</a>.
		</p><p>
			Configuration is accomplished in the following steps:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication#copying-certificates-from-active-directory-using-sftp_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">Copying CA and user certificates from Active Directory to the IdM server and client</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication#configuring-the-idm-server-and-clients-for-smart-card-authentication-using-adcs-certificates_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">Configuring the IdM server and clients for smart card authentication using ADCS certificates</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication#converting-the-pfx-file_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">Converting a PFX (PKCS#12) file to be able to store the certificate and private key into the smart card</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication#configuring-timeouts-in-sssd-conf_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">Configuring timeouts in the sssd.conf file</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication#certificate-mapping-rules-for-smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm">Creating certificate mapping rules for smart card authentication</a>
				</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					Identity Management (IdM) and Active Directory (AD) trust is installed
				</p><p class="simpara">
					For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_trust_between_idm_and_ad/index">Installing trust between IdM and AD</a>.
				</p></li><li class="listitem">
					Active Directory Certificate Services (ADCS) is installed and certificates for users are generated
				</li></ul></div><section class="section" id="windows-server-settings-required-for-trust-configuration-and-certificate-usage_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h3 class="title">9.1. Windows Server settings required for trust configuration and certificate usage</h3></div></div></div><p class="_abstract _abstract">
				You must configure the following on the Windows Server:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Active Directory Certificate Services (ADCS) is installed
					</li><li class="listitem">
						Certificate Authority is created
					</li><li class="listitem">
						Optional: If you are using Certificate Authority Web Enrollment, the Internet Information Services (IIS) must be configured
					</li></ul></div><p>
				Export the certificate:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Key must have <code class="literal">2048</code> bits or more
					</li><li class="listitem">
						Include a private key
					</li><li class="listitem"><p class="simpara">
						You will need a certificate in the following format: Personal Information Exchange — <code class="literal">PKCS #12(.PFX)</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Enable certificate privacy
							</li></ul></div></li></ul></div></section><section class="section" id="copying-certificates-from-active-directory-using-sftp_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h3 class="title">9.2. Copying certificates from Active Directory using sftp</h3></div></div></div><p class="_abstract _abstract">
				To be able to use smart card authetication, you need to copy the following certificate files:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A root CA certificate in the <code class="literal">CER</code> format: <code class="literal">adcs-winserver-ca.cer</code> on your IdM server.
					</li><li class="listitem">
						A user certificate with a private key in the <code class="literal">PFX</code> format: <code class="literal">aduser1.pfx</code> on an IdM client.
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					This procedure expects SSH access is allowed. If SSH is unavailable the user must copy the file from the AD Server to the IdM server and client.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Connect from <span class="strong strong"><strong>the IdM server</strong></span> and copy the <code class="literal">adcs-winserver-ca.cer</code> root certificate to the IdM server:
					</p><pre class="literallayout">root@idmserver ~]# sftp Administrator@winserver.ad.example.com
Administrator@winserver.ad.example.com's password:
Connected to Administrator@winserver.ad.example.com.
sftp&gt; cd &lt;Path to certificates&gt;
sftp&gt; ls
adcs-winserver-ca.cer    aduser1.pfx
sftp&gt;
sftp&gt; get adcs-winserver-ca.cer
Fetching &lt;Path to certificates&gt;/adcs-winserver-ca.cer to adcs-winserver-ca.cer
&lt;Path to certificates&gt;/adcs-winserver-ca.cer                 100%  1254    15KB/s 00:00
sftp quit</pre></li><li class="listitem"><p class="simpara">
						Connect from <span class="strong strong"><strong>the IdM client</strong></span> and copy the <code class="literal">aduser1.pfx</code> user certificate to the client:
					</p><pre class="literallayout">[root@client1 ~]# sftp Administrator@winserver.ad.example.com
Administrator@winserver.ad.example.com's password:
Connected to Administrator@winserver.ad.example.com.
sftp&gt; cd /&lt;Path to certificates&gt;
sftp&gt; get aduser1.pfx
Fetching &lt;Path to certificates&gt;/aduser1.pfx to aduser1.pfx
&lt;Path to certificates&gt;/aduser1.pfx                 100%  1254    15KB/s 00:00
sftp quit</pre></li></ol></div><p>
				Now the CA certificate is stored in the IdM server and the user certificates is stored on the client machine.
			</p></section><section class="section" id="configuring-the-idm-server-and-clients-for-smart-card-authentication-using-adcs-certificates_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h3 class="title">9.3. Configuring the IdM server and clients for smart card authentication using ADCS certificates</h3></div></div></div><p class="_abstract _abstract">
				You must configure the IdM (Identity Management) server and clients to be able to use smart card authentication in the IdM environment. IdM includes the <code class="literal">ipa-advise</code> scripts which makes all necessary changes:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Install necessary packages
					</li><li class="listitem">
						Configure IdM server and clients
					</li><li class="listitem">
						Copy the CA certificates into the expected locations
					</li></ul></div><p>
				You can run <code class="literal">ipa-advise</code> on your IdM server.
			</p><p>
				Follow this procedure to configure your server and clients for smart card authentication:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						On an IdM server: Preparing the <code class="literal">ipa-advise</code> script to configure your IdM server for smart card authentication.
					</li><li class="listitem">
						On an IdM server: Preparing the <code class="literal">ipa-advise</code> script to configure your IdM client for smart card authentication.
					</li><li class="listitem">
						On an IdM server: Applying the the <code class="literal">ipa-advise</code> server script on the IdM server using the AD certificate.
					</li><li class="listitem">
						Moving the client script to the IdM client machine.
					</li><li class="listitem">
						On an IdM client: Applying the the <code class="literal">ipa-advise</code> client script on the IdM client using the AD certificate.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The certificate has been copied to the IdM server.
					</li><li class="listitem">
						Obtain the Kerberos ticket.
					</li><li class="listitem">
						Log in as a user with administration rights.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the IdM server, use the <code class="literal">ipa-advise</code> script for configuring a client:
					</p><pre class="literallayout">[root@idmserver ~]# ipa-advise config-client-for-smart-card-auth &gt; sc_client.sh</pre></li><li class="listitem"><p class="simpara">
						On the IdM server, use the <code class="literal">ipa-advise</code> script for configuring a server:
					</p><pre class="literallayout">[root@idmserver ~]# ipa-advise config-server-for-smart-card-auth &gt; sc_server.sh</pre></li><li class="listitem"><p class="simpara">
						On the IdM server, execute the script:
					</p><pre class="literallayout">[root@idmserver ~]# sh -x sc_server.sh adcs-winserver-ca.cer</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								It configures the IdM Apache HTTP Server.
							</li><li class="listitem">
								It enables Public Key Cryptography for Initial Authentication in Kerberos (PKINIT) on the Key Distribution Center (KDC).
							</li><li class="listitem">
								It configures the IdM Web UI to accept smart card authorization requests.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">sc_client.sh</code> script to the client system:
					</p><pre class="literallayout">[root@idmserver ~]# scp sc_client.sh root@client1.idm.example.com:/root
Password:
sc_client.sh                  100%  2857   1.6MB/s   00:00</pre></li><li class="listitem"><p class="simpara">
						Copy the Windows certificate to the client system:
					</p><pre class="literallayout">[root@idmserver ~]# scp adcs-winserver-ca.cer root@client1.idm.example.com:/root
Password:
adcs-winserver-ca.cer                 100%  1254   952.0KB/s   00:00</pre></li><li class="listitem"><p class="simpara">
						On the client system, run the client script:
					</p><pre class="literallayout">[root@idmclient1 ~]# sh -x sc_client.sh adcs-winserver-ca.cer</pre></li></ol></div><p>
				The CA certificate is installed in the correct format on the IdM server and client systems and next step is to copy the user certificates onto the smart card itself.
			</p></section><section class="section" id="converting-the-pfx-file_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h3 class="title">9.4. Converting the PFX file</h3></div></div></div><p class="_abstract _abstract">
				Before you store the PFX (PKCS#12) file into the smart card, you must:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Convert the file to the PEM format
					</li><li class="listitem">
						Extract the private key and the certificate to two different files
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The PFX file is copied into the IdM client machine.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the IdM client, into the PEM format:
					</p><pre class="literallayout">[root@idmclient1 ~]# openssl pkcs12 -in aduser1.pfx -out aduser1_cert_only.pem -clcerts -nodes
Enter Import Password:</pre></li><li class="listitem"><p class="simpara">
						Extract the key into the separate file:
					</p><pre class="literallayout">[root@idmclient1 ~]# openssl pkcs12 -in adduser1.pfx -nocerts -out adduser1.pem &gt; aduser1.key</pre></li><li class="listitem"><p class="simpara">
						Extract the public certificate into the separate file:
					</p><pre class="literallayout">[root@idmclient1 ~]# openssl pkcs12 -in adduser1.pfx -clcerts -nokeys -out aduser1_cert_only.pem &gt; aduser1.crt</pre></li></ol></div><p>
				At this point, you can store the <code class="literal">aduser1.key</code> and <code class="literal">aduser1.crt</code> into the smart card.
			</p></section><section class="section" id="installing-tools-for-managing-and-using-smart-cards_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h3 class="title">9.5. Installing tools for managing and using smart cards</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">gnutls-utils</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">opensc</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">pcscd</code> service is running.
					</li></ul></div><p class="_abstract _abstract">
				Before you can configure your smart card, you must install the corresponding tools, which can generate certificates and start the <code class="literal">pscd</code> service.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">opensc</code> and <code class="literal">gnutls-utils</code> packages:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf -y install opensc gnutls-utils</strong></span></pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">pcscd</code> service.
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl start pcscd</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the <code class="literal">pcscd</code> service is up and running
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status pcscd</strong></span></pre></li></ul></div></section><section class="section" id="storing-a-certificate-on-the-smart-card_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h3 class="title">9.6. Preparing your smart card and uploading your certificates and keys to your smart card</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to configure your smart card with the <code class="literal">pkcs15-init</code> tool, which helps you to configure:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Erasing your smart card
					</li><li class="listitem">
						Setting new PINs and optional PIN Unblocking Keys (PUKs)
					</li><li class="listitem">
						Creating a new slot on the smart card
					</li><li class="listitem">
						Storing the certificate, private key, and public key in the slot
					</li><li class="listitem">
						If required, locking the smart card settings as certain smart cards require this type of finalization
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The <code class="literal">pkcs15-init</code> tool may not work with all smart cards. You must use the tools that work with the smart card you are using.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">opensc</code> package, which includes the <code class="literal">pkcs15-init</code> tool, is installed.
					</p><p class="simpara">
						For more details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth">Installing tools for managing and using smart cards</a>.
					</p></li><li class="listitem">
						The card is inserted in the reader and connected to the computer.
					</li><li class="listitem">
						You have a private key, a public key, and a certificate to store on the smart card. In this procedure, <code class="literal">testuser.key</code>, <code class="literal">testuserpublic.key</code>, and <code class="literal">testuser.crt</code> are the names used for the private key, public key, and the certificate.
					</li><li class="listitem">
						You have your current smart card user PIN and Security Officer PIN (SO-PIN).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Erase your smart card and authenticate yourself with your PIN:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>pkcs15-init --erase-card --use-default-transport-keys</strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span>
PIN [Security Officer PIN] required.
Please enter PIN [Security Officer PIN]:</pre><p class="simpara">
						The card has been erased.
					</p></li><li class="listitem"><p class="simpara">
						Initialize your smart card, set your user PIN and PUK, and your Security Officer PIN and PUK:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init --create-pkcs15 --use-default-transport-keys \ --pin <span class="emphasis"><em>963214</em></span> --puk <span class="emphasis"><em>321478</em></span> --so-pin <span class="emphasis"><em>65498714</em></span> --so-puk <span class="emphasis"><em>784123</em></span></strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span></pre><p class="simpara">
						The <code class="literal">pcks15-init</code> tool creates a new slot on the smart card.
					</p></li><li class="listitem"><p class="simpara">
						Set a label and the authentication ID for the slot:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init --store-pin --label testuser \ --auth-id 01 --so-pin <span class="emphasis"><em>65498714</em></span> --pin <span class="emphasis"><em>963214</em></span> --puk <span class="emphasis"><em>321478</em></span></strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span></pre><p class="simpara">
						The label is set to a human-readable value, in this case, <code class="literal">testuser</code>. The <code class="literal">auth-id</code> must be two hexadecimal values, in this case it is set to <code class="literal">01</code>.
					</p></li><li class="listitem"><p class="simpara">
						Store and label the private key in the new slot on the smart card:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init --store-private-key testuser.key --label testuser_key \ --auth-id 01 --id 01 --pin <span class="emphasis"><em>963214</em></span></strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							The value you specify for <code class="literal">--id</code> must be the same when storing your private key and storing your certificate in the next step. Specifying your own value for <code class="literal">--id</code> is recommended as otherwise a more complicated value is calculated by the tool.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Store and label the certificate in the new slot on the smart card:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init --store-certificate testuser.crt --label testuser_crt \ --auth-id 01 --id 01 --format pem --pin <span class="emphasis"><em>963214</em></span></strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Store and label the public key in the new slot on the smart card:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init --store-public-key testuserpublic.key --label testuserpublic_key --auth-id 01 --id 01 --pin <span class="emphasis"><em>963214</em></span></strong></span>
Using reader with a card: <span class="emphasis"><em>Reader name</em></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							If the public key corresponds to a private key or certificate, specify the same ID as the ID of the private key or certificate.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Optional: Certain smart cards require you to finalize the card by locking the settings:
					</p><pre class="screen">$ <span class="strong strong"><strong>pkcs15-init -F</strong></span></pre><p class="simpara">
						At this stage, your smart card includes the certificate, private key, and public key in the newly created slot. You have also created your user PIN and PUK and the Security Officer PIN and PUK.
					</p></li></ol></div></section><section class="section" id="configuring-timeouts-in-sssd-conf_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h3 class="title">9.7. Configuring timeouts in sssd.conf</h3></div></div></div><p class="_abstract _abstract">
				Authentication with a smart card certificate might take longer than the default timeouts used by SSSD. Time out expiration can be caused by:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Slow reader
					</li><li class="listitem">
						A forwarding form a physical device into a virtual environment
					</li><li class="listitem">
						Too many certificates stored on the smart card
					</li><li class="listitem">
						Slow response from the OCSP (Online Certificate Status Protocol) responder if OCSP is used to verify the certificates
					</li></ul></div><p>
				In this case you can prolong the following timeouts in the <code class="literal">sssd.conf</code> file, for example, to 60 seconds:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">p11_child_timeout</code>
					</li><li class="listitem">
						<code class="literal">krb5_auth_timeout</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You must be logged in as root.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open the <code class="literal">sssd.conf</code> file:
					</p><pre class="literallayout">[root@idmclient1 ~]# vim /etc/sssd/sssd.conf</pre></li><li class="listitem"><p class="simpara">
						Change the value of <code class="literal">p11_child_timeout</code>:
					</p><pre class="literallayout">[pam]
p11_child_timeout = 60</pre></li><li class="listitem"><p class="simpara">
						Change the value of <code class="literal">krb5_auth_timeout</code>:
					</p><pre class="literallayout">[domain/IDM.EXAMPLE.COM]
krb5_auth_timeout = 60</pre></li><li class="listitem">
						Save the settings.
					</li></ol></div><p>
				Now, the interaction with the smart card is allowed to run for 1 minute (60 seconds) before authentication will fail with a timeout.
			</p></section><section class="section" id="certificate-mapping-rules-for-smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm"><div class="titlepage"><div><div><h3 class="title">9.8. Creating certificate mapping rules for smart card authentication</h3></div></div></div><p class="_abstract _abstract">
				If you want to use one certificate for a user who has accounts in AD (Active Directory) and in IdM (Identity Management), you can create a certificate mapping rule on the IdM server.
			</p><p>
				After creating such a rule, the user is able to authenticate with their smart card in both domains.
			</p><p>
				For details about certificate mapping rules, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/con-idm-certmapdata_managing-smart-card-authentication">Certificate mapping rules for configuring authentication</a>.
			</p></section></section><section class="chapter" id="conf-certmap-idm_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 10. Configuring certificate mapping rules in Identity Management</h2></div></div></div><p class="_abstract _abstract">
			Certificate mapping rules are a convenient way of allowing users to authenticate using certificates in scenarios when the Identity Management (IdM) administrator does not have access to certain users' certificates. This is typically because the certificates have been issued by an external certificate authority.
		</p><section class="section" id="con-idm-certmapdata_conf-certmap-idm"><div class="titlepage"><div><div><h3 class="title">10.1. Certificate mapping rules for configuring authentication</h3></div></div></div><p class="_abstract _abstract">
				You might need to configure certificate mapping rules in the following scenarios:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Certificates have been issued by the Certificate System of the Active Directory (AD) with which the IdM domain is in a trust relationship.
					</li><li class="listitem">
						Certificates have been issued by an external certificate authority.
					</li><li class="listitem">
						The IdM environment is large with many users using smart cards. In this case, adding full certificates can be complicated. The subject and issuer are predictable in most scenarios and therefore easier to add ahead of time than the full certificate.
					</li></ul></div><p>
				As a system administrator, you can create a certificate mapping rule and add certificate mapping data to a user entry even before a certificate is issued to a particular user. Once the certificate is issued, the user can log in using the certificate even though the full certificate has not yet been uploaded to the user entry.
			</p><p>
				In addition, as certificates are renewed at regular intervals, certificate mapping rules reduce administrative overhead. When a user’s certificate is renewed, the administrator does not have to update the user entry. For example, if the mapping is based on the <code class="literal">Subject</code> and <code class="literal">Issuer</code> values, and if the new certificate has the same subject and issuer as the old one, the mapping still applies. If, in contrast, the full certificate was used, then the administrator would have to upload the new certificate to the user entry to replace the old one.
			</p><p>
				To set up certificate mapping:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						An administrator has to load the certificate mapping data or the full certificate into a user account.
					</li><li class="listitem">
						An administrator has to create a certificate mapping rule to allow successful logging into IdM for a user whose account contains a certificate mapping data entry that matches the information on the certificate.
					</li></ol></div><p>
				Once the certificate mapping rules have been created, when the end-user presents the certificate, stored either on a <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/dc-web-ui-auth_managing-certificates-in-idm">filesystem</a> or a <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth">smart card</a>, authentication is successful.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The Key Distribution Center (KDC) has a cache for certificate mapping rules. The cache is populated on the first <code class="literal">certauth</code> request and it has a hard-coded timeout of 300 seconds. KDC will not see any changes to certificate mapping rules unless it is restarted or the cache expires.
				</p></div></rh-alert><p>
				For details on the individual components that make up a mapping rule and how to obtain and use them, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#sc-id-mapping_conf-certmap-idm">Components of an identity mapping rule in IdM</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#sc-id-issuer-obtain-example_conf-certmap-idm">Obtaining the issuer from a certificate for use in a matching rule</a>.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Your certificate mapping rules can depend on the use case for which you are using the certificate. For example, if you are using SSH with certificates, you must have the full certificate to extract the public key from the certificate.
				</p></div></rh-alert></section><section class="section" id="sc-id-mapping_conf-certmap-idm"><div class="titlepage"><div><div><h3 class="title">10.2. Components of an identity mapping rule in IdM</h3></div></div></div><p class="_abstract _abstract">
				You configure different components when creating an <span class="emphasis"><em>identity mapping rule</em></span> in IdM. Each component has a default value that you can override. You can define the components in either the web UI or the CLI. In the CLI, the identity mapping rule is created using the <code class="literal">ipa certmaprule-add</code> command.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Mapping rule</span></dt><dd><p class="simpara">
							The mapping rule component associates (or <span class="emphasis"><em>maps</em></span>) a certificate with one or more user accounts. The rule defines an LDAP search filter that associates a certificate with the intended user account.
						</p><p class="simpara">
							Certificates issued by different certificate authorities (CAs) might have different properties and might be used in different domains. Therefore, IdM does not apply mapping rules unconditionally, but only to the appropriate certificates. The appropriate certificates are defined using <span class="emphasis"><em>matching rules</em></span>.
						</p><p class="simpara">
							Note that if you leave the mapping rule option empty, the certificates are searched in the <code class="literal">userCertificate</code> attribute as a DER encoded binary file.
						</p><p class="simpara">
							Define the mapping rule in the CLI using the <code class="literal">--maprule</code> option.
						</p></dd><dt><span class="term">Matching rule</span></dt><dd><p class="simpara">
							The matching rule component selects a certificate to which you want to apply the mapping rule. The default matching rule matches certificates with the <code class="literal">digitalSignature key</code> usage and <code class="literal">clientAuth extended key</code> usage.
						</p><p class="simpara">
							Define the matching rule in the CLI using the <code class="literal">--matchrule</code> option.
						</p></dd><dt><span class="term">Domain list</span></dt><dd><p class="simpara">
							The domain list specifies the identity domains in which you want IdM to search the users when processing identity mapping rules. If you leave the option unspecified, IdM searches the users only in the local domain to which the IdM client belongs.
						</p><p class="simpara">
							Define the domain in the CLI using the <code class="literal">--domain</code> option.
						</p></dd><dt><span class="term">Priority</span></dt><dd><p class="simpara">
							When multiple rules are applicable to a certificate, the rule with the highest priority takes precedence. All other rules are ignored.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The lower the numerical value, the higher the priority of the identity mapping rule. For example, a rule with a priority 1 has higher priority than a rule with a priority 2.
								</li><li class="listitem">
									If a rule has no priority value defined, it has the lowest priority.
								</li></ul></div><p class="simpara">
							Define the mapping rule priority in the CLI using the <code class="literal">--priority</code> option.
						</p></dd></dl></div><div class="formalpara"><p class="title"><strong>Certificate mapping rule example</strong></p><p>
					To define, using the CLI, a certificate mapping rule called <code class="literal">simple_rule</code> that allows authentication for a certificate issued by the <code class="literal">Smart Card CA</code> of the <code class="literal">EXAMPLE.ORG</code> organization if the <code class="literal">Subject</code> on that certificate matches a <code class="literal">certmapdata</code> entry in a user account in IdM:
				</p></div><pre class="literallayout"># <span class="strong strong"><strong>ipa certmaprule-add simple_rule --matchrule '&lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG' --maprule '(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})'</strong></span></pre></section><section class="section" id="sc-id-issuer-obtain-example_conf-certmap-idm"><div class="titlepage"><div><div><h3 class="title">10.3. Obtaining data from a certificate for use in a matching rule</h3></div></div></div><p class="_abstract _abstract">
				This procedure describes how to obtain data from a certificate so that you can copy and paste it into the matching rule of a certificate mapping rule. To get data required by a matching rule, use the <code class="literal">sssctl cert-show</code> or <code class="literal">sssctl cert-eval-rule</code> commands.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the user certificate in PEM format.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a variable pointing to your certificate that also ensures it is correctly encoded so you can retrieve the required data.
					</p><pre class="literallayout"># CERT=$(openssl x509 -in /path/to/certificate -outform der|base64 -w0)</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">sssctl cert-eval-rule</code> to determine the matching data. In the following example the certificate serial number is used.
					</p><pre class="literallayout"># sssctl cert-eval-rule $CERT --match='&lt;ISSUER&gt;CN=adcs19-WIN1-CA,DC=AD,DC=EXAMPLE,DC=COM' --map='LDAPU1:(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;SR&gt;{serial_number!hex_ur})'
Certificate matches rule.
Mapping filter:

    (altSecurityIdentities=X509:&lt;I&gt;DC=com,DC=example,DC=ad,CN=adcs19-WIN1-CA&lt;SR&gt;0F0000000000DB8852DD7B246C9C0F0000003B)</pre><p class="simpara">
						In this case, add everything after <code class="literal">altSecurityIdentities=</code> to the <code class="literal">altSecurityIdentities</code> attribute in AD for the user. If using SKI mapping, use <code class="literal">--map='LDAPU1:(altSecurityIdentities=X509:&lt;SKI&gt;{subject_key_id!hex_u})'</code>.
					</p></li><li class="listitem"><p class="simpara">
						Optional: To create a new mapping rule in the CLI based on a matching rule which specifies that the certificate issuer must match <code class="literal">adcs19-WIN1-CA</code> of the <code class="literal">ad.example.com</code> domain and the serial number of the certificate must match the <code class="literal">altSecurityIdentities</code> entry in a user account:
					</p><pre class="literallayout"># ipa certmaprule-add simple_rule --matchrule '&lt;ISSUER&gt;CN=adcs19-WIN1-CA,DC=AD,DC=EXAMPLE,DC=COM' --maprule 'LDAPU1:(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;SR&gt;{serial_number!hex_ur})'</pre></li></ol></div></section><section class="section" id="conf-certmap-for-users-in-idm_conf-certmap-idm"><div class="titlepage"><div><div><h3 class="title">10.4. Configuring certificate mapping for users stored in IdM</h3></div></div></div><p class="_abstract _abstract">
				To enable certificate mapping in IdM if the user for whom certificate authentication is being configured is stored in IdM, a system administrator must complete the following tasks:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Set up a certificate mapping rule so that IdM users with certificates that match the conditions specified in the mapping rule and in their certificate mapping data entries can authenticate to IdM.
					</li><li class="listitem">
						Enter certificate mapping data to an IdM user entry so that the user can authenticate using multiple certificates provided that they all contain the values specified in the certificate mapping data entry.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The user has an account in IdM.
					</li><li class="listitem">
						The administrator has either the whole certificate or the certificate mapping data to add to the user entry.
					</li></ul></div><section class="section" id="proc-add-maprule-webui_conf-certmap-for-users-in-idm"><div class="titlepage"><div><div><h4 class="title">10.4.1. Adding a certificate mapping rule in the IdM web UI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem">
							Log in to the IdM web UI as an administrator.
						</li><li class="listitem">
							Navigate to <code class="literal">Authentication</code> → <code class="literal">Certificate Identity Mapping Rules</code> → <code class="literal">Certificate Identity Mapping Rules</code>.
						</li><li class="listitem"><p class="simpara">
							Click <code class="literal">Add</code>.
						</p><div class="figure" id="conf-certmap-for-users-in-idm-new-certmaprule-add"><p class="title"><strong>Figure 10.1. Adding a new certificate mapping rule in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/72c74881008431b50032e8e3f9bec734/new-certmaprule-add.png" alt="Screenshot of the IdM Web UI displaying the &quot;Certificate Identity Mapping Rules&quot; sub-tab from the Authentication tab. The &quot;Add&quot; button at the right of the page is highlighted."></div></div></div></li><li class="listitem">
							Enter the rule name.
						</li><li class="listitem"><p class="simpara">
							Enter the mapping rule. For example, to make IdM search for the <code class="literal">Issuer</code> and <code class="literal">Subject</code> entries in any certificate presented to them, and base its decision to authenticate or not on the information found in these two entries of the presented certificate:
						</p><pre class="literallayout"><span class="strong strong"><strong>(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})</strong></span></pre></li><li class="listitem"><p class="simpara">
							Enter the matching rule. For example, to only allow certificates issued by the <code class="literal">Smart Card CA</code> of the <code class="literal">EXAMPLE.ORG</code> organization to authenticate users to IdM:
						</p><pre class="literallayout"><span class="strong strong"><strong>&lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG</strong></span></pre><div class="figure" id="conf-certmap-for-users-in-idm-certmaprule-add-details"><p class="title"><strong>Figure 10.2. Entering the details for a certificate mapping rule in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/c96905d9c2af05053c843cba58f6a92e/certmaprule-add-details1.png" alt="Screenshot of the &quot;Add Certificate Identity Mapping Rule&quot; pop-up window with the following fields filled in: Rule name (which is required) - Mapping rule - Matching rule. The Priority field is blank and there is also an Add button next to the Domain name label."></div></div></div></li><li class="listitem">
							Click <code class="literal">Add</code> at the bottom of the dialog box to add the rule and close the box.
						</li><li class="listitem"><p class="simpara">
							The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:
						</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div><p>
					Now you have a certificate mapping rule set up that compares the type of data specified in the mapping rule that it finds on a smart card certificate with the certificate mapping data in your IdM user entries. Once it finds a match, it authenticates the matching user.
				</p></section><section class="section" id="proc-add-maprule-cli_conf-certmap-for-users-in-idm"><div class="titlepage"><div><div><h4 class="title">10.4.2. Adding a certificate mapping rule in the IdM CLI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem"><p class="simpara">
							Obtain the administrator’s credentials:
						</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
							Enter the mapping rule and the matching rule the mapping rule is based on. For example, to make IdM search for the <code class="literal">Issuer</code> and <code class="literal">Subject</code> entries in any certificate presented, and base its decision to authenticate or not on the information found in these two entries of the presented certificate, recognizing only certificates issued by the <code class="literal">Smart Card CA</code> of the <code class="literal">EXAMPLE.ORG</code> organization:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmaprule-add <code class="literal">rule_name</code> --matchrule '&lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG' --maprule '(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})'</strong></span>
-------------------------------------------------------
Added Certificate Identity Mapping Rule "rule_name"
-------------------------------------------------------
  Rule name: rule_name
  Mapping rule: (ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})
  Matching rule: &lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:
						</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div><p>
					Now you have a certificate mapping rule set up that compares the type of data specified in the mapping rule that it finds on a smart card certificate with the certificate mapping data in your IdM user entries. Once it finds a match, it authenticates the matching user.
				</p></section><section class="section" id="proc-add-certmapdata-to-user-webui_conf-certmap-for-users-in-idm"><div class="titlepage"><div><div><h4 class="title">10.4.3. Adding certificate mapping data to a user entry in the IdM web UI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem">
							Log into the IdM web UI as an administrator.
						</li><li class="listitem">
							Navigate to <code class="literal">Users</code> → <code class="literal">Active users</code> → <code class="literal">idm_user</code>.
						</li><li class="listitem">
							Find the <code class="literal">Certificate mapping data</code> option and click <code class="literal">Add</code>.
						</li><li class="listitem"><p class="simpara">
							Choose one of the following options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If you have the certificate of <code class="literal">idm_user</code>:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
											In the command-line interface, display the certificate using the <code class="literal">cat</code> utility or a text editor:
										</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>cat idm_user_certificate.pem</strong></span>
-----BEGIN CERTIFICATE-----
MIIFFTCCA/2gAwIBAgIBEjANBgkqhkiG9w0BAQsFADA6MRgwFgYDVQQKDA9JRE0u
RVhBTVBMRS5DT00xHjAcBgNVBAMMFUNlcnRpZmljYXRlIEF1dGhvcml0eTAeFw0x
ODA5MDIxODE1MzlaFw0yMDA5MDIxODE1MzlaMCwxGDAWBgNVBAoMD0lETS5FWEFN
[...output truncated...]</pre></li><li class="listitem">
											Copy the certificate.
										</li><li class="listitem"><p class="simpara">
											In the IdM web UI, click <code class="literal">Add</code> next to <code class="literal">Certificate</code> and paste the certificate into the window that opens up.
										</p><div class="figure" id="conf-certmap-for-users-in-idm-add-user-certmapdata-cert"><p class="title"><strong>Figure 10.3. Adding a user’s certificate mapping data: certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/e379f8fc7f76ae285ab18d034ee34b47/user-add-cert.png" alt="Screenshot of a page displaying settings for the user &quot;demouser&quot; with an Identity Settings column on the left with entries such as Job Title - First name - Last name - Full name - Display name. The &quot;Account Settings&quot; column is on the right with entries such as User login - Password - UID - GID. The &quot;Add&quot; button for the &quot;Certificates&quot; entry is highlighted."></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
													If you do not have the certificate of <code class="literal">idm_user</code> at your disposal but know the <code class="literal">Issuer</code> and the <code class="literal">Subject</code> of the certificate, check the radio button of <code class="literal">Issuer and subject</code> and enter the values in the two respective boxes.
												</li></ul></div><div class="figure" id="conf-certmap-for-users-in-idm-add-user-certmapdata-data"><p class="title"><strong>Figure 10.4. Adding a user’s certificate mapping data: issuer and subject</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/3485df444832373a38a8aa2a047bbf71/user-add-certdata.png" alt="Screenshot of the &quot;Add Certificate Mapping Data&quot; pop-up window with two radial button options: &quot;Certificate mapping data&quot; and &quot;Issuer and subject.&quot; &quot;Issuer and subject&quot; is selected and its two fields (Issuer and Subject) have been filled out."></div></div></div></li></ol></div></li></ul></div></li><li class="listitem">
							Click <code class="literal">Add</code>.
						</li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
						If you have access to the whole certificate in the <code class="literal">.pem</code> format, verify that the user and certificate are linked:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Use the <code class="literal">sss_cache</code> utility to invalidate the record of <code class="literal">idm_user</code> in the SSSD cache and force a reload of the <code class="literal">idm_user</code> information:
						</p><pre class="literallayout"># <span class="strong strong"><strong>sss_cache -u idm_user</strong></span></pre></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">ipa certmap-match</code> command with the name of the file containing the certificate of the IdM user:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmap-match idm_user_cert.pem</strong></span>
--------------
1 user matched
--------------
 Domain: IDM.EXAMPLE.COM
 User logins: idm_user
----------------------------
Number of entries returned 1
----------------------------</pre><p class="simpara">
							The output confirms that now you have certificate mapping data added to <code class="literal">idm_user</code> and that a corresponding mapping rule exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as <code class="literal">idm_user</code>.
						</p></li></ol></div></section><section class="section" id="proc-add-certmapdata-to-user-cli_conf-certmap-for-users-in-idm"><div class="titlepage"><div><div><h4 class="title">10.4.4. Adding certificate mapping data to a user entry in the IdM CLI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem"><p class="simpara">
							Obtain the administrator’s credentials:
						</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
							Choose one of the following options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									If you have the certificate of <code class="literal">idm_user</code>, add the certificate to the user account using the <code class="literal">ipa user-add-cert</code> command:
								</li></ul></div><pre class="literallayout"># <span class="strong strong"><strong>CERT=$(openssl x509 -in idm_user_cert.pem -outform der|base64 -w0)</strong></span>
# <span class="strong strong"><strong>ipa user-add-certmapdata idm_user --certificate $CERT</strong></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If you do not have the certificate of <code class="literal">idm_user</code> but know the <code class="literal">Issuer</code> and the <code class="literal">Subject</code> of the user’s certificate:
								</p><pre class="literallayout"># <span class="strong strong"><strong>ipa user-add-certmapdata idm_user --subject "O=EXAMPLE.ORG,CN=test" --issuer "CN=Smart Card CA,O=EXAMPLE.ORG"</strong></span>
--------------------------------------------
Added certificate mappings to user "idm_user"
--------------------------------------------
  User login: idm_user
  Certificate mapping data: X509:&lt;I&gt;O=EXAMPLE.ORG,CN=Smart Card CA&lt;S&gt;CN=test,O=EXAMPLE.ORG</pre></li></ul></div></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
						If you have access to the whole certificate in the <code class="literal">.pem</code> format, verify that the user and certificate are linked:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Use the <code class="literal">sss_cache</code> utility to invalidate the record of <code class="literal">idm_user</code> in the SSSD cache and force a reload of the <code class="literal">idm_user</code> information:
						</p><pre class="literallayout"># <span class="strong strong"><strong>sss_cache -u idm_user</strong></span></pre></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">ipa certmap-match</code> command with the name of the file containing the certificate of the IdM user:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmap-match idm_user_cert.pem</strong></span>
--------------
1 user matched
--------------
 Domain: IDM.EXAMPLE.COM
 User logins: idm_user
----------------------------
Number of entries returned 1
----------------------------</pre><p class="simpara">
							The output confirms that now you have certificate mapping data added to <code class="literal">idm_user</code> and that a corresponding mapping rule exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as <code class="literal">idm_user</code>.
						</p></li></ol></div></section></section><section class="section" id="con-idm-ad-certmapdata_conf-certmap-idm"><div class="titlepage"><div><div><h3 class="title">10.5. Certificate mapping rules for trusts with Active Directory domains</h3></div></div></div><p class="_abstract _abstract">
				Different certificate mapping use cases are possible if an IdM deployment is in a trust relationship with an Active Directory (AD) domain.
			</p><p>
				Depending on the AD configuration, the following scenarios are possible:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						If the certificate is issued by AD Certificate System but the user and the certificate are stored in IdM, the mapping and the whole processing of the authentication request takes place on the IdM side. For details of configuring this scenario, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-users-in-idm_conf-certmap-idm">Configuring certificate mapping for users stored in IdM</a>
					</li><li class="listitem"><p class="simpara">
						If the user is stored in AD, the processing of the authentication request takes place in AD. There are three different subcases:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The AD user entry contains the whole certificate. For details how to configure IdM in this scenario, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-ad-certs_conf-certmap-idm">Configuring certificate mapping for users whose AD user entry contains the whole certificate</a>.
							</li><li class="listitem">
								AD is configured to map user certificates to user accounts. In this case, the AD user entry does not contain the whole certificate but instead contains an attribute called <code class="literal">altSecurityIdentities</code>. For details how to configure IdM in this scenario, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-ad-map_conf-certmap-idm">Configuring certificate mapping if AD is configured to map user certificates to user accounts</a>.
							</li><li class="listitem"><p class="simpara">
								The AD user entry contains neither the whole certificate nor the mapping data. In this case, there are two options:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
										If the user certificate is issued by AD Certificate System, the certificate either contains the user principal name as the Subject Alternative Name (SAN) or, if the latest updates are applied to AD, the SID of the user in the SID extension of the certificate. Both of these can be used to map the certificate to the user.
									</li><li class="listitem">
										If the user certificate is on a smart card, to enable SSH with smart cards, SSSD must derive the public SSH key from the certificate and therefore the full certificate is required. The only solution is to use the <code class="literal">ipa idoverrideuser-add</code> command to add the whole certificate to the AD user’s ID override in IdM. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map">Configuring certificate mapping if AD user entry contains no certificate or mapping data</a>.
									</li></ul></div></li></ul></div></li></ul></div><p>
				AD domain administrators can manually map certificates to a user in AD using the <code class="literal">altSecurityIdentities</code> attribute. There are six supported values for this attribute, though three mappings are considered insecure. As part of <a class="link" href="https://support.microsoft.com/en-us/topic/kb5014754-certificate-based-authentication-changes-on-windows-domain-controllers-ad2c23b0-15d8-4340-a468-4d4f3b188f16">May 10,2022 security update</a>, once it is installed, all devices are in compatibility mode and if a certificate is weakly mapped to a user, authentication occurs as expected. However, warning messages are logged identifying any certificates that are not compatible with full enforcement mode. As of November 14, 2023 or later, all devices will be updated to full enforcement mode and if a certificate fails the strong mapping criteria, authentication will be denied.
			</p><p>
				For example, when an AD user requests an IdM Kerberos ticket with a certificate (PKINIT), AD needs to map the certificate to a user internally and uses the new mapping rules for this. However in IdM, the previous rules continue to work if IdM is used to map a certificate to a user on an IdM client, .
			</p><p>
				IdM supports the new mapping templates, making it easier for an AD administrator to use the new rules and not maintain both. IdM now supports the new mapping templates added to Active Directory to include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Serial Number: LDAPU1:(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;SR&gt;{serial_number!hex_ur})
					</li><li class="listitem">
						Subject Key Id: LDAPU1:(altSecurityIdentities=X509:&lt;SKI&gt;{subject_key_id!hex_u})
					</li><li class="listitem">
						User SID: LDAPU1:(objectsid={sid})
					</li></ul></div><p>
				If you do not want to reissue certificates with the new SID extension, you can create a manual mapping by adding the appropriate mapping string to a user’s <code class="literal">altSecurityIdentities</code> attribute in AD.
			</p></section><section class="section" id="conf-certmap-for-ad-certs_conf-certmap-idm"><div class="titlepage"><div><div><h3 class="title">10.6. Configuring certificate mapping for users whose AD user entry contains the whole certificate</h3></div></div></div><p class="_abstract _abstract">
				This user story describes the steps necessary for enabling certificate mapping in IdM if the IdM deployment is in trust with Active Directory (AD), the user is stored in AD and the user entry in AD contains the whole certificate.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The user does not have an account in IdM.
					</li><li class="listitem">
						The user has an account in AD which contains a certificate.
					</li><li class="listitem">
						The IdM administrator has access to data on which the IdM certificate mapping rule can be based.
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					To ensure PKINIT works for a user, one of the following conditions must apply:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The certificate in the user entry includes the user principal name or the SID extension for the user.
						</li><li class="listitem">
							The user entry in AD has a suitable entry in the <code class="literal">altSecurityIdentities</code> attribute.
						</li></ul></div></div></rh-alert><section class="section" id="proc-add-maprule-webui-ad-cert_conf-certmap-for-ad-certs"><div class="titlepage"><div><div><h4 class="title">10.6.1. Adding a certificate mapping rule in the IdM web UI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem">
							Log into the IdM web UI as an administrator.
						</li><li class="listitem">
							Navigate to <code class="literal">Authentication</code> → <code class="literal">Certificate Identity Mapping Rules</code> → <code class="literal">Certificate Identity Mapping Rules</code>.
						</li><li class="listitem"><p class="simpara">
							Click <code class="literal">Add</code>.
						</p><div class="figure" id="conf-certmap-for-ad-certs-new-certmaprule-add-ad-cert"><p class="title"><strong>Figure 10.5. Adding a new certificate mapping rule in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/72c74881008431b50032e8e3f9bec734/new-certmaprule-add.png" alt="Screenshot of the IdM Web UI displaying the &quot;Certificate Identity Mapping Rules&quot; sub-page from the Authentication tab. The &quot;Add&quot; button to the right is highlighted."></div></div></div></li><li class="listitem">
							Enter the rule name.
						</li><li class="listitem"><p class="simpara">
							Enter the mapping rule. To have the whole certificate that is presented to IdM for authentication compared to what is available in AD:
						</p><pre class="literallayout"><span class="strong strong"><strong>(userCertificate;binary={cert!bin})</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								If mapping using the full certificate, if you renew the certificate, you must ensure that you add the new certificate to the AD user object.
							</p></div></rh-alert></li><li class="listitem"><p class="simpara">
							Enter the matching rule. For example, to only allow certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain to authenticate:
						</p><pre class="literallayout"><span class="strong strong"><strong>&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com</strong></span></pre><div class="figure" id="conf-certmap-for-ad-certs-certmaprule-add-details-ad-cert"><p class="title"><strong>Figure 10.6. Certificate mapping rule for a user with a certificate stored in AD</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/fc7ffb80cb1b02342a6f849e01be408a/certmaprule-add-details-ad-cert.png" alt="Screenshot of the &quot;Add Certificate Identity Mapping Rule&quot; pop-up window with the following fields filled in: Rule name (which is required) - Mapping rule - Matching rule. The Priority field is blank and there is also an &quot;Add&quot; button next to the &quot;Domain name&quot; label."></div></div></div></li><li class="listitem">
							Click <code class="literal">Add</code>.
						</li><li class="listitem"><p class="simpara">
							The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD in the CLI::
						</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div></section><section class="section" id="proc-add-maprule-cli-ad-cert_conf-certmap-for-ad-certs"><div class="titlepage"><div><div><h4 class="title">10.6.2. Adding a certificate mapping rule in the IdM CLI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem"><p class="simpara">
							Obtain the administrator’s credentials:
						</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
							Enter the mapping rule and the matching rule the mapping rule is based on. To have the whole certificate that is presented for authentication compared to what is available in AD, only allowing certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain to authenticate:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmaprule-add <code class="literal">simpleADrule</code> --matchrule '&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' --maprule '(userCertificate;binary={cert!bin})' --domain ad.example.com</strong></span>
-------------------------------------------------------
Added Certificate Identity Mapping Rule "simpleADrule"
-------------------------------------------------------
  Rule name: simpleADrule
  Mapping rule: (userCertificate;binary={cert!bin})
  Matching rule: &lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com
  Domain name: ad.example.com
  Enabled: TRUE</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								If mapping using the full certificate, if you renew the certificate, you must ensure that you add the new certificate to the AD user object.
							</p></div></rh-alert></li><li class="listitem"><p class="simpara">
							The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:
						</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div></section></section><section class="section" id="conf-certmap-for-ad-map_conf-certmap-idm"><div class="titlepage"><div><div><h3 class="title">10.7. Configuring certificate mapping if AD is configured to map user certificates to user accounts</h3></div></div></div><p class="_abstract _abstract">
				This user story describes the steps necessary for enabling certificate mapping in IdM if the IdM deployment is in trust with Active Directory (AD), the user is stored in AD, and the user entry in AD contains certificate mapping data.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The user does not have an account in IdM.
					</li><li class="listitem">
						The user has an account in AD which contains the <code class="literal">altSecurityIdentities</code> attribute, the AD equivalent of the IdM <code class="literal">certmapdata</code> attribute.
					</li><li class="listitem">
						The IdM administrator has access to data on which the IdM certificate mapping rule can be based.
					</li></ul></div><section class="section" id="proc-add-ad-maprule-webui_conf-certmap-for-ad-map"><div class="titlepage"><div><div><h4 class="title">10.7.1. Adding a certificate mapping rule in the IdM web UI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem">
							Log into the IdM web UI as an administrator.
						</li><li class="listitem">
							Navigate to <code class="literal">Authentication</code> → <code class="literal">Certificate Identity Mapping Rules</code> → <code class="literal">Certificate Identity Mapping Rules</code>.
						</li><li class="listitem"><p class="simpara">
							Click <code class="literal">Add</code>.
						</p><div class="figure" id="conf-certmap-for-ad-map-new-certmaprule-add-ad-map"><p class="title"><strong>Figure 10.7. Adding a new certificate mapping rule in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/72c74881008431b50032e8e3f9bec734/new-certmaprule-add.png" alt="Screenshot of the IdM Web UI displaying the &quot;Certificate Identity Mapping Rules&quot; sub-tab from the Authentication tab. The &quot;Add&quot; button at the right of the page is highlighted."></div></div></div></li><li class="listitem">
							Enter the rule name.
						</li><li class="listitem"><p class="simpara">
							Enter the mapping rule. For example, to make AD DC search for the <code class="literal">Issuer</code> and <code class="literal">Subject</code> entries in any certificate presented, and base its decision to authenticate or not on the information found in these two entries of the presented certificate:
						</p><pre class="literallayout"><span class="strong strong"><strong>(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500})</strong></span></pre></li><li class="listitem"><p class="simpara">
							Enter the matching rule. For example, to only allow certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain to authenticate users to IdM:
						</p><pre class="literallayout"><span class="strong strong"><strong>&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com</strong></span></pre></li><li class="listitem"><p class="simpara">
							Enter the domain:
						</p><pre class="literallayout"><span class="strong strong"><strong>ad.example.com</strong></span></pre><div class="figure" id="conf-certmap-for-ad-map-certmaprule-add-details-ad-map"><p class="title"><strong>Figure 10.8. Certificate mapping rule if AD is configured for mapping</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/ed680029d040c1716bf14840355019b8/certmaprule-add-details-ad-map.png" alt="Screenshot of the &quot;Add Certificate Identity Mapping Rule&quot; pop-up window with the following fields filled in: Rule name (which is required) - Mapping rule - Matching rule. The &quot;Priority&quot; field is blank and there is also an &quot;Add&quot; button next to the &quot;Domain name&quot; label."></div></div></div></li><li class="listitem">
							Click <code class="literal">Add</code>.
						</li><li class="listitem"><p class="simpara">
							The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD in the CLI::
						</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div></section><section class="section" id="proc-add-ad-maprule-cli_conf-certmap-for-ad-map"><div class="titlepage"><div><div><h4 class="title">10.7.2. Adding a certificate mapping rule in the IdM CLI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem"><p class="simpara">
							Obtain the administrator’s credentials:
						</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
							Enter the mapping rule and the matching rule the mapping rule is based on. For example, to make AD search for the <code class="literal">Issuer</code> and <code class="literal">Subject</code> entries in any certificate presented, and only allow certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmaprule-add ad_configured_for_mapping_rule --matchrule '&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' --maprule '(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500})' --domain=ad.example.com</strong></span>
-------------------------------------------------------
Added Certificate Identity Mapping Rule "ad_configured_for_mapping_rule"
-------------------------------------------------------
  Rule name: ad_configured_for_mapping_rule
  Mapping rule: (altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500})
  Matching rule: &lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com
  Domain name: ad.example.com
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:
						</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div></section><section class="section" id="check-if-ad-maprule-exists_conf-certmap-for-ad-map"><div class="titlepage"><div><div><h4 class="title">10.7.3. Checking certificate mapping data on the AD side</h4></div></div></div><p class="_abstract _abstract">
					The <code class="literal">altSecurityIdentities</code> attribute is the Active Directory (AD) equivalent of <code class="literal">certmapdata</code> user attribute in IdM. When configuring certificate mapping in IdM in the scenario when a trusted AD domain is configured to map user certificates to user accounts, the IdM system administrator needs to check that the <code class="literal">altSecurityIdentities</code> attribute is set correctly in the user entries in AD.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The user account must have user administration access.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To check that AD contains the right information for the user stored in AD, use the <code class="literal">ldapsearch</code> command. For example, enter the command below to check with the <code class="literal">adserver.ad.example.com</code> server that the following conditions apply:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									The <code class="literal">altSecurityIdentities</code> attribute is set in the user entry of <code class="literal">ad_user</code>.
								</li><li class="listitem"><p class="simpara">
									The matchrule stipulates that the following conditions apply:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
											The certificate that <code class="literal">ad_user</code> uses to authenticate to AD was issued by <code class="literal">AD-ROOT-CA</code> of the <code class="literal">ad.example.com</code> domain.
										</li><li class="listitem">
											The subject is <code class="literal">&lt;S&gt;DC=com,DC=example,DC=ad,CN=Users,CN=ad_user</code>:
										</li></ul></div></li></ul></div><pre class="literallayout">$ <span class="strong strong"><strong>ldapsearch -o ldif-wrap=no -LLL -h adserver.ad.example.com</strong></span> \
<span class="strong strong"><strong>-p 389 -D cn=Administrator,cn=users,dc=ad,dc=example,dc=com</strong></span> \
<span class="strong strong"><strong>-W -b cn=users,dc=ad,dc=example,dc=com "(cn=ad_user)"</strong></span> \
<span class="strong strong"><strong>altSecurityIdentities</strong></span>
Enter LDAP Password:
dn: CN=ad_user,CN=Users,DC=ad,DC=example,DC=com
altSecurityIdentities: X509:&lt;I&gt;DC=com,DC=example,DC=ad,CN=AD-ROOT-CA&lt;S&gt;DC=com,DC=example,DC=ad,CN=Users,CN=ad_user</pre></li></ul></div></section></section><section class="section" id="conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map"><div class="titlepage"><div><div><h3 class="title">10.8. Configuring certificate mapping if AD user entry contains no certificate or mapping data</h3></div></div></div><p class="_abstract _abstract">
				This user story describes the steps necessary for enabling certificate mapping in IdM if the IdM deployment is in trust with Active Directory (AD), the user is stored in AD and the user entry in AD contains neither the whole certificate nor certificate mapping data.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The user does not have an account in IdM.
					</li><li class="listitem">
						The user has an account in AD which contains neither the whole certificate nor the <code class="literal">altSecurityIdentities</code> attribute, the AD equivalent of the IdM <code class="literal">certmapdata</code> attribute.
					</li><li class="listitem"><p class="simpara">
						The IdM administrator has done one of the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Added the whole AD user certificate to the AD user’s <code class="literal">user ID override</code> in IdM.
							</li><li class="listitem">
								Created a certificate mapping rule that maps to an alternative field in the certificate, such as Subject Alternative Name or the SID of the user.
							</li></ul></div></li></ul></div><section class="section" id="proc-add-certmaprule-ad-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map"><div class="titlepage"><div><div><h4 class="title">10.8.1. Adding a certificate mapping rule in the IdM web UI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem">
							Log into the IdM web UI as an administrator.
						</li><li class="listitem">
							Navigate to <code class="literal">Authentication</code> → <code class="literal">Certificate Identity Mapping Rules</code> → <code class="literal">Certificate Identity Mapping Rules</code>.
						</li><li class="listitem"><p class="simpara">
							Click <code class="literal">Add</code>.
						</p><div class="figure" id="conf-certmap-ad-no-cert-no-map-new-certmaprule-add-ad-no-cert-no-map"><p class="title"><strong>Figure 10.9. Adding a new certificate mapping rule in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/72c74881008431b50032e8e3f9bec734/new-certmaprule-add.png" alt="Screenshot of the IdM Web UI displaying the &quot;Certificate Identity Mapping Rules&quot; sub-page from the Authentication tab. The &quot;Add&quot; button to the right is highlighted"></div></div></div></li><li class="listitem">
							Enter the rule name.
						</li><li class="listitem"><p class="simpara">
							Enter the mapping rule. To have the whole certificate that is presented to IdM for authentication compared to the certificate stored in the user ID override entry of the AD user entry in IdM:
						</p><pre class="literallayout"><span class="strong strong"><strong>(userCertificate;binary={cert!bin})</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								As the certificate also contains the user principal name as the SAN, or with the latest updates, the SID of the user in the SID extension of the certificate, you can also use these fields to map the certificate to the user. For example, if using the SID of the user, replace this mapping rule with <code class="literal">LDAPU1:(objectsid={sid})</code>. For more information on certificate mapping, see the <code class="literal">sss-certmap</code> man page on your system.
							</p></div></rh-alert></li><li class="listitem"><p class="simpara">
							Enter the matching rule. For example, to only allow certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain to authenticate:
						</p><pre class="literallayout"><span class="strong strong"><strong>&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com</strong></span></pre></li><li class="listitem"><p class="simpara">
							Enter the domain name. For example, to search for users in the <code class="literal">ad.example.com</code> domain:
						</p><div class="figure" id="conf-certmap-ad-no-cert-no-map-certmaprule-add-details-ad-no-cert-no-map"><p class="title"><strong>Figure 10.10. Certificate mapping rule for a user with no certificate or mapping data stored in AD</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/fc7ffb80cb1b02342a6f849e01be408a/certmaprule-add-details-ad-cert.png" alt="Screenshot of the &quot;Add Certificate Identity Mapping Rule&quot; pop-up window with the following fields filled in: Rule name (which is required) - Mapping rule - Matching rule. The &quot;Priority&quot; field is blank and there is also an Add button next to the &quot;Domain name&quot; label."></div></div></div></li><li class="listitem">
							Click <code class="literal">Add</code>.
						</li><li class="listitem"><p class="simpara">
							The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD in the CLI:
						</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div></section><section class="section" id="proc-add-certmaprule-ad-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map"><div class="titlepage"><div><div><h4 class="title">10.8.2. Adding a certificate mapping rule in the IdM CLI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem"><p class="simpara">
							Obtain the administrator’s credentials:
						</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
							Enter the mapping rule and the matching rule the mapping rule is based on. To have the whole certificate that is presented for authentication compared to the certificate stored in the user ID override entry of the AD user entry in IdM, only allowing certificates issued by the <code class="literal">AD-ROOT-CA</code> of the <code class="literal">AD.EXAMPLE.COM</code> domain to authenticate:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmaprule-add <code class="literal">simpleADrule</code> --matchrule '&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' --maprule '(userCertificate;binary={cert!bin})' --domain ad.example.com</strong></span>
-------------------------------------------------------
Added Certificate Identity Mapping Rule "simpleADrule"
-------------------------------------------------------
  Rule name: simpleADrule
  Mapping rule: (userCertificate;binary={cert!bin})
  Matching rule: &lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com
  Domain name: ad.example.com
  Enabled: TRUE</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								As the certificate also contains the user principal name as the SAN, or with the latest updates, the SID of the user in the SID extension of the certificate, you can also use these fields to map the certificate to the user. For example, if using the SID of the user, replace this mapping rule with <code class="literal">LDAPU1:(objectsid={sid})</code>. For more information on certificate mapping, see the <code class="literal">sss-certmap</code> man page on your system.
							</p></div></rh-alert></li><li class="listitem"><p class="simpara">
							The System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:
						</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li></ol></div></section><section class="section" id="proc-add-certmapdata-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map"><div class="titlepage"><div><div><h4 class="title">10.8.3. Adding a certificate to an AD user’s ID override in the IdM web UI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem">
							Navigate to <code class="literal">Identity</code> → <code class="literal">ID Views</code> → <code class="literal">Default Trust View</code>.
						</li><li class="listitem"><p class="simpara">
							Click <code class="literal">Add</code>.
						</p><div class="figure" id="conf-certmap-ad-no-cert-no-map-new-useridoverride-add"><p class="title"><strong>Figure 10.11. Adding a new user ID override in the IdM web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/e2cda7ac50cef2d6ce4cf2df7dff34a6/new-useridoverride-add.png" alt="Screenshot of the IdM Web UI displaying the &quot;ID Views&quot; page from the Identity tab. The Add button on the right is highlighted."></div></div></div></li><li class="listitem">
							In the <code class="literal">User to override</code> field, enter <code class="literal">ad_user@ad.example.com</code>.
						</li><li class="listitem"><p class="simpara">
							Copy and paste the certificate of <code class="literal">ad_user</code> into the <code class="literal">Certificate</code> field.
						</p><div class="figure" id="conf-certmap-ad-no-cert-no-map-useridoverride-add-details"><p class="title"><strong>Figure 10.12. Configuring the User ID override for an AD user</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/e089e03fcdb76a3eb2dd295322c51f54/useridoverride-add-details.png" alt="Screenshot displaying the &quot;Add User ID override&quot; pop-up window with the following fields: User to override (which is required) - User login - GECOS - UID - GID - Certificate (which has been filled in with the plaintext version of a certificate)."></div></div></div></li><li class="listitem">
							Click <code class="literal">Add</code>.
						</li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
						Verify that the user and certificate are linked:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Use the <code class="literal">sss_cache</code> utility to invalidate the record of <code class="literal">ad_user@ad.example.com</code> in the SSSD cache and force a reload of the <code class="literal">ad_user@ad.example.com</code> information:
						</p><pre class="literallayout"># <span class="strong strong"><strong>sss_cache -u ad_user@ad.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">ipa certmap-match</code> command with the name of the file containing the certificate of the AD user:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmap-match ad_user_cert.pem</strong></span>
--------------
1 user matched
--------------
 Domain: AD.EXAMPLE.COM
 User logins: ad_user@ad.example.com
----------------------------
Number of entries returned 1
----------------------------</pre></li></ol></div><p>
					The output confirms that you have certificate mapping data added to <code class="literal">ad_user@ad.example.com</code> and that a corresponding mapping rule defined in <a class="link" href="#conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map" title="10.8. Configuring certificate mapping if AD user entry contains no certificate or mapping data">Adding a certificate mapping rule if the AD user entry contains no certificate or mapping data</a> exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as <code class="literal">ad_user@ad.example.com</code>.
				</p><div class="_additional-resources _additional-resources"><p class="title"><strong>Additional resources</strong></p><p>
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/assembly_using-id-views-for-active-directory-users_managing-users-groups-hosts">Using ID views for Active Directory users</a>
					</p></div></section><section class="section" id="proc-add-certmapdata-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map"><div class="titlepage"><div><div><h4 class="title">10.8.4. Adding a certificate to an AD user’s ID override in the IdM CLI</h4></div></div></div><div class="orderedlist _abstract"><ol class="orderedlist _abstract" type="1"><li class="listitem"><p class="simpara">
							Obtain the administrator’s credentials:
						</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
							Store the certificate blob in a new variable called <code class="literal">CERT</code>:
						</p><pre class="literallayout"># <span class="strong strong"><strong>CERT=$(openssl x509 -in /path/to/certificate -outform der|base64 -w0)</strong></span></pre></li><li class="listitem"><p class="simpara">
							Add the certificate of <code class="literal">ad_user@ad.example.com</code> to the user account using the <code class="literal">ipa idoverrideuser-add-cert</code> command:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa idoverrideuser-add-cert ad_user@ad.example.com --certificate $CERT</strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
						Verify that the user and certificate are linked:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Use the <code class="literal">sss_cache</code> utility to invalidate the record of <code class="literal">ad_user@ad.example.com</code> in the SSSD cache and force a reload of the <code class="literal">ad_user@ad.example.com</code> information:
						</p><pre class="literallayout"># <span class="strong strong"><strong>sss_cache -u ad_user@ad.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">ipa certmap-match</code> command with the name of the file containing the certificate of the AD user:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa certmap-match ad_user_cert.pem</strong></span>
--------------
1 user matched
--------------
 Domain: AD.EXAMPLE.COM
 User logins: ad_user@ad.example.com
----------------------------
Number of entries returned 1
----------------------------</pre></li></ol></div><p>
					The output confirms that you have certificate mapping data added to <code class="literal">ad_user@ad.example.com</code> and that a corresponding mapping rule defined in <a class="link" href="#conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map" title="10.8. Configuring certificate mapping if AD user entry contains no certificate or mapping data">Adding a certificate mapping rule if the AD user entry contains no certificate or mapping data</a> exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as <code class="literal">ad_user@ad.example.com</code>.
				</p><div class="_additional-resources _additional-resources"><p class="title"><strong>Additional resources</strong></p><p>
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/assembly_using-id-views-for-active-directory-users_managing-users-groups-hosts">Using ID views for Active Directory users</a>
					</p></div></section></section><section class="section" id="sc-cert-mapping-rule-examples_conf-certmap-for-ad-map"><div class="titlepage"><div><div><h3 class="title">10.9. Combining several identity mapping rules into one</h3></div></div></div><p class="_abstract _abstract">
				To combine several identity mapping rules into one combined rule, use the <code class="literal">|</code> (or) character to precede the individual mapping rules, and separate them using <code class="literal">()</code> brackets, for example:
			</p><div class="formalpara"><p class="title"><strong>Certificate mapping filter example 1</strong></p><p>

</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa certmaprule-add ad_cert_for_ipa_and_ad_users \ --maprule='(|(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}))' \ --matchrule='&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' \ --domain=ad.example.com</strong></span></pre>

				<p></p></div><p>
				In the above example, the filter definition in the <code class="literal option">--maprule</code> option includes these criteria:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500}</code> is a filter that links the subject and issuer from a smart card certificate to the value of the <code class="literal">ipacertmapdata</code> attribute in an IdM user account, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#proc-add-maprule-cli_conf-certmap-for-users-in-idm">Adding a certificate mapping rule in IdM</a>
					</li><li class="listitem">
						<code class="literal">altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}</code> is a filter that links the subject and issuer from a smart card certificate to the value of the <code class="literal">altSecurityIdentities</code> attribute in an AD user account, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-ad-map_conf-certmap-idm">Adding a certificate mapping rule if the trusted AD domain is configured to map user certificates</a>
					</li><li class="listitem">
						The addition of the <code class="literal">--domain=ad.example.com</code> option means that users mapped to a given certificate are not only searched in the local <code class="literal">idm.example.com</code> domain but also in the <code class="literal">ad.example.com</code> domain
					</li></ul></div><p>
				The filter definition in the <code class="literal option">--maprule</code> option accepts the logical operator <code class="literal">|</code> (or), so that you can specify multiple criteria. In this case, the rule maps all user accounts that meet at least one of the criteria.
			</p><div class="formalpara"><p class="title"><strong>Certificate mapping filter example 2</strong></p><p>

</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa certmaprule-add ipa_cert_for_ad_users</strong></span> \
  <span class="strong strong"><strong>--maprule='(|(userCertificate;binary={cert!bin})(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}))'</strong></span> \
  <span class="strong strong"><strong>--matchrule='&lt;ISSUER&gt;CN=Certificate Authority,O=REALM.EXAMPLE.COM'</strong></span> \
  <span class="strong strong"><strong>--domain=idm.example.com --domain=ad.example.com</strong></span></pre>

				<p></p></div><p>
				In the above example, the filter definition in the <code class="literal option">--maprule</code> option includes these criteria:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">userCertificate;binary={cert!bin}</code> is a filter that returns user entries that include the whole certificate. For AD users, creating this type of filter is described in detail in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map">Adding a certificate mapping rule if the AD user entry contains no certificate or mapping data</a>.
					</li><li class="listitem">
						<code class="literal">ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500}</code> is a filter that links the subject and issuer from a smart card certificate to the value of the <code class="literal">ipacertmapdata</code> attribute in an IdM user account, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-users-in-idm_conf-certmap-idm">Adding a certificate mapping rule in IdM</a>.
					</li><li class="listitem">
						<code class="literal">altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}</code> is a filter that links the subject and issuer from a smart card certificate to the value of the <code class="literal">altSecurityIdentities</code> attribute in an AD user account, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-ad-map_conf-certmap-idm">Adding a certificate mapping rule if the trusted AD domain is configured to map user certificates</a>.
					</li></ul></div><p>
				The filter definition in the <code class="literal option">--maprule</code> option accepts the logical operator <code class="literal">|</code> (or), so that you can specify multiple criteria. In this case, the rule maps all user accounts that meet at least one of the criteria.
			</p></section><section class="section _additional-resources" id="additional_resources_3"><div class="titlepage"><div><div><h3 class="title">10.10. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">sss-certmap(5)</code> man page on your system
					</li></ul></div></section></section><section class="chapter" id="dc-web-ui-auth_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 11. Configuring authentication with a certificate stored on the desktop of an IdM client</h2></div></div></div><p class="_abstract _abstract">
			By configuring Identity Management (IdM), IdM system administrators can enable users to authenticate to the IdM web UI and command-line interface (CLI) using a certificate that a Certificate Authority (CA) has issued to the users. The certificate is stored on the desktop of an IdM client.
		</p><p>
			The web browser can run on a system that is not part of the IdM domain.
		</p><p>
			Note the following while configuring authentication with a certificate:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					you can skip <a class="link" href="#requesting-and-exporting-a-user-certificate_dc-web-ui-auth" title="11.2. Requesting a new user certificate and exporting it to the client">Requesting a new user certificate and exporting it to the client</a> if the user you want to authenticate using a certificate already has a certificate;
				</li><li class="listitem">
					you can skip <a class="link" href="#proc_making-sure-the-certificate-and-user-are-linked-together_dc-web-ui-auth" title="11.3. Making sure the certificate and user are linked together">Making sure the certificate and user are linked together</a> if the user’s certificate has been issued by the IdM CA.
				</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
				Only Identity Management users can log into the web UI using a certificate. Active Directory users can log in with their user name and password.
			</p></div></rh-alert><section class="section" id="cert-idm-users-auth-preparing-the-server_dc-web-ui-auth"><div class="titlepage"><div><div><h3 class="title">11.1. Configuring the Identity Management Server for Certificate Authentication in the Web UI</h3></div></div></div><p class="_abstract _abstract">
				As an Identity Management (IdM) administrator, you can allow users to use certificates to authenticate to your IdM environment.
			</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					As the Identity Management administrator:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On an Identity Management server, obtain administrator privileges and create a shell script to configure the server.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Run the <code class="literal command">ipa-advise config-server-for-smart-card-auth</code> command, and save its output to a file, for example <code class="literal replaceable">server_certificate_script.sh</code>:
							</p><pre class="literallayout"># kinit admin
# ipa-advise config-server-for-smart-card-auth &gt; <code class="literal replaceable">server_certificate_script.sh</code></pre></li><li class="listitem"><p class="simpara">
								Add execute permissions to the file using the <code class="literal">chmod</code> utility:
							</p><pre class="literallayout"># chmod +x <code class="literal replaceable">server_certificate_script.sh</code></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						On all the servers in the Identity Management domain, run the <code class="literal replaceable">server_certificate_script.sh</code> script
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								with the path of the IdM Certificate Authority certificate, <code class="literal filename">/etc/ipa/ca.crt</code>, as input if the IdM CA is the only certificate authority that has issued the certificates of the users you want to enable certificate authentication for:
							</p><pre class="literallayout"># <code class="literal replaceable">./server_certificate_script.sh</code> <code class="literal filename">/etc/ipa/ca.crt</code></pre></li><li class="listitem"><p class="simpara">
								with the paths leading to the relevant CA certificates as input if different external CAs signed the certificates of the users who you want to enable certificate authentication for:
							</p><pre class="literallayout"># <code class="literal replaceable">./server_certificate_script.sh</code> <code class="literal replaceable">/tmp/ca1.pem</code> <code class="literal replaceable">/tmp/ca2.pem</code></pre></li></ol></div></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Do not forget to run the script on each new replica that you add to the system in the future if you want to have certificate authentication for users enabled in the whole topology.
				</p></div></rh-alert></section><section class="section" id="requesting-and-exporting-a-user-certificate_dc-web-ui-auth"><div class="titlepage"><div><div><h3 class="title">11.2. Requesting a new user certificate and exporting it to the client</h3></div></div></div><p class="_abstract _abstract">
				As an Identity Management (IdM) administrator, you can create certificates for users in your IdM environment and export them to the IdM clients on which you want to enable certificate authentication for users.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You do not need to follow this procedure if the user you want to authenticate using a certificate already has a certificate.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Create a new directory, for example <code class="literal replaceable">~/certdb/</code>, and make it a temporary certificate database. When asked, create an NSS Certificate DB password to encrypt the keys to the certificate to be generated in a subsequent step:
					</p><pre class="literallayout"># mkdir <code class="literal replaceable">~/certdb/</code>
# certutil -N -d <code class="literal replaceable">~/certdb/</code>
Enter a password which will be used to encrypt your keys.
The password should be at least 8 characters long,
and should contain at least one non-alphabetic character.

Enter new password:
Re-enter password:</pre></li><li class="listitem"><p class="simpara">
						Create the certificate signing request (CSR) and redirect the output to a file. For example, to create a CSR with the name <code class="literal replaceable">certificate_request.csr</code> for a <code class="literal replaceable">4096</code> bit certificate for the <code class="literal replaceable">idm_user</code> user in the <code class="literal replaceable">IDM.EXAMPLE.COM</code> realm, setting the nickname of the certificate private keys to <code class="literal replaceable">idm_user</code> for easy findability, and setting the subject to <code class="literal replaceable">CN=idm_user,O=IDM.EXAMPLE.COM</code>:
					</p><pre class="literallayout"># certutil -R -d <code class="literal replaceable">~/certdb/</code> -a -g <code class="literal replaceable">4096</code> -n <code class="literal replaceable">idm_user</code> -s "CN=<code class="literal replaceable">idm_user</code>,O=IDM.EXAMPLE.COM" &gt; <code class="literal replaceable">certificate_request.csr</code></pre></li><li class="listitem"><p class="simpara">
						When prompted, enter the same password that you entered when using <code class="literal systemitem">certutil</code> to create the temporary database. Then continue typing randlomly until told to stop:
					</p><pre class="literallayout">Enter Password or Pin for "NSS Certificate DB":

A random seed must be generated that will be used in the
creation of your key.  One of the easiest ways to create a
random seed is to use the timing of keystrokes on a keyboard.

To begin, type keys on the keyboard until this progress meter
is full.  DO NOT USE THE AUTOREPEAT FUNCTION ON YOUR KEYBOARD!


Continue typing until the progress meter is full:</pre></li><li class="listitem"><p class="simpara">
						Submit the certificate request file to the server. Specify the Kerberos principal to associate with the newly-issued certificate, the output file to store the certificate, and optionally the certificate profile. For example, to obtain a certificate of the <code class="literal replaceable">IECUserRoles</code> profile, a profile with added user roles extension, for the <code class="literal replaceable">idm_user</code>@<code class="literal replaceable">IDM.EXAMPLE.COM</code> principal, and save it in the <code class="literal replaceable">~/idm_user.pem</code> file:
					</p><pre class="literallayout"># ipa cert-request <code class="literal replaceable">certificate_request.csr</code> --principal=<code class="literal replaceable">idm_user</code>@<code class="literal replaceable">IDM.EXAMPLE.COM</code> --profile-id=<code class="literal replaceable">IECUserRoles</code> --certificate-out=<code class="literal replaceable">~/idm_user.pem</code></pre></li><li class="listitem"><p class="simpara">
						Add the certificate to the NSS database. Use the <code class="literal option">-n</code> option to set the same nickname that you used when creating the CSR previously so that the certificate matches the private key in the NSS database. The <code class="literal option">-t</code> option sets the trust level. For details, see the certutil(1) man page. The <code class="literal option">-i</code> option specifies the input certificate file. For example, to add to the NSS database a certificate with the <code class="literal replaceable">idm_user</code> nickname that is stored in the <code class="literal replaceable">~/idm_user.pem</code> file in the <code class="literal replaceable">~/certdb/</code> database:
					</p><pre class="literallayout"># certutil -A -d <code class="literal replaceable">~/certdb/</code> -n <code class="literal replaceable">idm_user</code> -t "P,," -i <code class="literal replaceable">~/idm_user.pem</code></pre></li><li class="listitem"><p class="simpara">
						Verify that the key in the NSS database does not show <code class="literal replaceable">(orphan)</code> as its nickname. For example, to verify that the certificate stored in the <code class="literal replaceable">~/certdb/</code> database is not orphaned:
					</p><pre class="literallayout"># certutil -K -d <code class="literal replaceable">~/certdb/</code>
&lt; 0&gt; rsa      5ad14d41463b87a095b1896cf0068ccc467df395   <span class="strong strong"><strong>NSS Certificate DB:idm_user</strong></span></pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal command">pk12util</code> command to export the certificate from the NSS database to the PKCS12 format. For example, to export the certificate with the <code class="literal replaceable">idm_user</code> nickname from the <code class="literal filename">/root/certdb</code> NSS database into the <code class="literal replaceable">~/idm_user.p12</code> file:
					</p><pre class="literallayout"># pk12util -d <code class="literal filename">~/certdb</code> -o <code class="literal replaceable">~/idm_user.p12</code> -n <code class="literal replaceable">idm_user</code>
Enter Password or Pin for "NSS Certificate DB":
Enter password for PKCS12 file:
Re-enter password:
pk12util: PKCS12 EXPORT SUCCESSFUL</pre></li><li class="listitem"><p class="simpara">
						Transfer the certificate to the host on which you want the certificate authentication for <code class="literal replaceable">idm_user</code> to be enabled:
					</p><pre class="literallayout"># scp <code class="literal replaceable">~/idm_user.p12</code> <code class="literal replaceable">idm_user@client.idm.example.com:/home/idm_user/</code></pre></li><li class="listitem"><p class="simpara">
						On the host to which the certificate has been transferred, make the directory in which the .pkcs12 file is stored inaccessible to the 'other' group for security reasons:
					</p><pre class="literallayout"># chmod o-rwx <code class="literal replaceable">/home/idm_user/</code></pre></li><li class="listitem"><p class="simpara">
						For security reasons, remove the temporary NSS database and the .pkcs12 file from the server:
					</p><pre class="literallayout"># rm <code class="literal replaceable">~/certdb/</code>
# rm <code class="literal replaceable">~/idm_user.p12</code></pre></li></ol></div></section><section class="section" id="proc_making-sure-the-certificate-and-user-are-linked-together_dc-web-ui-auth"><div class="titlepage"><div><div><h3 class="title">11.3. Making sure the certificate and user are linked together</h3></div></div></div><rh-alert class="admonition note _abstract" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You do not need to follow this procedure if the user’s certificate has been issued by the IdM CA.
				</p></div></rh-alert><p>
				For certificate authentication to work, you need to make sure that the certificate is linked to the user that will use it to authenticate to Identity Management (IdM).
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						If the certificate is provided by a Certificate Authority that is not part of your Identity Management environment, link the user and the certificate following the procedure described in <a class="link" href="#conf-certmap-for-users-in-idm_conf-certmap-idm" title="10.4. Configuring certificate mapping for users stored in IdM">Linking User Accounts to Certificates</a>.
					</li><li class="listitem">
						If the certificate is provided by Identity Management CA, the certificate is already automatically added in the user entry and you do not have to link the certificate to the user account. For details on creating a new certificate in IdM, see <a class="link" href="#requesting-and-exporting-a-user-certificate_dc-web-ui-auth" title="11.2. Requesting a new user certificate and exporting it to the client">Requesting a new user certificate and exporting it to the client</a>.
					</li></ul></div></section><section class="section" id="configuring-browser-for-cert-auth_dc-web-ui-auth"><div class="titlepage"><div><div><h3 class="title">11.4. Configuring a browser to enable certificate authentication</h3></div></div></div><p class="_abstract _abstract">
				To be able to authenticate with a certificate when using the WebUI to log into Identity Management (IdM), you need to import the user and the relevant certificate authority (CA) certificates into the Mozilla Firefox or Google Chrome browser. The host itself on which the browser is running does not have to be part of the IdM domain.
			</p><p>
				IdM supports the following browsers for connecting to the WebUI:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Mozilla Firefox 38 and later
					</li><li class="listitem">
						Google Chrome 46 and later
					</li></ul></div><p>
				The following procedure shows how to configure the Mozilla Firefox 57.0.1 browser.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the <a class="link" href="#requesting-and-exporting-a-user-certificate_dc-web-ui-auth" title="11.2. Requesting a new user certificate and exporting it to the client">user certificate</a> that you want to import to the browser at your disposal in the PKCS#12 format.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open Firefox, then navigate to <code class="literal gui">Preferences</code> → <code class="literal gui">Privacy &amp; Security</code>.
					</p><div class="figure" id="privacy-security_dc-web-ui-auth"><p class="title"><strong>Figure 11.1. Privacy and Security section in Preferences</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/c69e139faf91acb67d6b6a7faa65b410/privacy_and_security.png" alt="Screenshot of the Firefox settings page and the &quot;Privacy &amp; Security&quot; option is highlighted."></div></div></div></li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">View Certificates</span>.
					</p><div class="figure" id="view-certificates_dc-web-ui-auth"><p class="title"><strong>Figure 11.2. View Certificates in Privacy and Security</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/aa5fb25b2f4b3061fe69192d0af19b1c/view_certificates.png" alt="A screenshot of the &quot;Certificates&quot; section and the &quot;View Certificates&quot; button at the bottom right is highlighted."></div></div></div></li><li class="listitem">
						In the <code class="literal gui">Your Certificates</code> tab, click <span class="guibutton">Import</span>. Locate and open the certificate of the user in the PKCS12 format, then click <span class="guibutton">OK</span> and <span class="guibutton">OK</span>.
					</li><li class="listitem"><p class="simpara">
						Make sure that the Identity Management Certificate Authority is recognized by Firefox as a trusted authority:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Save the IdM CA certificate locally:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Navigate to the IdM web UI by writing the name of your IdM server in the Firefox address bar. Click <code class="literal gui">Advanced</code> on the Insecure Connection warning page.
									</p><div class="figure" id="connection-not-secure-idm_dc-web-ui-auth"><p class="title"><strong>Figure 11.3. Insecure Connection</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/3aeddaa6fb1e422625f6a9c6acf7427d/connection-not-secure-idm.png" alt="A screenshot of a warning dialog box with the title &quot;Your connection is not secure.&quot; The error message says &quot;The owner of idm.lab.example.net has configured their website improperly. To protect your information from being stolen Firefox has not connected to this website.&quot; There are two buttons below the error message: &quot;Go Back&quot; and &quot;Advanced.&quot; The &quot;Advanced&quot; button has been highlighted."></div></div></div></li><li class="listitem"><p class="simpara">
										<code class="literal gui">Add Exception</code>. Click <code class="literal gui">View</code>.
									</p><div class="figure" id="view-ca-certificate-idm_dc-web-ui-auth"><p class="title"><strong>Figure 11.4. View the Details of a Certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/a658b28045cc4481f8235356c39ed8d3/view-ca-certificate-idm.png" alt="A screenshot showing a text entry field for &quot;Location&quot; with the URL for the IdM Web UI and a &quot;Certificate Status&quot; entry labeled as &quot;This site attempts to identify itself with invalid information.&quot; A &quot;View&quot; button to the right has been highlighted."></div></div></div></li><li class="listitem"><p class="simpara">
										In the <code class="literal gui">Details</code> tab, highlight the <code class="literal gui">Certificate Authority</code> fields.
									</p><div class="figure" id="exporting-ca-cert-idm_dc-web-ui-auth"><p class="title"><strong>Figure 11.5. Exporting the CA Certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/59d8bc504687f45d88843d1512904c15/exporting-ca-cert-idm.png" alt="A screenshot displaying information for the idm.lab.example.net Certificate Authority. &quot;Certificate Authority&quot; has been highlighted in the &quot;Certificate Fields&quot; expanding tree. The &quot;Export…​&quot; button at the bottom has also been highlighted."></div></div></div></li><li class="listitem">
										Click <span class="guibutton">Export</span>. Save the CA certificate, for example as the <code class="literal filename">CertificateAuthority.crt</code> file, then click <span class="guibutton">Close</span>, and <span class="guibutton">Cancel</span>.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Import the IdM CA certificate to Firefox as a trusted certificate authority certificate:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Open Firefox, navigate to Preferences and click <span class="guibutton">Privacy &amp; Security</span>.
									</p><div class="figure" id="privacy-security-2_dc-web-ui-auth"><p class="title"><strong>Figure 11.6. Privacy and Security section in Preferences</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/c69e139faf91acb67d6b6a7faa65b410/privacy_and_security.png" alt="Screenshot of the Firefox settings page. The &quot;Privacy &amp; Security&quot; option is highlighted."></div></div></div></li><li class="listitem"><p class="simpara">
										Click <span class="guibutton">View Certificates</span>.
									</p><div class="figure" id="view-certificates-2_dc-web-ui-auth"><p class="title"><strong>Figure 11.7. View Certificates in Privacy and Security</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/aa5fb25b2f4b3061fe69192d0af19b1c/view_certificates.png" alt="A screenshot of the &quot;Certificates&quot; section. The &quot;View Certificates&quot; button at the bottom right is highlighted."></div></div></div></li><li class="listitem">
										In the <code class="literal gui">Authorities</code> tab, click <span class="guibutton">Import</span>. Locate and open the CA certificate that you saved in the previous step in the <code class="literal filename">CertificateAuthority.crt</code> file. Trust the certificate to identify websites, then click <span class="guibutton">OK</span> and <span class="guibutton">OK</span>.
									</li></ul></div></li></ol></div></li><li class="listitem">
						Continue to <a class="link" href="#cert-idm-users-auth-procedure_dc-web-ui-auth" title="11.5. Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User">Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User</a>.
					</li></ol></div></section><section class="section" id="cert-idm-users-auth-procedure_dc-web-ui-auth"><div class="titlepage"><div><div><h3 class="title">11.5. Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to authenticate as a user to the Identity Management (IdM) web UI using a certificate stored on the desktop of an Identity Management client.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the browser, navigate to the Identity Management web UI at, for example, <code class="literal">https:</code>//<code class="literal">server.idm.example.com/ipa/ui</code>.
					</li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">Login Using Certificate</span>.
					</p><div class="figure" id="idm140333357506096"><p class="title"><strong>Figure 11.8. <span class="guibutton">Login Using Certificate</span> in the Identity Management web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/af9fb598140f6857d0dfaf5408f3e2e9/smart_card_login.png" alt="Screenshot of the Identity Management Web UI login page highlighting the &quot;Login Using Certificate&quot; button below the password prompt"></div></div></div></li><li class="listitem">
						The user’s certificate should already be selected. Uncheck <span class="guibutton">Remember this decision</span>, then click <span class="guibutton">OK</span>.
					</li></ol></div><p>
				You are now authenticated as the user who corresponds to the certificate.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication">Configuring Identity Management for smart card authentication</a>
					</li></ul></div></section><section class="section" id="authenticating-idm-cli-user-certificate_dc-web-ui-auth"><div class="titlepage"><div><div><h3 class="title">11.6. Configuring an IdM client to enable authenticating to the CLI using a certificate</h3></div></div></div><p class="_abstract _abstract">
				To make certificate authentication work for an IdM user in the Command Line Interface (CLI) of your IdM client, import the IdM user’s certificate and the private key to the IdM client. For details on creating and transferring the user certificate, see <a class="link" href="#requesting-and-exporting-a-user-certificate_dc-web-ui-auth" title="11.2. Requesting a new user certificate and exporting it to the client">Requesting a new user certificate and exporting it to the client</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Log into the IdM client and have the .p12 file containing the user’s certificate and the private key ready. To obtain and cache the Kerberos ticket granting ticket (TGT), run the <code class="literal command">kinit</code> command with the user’s principal, using the <code class="literal replaceable">-X</code> option with the <code class="literal replaceable">X509_username:/path/to/file.p12</code> attribute to specify where to find the user’s X509 identity information. For example, to obtain the TGT for <code class="literal replaceable">idm_user</code> using the user’s identity information stored in the <code class="literal replaceable">~/idm_user.p12</code> file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit -X X509_idm_user='PKCS12:~/idm_user.p12' idm_user</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							The command also supports the .pem file format: <span class="strong strong"><strong>kinit -X X509_username='FILE:/path/to/cert.pem,/path/to/key' user_principal</strong></span>
						</p></div></rh-alert></li></ul></div></section></section><section class="chapter" id="ipa-ca-renewal_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 12. Using IdM CA renewal server</h2></div></div></div><section class="section" id="ca-renewal-server_ipa-ca-renewal"><div class="titlepage"><div><div><h3 class="title">12.1. Explanation of IdM CA renewal server</h3></div></div></div><p class="_abstract _abstract">
				In an Identity Management (IdM) deployment that uses an embedded certificate authority (CA), the CA renewal server maintains and renews IdM system certificates. It ensures robust IdM deployments.
			</p><p>
				IdM system certificates include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">IdM CA</code> certificate
					</li><li class="listitem">
						<code class="literal">OCSP</code> signing certificate
					</li><li class="listitem">
						<code class="literal">IdM CA subsystem</code> certificates
					</li><li class="listitem">
						<code class="literal">IdM CA audit signing</code> certificate
					</li><li class="listitem">
						<code class="literal">IdM renewal agent</code> (RA) certificate
					</li><li class="listitem">
						<code class="literal">KRA</code> transport and storage certificates
					</li></ul></div><p>
				What characterizes system certificates is that their keys are shared by all CA replicas. In contrast, the IdM service certificates (for example, <code class="literal">LDAP</code>, <code class="literal">HTTP</code> and <code class="literal">PKINIT</code> certificates), have different keypairs and subject names on different IdM CA servers.
			</p><p>
				In IdM topology, by default, the first IdM CA server is the CA renewal server.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					In upstream documentation, the IdM CA is called <code class="literal">Dogtag</code>.
				</p></div></rh-alert><div class="formalpara"><p class="title"><strong>The role of the CA renewal server</strong></p><p>
					The <code class="literal">IdM CA</code>, <code class="literal">IdM CA subsystem</code>, and <code class="literal">IdM RA</code> certificates are crucial for IdM deployment. Each certificate is stored in an NSS database in the <code class="literal">/etc/pki/pki-tomcat/</code> directory and also as an LDAP database entry. The certificate stored in LDAP must match the certificate stored in the NSS database. If they do not match, authentication failures occur between the IdM framework and IdM CA, and between IdM CA and LDAP.
				</p></div><p>
				All IdM CA replicas have tracking requests for every system certificate. If an IdM deployment with integrated CA does not contain a CA renewal server, each IdM CA server requests the renewal of system certificates independently. This results in different CA replicas having various system certificates and authentication failures occurring.
			</p><p>
				Appointing one CA replica as the renewal server allows the system certificates to be renewed exactly once, when required, and thus prevents authentication failures.
			</p><div class="formalpara"><p class="title"><strong>The role of the <code class="literal">certmonger</code> service on CA replicas</strong></p><p>
					The <code class="literal">certmonger</code> service running on all IdM CA replicas uses the <code class="literal">dogtag-ipa-ca-renew-agent</code> renewal helper to keep track of IdM system certificates. The renewal helper program reads the CA renewal server configuration. On each CA replica that is not the CA renewal server, the renewal helper retrieves the latest system certificates from the <code class="literal">ca_renewal</code> LDAP entries. Due to non-determinism in when exactly <code class="literal">certmonger</code> renewal attempts occur, the <code class="literal">dogtag-ipa-ca-renew-agent</code> helper sometimes attempts to update a system certificate before the CA renewal server has actually renewed the certificate. If this happens, the old, soon-to-expire certificate is returned to the <code class="literal">certmonger</code> service on the CA replica. The <code class="literal">certmonger</code> service, realizing it is the same certificate that is already stored in its database, keeps attempting to renew the certificate with some delay between individual attempts until it can retrieve the updated certificate from the CA renewal server.
				</p></div><div class="formalpara"><p class="title"><strong>The correct functioning of IdM CA renewal server</strong></p><p>
					An IdM deployment with an embedded CA is an IdM deployment that was installed with an IdM CA - or whose IdM CA server was installed later. An IdM deployment with an embedded CA must at all times have exactly one CA replica configured as the renewal server. The renewal server must be online and fully functional, and must replicate properly with the other servers.
				</p></div><p>
				If the current CA renewal server is being deleted using the <code class="literal">ipa server-del</code>, <code class="literal">ipa-replica-manage del</code>, <code class="literal">ipa-csreplica-manage del</code> or <code class="literal">ipa-server-install --uninstall</code> commands, another CA replica is automatically assigned as the CA renewal server. This policy ensures that the renewal server configuration remains valid.
			</p><p>
				This policy does not cover the following situations:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Offline renewal server</strong></span>
					</p><p class="simpara">
						If the renewal server is offline for an extended duration, it may miss a renewal window. In this situation, all nonrenewal CA servers keep reinstalling the current system certificates until the certificates expire. When this occurs, the IdM deployment is disrupted because even one expired certificate can cause renewal failures for other certificates.
					</p></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Replication problems</strong></span>
					</p><p class="simpara">
						If replication problems exist between the renewal server and other CA replicas, renewal might succeed, but the other CA replicas might not be able to retrieve the updated certificates before they expire.
					</p><p class="simpara">
						To prevent this situation, make sure that your replication agreements are working correctly. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/linux_domain_identity_authentication_and_policy_guide/trouble-gen-replication">general</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/linux_domain_identity_authentication_and_policy_guide/trouble-replica">specific</a> replication troubleshooting guidelines in the RHEL 7 <span class="emphasis"><em>Linux Domain Identity, Authentication, and Policy Guide</em></span>.
					</p></li></ul></div></section><section class="section" id="changing-ca-renewal_ipa-ca-renewal"><div class="titlepage"><div><div><h3 class="title">12.2. Changing and resetting IdM CA renewal server</h3></div></div></div><p class="_abstract _abstract">
				When a certificate authority (CA) renewal server is being decommissioned, Identity Management (IdM) automatically selects a new CA renewal server from the list of IdM CA servers. The system administrator cannot influence the selection.
			</p><p>
				To be able to select the new IdM CA renewal server, the system administrator must perform the replacement manually. Choose the new CA renewal server before starting the process of decommissioning the current renewal server.
			</p><p>
				If the current CA renewal server configuration is invalid, reset the IdM CA renewal server.
			</p><p>
				Complete this procedure to change or reset the CA renewal server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the IdM administrator credentials.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Obtain the IdM administrator credentials:
					</p><pre class="literallayout">~]$ <span class="strong strong"><strong>kinit admin</strong></span>
Password for admin@IDM.EXAMPLE.COM:</pre></li><li class="listitem"><p class="simpara">
						Optional: To find out which IdM servers in the deployment have the CA role necessary to be eligible to become the new CA renewal server:
					</p><pre class="literallayout">~]$ <span class="strong strong"><strong>ipa server-role-find --role 'CA server'</strong></span>
----------------------
2 server roles matched
----------------------
  Server name: server.idm.example.com
  Role name: <span class="strong strong"><strong>CA server</strong></span>
  Role status: enabled

  Server name: replica.idm.example.com
  Role name: <span class="strong strong"><strong>CA server</strong></span>
  Role status: enabled
----------------------------
Number of entries returned 2
----------------------------</pre><p class="simpara">
						There are two CA servers in the deployment.
					</p></li><li class="listitem"><p class="simpara">
						Optionall: To find out which CA server is the current CA renewal server, enter:
					</p><pre class="literallayout">~]$ <span class="strong strong"><strong>ipa config-show | grep 'CA renewal'</strong></span>
  IPA CA renewal master: server.idm.example.com</pre><p class="simpara">
						The current renewal server is <code class="literal">server.idm.example.com</code>.
					</p></li><li class="listitem"><p class="simpara">
						To change the renewal server configuration, use the <code class="literal">ipa config-mod</code> utility with the <code class="literal">--ca-renewal-master-server</code> option:
					</p><pre class="literallayout">~]$ <span class="strong strong"><strong>ipa config-mod --ca-renewal-master-server replica.idm.example.com | grep 'CA renewal'</strong></span>
  IPA CA renewal master: replica.idm.example.com</pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							You can also switch to a new CA renewal server using:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The <code class="literal">ipa-cacert-manage --renew</code> command. This command both renews the CA certificate <span class="emphasis"><em>and</em></span> makes the CA server on which you execute the command the new CA renewal server.
								</li><li class="listitem"><p class="simpara">
									The <code class="literal">ipa-cert-fix</code> command. This command recovers the deployment when expired certificates are causing failures. It also makes the CA server on which you execute the command the new CA renewal server.
								</p><p class="simpara">
									For details, see <a class="link" href="#renewing-expired-system-certificates-on-a-ca_renewing-expired-system-certificates-when-idm-is-offline" title="14.1. Renewing expired system certificates on a CA renewal server">Renewing expired system certificates when IdM is offline</a>.
								</p></li></ul></div></div></rh-alert></li></ol></div></section></section><section class="chapter" id="managing-externally-signed-ca-certificates_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 13. Managing externally-signed CA certificates</h2></div></div></div><p class="_abstract _abstract">
			Identity Management (IdM) provides different types of certificate authority (CA) configurations. You can chose to install IdM with an integrated CA or with an external CA. You must specify the type of CA you are using during the installation. However, once installed you can move from an externally-signed CA to a self-signed CA and vice versa. Additionally, while a self-signed CA is automatically renewed, you must ensure that you renew your externally-signed CA certificate. Refer to the relevant sections as required to manage your externally-signed CA certificates.
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					Installing IdM with an externally-signed CA:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-ipa-server-with-external-ca_installing-identity-management">Installing an IdM server with integrated DNS and with an external CA as the root CA.</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_installing-an-ipa-server-without-dns-with-external-ca_installing-identity-management">Installing an IdM server without integrated DNS and with an external CA as the root CA.</a>
						</li></ul></div></li><li class="listitem">
					<a class="link" href="#switch-from-externally-to-self-signed-ca_managing-externally-signed-ca-certificates" title="13.1. Switching from an externally-signed to a self-signed CA in IdM">Switching from an externally-signed CA to a self-signed CA.</a>
				</li><li class="listitem">
					<a class="link" href="#switching-from-a-self-signed-to-an-externally-signed-ca-in-idm_managing-externally-signed-ca-certificates" title="13.2. Switching from a self-signed to an externally-signed CA in IdM">Switching from a self-signed CA to an externally-signed CA.</a>
				</li><li class="listitem">
					<a class="link" href="#renew-with-externally-signed-CA_managing-externally-signed-ca-certificates" title="13.3. Renewing the IdM CA renewal server certificate using an external CA">Renewing the externally-signed CA certificate.</a>
				</li></ul></div><section class="section" id="switch-from-externally-to-self-signed-ca_managing-externally-signed-ca-certificates"><div class="titlepage"><div><div><h3 class="title">13.1. Switching from an externally-signed to a self-signed CA in IdM</h3></div></div></div><p class="_abstract _abstract">
				Complete this procedure to switch from an externally-signed to a self-signed certificate of the Identity Management (IdM) certificate authority (CA). With a self-signed CA, the renewal of the CA certificate is managed automatically: a system administrator does not need to submit a certificate signing request (CSR) to an external authority.
			</p><p>
				Switching from an externally-signed to a self-signed CA replaces only the CA certificate. The certificates signed by the previous CA are still valid and still in use. For example, the certificate chain for the <code class="literal">LDAP</code> certificate remains unchanged even after you have moved to a self-signed CA:
			</p><pre class="literallayout"><code class="literal">external_CA</code> certificate &gt; <code class="literal">IdM CA</code> certificate &gt; <code class="literal">LDAP</code> certificate</pre><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> access to the IdM CA renewal server and all IdM clients and servers.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the IdM CA renewal server, renew the CA certificate as self-signed:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-cacert-manage renew --self-signed</strong></span>
Renewing CA certificate, please wait
CA certificate successfully renewed
The ipa-cacert-manage command was successful</pre></li><li class="listitem"><p class="simpara">
						<code class="literal">SSH</code> to all the remaining IdM servers and clients as <code class="literal">root</code>. For example:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ssh root@idmclient01.idm.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
						On the IdM client, update the local IdM certificate databases with the certificates from the server:
					</p><pre class="literallayout">[idmclient01 ~]# <span class="strong strong"><strong>ipa-certupdate</strong></span>
Systemwide CA database updated.
Systemwide CA database updated.
The ipa-certupdate command was successful</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To check if your update has been successful and the new CA certificate has been added to the <code class="literal">/etc/ipa/ca.crt</code> file:
					</p><pre class="literallayout">[idmclient01 ~]$ <span class="strong strong"><strong>openssl crl2pkcs7 -nocrl -certfile /etc/ipa/ca.crt | openssl pkcs7 -print_certs -text -noout</strong></span>
[...]
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 39 (0x27)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: O=IDM.EXAMPLE.COM, CN=Certificate Authority
        Validity
            Not Before: Jul  1 16:32:45 2019 GMT
            Not After : Jul  1 16:32:45 2039 GMT
        Subject: O=IDM.EXAMPLE.COM, CN=Certificate Authority
[...]</pre><p class="simpara">
						The output shows that the update has been successful as the new CA certificate is listed with the older CA certificates.
					</p></li></ol></div></section><section class="section" id="switching-from-a-self-signed-to-an-externally-signed-ca-in-idm_managing-externally-signed-ca-certificates"><div class="titlepage"><div><div><h3 class="title">13.2. Switching from a self-signed to an externally-signed CA in IdM</h3></div></div></div><p class="_abstract _abstract">
				You can switch from a self-signed CA to an externally-signed CA in IdM. Once you switch to an externally-signed CA in IdM, your IdM CA server becomes a subCA of the external CA. Also, the renewal of the CA certificate is not managed automatically and a system administrator must submit a certificate signing request (CSR) to the external authority.
			</p><p>
				To switch to an externally-signed CA, a CSR must be signed by the external CA. Follow the steps in <a class="link" href="#renew-with-externally-signed-CA_managing-externally-signed-ca-certificates" title="13.3. Renewing the IdM CA renewal server certificate using an external CA">Renewing the IdM CA renewal server certificate using an external CA</a> to switch to a self-signed CA in IdM.
			</p></section><section class="section" id="renew-with-externally-signed-CA_managing-externally-signed-ca-certificates"><div class="titlepage"><div><div><h3 class="title">13.3. Renewing the IdM CA renewal server certificate using an external CA</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to renew the Identity Management (IdM) certificate authority (CA) certificate using an external CA to sign the certificate signing request (CSR). In this configuration, your IdM CA server is a subCA of the external CA. The external CA can, but does not have to, be an Active Directory Certificate Server (AD CS).
			</p><p>
				If the external certificate authority is AD CS, you can specify the template you want for the IdM CA certificate in the CSR. A certificate template defines the policies and rules that a CA uses when a certificate request is received. Certificate templates in AD correspond to certificate profiles in IdM.
			</p><p>
				You can define a specific AD CS template by its Object Identifier (OID). OIDs are unique numeric values issued by various issuing authorities to uniquely identify data elements, syntaxes, and other parts of distributed applications.
			</p><p>
				Alternatively, you can define a specific AD CS template by its name. For example, the name of the default profile used in a CSR submitted by an IdM CA to an AD CS is <code class="literal">subCA</code>.
			</p><p>
				To define a profile by specifying its OID or name in the CSR, use the <code class="literal">external-ca-profile</code> option. For details, see the <code class="literal">ipa-cacert-manage</code> man page on your system.
			</p><p>
				Apart from using a ready-made certificate template, you can also create a custom certificate template in the AD CS, and use it in the CSR.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root access to the IdM CA renewal server.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					Complete this procedure to renew the certificate of the IdM CA with external signing, regardless of whether current CA certificate is self-signed or externally-signed.
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a CSR to be submitted to the external CA:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If the external CA is an AD CS, use the <code class="literal">--external-ca-type=ms-cs</code> option. If you want a different template than the default <code class="literal">subCA</code> template, specify it using the <code class="literal">--external-ca-profile</code> option:
							</p><pre class="literallayout">~]# <code class="literal">ipa-cacert-manage renew --external-ca --external-ca-type=ms-cs [--external-ca-profile=PROFILE]</code>
Exporting CA certificate signing request, please wait
The next step is to get /var/lib/ipa/ca.csr signed by your CA and re-run ipa-cacert-manage as:
ipa-cacert-manage renew --external-cert-file=/path/to/signed_certificate --external-cert-file=/path/to/external_ca_certificate
The ipa-cacert-manage command was successful</pre></li><li class="listitem"><p class="simpara">
								If the external CA is not an AD CS:
							</p><pre class="literallayout">~]# <code class="literal">ipa-cacert-manage renew --external-ca</code>
Exporting CA certificate signing request, please wait
The next step is to get /var/lib/ipa/ca.csr signed by your CA and re-run ipa-cacert-manage as:
ipa-cacert-manage renew --external-cert-file=/path/to/signed_certificate --external-cert-file=/path/to/external_ca_certificate
The ipa-cacert-manage command was successful</pre><p class="simpara">
								The output shows that a CSR has been created and is stored in the <code class="literal">/var/lib/ipa/ca.csr</code> file.
							</p></li></ul></div></li><li class="listitem">
						Submit the CSR located in <code class="literal">/var/lib/ipa/ca.csr</code> to the external CA. The process differs depending on the service to be used as the external CA.
					</li><li class="listitem"><p class="simpara">
						Retrieve the issued certificate and the CA certificate chain for the issuing CA in a base 64-encoded blob, which is:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A PEM file if the external CA is not an AD CS.
							</li><li class="listitem"><p class="simpara">
								A Base_64 certificate if the external CA is an AD CS.
							</p><p class="simpara">
								The process differs for every certificate service. Usually, a download link on a web page or in the notification email allows the administrator to download all the required certificates.
							</p><p class="simpara">
								If the external CA is an AD CS and you have submitted the CSR with a known template through the Microsoft Windows Certification Authority management window, the AD CS issues the certificate immediately and the Save Certificate dialog appears in the AD CS web interface, asking where to save the issued certificate.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						Run the <code class="literal">ipa-cacert-manage renew</code> command again, adding all the CA certificate files required to supply a full certificate chain. Specify as many files as you need, using the <code class="literal">--external-cert-file</code> option multiple times:
					</p><pre class="literallayout">~]# <code class="literal">ipa-cacert-manage renew --external-cert-file=/path/to/signed_certificate --external-cert-file=/path/to/external_ca_certificate_1 --external-cert-file=/path/to/external_ca_certificate_2</code></pre></li><li class="listitem"><p class="simpara">
						On all the IdM servers and clients, update the local IdM certificate databases with the certificates from the server:
					</p><pre class="literallayout">[client ~]$ <span class="strong strong"><strong>ipa-certupdate</strong></span>
Systemwide CA database updated.
Systemwide CA database updated.
The ipa-certupdate command was successful</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To check if your update has been successful and the new CA certificate has been added to the <code class="literal">/etc/ipa/ca.crt</code> file:
					</p><pre class="literallayout">[client ~]$ <span class="strong strong"><strong>openssl crl2pkcs7 -nocrl -certfile /etc/ipa/ca.crt | openssl pkcs7 -print_certs -text -noout</strong></span>
[...]
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 39 (0x27)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: O=IDM.EXAMPLE.COM, CN=Certificate Authority
        Validity
            Not Before: Jul  1 16:32:45 2019 GMT
            Not After : Jul  1 16:32:45 2039 GMT
        Subject: O=IDM.EXAMPLE.COM, CN=Certificate Authority
[...]</pre><p class="simpara">
						The output shows that the update has been successful as the new CA certificate is listed with the older CA certificates.
					</p></li></ol></div></section></section><section class="chapter" id="renewing-expired-system-certificates-when-idm-is-offline_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 14. Renewing expired system certificates when IdM is offline</h2></div></div></div><p class="_abstract _abstract">
			If a system certificate has expired, Identity Management (IdM) fails to start. IdM supports renewing system certificates even in this situation by using the <code class="literal">ipa-cert-fix</code> tool.
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Ensure that the LDAP service is running by entering the <code class="literal">ipactl start --ignore-service-failures</code> command on the host.
				</li></ul></div><section class="section" id="renewing-expired-system-certificates-on-a-ca_renewing-expired-system-certificates-when-idm-is-offline"><div class="titlepage"><div><div><h3 class="title">14.1. Renewing expired system certificates on a CA renewal server</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to apply the <code class="literal">ipa-cert-fix</code> tool on expired IdM certificates.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					If you run the <code class="literal">ipa-cert-fix</code> tool on a CA (Certificate Authority) host that is not the CA renewal server, and the utility renews shared certificates, that host automatically becomes the new CA renewal server in the domain. There must always be only one CA renewal server in the domain to avoid inconsistencies.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Log in to the server with administration rights
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Optional: Backup the system. This is heavily recommended, as <code class="literal">ipa-cert-fix</code> makes irreversible changes to <code class="literal">nssdbs</code>. Because <code class="literal">ipa-cert-fix</code> also makes changes to the LDAP, it is recommended to backup the entire cluster as well.
					</li><li class="listitem"><p class="simpara">
						Start the <code class="literal">ipa-cert-fix</code> tool to analyze the system and list expired certificates that require renewal:
					</p><pre class="literallayout"># ipa-cert-fix
...
The following certificates will be renewed:

Dogtag sslserver certificate:
  Subject: CN=ca1.example.com,O=EXAMPLE.COM 201905222205
  Serial:  13
  Expires: 2019-05-12 05:55:47
...
Enter "yes" to proceed:</pre></li><li class="listitem"><p class="simpara">
						Enter <code class="literal">yes</code> to start the renewal process:
					</p><pre class="literallayout">Enter "yes" to proceed: true
Proceeding.
Renewed Dogtag sslserver certificate:
  Subject: CN=ca1.example.com,O=EXAMPLE.COM 201905222205
  Serial:  268369925
  Expires: 2021-08-14 02:19:33
...

Becoming renewal master.
The ipa-cert-fix command was successful</pre><p class="simpara">
						It can take up to one minute before <code class="literal">ipa-cert-fix</code> renews all expired certificates.
					</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that all services are now running:
					</p><pre class="literallayout"># ipactl status
Directory Service: RUNNING
krb5kdc Service: RUNNING
kadmin Service: RUNNING
httpd Service: RUNNING
ipa-custodia Service: RUNNING
pki-tomcatd Service: RUNNING
ipa-otpd Service: RUNNING
ipa: INFO: The ipactl command was successful</pre></li></ol></div><p>
				At this point, certificates have been renewed and services are running. The next step is to check other servers in the IdM domain.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If you need to repair certificates across multiple CA servers:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							After ensuring that LDAP replication is working across the topology, first run <code class="literal">ipa-cert-fix</code> on one CA server, according to the above procedure.
						</li><li class="listitem">
							Before you run <code class="literal">ipa-cert-fix</code> on another CA server, trigger Certmonger renewals for shared certificates via <code class="literal">getcert-resubmit</code> (on the other CA server), to avoid unnecessary renewal of shared certificates.
						</li></ol></div></div></rh-alert></section><section class="section" id="verifying-other-idm-servers-in-the-domain-after-renewal_renewing-expired-system-certificates-when-idm-is-offline"><div class="titlepage"><div><div><h3 class="title">14.2. Verifying other IdM servers in the IdM domain after renewal</h3></div></div></div><p class="_abstract _abstract">
				After the renewing the CA renewal server’s certificates with the <code class="literal">ipa-cert-fix</code> tool, you must:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Restart all other Identity Management (IdM) servers in the domain.
					</li><li class="listitem">
						Check if certmonger renewed certificates.
					</li><li class="listitem">
						If there are other Certificate Authority (CA) replicas with expired system certificates, renew those certificates with the <code class="literal">ipa-cert-fix</code> tool as well.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Log in to the server with administration rights.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Restart IdM with the <code class="literal">--force</code> parameter:
					</p><pre class="literallayout"># ipactl restart --force</pre><p class="simpara">
						With the <code class="literal">--force</code> parameter, the <code class="literal">ipactl</code> utility ignores individual service startup failures. For example, if the server is also a CA with expired certificates, the <code class="literal">pki-tomcat</code> service fails to start. This is expected and ignored because of using the <code class="literal">--force</code> parameter.
					</p></li><li class="listitem"><p class="simpara">
						After the restart, verify that the <code class="literal">certmonger</code> service renewed the certificates (certificate status says MONITORING):
					</p><pre class="literallayout"># getcert list | egrep '^Request|status:|subject:'
Request ID '20190522120745':
        status: MONITORING
        subject: CN=IPA RA,O=EXAMPLE.COM 201905222205
Request ID '20190522120834':
        status: MONITORING
        subject: CN=Certificate Authority,O=EXAMPLE.COM 201905222205
...</pre><p class="simpara">
						It can take some time before <code class="literal">certmonger</code> renews the shared certificates on the replica.
					</p></li><li class="listitem"><p class="simpara">
						If the server is also a CA, the previous command reports <code class="literal">CA_UNREACHABLE</code> for the certificate the <code class="literal">pki-tomcat</code> service uses:
					</p><pre class="literallayout">Request ID '20190522120835':
        status: CA_UNREACHABLE
        subject: CN=ca2.example.com,O=EXAMPLE.COM 201905222205
...</pre></li><li class="listitem"><p class="simpara">
						To renew this certificate, use the <code class="literal">ipa-cert-fix</code> utility:
					</p><pre class="literallayout"># ipa-cert-fix
Dogtag sslserver certificate:
  Subject: CN=ca2.example.com,O=EXAMPLE.COM
  Serial:  3
  Expires: 2019-05-11 12:07:11

Enter "yes" to proceed: true
Proceeding.
Renewed Dogtag sslserver certificate:
  Subject: CN=ca2.example.com,O=EXAMPLE.COM 201905222205
  Serial:  15
  Expires: 2019-08-14 04:25:05

The ipa-cert-fix command was successful</pre></li></ol></div><p>
				Now, all IdM certificates have been renewed and work correctly.
			</p></section></section><section class="chapter" id="proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-not-yet-expired-on-an-idm-replica_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 15. Replacing the web server and LDAP server certificates if they have not yet expired on an IdM replica</h2></div></div></div><p class="_abstract _abstract">
			As an Identity Management (IdM) system administrator, you can manually replace the certificates for the web (or <code class="literal">httpd</code>) and LDAP (or <code class="literal">Directory</code>) services running on an IdM server. For example, this might be necessary if the certificates are nearing expiration and if the <code class="literal">certmonger</code> utility is either not configured to renew the certificates automatically or if the certificates are signed by an external certificate authority (CA).
		</p><p>
			The example installs the certificates for the services running on the <span class="strong strong"><strong>server.idm.example.com</strong></span> IdM server. You obtain the certificates from an external CA.
		</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
				The HTTP and LDAP service certificates have different keypairs and subject names on different IdM servers and so you must renew the certificates on each IdM server individually.
			</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					On at least one other IdM replica in the topology with which the IdM server has a replication agreement, the web and LDAP certificates are still valid. This is a prerequisite for the <code class="literal">ipa-server-certinstall</code> command. The command requires a <code class="literal">TLS</code> connection to communicate with other IdM replicas. However, with invalid certificates, such a connection could not be established, and the <code class="literal">ipa-server-certinstall</code> command would fail. In that case, see <a class="link" href="#proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-expired-in-the-whole-idm-deployment_managing-certificates-in-idm" title="Chapter 16. Replacing the web server and LDAP server certificates if they have expired in the whole IdM deployment">Replacing the web server and LDAP server certificates if they have expired in the whole IdM deployment</a>.
				</li><li class="listitem">
					You have <code class="literal">root</code> access to the IdM server.
				</li><li class="listitem">
					You know the <code class="literal">Directory Manager</code> password.
				</li><li class="listitem">
					You have access to a file storing the CA certificate chain of the external CA, <span class="emphasis"><em>ca_certificate_chain_file.crt</em></span>.
				</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
					Install the certificates contained in <span class="emphasis"><em>ca_certificate_chain_file.crt</em></span> as additional CA certificates to IdM:
				</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-cacert-manage install</strong></span></pre></li><li class="listitem"><p class="simpara">
					Update the local IdM certificate databases with certificates from <span class="emphasis"><em>ca_certicate_chain_file.crt</em></span>:
				</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-certupdate</strong></span></pre></li><li class="listitem"><p class="simpara">
					Generate a private key and a certificate signing request (CSR) using the <code class="literal">OpenSSL</code> utility:
				</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl req -new -newkey rsa:4096 -days 365 -nodes -keyout new.key -out new.csr -addext "subjectAltName = DNS:server.idm.example.com" -subj '/CN=<span class="emphasis"><em>server.idm.example.com</em></span>,O=<span class="emphasis"><em>IDM.EXAMPLE.COM</em></span>'</strong></span></pre><p class="simpara">
					Submit the CSR to the external CA. The process differs depending on the service to be used as the external CA. After the CA signs the certificate, import the certificate to the IdM server.
				</p></li><li class="listitem"><p class="simpara">
					On the IdM server, replace the Apache web server’s old private key and certificate with the new key and the newly-signed certificate:
				</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-server-certinstall -w --pin=<span class="emphasis"><em>password</em></span> <span class="emphasis"><em>new.key</em></span> <span class="emphasis"><em>new.crt</em></span></strong></span></pre><p class="simpara">
					In the command above:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">-w</code> option specifies that you are installing a certificate into the web server.
						</li><li class="listitem">
							The <code class="literal">--pin</code> option specifies the password protecting the private key.
						</li></ul></div></li><li class="listitem">
					When prompted, enter the <code class="literal">Directory Manager</code> password.
				</li><li class="listitem"><p class="simpara">
					Replace the LDAP server’s old private key and certificate with the new key and the newly-signed certificate:
				</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-server-certinstall -d --pin=<span class="emphasis"><em>password</em></span> <span class="emphasis"><em>new.key</em></span> <span class="emphasis"><em>new.cert</em></span></strong></span></pre><p class="simpara">
					In the command above:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">-d</code> option specifies that you are installing a certificate into the LDAP server.
						</li><li class="listitem">
							The <code class="literal">--pin</code> option specifies the password protecting the private key.
						</li></ul></div></li><li class="listitem">
					When prompted, enter the <code class="literal">Directory Manager</code> password.
				</li><li class="listitem"><p class="simpara">
					Restart the <code class="literal">httpd</code> service:
				</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart httpd.service</strong></span></pre></li><li class="listitem"><p class="simpara">
					Restart the <code class="literal">Directory</code> service:
				</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart dirsrv@IDM.EXAMPLE.COM.service</strong></span></pre></li><li class="listitem"><p class="simpara">
					If a subCA has been removed or replaced on the servers, update the clients:
				</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-certupdate</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/convert-cert-formats-idm_managing-certificates-in-idm">Converting certificate formats to work with IdM</a>
				</li><li class="listitem">
					<code class="literal">ipa-server-certinstall(1)</code> man page on your system
				</li></ul></div></section><section class="chapter" id="proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-expired-in-the-whole-idm-deployment_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 16. Replacing the web server and LDAP server certificates if they have expired in the whole IdM deployment</h2></div></div></div><p class="_abstract _abstract">
			Identity Management (IdM) uses the following service certificates:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					The LDAP (or <code class="literal">Directory</code>) server certificate
				</li><li class="listitem">
					The web (or <code class="literal">httpd</code>) server certificate
				</li><li class="listitem">
					The PKINIT certificate
				</li></ul></div><p>
			In an IdM deployment without a CA, <code class="literal">certmonger</code> does not by default track IdM service certificates or notify of their expiration. If the IdM system administrator does not manually set up notifications for these certificates, or configure <code class="literal">certmonger</code> to track them, the certificates will expire without notice.
		</p><p>
			Follow this procedure to manually replace expired certificates for the <code class="literal">httpd</code> and LDAP services running on the <span class="strong strong"><strong>server.idm.example.com</strong></span> IdM server.
		</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
				The HTTP and LDAP service certificates have different keypairs and subject names on different IdM servers. Therefore, you must renew the certificates on each IdM server individually.
			</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The HTTP and LDAP certificates have expired on <span class="emphasis"><em>all</em></span> IdM replicas in the topology. If not, see <a class="link" href="#proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-not-yet-expired-on-an-idm-replica_managing-certificates-in-idm" title="Chapter 15. Replacing the web server and LDAP server certificates if they have not yet expired on an IdM replica">Replacing the web server and LDAP server certificates if they have not yet expired on an IdM replica</a>.
				</li><li class="listitem">
					You have <code class="literal">root</code> access to the IdM server and replicas.
				</li><li class="listitem">
					You know the <code class="literal">Directory Manager</code> password.
				</li><li class="listitem"><p class="simpara">
					You have created backups of the following directories and files:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							<code class="literal">/etc/dirsrv/slapd-<span class="emphasis"><em>IDM-EXAMPLE-COM</em></span>/</code>
						</li><li class="listitem">
							<code class="literal">/etc/httpd/alias</code>
						</li><li class="listitem">
							<code class="literal">/var/lib/certmonger</code>
						</li><li class="listitem">
							<code class="literal">/var/lib/ipa/certs/</code>
						</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					Optional: Perform a backup of <code class="literal">/var/lib/ipa/private</code> and <code class="literal">/var/lib/ipa/passwds</code>.
				</li><li class="listitem"><p class="simpara">
					If you are not using the same CA to sign the new certificates or if the already installed CA certificate is no longer valid, update the information about the external CA in your local database with a file that contains a valid CA certificate chain of the external CA. The file is accepted in PEM and DER certificate, PKCS#7 certificate chain, PKCS#8 and raw private key and PKCS#12 formats.
				</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
							Install the certificates available in <span class="emphasis"><em>ca_certificate_chain_file.crt</em></span> as additional CA certificates into IdM:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-cacert-manage install ca_certificate_chain_file.crt</strong></span></pre></li><li class="listitem"><p class="simpara">
							Update the local IdM certificate databases with certificates from <span class="emphasis"><em>ca_certicate_chain_file.crt</em></span>:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-certupdate</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
					Request the certificates for <code class="literal">httpd</code> and LDAP:
				</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
							Create a certificate signing request (CSR) for the Apache web server running on your IdM instances to your third party CA using the <code class="literal">OpenSSL</code> utility.
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									The creation of a new private key is optional. If you still have the original private key, you can use the <code class="literal">-in</code> option with the <code class="literal">openssl req</code> command to specify the input file name to read the request from:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl req -new -nodes -in /var/lib/ipa/private/httpd.key -out /tmp/http.csr -addext 'subjectAltName = DNS:_server.idm.example.com_, otherName:1.3.6.1.4.1.311.20.2.3;UTF8:HTTP/<span class="emphasis"><em>server.idm.example.com@IDM.EXAMPLE.COM</em></span>' -subj '/O=<span class="emphasis"><em>IDM.EXAMPLE.COM/CN=server.idm.example.com</em></span>'</strong></span></pre></li><li class="listitem"><p class="simpara">
									If you want to create a new key:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl req -new -newkey rsa:2048 -nodes -keyout /var/lib/ipa/private/httpd.key -out /tmp/http.csr -addext 'subjectAltName = DNS:<span class="emphasis"><em>server.idm.example.com</em></span>, otherName:1.3.6.1.4.1.311.20.2.3;UTF8:HTTP/<span class="emphasis"><em>server.idm.example.com@IDM.EXAMPLE.COM</em></span>' -subj '/O=<span class="emphasis"><em>IDM.EXAMPLE.COM</em></span>/CN=<span class="emphasis"><em>server.idm.example.com</em></span>'</strong></span></pre></li></ul></div></li><li class="listitem"><p class="simpara">
							Create a certificate signing request (CSR) for the LDAP server running on your IdM instances to your third party CA using the <code class="literal">OpenSSL</code> utility:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl req -new -newkey rsa:2048 -nodes -keyout ~/ldap.key -out /tmp/ldap.csr -addext 'subjectAltName = DNS:<span class="emphasis"><em>server.idm.example.com</em></span>, otherName:1.3.6.1.4.1.311.20.2.3;UTF8:ldap/<span class="emphasis"><em>server.idm.example.com@IDM.EXAMPLE.COM</em></span>' -subj '/O=<span class="emphasis"><em>IDM.EXAMPLE.COM</em></span>/CN=<span class="emphasis"><em>server.idm.example.com</em></span>'</strong></span></pre></li><li class="listitem">
							Submit the CSRs, <span class="strong strong"><strong>/tmp/http.csr</strong></span> and <span class="strong strong"><strong>tmp/ldap.csr</strong></span>, to the external CA, and obtain a certificate for <code class="literal">httpd</code> and a certificate for LDAP. The process differs depending on the service to be used as the external CA.
						</li></ol></div></li><li class="listitem"><p class="simpara">
					Install the certificate for <code class="literal">httpd</code> :
				</p><pre class="literallayout"># <span class="strong strong"><strong>cp /path/to/httpd.crt /var/lib/ipa/certs/</strong></span></pre></li><li class="listitem"><p class="simpara">
					Install the LDAP certificate into an NSS database:
				</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
							Optional: List the available certificates:
						</p><pre class="literallayout"># <span class="strong strong"><strong>certutil -d /etc/dirsrv/slapd-<span class="emphasis"><em>IDM-EXAMPLE-COM</em></span>/ -L</strong></span>
Certificate Nickname                                         Trust Attributes
                                                             SSL,S/MIME,JAR/XPI

<span class="strong strong"><strong>Server-Cert</strong></span>                                                  u,u,u</pre><p class="simpara">
							The default certificate nickname is <span class="strong strong"><strong>Server-Cert</strong></span>, but it is possible that a different name was applied.
						</p></li><li class="listitem"><p class="simpara">
							Remove the old invalid certificate from the NSS database (<code class="literal">NSSDB</code>) by using the certificate nickname from the previous step:
						</p><pre class="literallayout"># <span class="strong strong"><strong>certutil -D -d /etc/dirsrv/slapd-<span class="emphasis"><em>IDM-EXAMPLE-COM</em></span>/ -n 'Server-Cert' -f /etc/dirsrv/slapd-<span class="emphasis"><em>IDM-EXAMPLE-COM</em></span>/pwdfile.txt</strong></span></pre></li><li class="listitem"><p class="simpara">
							Create a PKCS12 file to ease the import process into <code class="literal">NSSDB</code>:
						</p><pre class="literallayout"># <span class="strong strong"><strong>openssl pkcs12 -export -in ldap.crt -inkey ldap.key -out ldap.p12 -name Server-Cert</strong></span></pre></li><li class="listitem"><p class="simpara">
							Install the created PKCS#12 file into the <code class="literal">NSSDB</code>:
						</p><pre class="literallayout"># <span class="strong strong"><strong>pk12util -i ldap.p12 -d /etc/dirsrv/slapd-<span class="emphasis"><em>IDM-EXAMPLE-COM</em></span>/ -k /etc/dirsrv/slapd-<span class="emphasis"><em>IDM-EXAMPLE-COM</em></span>/pwdfile.txt</strong></span></pre></li><li class="listitem"><p class="simpara">
							Check that the new certificate has been successfully imported:
						</p><pre class="literallayout"># <span class="strong strong"><strong>certutil -L -d /etc/dirsrv/slapd-<span class="emphasis"><em>IDM-EXAMPLE-COM</em></span>/</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
					Restart the <code class="literal">httpd</code> service:
				</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart httpd.service</strong></span></pre></li><li class="listitem"><p class="simpara">
					Restart the <code class="literal">Directory</code> service:
				</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart dirsrv@<span class="emphasis"><em>IDM-EXAMPLE-COM</em></span>.service</strong></span></pre></li><li class="listitem">
					Perform all the previous steps on all your IdM replicas. This is a prerequisite for establishing <code class="literal">TLS</code> connections between the replicas.
				</li><li class="listitem"><p class="simpara">
					Enroll the new certificates to LDAP storage:
				</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
							Replace the Apache web server’s old private key and certificate with the new key and the newly-signed certificate:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-server-certinstall -w --pin=password /var/lib/ipa/private/httpd.key /var/lib/ipa/certs/httpd.crt</strong></span></pre><p class="simpara">
							In the command above:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The <code class="literal">-w</code> option specifies that you are installing a certificate into the web server.
								</li><li class="listitem">
									The <code class="literal">--pin</code> option specifies the password protecting the private key.
								</li></ul></div></li><li class="listitem">
							When prompted, enter the <code class="literal">Directory Manager</code> password.
						</li><li class="listitem"><p class="simpara">
							Replace the LDAP server’s old private key and certificate with the new key and the newly-signed certificate:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-server-certinstall -d --pin=password /etc/dirsrv/slapd-<span class="emphasis"><em>IDM-EXAMPLE-COM</em></span>/ldap.key /path/to/ldap.crt</strong></span></pre><p class="simpara">
							In the command above:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The <code class="literal">-d</code> option specifies that you are installing a certificate into the LDAP server.
								</li><li class="listitem">
									The <code class="literal">--pin</code> option specifies the password protecting the private key.
								</li></ul></div></li><li class="listitem">
							When prompted, enter the <code class="literal">Directory Manager</code> password.
						</li><li class="listitem"><p class="simpara">
							Restart the <code class="literal">httpd</code> service:
						</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart httpd.service</strong></span></pre></li><li class="listitem"><p class="simpara">
							Restart the <code class="literal">Directory</code> service:
						</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart dirsrv@<span class="emphasis"><em>IDM-EXAMPLE-COM</em></span>.service</strong></span></pre></li></ol></div></li><li class="listitem">
					Execute the commands from the previous step on all the other affected replicas.
				</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/convert-cert-formats-idm_managing-certificates-in-idm">Converting certificate formats to work with IdM</a>
				</li><li class="listitem">
					man <code class="literal">ipa-server-certinstall(1)</code>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/solutions/6765131">How do I manually renew Identity Management (IPA) certificates on RHEL 8 after they have expired? (CA-less IPA)</a>
				</li></ul></div></section><section class="chapter" id="generating-crl-on-the-idm-ca-server_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 17. Generating CRL on the IdM CA server</h2></div></div></div><p class="_abstract _abstract">
			If your IdM deployment uses an embedded certificate authority (CA), you may need to move generating the Certificate Revocation List (CRL) from one Identity Management (IdM) server to another. It can be necessary, for example, when you want to migrate the server to another system.
		</p><p>
			Only configure one server to generate the CRL. The IdM server that performs the CRL publisher role is usually the same server that performs the CA renewal server role, but this is not mandatory. Before you decommission the CRL publisher server, select and configure another server to perform the CRL publisher server role.
		</p><section class="section" id="stopping-crl-generation-on-idm-server_generating-crl-on-the-idm-ca-server"><div class="titlepage"><div><div><h3 class="title">17.1. Stopping CRL generation on an IdM server</h3></div></div></div><p class="_abstract _abstract">
				To stop generating the Certificate Revocation List (CRL) on the IdM CRL publisher server, use the <code class="literal">ipa-crlgen-manage</code> command. Before you disable the generation, verify that the server really generates CRL. You can then disable it.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You must be logged in as root.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check if your server is generating the CRL:
					</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa-crlgen-manage status</strong></span>
CRL generation: <span class="strong strong"><strong>enabled</strong></span>
Last CRL update: 2019-10-31 12:00:00
Last CRL Number: 6
The ipa-crlgen-manage command was successful</pre></li><li class="listitem"><p class="simpara">
						Stop generating the CRL on the server:
					</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa-crlgen-manage disable</strong></span>
Stopping pki-tomcatd
Editing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg
Starting pki-tomcatd
Editing /etc/httpd/conf.d/ipa-pki-proxy.conf
Restarting httpd
CRL generation disabled on the local host. Please make sure to configure CRL generation on another master with ipa-crlgen-manage enable.
The ipa-crlgen-manage command was successful</pre></li><li class="listitem"><p class="simpara">
						Check if the server stopped generating CRL:
					</p><pre class="literallayout">[root@server ~]# <span class="strong strong"><strong>ipa-crlgen-manage status</strong></span></pre></li></ol></div><p>
				The server stopped generating the CRL. The next step is to enable CRL generation on the IdM replica.
			</p></section><section class="section" id="starting-crl-generation-on-idm-replica-server_generating-crl-on-the-idm-ca-server"><div class="titlepage"><div><div><h3 class="title">17.2. Starting CRL generation on an IdM replica server</h3></div></div></div><p class="_abstract _abstract">
				You can start generating the Certificate Revocation List (CRL) on an IdM CA server with the <code class="literal">ipa-crlgen-manage</code> command.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The RHEL system must be an IdM Certificate Authority server.
					</li><li class="listitem">
						You must be logged in as root.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Start generating the CRL:
					</p><pre class="literallayout">[root@replica1 ~]# <span class="strong strong"><strong>ipa-crlgen-manage enable</strong></span>
Stopping pki-tomcatd
Editing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg
Starting pki-tomcatd
Editing /etc/httpd/conf.d/ipa-pki-proxy.conf
Restarting httpd
Forcing CRL update
CRL generation enabled on the local host. Please make sure to have only a single CRL generation master.
The ipa-crlgen-manage command was successful</pre></li><li class="listitem"><p class="simpara">
						Check if the CRL is generated:
					</p><pre class="literallayout">[root@replica1 ~]# <span class="strong strong"><strong>ipa-crlgen-manage status</strong></span>
CRL generation: <span class="strong strong"><strong>enabled</strong></span>
Last CRL update: 2019-10-31 12:10:00
Last CRL Number: 7
The ipa-crlgen-manage command was successful</pre></li></ol></div></section><section class="section" id="changing-the-crl-update-interval_generating-crl-on-the-idm-ca-server"><div class="titlepage"><div><div><h3 class="title">17.3. Changing the CRL update interval</h3></div></div></div><p>
				The Certificate Revocation List (CRL) file is automatically generated by the Identity Management Certificate Authority (Idm CA) every four hours by default. You can change this interval with the following procedure.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Stop the CRL generation server:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop pki-tomcatd@pki-tomcat.service</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">/var/lib/pki/pki-tomcat/conf/ca/CS.cfg</code> file, and change the <code class="literal">ca.crl.MasterCRL.autoUpdateInterval</code> value to the new interval setting. For example, to generate the CRL every 60 minutes:
					</p><pre class="screen">ca.crl.MasterCRL.autoUpdateInterval=<span class="strong strong"><strong>60</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							If you update the <code class="literal">ca.crl.MasterCRL.autoUpdateInterval</code> parameter, the change will become effective after the next already scheduled CRL update.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Start the CRL generation server:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl start pki-tomcatd@pki-tomcat.service</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For more information about the CRL generation on an IdM replica server, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_certificates_in_idm/index#starting-crl-generation-on-idm-replica-server_generating-crl-on-the-idm-ca-server">Starting CRL generation on an IdM replica server</a>.
					</li></ul></div></section></section><section class="chapter" id="proc_decommissioning-a-server-that-performs-the-ca-renewal-server-and-crl-publisher-roles_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 18. Decommissioning a server that performs the CA renewal server and CRL publisher roles</h2></div></div></div><p class="_abstract _abstract">
			You might have one server performing both the Certificate Authority (CA) renewal server role and the Certificate Revocation List (CRL) publisher role. If you need to take this server offline or decommission it, select and configure another CA server to perform these roles.
		</p><p>
			In this example, the host <code class="literal">server.idm.example.com</code>, which fulfills the CA renewal server and CRL publisher roles, must be decommissioned. This procedure transfers the CA renewal server and CRL publisher roles to the host <code class="literal">replica.idm.example.com</code> and removes <code class="literal">server.idm.example.com</code> from the IdM environment.
		</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
				You do not need to configure the same server to perform both CA renewal server and CRL publisher roles.
			</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					You have the IdM administrator credentials.
				</li><li class="listitem">
					You have the root password for the server you are decommissioning.
				</li><li class="listitem">
					You have at least two CA replicas in your IdM environment.
				</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
					Obtain the IdM administrator credentials:
				</p><pre class="literallayout">[user@server ~]$ kinit admin
Password for admin@IDM.EXAMPLE.COM:</pre></li><li class="listitem"><p class="simpara">
					Optional: If you are not sure which servers perform the CA renewal server and CRL publisher roles:
				</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
							Display the current CA renewal server. You can run the following command from any IdM server:
						</p><pre class="literallayout">[user@server ~]$ ipa config-show | grep 'CA renewal'
  IPA CA renewal master: server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
							Test if a host is the current CRL publisher.
						</p><pre class="literallayout">[user@server ~]$ ipa-crlgen-manage status
<span class="strong strong"><strong>CRL generation: enabled</strong></span>
Last CRL update: 2019-10-31 12:00:00
Last CRL Number: 6
The ipa-crlgen-manage command was successful</pre><p class="simpara">
							A CA server that does not generate the CRL displays <code class="literal">CRL generation: disabled</code>.
						</p><pre class="literallayout">[user@replica ~]$ ipa-crlgen-manage status
<span class="strong strong"><strong>CRL generation: disabled</strong></span>
The ipa-crlgen-manage command was successful</pre><p class="simpara">
							Continue entering this command on CA servers until you find the CRL publisher server.
						</p></li><li class="listitem"><p class="simpara">
							Display all other CA servers you can promote to fulfill these roles. This environment has two CA servers.
						</p><pre class="literallayout">[user@server ~]$ ipa server-role-find --role 'CA server'
----------------------
2 server roles matched
----------------------
  Server name: server.idm.example.com
  Role name: CA server
  Role status: enabled
  Server name: replica.idm.example.com
  Role name: CA server
  Role status: enabled
----------------------------
Number of entries returned 2
----------------------------</pre></li></ol></div></li><li class="listitem"><p class="simpara">
					Set <code class="literal">replica.idm.example.com</code> as the CA renewal server.
				</p><pre class="literallayout">[user@server ~]$ ipa config-mod --ca-renewal-master-server replica.idm.example.com</pre></li><li class="listitem"><p class="simpara">
					On <code class="literal">server.idm.example.com</code>:
				</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
							Disable the certificate updater task:
						</p><pre class="literallayout">[root@server ~]# pki-server ca-config-set ca.certStatusUpdateInterval 0</pre></li><li class="listitem"><p class="simpara">
							Restart IdM services:
						</p><pre class="literallayout">[root@server ~]# ipactl restart</pre></li></ol></div></li><li class="listitem"><p class="simpara">
					On <code class="literal">replica.idm.example.com</code>:
				</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
							Enable the certificate updater task:
						</p><pre class="literallayout">[root@replica ~]# pki-server ca-config-unset ca.certStatusUpdateInterval</pre></li><li class="listitem"><p class="simpara">
							Restart IdM services:
						</p><pre class="literallayout">[root@replica ~]# ipactl restart</pre></li></ol></div></li><li class="listitem"><p class="simpara">
					On <code class="literal">server.idm.example.com</code>, stop generating the CRL.
				</p><pre class="literallayout">[user@server ~]$ ipa-crlgen-manage disable
Stopping pki-tomcatd
Editing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg
Starting pki-tomcatd
Editing /etc/httpd/conf.d/ipa-pki-proxy.conf
Restarting httpd
CRL generation disabled on the local host. Please make sure to configure CRL generation on another master with ipa-crlgen-manage enable.
The ipa-crlgen-manage command was successful</pre></li><li class="listitem"><p class="simpara">
					On <code class="literal">replica.idm.example.com</code>, start generating the CRL.
				</p><pre class="literallayout">[user@replica ~]$ ipa-crlgen-manage enable
Stopping pki-tomcatd
Editing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg
Starting pki-tomcatd
Editing /etc/httpd/conf.d/ipa-pki-proxy.conf
Restarting httpd
Forcing CRL update
CRL generation enabled on the local host. Please make sure to have only a single CRL generation master.
The ipa-crlgen-manage command was successful</pre></li><li class="listitem"><p class="simpara">
					Stop IdM services on <code class="literal">server.idm.example.com</code>:
				</p><pre class="literallayout">[root@server ~]# ipactl stop</pre></li><li class="listitem"><p class="simpara">
					On <code class="literal">replica.idm.example.com</code>, delete <code class="literal">server.idm.example.com</code> from the IdM environment.
				</p><pre class="literallayout">[user@replica ~]$ ipa server-del server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
					On <code class="literal">server.idm.example.com</code>, use the <code class="literal">ipa-server-install --uninstall</code> command as the root account:
				</p><pre class="literallayout">[root@server ~]# ipa-server-install --uninstall
...
Are you sure you want to continue with the uninstall procedure? [no]: <span class="strong strong"><strong>yes</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					Display the current CA renewal server.
				</p><pre class="literallayout">[user@replica ~]$ ipa config-show | grep 'CA renewal'
  IPA CA renewal master: <span class="strong strong"><strong>replica.idm.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
					Confirm that the <code class="literal">replica.idm.example.com</code> host is generating the CRL.
				</p><pre class="literallayout">[user@replica ~]$ ipa-crlgen-manage status
<span class="strong strong"><strong>CRL generation: enabled</strong></span>
Last CRL update: 2019-10-31 12:10:00
Last CRL Number: 7
The ipa-crlgen-manage command was successful</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/ipa-ca-renewal_managing-certificates-in-idm#changing-ca-renewal_ipa-ca-renewal">Changing and resetting IdM CA renewal server</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/generating-crl-on-the-idm-ca-server_managing-certificates-in-idm">Generating CRL on the IdM CA server</a>
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-idm-replica_installing-identity-management">Uninstalling an IdM replica</a>
				</li></ul></div></section><section class="chapter" id="using-certmonger_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 19. Obtaining an IdM certificate for a service using certmonger</h2></div></div></div><section class="section _abstract" id="certmonger_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h3 class="title">19.1. Certmonger overview</h3></div></div></div><p class="_abstract _abstract">
				When Identity Management (IdM) is installed with an integrated IdM Certificate Authority (CA), it uses the <code class="literal">certmonger</code> service to track and renew system and service certificates. When the certificate is reaching its expiration date, <code class="literal">certmonger</code> manages the renewal process by:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Regenerating a certificate-signing request (CSR) using the options provided in the original request.
					</li><li class="listitem">
						Submitting the CSR to the IdM CA using the IdM API <code class="literal">cert-request</code> command.
					</li><li class="listitem">
						Receiving the certificate from the IdM CA.
					</li><li class="listitem">
						Executing a pre-save command if specified by the original request.
					</li><li class="listitem">
						Installing the new certificate in the location specified in the renewal request: either in an <code class="literal">NSS</code> database or in a file.
					</li><li class="listitem">
						Executing a post-save command if specified by the original request. For example, the post-save command can instruct <code class="literal">certmonger</code> to restart a relevant service, so that the service picks up the new certificate.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Types of certificates <code class="literal">certmonger</code> tracks</strong></p><p>
					Certificates can be divided into system and service certificates.
				</p></div><p>
				Unlike service certificates (for example, for <code class="literal">HTTP</code>, <code class="literal">LDAP</code> and <code class="literal">PKINIT</code>), which have different keypairs and subject names on different servers, IdM system certificates and their keys are shared by all CA replicas. The IdM system certificates include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">IdM CA</code> certificate
					</li><li class="listitem">
						<code class="literal">OCSP</code> signing certificate
					</li><li class="listitem">
						<code class="literal">IdM CA subsystem</code> certificates
					</li><li class="listitem">
						<code class="literal">IdM CA audit signing</code> certificate
					</li><li class="listitem">
						<code class="literal">IdM renewal agent</code> (RA) certificate
					</li><li class="listitem">
						<code class="literal">KRA</code> transport and storage certificates
					</li></ul></div><p>
				The <code class="literal">certmonger</code> service tracks the IdM system and service certificates that were requested during the installation of IdM environment with an integrated CA. <code class="literal">Certmonger</code> also tracks certificates that have been requested manually by the system administrator for other services running on the IdM host. <code class="literal">Certmonger</code> does not track external CA certificates or user certificates.
			</p><div class="formalpara"><p class="title"><strong>Certmonger components</strong></p><p>
					The <code class="literal">certmonger</code> service consists of two main components:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">certmonger daemon</code>, which is the engine tracking the list of certificates and launching renewal commands
					</li><li class="listitem">
						The <code class="literal">getcert</code> utility for the <code class="literal">command-line interface</code> (CLI), which allows the system administrator to actively send commands to the <code class="literal">certmonger</code> daemon.
					</li></ul></div><p>
				More specifically, the system administrator can use the <code class="literal">getcert</code> utility to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs" title="19.2. Obtaining an IdM certificate for a service using certmonger">Request a new certificate</a>
					</li><li class="listitem">
						<a class="link" href="#viewing-cert-tracked-by-certmonger_certmonger-for-issuing-renewing-service-certs" title="19.4. Viewing the details of a certificate request tracked by certmonger">View the list of certificates that <code class="literal">certmonger</code> tracks</a>
					</li><li class="listitem">
						<a class="link" href="#start-stop-cert-tracking_certmonger-for-issuing-renewing-service-certs" title="19.5. Starting and stopping certificate tracking">Start or stop tracking a certificate</a>
					</li><li class="listitem">
						<a class="link" href="#renew-cert_certmonger-for-issuing-renewing-service-certs" title="19.6. Renewing a certificate manually">Renew a certificate</a>
					</li></ul></div></section><section class="section" id="obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h3 class="title">19.2. Obtaining an IdM certificate for a service using certmonger</h3></div></div></div><p>
				To ensure that communication between browsers and the web service running on your Identity Management (IdM) client is secure and encrypted, use a TLS certificate. Obtain the TLS certificate for your web service from the IdM Certificate Authority (CA).
			</p><p>
				Follow this procedure to use <code class="literal">certmonger</code> to obtain an IdM certificate for a service (<code class="literal">HTTP/my_company.idm.example.com</code>@<code class="literal">IDM.EXAMPLE.COM</code>) running on an IdM client.
			</p><p>
				Using <code class="literal">certmonger</code> to request the certificate automatically means that <code class="literal">certmonger</code> manages and renews the certificate when it is due for a renewal.
			</p><p>
				For a visual representation of what happens when <code class="literal">certmonger</code> requests a service certificate, see <a class="xref" href="#communication-flow-certmonger-requesting-service-cert_certmonger-for-issuing-renewing-service-certs" title="19.3. Communication flow for certmonger requesting a service certificate">Section 19.3, “Communication flow for certmonger requesting a service certificate”</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The web server is enrolled as an IdM client.
					</li><li class="listitem">
						You have root access to the IdM client on which you are running the procedure.
					</li><li class="listitem">
						The service for which you are requesting a certificate does not have to pre-exist in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the <code class="literal">my_company.idm.example.com</code> IdM client on which the <code class="literal">HTTP</code> service is running, request a certificate for the service corresponding to the <code class="literal">HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM</code> principal, and specify that
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The certificate is to be stored in the local <code class="literal">/etc/pki/tls/certs/httpd.pem</code> file
							</li><li class="listitem">
								The private key is to be stored in the local <code class="literal">/etc/pki/tls/private/httpd.key</code> file
							</li><li class="listitem"><p class="simpara">
								That an extensionRequest for a <code class="literal">SubjectAltName</code> be added to the signing request with the DNS name of <code class="literal">my_company.idm.example.com</code>:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-getcert request -K HTTP/my_company.idm.example.com -k /etc/pki/tls/private/httpd.key -f /etc/pki/tls/certs/httpd.pem -g 2048 -D my_company.idm.example.com -C "systemctl restart httpd"</strong></span>
New signing request "20190604065735" added.</pre><p class="simpara">
								In the command above:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										The <code class="literal">ipa-getcert request</code> command specifies that the certificate is to be obtained from the IdM CA. The <code class="literal">ipa-getcert request</code> command is a shortcut for <code class="literal">getcert request -c IPA</code>.
									</li><li class="listitem">
										The <code class="literal">-g</code> option specifies the size of key to be generated if one is not already in place.
									</li><li class="listitem">
										The <code class="literal">-D</code> option specifies the <code class="literal">SubjectAltName</code> DNS value to be added to the request.
									</li><li class="listitem">
										The <code class="literal">-C</code> option instructs <code class="literal">certmonger</code> to restart the <code class="literal">httpd</code> service after obtaining the certificate.
									</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										To specify that the certificate be issued with a particular profile, use the <code class="literal">-T</code> option.
									</li><li class="listitem">
										To request a certificate using the named issuer from the specified CA, use the <code class="literal">-X ISSUER</code> option.
									</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: To check the status of your request:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-getcert list -f /etc/pki/tls/certs/httpd.pem</strong></span>
Number of certificates and requests being tracked: 3.
Request ID '20190604065735':
    status: MONITORING
    stuck: no
    key pair storage: type=FILE,location='/etc/pki/tls/private/httpd.key'
    certificate: type=FILE,location='/etc/pki/tls/certs/httpd.crt'
    CA: IPA
[...]</pre><p class="simpara">
						The output shows that the request is in the <code class="literal">MONITORING</code> status, which means that a certificate has been obtained. The locations of the key pair and the certificate are those requested.
					</p></li></ol></div></section><section class="section" id="communication-flow-certmonger-requesting-service-cert_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h3 class="title">19.3. Communication flow for certmonger requesting a service certificate</h3></div></div></div><p class="_abstract _abstract">
				These diagrams show the stages of what happens when <code class="literal">certmonger</code> requests a service certificate from Identity Management (IdM) certificate authority (CA) server. The sequence consists of these diagrams:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-1" title="Figure 19.1. Unencrypted communication">Unencrypted communication</a>
					</li><li class="listitem">
						<a class="link" href="#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-2" title="Figure 19.2. Certmonger requesting a service certificate">Certmonger requesting a service certificate</a>
					</li><li class="listitem">
						<a class="link" href="#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-3" title="Figure 19.3. IdM CA issuing the service certificate">IdM CA issuing the service certificate</a>
					</li><li class="listitem">
						<a class="link" href="#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-4" title="Figure 19.4. Certmonger applying the service certificate">Certmonger applying the service certificate</a>
					</li><li class="listitem">
						<a class="link" href="#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-5" title="Figure 19.5. Certmonger requesting a new certificate when the old one is nearing expiration">Certmonger requesting a new certificate when the old one is nearing expiration</a>
					</li></ul></div><p>
				<a class="link" href="#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-1" title="Figure 19.1. Unencrypted communication">Unencrypted communication</a> shows the initial situation: without an HTTPS certificate, the communication between the web server and the browser is unencrypted.
			</p><div class="figure" id="certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-1"><p class="title"><strong>Figure 19.1. Unencrypted communication</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/7f96cab7e5e718e3e2e3590b5afd83c1/84_RHEL_IdM_0420_1.png" alt="A diagram displaying an IdM client running an Apache web server and the certmonger service. There are arrows between a browser and the Apache webserver showing it is connecting over an unencrypted HTTP connection. There is an inactive connection from the certmonger service to an IdM CA server."></div></div></div><p>
				<br>
			</p><p>
				<a class="link" href="#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-2" title="Figure 19.2. Certmonger requesting a service certificate">Certmonger requesting a service certificate</a> shows the system administrator using <code class="literal">certmonger</code> to manually request an HTTPS certificate for the Apache web server. Note that when requesting a web server certificate, certmonger does not communicate directly with the CA. It proxies through IdM.
			</p><div class="figure" id="certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-2"><p class="title"><strong>Figure 19.2. Certmonger requesting a service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/9667aa246bcf76921969274115666533/84_RHEL_IdM_0420_2.png" alt="A diagram displaying an arrow between the certmonger service on the IdM client and the IdM CA server to show it is connecting via an ipa-getcert request."></div></div></div><p>
				<br>
			</p><p>
				<a class="link" href="#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-3" title="Figure 19.3. IdM CA issuing the service certificate">IdM CA issuing the service certificate</a> shows an IdM CA issuing an HTTPS certificate for the web server.
			</p><div class="figure" id="certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-3"><p class="title"><strong>Figure 19.3. IdM CA issuing the service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/760743dd58ac7f0566834b5657089cbe/84_RHEL_IdM_0420_3.png" alt="A diagram displaying an arrow between the IdM CA server and the certmonger service on the IdM client - showing it is connecting and sending an HTTPS certificate."></div></div></div><p>
				<br>
			</p><p>
				<a class="link" href="#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-4" title="Figure 19.4. Certmonger applying the service certificate">Certmonger applying the service certificate</a> shows <code class="literal">certmonger</code> placing the HTTPS certificate in appropriate locations on the IdM client and, if instructed to do so, restarting the <code class="literal">httpd</code> service. The Apache server subsequently uses the HTTPS certificate to encrypt the traffic between itself and the browser.
			</p><div class="figure" id="certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-4"><p class="title"><strong>Figure 19.4. Certmonger applying the service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/710c6fb955eeee2dd6fbc2cd2a0e4ff8/84_RHEL_IdM_0420_4.png" alt="A diagram displaying an image of an HTTPS certificate assigned to the Apache web server and one assigned to the certmonger service. There are arrows between the browser and the Apache webserver showing that the connection is now an encrypted HTTPS connection. The connection between the certmonger service and the IdM CA server is inactive."></div></div></div><p>
				<br>
			</p><p>
				<a class="link" href="#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-5" title="Figure 19.5. Certmonger requesting a new certificate when the old one is nearing expiration">Certmonger requesting a new certificate when the old one is nearing expiration</a> shows <code class="literal">certmonger</code> automatically requesting a renewal of the service certificate from the IdM CA before the expiration of the certificate. The IdM CA issues a new certificate.
			</p><div class="figure" id="certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-5"><p class="title"><strong>Figure 19.5. Certmonger requesting a new certificate when the old one is nearing expiration</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/419091544b0b5520f3b5c2e321fc2de7/84_RHEL_IdM_0420_5.png" alt="A diagram displaying an arrow from the certmonger service on the IdM client connecting to the IdM CA server to show it is performing an ipa-getcert request. An arrow from the IdM CA server to the Certmonger is labeled HTTPS certificate to show it is transferring an HTTPS certificate to the certmonger service."></div></div></div><p>
				<br>
			</p></section><section class="section" id="viewing-cert-tracked-by-certmonger_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h3 class="title">19.4. Viewing the details of a certificate request tracked by certmonger</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal">certmonger</code> service monitors certificate requests. When a request for a certificate is successfully signed, it results in a certificate. <code class="literal">Certmonger</code> manages certificate requests including the resulting certificates. Follow this procedure to view the details of a particular certificate request managed by <code class="literal">certmonger</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						If you know how to specify the certificate request, list the details of only that particular certificate request. You can, for example, specify:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The request ID
							</li><li class="listitem">
								The location of the certificate
							</li><li class="listitem"><p class="simpara">
								The certificate nickname
							</p><p class="simpara">
								For example, to view the details of the certificate whose request ID is 20190408143846, using the <code class="literal">-v</code> option to view all the details of errors in case your request for a certificate was unsuccessful:
							</p><pre class="literallayout"># <span class="strong strong"><strong>getcert list -i 20190408143846 -v</strong></span>
Number of certificates and requests being tracked: 16.
Request ID '20190408143846':
	status: MONITORING
	stuck: no
	key pair storage: type=NSSDB,location='/etc/dirsrv/slapd-IDM-EXAMPLE-COM',nickname='Server-Cert',token='NSS Certificate DB',pinfile='/etc/dirsrv/slapd-IDM-EXAMPLE-COM/pwdfile.txt'
	certificate: type=NSSDB,location='/etc/dirsrv/slapd-IDM-EXAMPLE-COM',nickname='Server-Cert',token='NSS Certificate DB'
	CA: IPA
	issuer: CN=Certificate Authority,O=IDM.EXAMPLE.COM
	subject: CN=r8server.idm.example.com,O=IDM.EXAMPLE.COM
	expires: 2021-04-08 16:38:47 CEST
	dns: r8server.idm.example.com
	principal name: ldap/server.idm.example.com@IDM.EXAMPLE.COM
	key usage: digitalSignature,nonRepudiation,keyEncipherment,dataEncipherment
	eku: id-kp-serverAuth,id-kp-clientAuth
	pre-save command:
	post-save command: /usr/libexec/ipa/certmonger/restart_dirsrv IDM-EXAMPLE-COM
	track: true
	auto-renew: true</pre></li></ul></div><p class="simpara">
						The output displays several pieces of information about the certificate, for example:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								the certificate location; in the example above, it is the NSS database in the <code class="literal">/etc/dirsrv/slapd-IDM-EXAMPLE-COM</code> directory
							</li><li class="listitem">
								the certificate nickname; in the example above, it is <code class="literal">Server-Cert</code>
							</li><li class="listitem">
								the file storing the pin; in the example above, it is <code class="literal">/etc/dirsrv/slapd-IDM-EXAMPLE-COM/pwdfile.txt</code>
							</li><li class="listitem">
								the Certificate Authority (CA) that will be used to renew the certificate; in the example above, it is the <code class="literal">IPA</code> CA
							</li><li class="listitem">
								the expiration date; in the example above, it is <code class="literal">2021-04-08 16:38:47 CEST</code>
							</li><li class="listitem">
								the status of the certificate; in the example above, the <code class="literal">MONITORING</code> status means that the certificate is valid and it is being tracked
							</li><li class="listitem">
								the post-save command; in the example above, it is the restart of the <code class="literal">LDAP</code> service
							</li></ul></div></li><li class="listitem"><p class="simpara">
						If you do not know how to specify the certificate request, list the details of all the certificates that <code class="literal">certmonger</code> is monitoring or attempting to obtain:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert list</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">getcert list</code> man page on your system.
					</li></ul></div></section><section class="section" id="start-stop-cert-tracking_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h3 class="title">19.5. Starting and stopping certificate tracking</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use the <code class="literal">getcert stop-tracking</code> and <code class="literal">getcert start-tracking</code> commands to monitor certificates. The two commands are provided by the <code class="literal">certmonger</code> service. Enabling certificate tracking is especially useful if you have imported a certificate issued by the Identity Management (IdM) certificate authority (CA) onto the machine from a different IdM client. Enabling certificate tracking can also be the final step of the following provisioning scenario:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						On the IdM server, you create a certificate for a system that does not exist yet.
					</li><li class="listitem">
						You create the new system.
					</li><li class="listitem">
						You enroll the new system as an IdM client.
					</li><li class="listitem">
						You import the certificate and the key from the IdM server on to the IdM client.
					</li><li class="listitem">
						You start tracking the certificate using <code class="literal">certmonger</code> to ensure that it gets renewed when it is due to expire.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To disable the monitoring of a certificate with the Request ID of 20190408143846:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert stop-tracking -i 20190408143846</strong></span></pre><p class="simpara">
						For more options, see the <code class="literal">getcert stop-tracking</code> man page on your system.
					</p></li><li class="listitem"><p class="simpara">
						To enable the monitoring of a certificate stored in the <code class="literal">/tmp/some_cert.crt</code> file, whose private key is stored in the <code class="literal">/tmp/some_key.key</code> file:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert start-tracking -c IPA -f /tmp/some_cert.crt -k /tmp/some_key.key</strong></span></pre><p class="simpara">
						<code class="literal">Certmonger</code> cannot automatically identify the CA type that issued the certificate. For this reason, add the <code class="literal">-c</code> option with the <code class="literal">IPA</code> value to the <code class="literal">getcert start-tracking</code> command if the certificate was issued by the IdM CA. Omitting to add the <code class="literal">-c</code> option results in <code class="literal">certmonger</code> entering the NEED_CA state.
					</p><p class="simpara">
						For more options, see the <code class="literal">getcert start-tracking</code> man page on your system.
					</p></li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The two commands do not manipulate the certificate. For example, <code class="literal">getcert stop-tracking</code> does not delete the certificate or remove it from the NSS database or from the filesystem but simply removes the certificate from the list of monitored certificates. Similarly, <code class="literal">getcert start-tracking</code> only adds a certificate to the list of monitored certificates.
				</p></div></rh-alert></section><section class="section" id="renew-cert_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h3 class="title">19.6. Renewing a certificate manually</h3></div></div></div><p class="_abstract _abstract">
				When a certificate is near its expiration date, the <code class="literal">certmonger</code> daemon automatically issues a renewal command using the certificate authority (CA) helper, obtains a renewed certificate and replaces the previous certificate with the new one.
			</p><p>
				You can also manually renew a certificate in advance by using the <code class="literal">getcert resubmit</code> command. This way, you can update the information the certificate contains, for example, by adding a Subject Alternative Name (SAN).
			</p><p>
				Follow this procedure to renew a certificate manually.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To renew a certificate with the Request ID of 20190408143846:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert resubmit -i 20190408143846</strong></span></pre><p class="simpara">
						To obtain the Request ID for a specific certificate, use the <code class="literal">getcert list</code> command. For details, see the <code class="literal">getcert list</code> man page on your system.
					</p></li></ul></div></section><section class="section" id="add-tracking-back-to-idm-certs_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h3 class="title">19.7. Making certmonger resume tracking of IdM certificates on a CA replica</h3></div></div></div><p class="_abstract _abstract">
				This procedure shows how to make <code class="literal">certmonger</code> resume the tracking of Identity Management (IdM) system certificates that are crucial for an IdM deployment with an integrated certificate authority after the tracking of certificates was interrupted. The interruption may have been caused by the IdM host being unenrolled from IdM during the renewal of the system certificates or by replication topology not working properly. The procedure also shows how to make <code class="literal">certmonger</code> resume the tracking of the IdM service certificates, namely the <code class="literal">HTTP</code>, <code class="literal">LDAP</code> and <code class="literal">PKINIT</code> certificates.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The host on which you want to resume tracking system certificates is an IdM server that is also an IdM certificate authority (CA) but not the IdM CA renewal server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Get the PIN for the subsystem CA certificates:
					</p><pre class="literallayout"># <span class="strong strong"><strong>grep 'internal=' /var/lib/pki/pki-tomcat/conf/password.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Add tracking to the subsystem CA certificates, replacing <code class="literal">[internal PIN]</code> in the commands below with the PIN obtained in the previous step:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n "caSigningCert cert-pki-ca" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert "caSigningCert cert-pki-ca"' -T caCACert</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n "auditSigningCert cert-pki-ca" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert "auditSigningCert cert-pki-ca"' -T caSignedLogCert</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n "ocspSigningCert cert-pki-ca" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert "ocspSigningCert cert-pki-ca"' -T caOCSPCert</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n "subsystemCert cert-pki-ca" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert "subsystemCert cert-pki-ca"' -T caSubsystemCert</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n "Server-Cert cert-pki-ca" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert "Server-Cert cert-pki-ca"' -T caServerCert</strong></span></pre></li><li class="listitem"><p class="simpara">
						Add tracking for the remaining IdM certificates, the <code class="literal">HTTP</code>, <code class="literal">LDAP</code>, <code class="literal">IPA renewal agent</code> and <code class="literal">PKINIT</code> certificates:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert start-tracking -f /var/lib/ipa/certs/httpd.crt -k /var/lib/ipa/private/httpd.key -p /var/lib/ipa/passwds/idm.example.com-443-RSA -c IPA -C /usr/libexec/ipa/certmonger/restart_httpd -T caIPAserviceCert</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -d /etc/dirsrv/slapd-IDM-EXAMPLE-COM -n "Server-Cert" -c IPA -p /etc/dirsrv/slapd-IDM-EXAMPLE-COM/pwdfile.txt -C '/usr/libexec/ipa/certmonger/restart_dirsrv "IDM-EXAMPLE-COM"' -T caIPAserviceCert</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -f /var/lib/ipa/ra-agent.pem -k /var/lib/ipa/ra-agent.key -c dogtag-ipa-ca-renew-agent -B /usr/libexec/ipa/certmonger/renew_ra_cert_pre -C /usr/libexec/ipa/certmonger/renew_ra_cert -T caSubsystemCert</strong></span>

# <span class="strong strong"><strong>getcert start-tracking -f /var/kerberos/krb5kdc/kdc.crt -k /var/kerberos/krb5kdc/kdc.key -c dogtag-ipa-ca-renew-agent -B /usr/libexec/ipa/certmonger/renew_ra_cert_pre -C /usr/libexec/ipa/certmonger/renew_kdc_cert -T KDCs_PKINIT_Certs</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart <code class="literal">certmonger</code>:
					</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart certmonger</strong></span></pre></li><li class="listitem"><p class="simpara">
						Wait for one minute after <code class="literal">certmonger</code> has started and then check the statuses of the new certificates:
					</p><pre class="literallayout"># <span class="strong strong"><strong>getcert list</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						If your IdM system certificates have all expired, see <a class="link" href="https://access.redhat.com/solutions/3357261">this Knowledge Centered Support (KCS) solution</a> to manually renew IdM system certificates on the IdM CA server that is also the CA renewal server and the CRL publisher server. Then follow the procedure described in <a class="link" href="https://access.redhat.com/solutions/3357331">this KCS solution</a> to manually renew IdM system certificates on all the other CA servers in the topology.
					</li></ul></div></section><section class="section" id="assembly_using-scep-with-certmonger_certmonger-for-issuing-renewing-service-certs"><div class="titlepage"><div><div><h3 class="title">19.8. Using SCEP with certmonger</h3></div></div></div><p>
				The Simple Certificate Enrollment Protocol (SCEP) is a certificate management protocol that you can use across different devices and operating systems. If you are using a SCEP server as an external certificate authority (CA) in your environment, you can use <code class="literal">certmonger</code> to obtain a certificate for an Identity Management (IdM) client.
			</p><section class="section" id="con_scep-overview_assembly_using-scep-with-certmonger"><div class="titlepage"><div><div><h4 class="title">19.8.1. SCEP overview</h4></div></div></div><p>
					The Simple Certificate Enrollment Protocol (SCEP) is a certificate management protocol that you can use across different devices and operating systems. You can use a SCEP server as an external certificate authority (CA).
				</p><p>
					You can configure an Identity Management (IdM) client to request and retrieve a certificate over HTTP directly from the CA SCEP service. This process is secured by a shared secret that is usually valid only for a limited time.
				</p><p>
					On the client side, SCEP requires you to provide the following components:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							SCEP URL: the URL of the CA SCEP interface.
						</li><li class="listitem">
							SCEP shared secret: a <code class="literal">challengePassword</code> PIN shared between the CA and the SCEP client, used to obtain the certificate.
						</li></ul></div><p>
					The client then retrieves the CA certificate chain over SCEP and sends a certificate signing request to the CA.
				</p><p>
					When configuring SCEP with <code class="literal">certmonger</code>, you create a new CA configuration profile that specifies the issued certificate parameters.
				</p></section><section class="section" id="proc_requesting-an-idm-ca-signed-certificate-through-scep_assembly_using-scep-with-certmonger"><div class="titlepage"><div><div><h4 class="title">19.8.2. Requesting an IdM CA-signed certificate through SCEP</h4></div></div></div><p>
					The following example adds a <code class="literal">SCEP_example</code> SCEP CA configuration to <code class="literal">certmonger</code> and requests a new certificate on the <code class="literal">client.idm.example.com</code> IdM client. <code class="literal">certmonger</code> supports both the NSS certificate database format and file-based (PEM) formats, such as OpenSSL.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You know the SCEP URL.
						</li><li class="listitem">
							You have the <code class="literal">challengePassword</code> PIN shared secret.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Add the CA configuration to <code class="literal">certmonger</code>:
						</p><pre class="literallayout">[root@client.idm.example.com ~]# getcert add-scep-ca -c <span class="emphasis"><em>SCEP_example</em></span> -u <span class="emphasis"><em>SCEP_URL</em></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">-c</code>: Mandatory nickname for the CA configuration. The same value can later be used with other <code class="literal">getcert</code> commands.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">-u</code>: URL of the server’s SCEP interface.
								</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
										When using an HTTPS URL, you must also specify the location of the PEM-formatted copy of the SCEP server CA certificate using the <code class="literal">-R</code> option.
									</p></div></rh-alert></li></ul></div></li><li class="listitem"><p class="simpara">
							Verify that the CA configuration has been successfully added:
						</p><pre class="literallayout">[root@client.idm.example.com ~]# getcert list-cas -c SCEP_example
CA 'SCEP_example':
       is-default: no
       ca-type: EXTERNAL
       helper-location: /usr/libexec/certmonger/scep-submit -u http://SCEP_server_enrollment_interface_URL
       SCEP CA certificate thumbprint (MD5): A67C2D4B 771AC186 FCCA654A 5E55AAF7
       SCEP CA certificate thumbprint (SHA1): FBFF096C 6455E8E9 BD55F4A5 5787C43F 1F512279</pre><p class="simpara">
							If the configuration was successfully added, certmonger retrieves the CA chain from the remote CA. The CA chain then appears as thumbprints in the command output. When accessing the server over unencrypted HTTP, manually compare the thumbprints with the ones displayed at the SCEP server to prevent a man-in-the-middle attack.
						</p></li><li class="listitem"><p class="simpara">
							Request a certificate from the CA:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If you are using NSS:
								</p><pre class="literallayout">[root@client.idm.example.com ~]# getcert request -I <span class="emphasis"><em>Example_Task</em></span> -c <span class="emphasis"><em>SCEP_example</em></span> -d /etc/pki/nssdb -n <span class="emphasis"><em>ExampleCert</em></span> -N cn="<span class="emphasis"><em>client.idm.example.com</em></span>" -L <span class="emphasis"><em>one-time_PIN</em></span> -D <span class="emphasis"><em>client.idm.example.com</em></span></pre><p class="simpara">
									You can use the options to specify the following parameters of the certificate request:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">-I</code>: <span class="emphasis"><em>(Optional)</em></span> Name of the task: the tracking ID for the request. The same value can later be used with the <code class="literal">getcert list</code> command.
										</li><li class="listitem">
											<code class="literal">-c</code>: CA configuration to submit the request to.
										</li><li class="listitem">
											<code class="literal">-d</code>: Directory with the NSS database to store the certificate and key.
										</li><li class="listitem">
											<code class="literal">-n</code>: Nickname of the certificate, used in the NSS database.
										</li><li class="listitem">
											<code class="literal">-N</code>: Subject name in the CSR.
										</li><li class="listitem">
											<code class="literal">-L</code>: Time-limited one-time <code class="literal">challengePassword</code> PIN issued by the CA.
										</li><li class="listitem">
											<code class="literal">-D</code>: Subject Alternative Name for the certificate, usually the same as the host name.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									If you are using OpenSSL:
								</p><pre class="literallayout">[root@client.idm.example.com ~]# getcert request -I <span class="emphasis"><em>Example_Task</em></span> -c <span class="emphasis"><em>SCEP_example</em></span> -f /etc/pki/tls/certs/server.crt -k /etc/pki/tls/private/private.key -N cn="<span class="emphasis"><em>client.idm.example.com</em></span>" -L <span class="emphasis"><em>one-time_PIN</em></span> -D <span class="emphasis"><em>client.idm.example.com</em></span></pre><p class="simpara">
									You can use the options to specify the following parameters of the certificate request:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">-I</code>: <span class="emphasis"><em>(Optional)</em></span> Name of the task: the tracking ID for the request. The same value can later be used with the <code class="literal">getcert list</code> command.
										</li><li class="listitem">
											<code class="literal">-c</code>: CA configuration to submit the request to.
										</li><li class="listitem">
											<code class="literal">-f</code>: Storage path to the certificate.
										</li><li class="listitem">
											<code class="literal">-k</code>: Storage path to the key.
										</li><li class="listitem">
											<code class="literal">-N</code>: Subject name in the CSR.
										</li><li class="listitem">
											<code class="literal">-L</code>: Time-limited one-time <code class="literal">challengePassword</code> PIN issued by the CA.
										</li><li class="listitem">
											<code class="literal">-D</code>: Subject Alternative Name for the certificate, usually the same as the host name.
										</li></ul></div></li></ul></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Verify that a certificate was issued and correctly stored in the local database:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If you used NSS, enter:
								</p><pre class="screen">[root@client.idm.example.com ~]# getcert list -I Example_Task
	Request ID 'Example_Task':
        status: MONITORING
        stuck: no
        key pair storage: type=NSSDB,location='/etc/pki/nssdb',nickname='ExampleCert',token='NSS Certificate DB'
        certificate: type=NSSDB,location='/etc/pki/nssdb',nickname='ExampleCert',token='NSS Certificate DB'
        signing request thumbprint (MD5): 503A8EDD DE2BE17E 5BAA3A57 D68C9C1B
        signing request thumbprint (SHA1): B411ECE4 D45B883A 75A6F14D 7E3037F1 D53625F4
        CA: IPA
        issuer: CN=Certificate Authority,O=EXAMPLE.COM
        subject: CN=client.idm.example.com,O=EXAMPLE.COM
        expires: 2018-05-06 10:28:06 UTC
        key usage: digitalSignature,keyEncipherment
        eku: iso.org.dod.internet.security.mechanisms.8.2.2
        certificate template/profile: IPSECIntermediateOffline
        pre-save command:
        post-save command:
        track: true
	auto-renew: true</pre></li><li class="listitem"><p class="simpara">
									If you used OpenSSL, enter:
								</p><pre class="screen">[root@client.idm.example.com ~]# getcert list -I Example_Task
Request ID 'Example_Task':
       status: MONITORING
       stuck: no
       key pair storage: type=FILE,location='/etc/pki/tls/private/private.key'
       certificate: type=FILE,location='/etc/pki/tls/certs/server.crt'
       CA: IPA
       issuer: CN=Certificate Authority,O=EXAMPLE.COM
       subject: CN=client.idm.example.com,O=EXAMPLE.COM
       expires: 2018-05-06 10:28:06 UTC
       eku: id-kp-serverAuth,id-kp-clientAuth
       pre-save command:
       post-save command:
       track: true
       auto-renew: true</pre><p class="simpara">
									The status <span class="strong strong"><strong>MONITORING</strong></span> signifies a successful retrieval of the issued certificate. The <code class="literal">getcert-list(1)</code> man page lists other possible states and their meanings.
								</p></li></ul></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							For more options when requesting a certificate, see the <code class="literal">getcert-request(1)</code> man page on your system.
						</li></ul></div></section><section class="section" id="proc_automatically-renewing-ad-scep-certificates-with-certmonger_assembly_using-scep-with-certmonger"><div class="titlepage"><div><div><h4 class="title">19.8.3. Automatically renewing AD SCEP certificates with certmonger</h4></div></div></div><p>
					When <code class="literal">certmonger</code> sends a SCEP certificate renewal request, this request is signed using the existing certificate private key. However, renewal requests sent by <code class="literal">certmonger</code> by default also include the <code class="literal">challengePassword</code> PIN that was used to originally obtain the certificates.
				</p><p>
					An Active Directory (AD) Network Device Enrollment Service (NDES) server that works as the SCEP server automatically rejects any requests for renewal that contain the original <code class="literal">challengePassword</code> PIN. Consequently, the renewal fails.
				</p><p>
					For renewal with AD to work, you need to configure <code class="literal">certmonger</code> to send the signed renewal requests without the <code class="literal">challengePassword</code> PIN. You also need to configure the AD server so that it does not compare the subject name at renewal.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						There may be SCEP servers other than AD that also refuse requests containing the <code class="literal">challengePassword</code>. In those cases, you may also need to change the <code class="literal">certmonger</code> configuration in this way.
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The RHEL server has to be running RHEL 8.6 or newer.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Open <code class="literal">regedit</code> on the AD server.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography\MSCEP</strong></span> subkey, add a new 32-bit REG_DWORD entry <code class="literal">DisableRenewalSubjectNameMatch</code> and set its value to <code class="literal">1</code>.
						</li><li class="listitem"><p class="simpara">
							On the server where <code class="literal">certmonger</code> is running, open the <code class="literal">/etc/certmonger/certmonger.conf</code> file and add the following section:
						</p><pre class="screen">[scep]
challenge_password_otp = yes</pre></li><li class="listitem"><p class="simpara">
							Restart certmonger:
						</p><pre class="screen"># systemctl restart certmonger</pre></li></ol></div></section></section></section><section class="chapter" id="deploying-and-managing-the-acme-service-in-idm_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 20. Deploying and managing the ACME service in IdM</h2></div></div></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
				This feature is a technology preview.
			</p></div></rh-alert><p>
			Automated Certificate Management Environment (ACME) is a protocol for automated identifier validation and certificate issuance. Its goal is to improve security by reducing certificate lifetimes and avoiding manual processes in certificate lifecycle management.
		</p><p>
			Using RHEL Identity Management (IdM), the administrator can easily deploy and manage the ACME service topology-wide from a single system.
		</p><section class="section" id="the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm"><div class="titlepage"><div><div><h3 class="title">20.1. The ACME service in IdM</h3></div></div></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					This feature is a technology preview.
				</p></div></rh-alert><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					IdM currently supports ACME only in RHEL 9.2 or newer with Random Certificate Serial Numbers (RSNv3) enabled.
				</p></div></rh-alert><p>
				ACME uses a challenge and response authentication mechanism to prove that a client has control of an identifier. In ACME, an identifier is a proof of ownership used to obtain a certificate by solving a challenge. In Identity Management (IdM), ACME currently supports the following challenges:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">dns-01</code> where the client creates DNS records to prove it has control of the identifier
					</li><li class="listitem">
						<code class="literal">http-01</code> where the client provisions an HTTP resource to prove it has control of the identifier
					</li></ul></div><p>
				In IdM, the ACME service uses the PKI ACME responder. The ACME subsystem is automatically deployed on every CA server in the IdM deployment, but it will not service requests until the administrator enables it. The servers are discovered using the name <code class="literal">ipa-ca.DOMAIN</code>. All IdM CA servers are registered with this DNS name so requests are load balanced via round-robin to them.
			</p><p>
				ACME is also deployed, but disabled, when the administrator upgrades a server using the <code class="literal">ipa-server-upgrade</code> command.
			</p><p>
				ACME runs as a separate service within Apache Tomcat. The ACME configuration files are stored in <code class="literal">/etc/pki/pki-tomcat/acme</code> and PKI logs ACME information to <code class="literal">/var/log/pki/pki-tomcat/acme/</code>.
			</p><p>
				IdM uses the <code class="literal">acmeIPAServerCert</code> profile when issuing ACME certificates. The validity period of issued certificates is 90 days. For this reason, it is strongly recommended to set ACME to automatically remove expired certificates so that they do not accumulate in the CA, as this could negatively affect performance.
			</p><p>
				There are different ACME clients available. For use with RHEL, the chosen client must support either of the <code class="literal">dns-01</code> and <code class="literal">http-01</code> challenges. Currently, the following clients have been tested and are known to work with ACME in RHEL:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">certbot</code> with both the <code class="literal">http-01</code> and <code class="literal">dns-01</code> challenges
					</li><li class="listitem">
						<code class="literal">mod_md</code>, which supports only the <code class="literal">http-01</code> challenge
					</li></ul></div></section><section class="section" id="enabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm"><div class="titlepage"><div><div><h3 class="title">20.2. Enabling the ACME service in IdM</h3></div></div></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					This feature is a technology preview.
				</p></div></rh-alert><p>
				By default, the ACME service is deployed, but disabled. Enabling the ACME service enables it on all IdM CA servers across the entire IdM deployment. This is handled via replication.
			</p><p>
				In this example, you enable ACME and set it to automatically remove expired certificates on the first day of every month at midnight.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Servers in the IdM deployment are running RHEL 9.2 or newer with Random Certificate Serial Numbers (RSNv3) enabled.
					</li><li class="listitem">
						You have root privileges on the IdM server on which you are running the procedure.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enable ACME across the whole IdM deployment:
					</p><pre class="screen"># ipa-acme-manage enable
The ipa-acme-manage command was successful</pre></li><li class="listitem"><p class="simpara">
						Set ACME to automatically remove expired certificates from the CA:
					</p><pre class="screen"># ipa-acme-manage pruning --enable --cron "0 0 1 * *"</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Expired certificates are removed after their retention period. By default, this is 30 days after expiry.
						</p></div></rh-alert></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						To check if the ACME service is installed and enabled, use the <code class="literal command">ipa-acme-manage status</code> command:
					</li></ul></div><pre class="screen"># ipa-acme-manage status
ACME is enabled
The ipa-acme-manage command was successful</pre></section><section class="section" id="disabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm"><div class="titlepage"><div><div><h3 class="title">20.3. Disabling the ACME service in IdM</h3></div></div></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					This feature is a technology preview.
				</p></div></rh-alert><p>
				Disabling the ACME service disables it across the entire IdM deployment. This is handled via replication.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Servers in the IdM deployment are running RHEL 9.2 or newer with Random Certificate Serial Numbers (RSNv3) enabled.
					</li><li class="listitem">
						You have root privileges on the IdM server on which you are running the procedure.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Disable ACME across the whole IdM deployment:
					</p><pre class="screen"># ipa-acme-manage disable
The ipa-acme-manage command was successful</pre></li><li class="listitem"><p class="simpara">
						Optional: Disable automatic removal of expired certificates:
					</p><pre class="screen">ipa-acme-manage pruning --disable</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						To check if the ACME service is installed, but disabled, use the <code class="literal command">ipa-acme-manage status</code> command:
					</li></ul></div><pre class="screen"># ipa-acme-manage status
ACME is disabled
The ipa-acme-manage command was successful</pre></section></section><section class="chapter" id="requesting-certificates-using-rhel-system-roles_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 21. Requesting certificates by using the RHEL system role</h2></div></div></div><p class="_abstract _abstract">
			You can use the <code class="literal">certificate</code> system role to issue and manage certificates.
		</p><section class="section" id="the-certificate-system-role_requesting-certificates-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">21.1. The <code class="literal">certificate</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				Using the <code class="literal">certificate</code> system role, you can manage issuing and renewing TLS and SSL certificates using Ansible Core.
			</p><p>
				The role uses <code class="literal">certmonger</code> as the certificate provider, and currently supports issuing and renewing self-signed certificates and using the IdM integrated certificate authority (CA).
			</p><p>
				You can use the following variables in your Ansible playbook with the <code class="literal">certificate</code> system role:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">certificate_wait</code></span></dt><dd>
							to specify if the task should wait for the certificate to be issued.
						</dd><dt><span class="term"><code class="literal">certificate_requests</code></span></dt><dd>
							to represent each certificate to be issued and its parameters.
						</dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/certificate/</code> directory
					</li></ul></div></section><section class="section" id="requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">21.2. Requesting a new self-signed certificate by using the <code class="literal">certificate</code> RHEL system role</h3></div></div></div><p>
				With the <code class="literal">certificate</code> system role, you can use Ansible Core to issue self-signed certificates.
			</p><p>
				This process uses the <code class="literal">certmonger</code> provider and requests the certificate through the <code class="literal">getcert</code> command.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- hosts: managed-node-01.example.com
  roles:
    - rhel-system-roles.certificate
  vars:
    certificate_requests:
      - name: mycert
        dns: "*.example.com"
        ca: self-sign</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">name</code> parameter to the desired name of the certificate, such as <code class="literal">mycert</code>.
							</li><li class="listitem">
								Set the <code class="literal">dns</code> parameter to the domain to be included in the certificate, such as <code class="literal">*.example.com</code>.
							</li><li class="listitem">
								Set the <code class="literal">ca</code> parameter to <code class="literal">self-sign</code>.
							</li></ul></div><p class="simpara">
						By default, <code class="literal">certmonger</code> automatically tries to renew the certificate before it expires. You can disable this by setting the <code class="literal">auto_renew</code> parameter in the Ansible playbook to <code class="literal">no</code>.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/certificate/</code> directory
					</li></ul></div></section><section class="section" id="requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">21.3. Requesting a new certificate from IdM CA by using the <code class="literal">certificate</code> RHEL system role</h3></div></div></div><p>
				With the <code class="literal">certificate</code> system role, you can use <code class="literal">anible-core</code> to issue certificates while using an IdM server with an integrated certificate authority (CA). Therefore, you can efficiently and consistently manage the certificate trust chain for multiple systems when using IdM as the CA.
			</p><p>
				This process uses the <code class="literal">certmonger</code> provider and requests the certificate through the <code class="literal">getcert</code> command.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- hosts: managed-node-01.example.com
  roles:
    - rhel-system-roles.certificate
  vars:
    certificate_requests:
      - name: mycert
        dns: www.example.com
        principal: HTTP/www.example.com@EXAMPLE.COM
        ca: ipa</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">name</code> parameter to the desired name of the certificate, such as <code class="literal">mycert</code>.
							</li><li class="listitem">
								Set the <code class="literal">dns</code> parameter to the domain to be included in the certificate, such as <code class="literal">www.example.com</code>.
							</li><li class="listitem">
								Set the <code class="literal">principal</code> parameter to specify the Kerberos principal, such as <code class="literal">HTTP/www.example.com@EXAMPLE.COM</code>.
							</li><li class="listitem">
								Set the <code class="literal">ca</code> parameter to <code class="literal">ipa</code>.
							</li></ul></div><p class="simpara">
						By default, <code class="literal">certmonger</code> automatically tries to renew the certificate before it expires. You can disable this by setting the <code class="literal">auto_renew</code> parameter in the Ansible playbook to <code class="literal">no</code>.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/certificate/</code> directory
					</li></ul></div></section><section class="section" id="specifying-commands-to-run-before-or-after-certificate-issuance-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">21.4. Specifying commands to run before or after certificate issuance by using the <code class="literal">certificate</code> RHEL system role</h3></div></div></div><p>
				With the <code class="literal">certificate</code> Role, you can use Ansible Core to execute a command before and after a certificate is issued or renewed.
			</p><p>
				In the following example, the administrator ensures stopping the <code class="literal">httpd</code> service before a self-signed certificate for <code class="literal">www.example.com</code> is issued or renewed, and restarting it afterwards.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- hosts: managed-node-01.example.com
  roles:
    - rhel-system-roles.certificate
  vars:
    certificate_requests:
      - name: mycert
        dns: www.example.com
        ca: self-sign
        run_before: systemctl stop httpd.service
        run_after: systemctl start httpd.service</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">name</code> parameter to the desired name of the certificate, such as <code class="literal">mycert</code>.
							</li><li class="listitem">
								Set the <code class="literal">dns</code> parameter to the domain to be included in the certificate, such as <code class="literal">www.example.com</code>.
							</li><li class="listitem">
								Set the <code class="literal">ca</code> parameter to the CA you want to use to issue the certificate, such as <code class="literal">self-sign</code>.
							</li><li class="listitem">
								Set the <code class="literal">run_before</code> parameter to the command you want to execute before this certificate is issued or renewed, such as <code class="literal">systemctl stop httpd.service</code>.
							</li><li class="listitem">
								Set the <code class="literal">run_after</code> parameter to the command you want to execute after this certificate is issued or renewed, such as <code class="literal">systemctl start httpd.service</code>.
							</li></ul></div><p class="simpara">
						By default, <code class="literal">certmonger</code> automatically tries to renew the certificate before it expires. You can disable this by setting the <code class="literal">auto_renew</code> parameter in the Ansible playbook to <code class="literal">no</code>.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/certificate/</code> directory
					</li></ul></div></section></section><section class="chapter" id="restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 22. Restricting an application to trust only a subset of certificates</h2></div></div></div><p class="_abstract _abstract">
			If your Identity Management (IdM) installation is configured with the integrated Certificate System (CS) certificate authority (CA), you are able to create lightweight sub-CAs. All sub-CAs you create are subordinated to the primary CA of the certificate system, the <span class="strong strong"><strong>ipa</strong></span> CA.
		</p><p>
			A <span class="emphasis"><em>lightweight sub-CA</em></span> in this context means <span class="emphasis"><em>a sub-CA issuing certificates for a specific purpose</em></span>. For example, a lightweight sub-CA enables you to configure a service, such as a virtual private network (VPN) gateway and a web browser, to accept only certificates issued by <span class="emphasis"><em>sub-CA A</em></span>. By configuring other services to accept certificates only issued by <span class="emphasis"><em>sub-CA B</em></span>, you prevent them from accepting certificates issued by <span class="emphasis"><em>sub-CA A</em></span>, the primary CA, that is the <code class="literal">ipa</code> CA, and any intermediate sub-CA between the two.
		</p><p>
			If you revoke the intermediate certificate of a sub-CA, <a class="link" href="#invalidating-a-specific-group-of-related-certificates-quickly_managing-certificates-in-idm" title="Chapter 23. Invalidating a specific group of related certificates quickly">all certificates issued by this sub-CA are automatically considered invalid</a> by correctly configured clients. All the other certificates issued directly by the root CA, <span class="strong strong"><strong>ipa</strong></span>, or another sub-CA, remain valid.
		</p><p>
			This section uses the example of the Apache web server to illustrate how to restrict an application to trust only a subset of certificates. Complete this section to restrict the web server running on your IdM client to use a certificate issued by the <span class="strong strong"><strong>webserver-ca</strong></span> IdM sub-CA, and to require the users to authenticate to the web server using user certificates issued by the <span class="strong strong"><strong>webclient-ca</strong></span> IdM sub-CA.
		</p><p>
			The steps you need to take are:
		</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
					<a class="link" href="#creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs" title="22.1. Managing lightweight sub-CAs">Create an IdM sub-CA</a>
				</li><li class="listitem">
					<a class="link" href="#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" title="22.2. Downloading the sub-CA certificate from IdM WebUI">Download the sub-CA certificate from IdM WebUI</a>
				</li><li class="listitem">
					<a class="link" href="#creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs" title="22.3. Creating CA ACLs for web server and client authentication">Create a CA ACL specifying the correct combination of users, services and CAs, and the certificate profile used</a>
				</li><li class="listitem">
					<a class="link" href="#obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs" title="22.4. Obtaining an IdM certificate for a service using certmonger">Request a certificate for the web service running on an IdM client from the IdM sub-CA</a>
				</li><li class="listitem">
					<a class="link" href="#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" title="22.6. Setting up a single-instance Apache HTTP Server">Set up a single-instance Apache HTTP Server</a>
				</li><li class="listitem">
					<a class="link" href="#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs" title="22.7. Adding TLS encryption to an Apache HTTP Server">Add TLS encryption to the Apache HTTP Server</a>
				</li><li class="listitem">
					<a class="link" href="#setting-the-supported-tls-protocol-versions-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" title="22.8. Setting the supported TLS protocol versions on an Apache HTTP Server">Set the supported TLS protocol versions on an Apache HTTP Server</a>
				</li><li class="listitem">
					<a class="link" href="#setting-the-supported-ciphers-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs" title="22.9. Setting the supported ciphers on an Apache HTTP Server">Set the supported ciphers on the Apache HTTP Server</a>
				</li><li class="listitem">
					<a class="link" href="#configuring-tls-client-certificate-authentication_restricting-an-application-to-trust-a-subset-of-certs" title="22.10. Configuring TLS client certificate authentication">Configure TLS client certificate authentication on the web server</a>
				</li><li class="listitem">
					<a class="link" href="#requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs" title="22.11. Requesting a new user certificate and exporting it to the client">Request a certificate for the user from the IdM sub-CA and export it to the client</a>
				</li><li class="listitem">
					<a class="link" href="#configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs" title="22.12. Configuring a browser to enable certificate authentication">Import the user certificate into the browser and configure the browser to trust the sub-CA certificate</a>
				</li></ol></div><section class="section" id="creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.1. Managing lightweight sub-CAs</h3></div></div></div><p class="_abstract _abstract">
				This section describes how to manage lightweight subordinate certificate authorities (sub-CAs). All sub-CAs you create are subordinated to the primary CA of the certificate system, the <code class="literal">ipa</code> CA. You can also disable and delete sub-CAs.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If you delete a sub-CA, revocation checking for that sub-CA will no longer work. Only delete a sub-CA when there are no more certificates that were issued by that sub-CA whose <code class="literal">notAfter</code> expiration time is in the future.
						</li><li class="listitem">
							You should only disable sub-CAs while there are still non-expired certificates that were issued by that sub-CA. If all certificates that were issued by a sub-CA have expired, you can delete that sub-CA.
						</li><li class="listitem">
							You cannot disable or delete the IdM CA.
						</li></ul></div></div></rh-alert><p>
				For details on managing sub-CAs, see:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#creating-a-sub-CA-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" title="22.1.1. Creating a sub-CA from the IdM WebUI">Creating a sub-CA from the IdM WebUI</a>
					</li><li class="listitem">
						<a class="link" href="#proc_deleting-a-sub-ca-from-the-idm-webui_restricting-an-application-to-trust-a-subset-of-certs" title="22.1.2. Deleting a sub-CA from the IdM WebUI">Deleting a sub-CA from the IdM WebUI</a>
					</li><li class="listitem">
						<a class="link" href="#creating-a-sub-CA-from-IdM-CLI_restricting-an-application-to-trust-a-subset-of-certs" title="22.1.3. Creating a sub-CA from the IdM CLI">Creating a sub-CA from the IdM CLI</a>
					</li><li class="listitem">
						<a class="link" href="#proc_disabling-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs" title="22.1.4. Disabling a sub-CA from the IdM CLI">Disabling a sub-CA from the IdM CLI</a>
					</li><li class="listitem">
						<a class="link" href="#proc_deleting-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs" title="22.1.5. Deleting a sub-CA from the IdM CLI">Deleting a sub-CA from the IdM CLI </a>
					</li></ul></div><section class="section" id="creating-a-sub-CA-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h4 class="title">22.1.1. Creating a sub-CA from the IdM WebUI</h4></div></div></div><p class="_abstract _abstract">
					Follow this procedure to use the IdM WebUI to create new sub-CAs named <span class="strong strong"><strong>webserver-ca</strong></span> and <span class="strong strong"><strong>webclient-ca</strong></span>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Make sure you have obtained the administrator’s credentials.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the <span class="strong strong"><strong>Authentication</strong></span> menu, click <span class="strong strong"><strong>Certificates</strong></span>.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>Certificate Authorities</strong></span> and click <span class="strong strong"><strong>Add</strong></span>.
						</li><li class="listitem">
							Enter the name of the <span class="strong strong"><strong>webserver-ca</strong></span> sub-CA. Enter the Subject DN, for example <span class="strong strong"><strong>CN=WEBSERVER,O=IDM.EXAMPLE.COM</strong></span>, in the Subject DN field. Note that the Subject DN must be unique in the IdM CA infrastructure.
						</li><li class="listitem">
							Enter the name of the <span class="strong strong"><strong>webclient-ca</strong></span> sub-CA. Enter the Subject DN <span class="strong strong"><strong>CN=WEBCLIENT,O=IDM.EXAMPLE.COM</strong></span> in the Subject DN field.
						</li><li class="listitem"><p class="simpara">
							In the command-line interface, run the <code class="literal">ipa-certupdate</code> command to create a <span class="strong strong"><strong>certmonger</strong></span> tracking request for the <span class="strong strong"><strong>webserver-ca</strong></span> and <span class="strong strong"><strong>webclient-ca</strong></span> sub-CA certificates:
						</p><pre class="literallayout">[root@ipaserver ~]# <code class="literal">ipa-certupdate</code></pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
								Forgetting to run the <code class="literal">ipa-certupdate</code> command after creating a sub-CA means that if the sub-CA certificate expires, end-entity certificates issued by the sub-CA are considered invalid even if the end-entity certificate has not expired.
							</p></div></rh-alert></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Verify that the signing certificate of the new sub-CA has been added to the IdM database:
						</p><pre class="literallayout">[root@ipaserver ~]# <code class="literal">certutil -d /etc/pki/pki-tomcat/alias/ -L</code>

Certificate Nickname                      Trust Attributes
                                          SSL,S/MIME,JAR/XPI

caSigningCert cert-pki-ca                 CTu,Cu,Cu
Server-Cert cert-pki-ca                   u,u,u
auditSigningCert cert-pki-ca              u,u,Pu
<span class="strong strong"><strong>caSigningCert cert-pki-ca ba83f324-5e50-4114-b109-acca05d6f1dc u,u,u</strong></span>
ocspSigningCert cert-pki-ca               u,u,u
subsystemCert cert-pki-ca                 u,u,u</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								The new sub-CA certificate is automatically transferred to all the replicas that have a certificate system instance installed.
							</p></div></rh-alert></li></ul></div></section><section class="section" id="proc_deleting-a-sub-ca-from-the-idm-webui_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h4 class="title">22.1.2. Deleting a sub-CA from the IdM WebUI</h4></div></div></div><p class="_abstract _abstract">
					Follow this procedure to delete lightweight sub-CAs in the IdM WebUI.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								If you delete a sub-CA, revocation checking for that sub-CA will no longer work. Only delete a sub-CA when there are no more certificates that were issued by that sub-CA whose <code class="literal">notAfter</code> expiration time is in the future.
							</li><li class="listitem">
								You should only disable sub-CAs while there are still non-expired certificates that were issued by that sub-CA. If all certificates that were issued by a sub-CA have expired, you can delete that sub-CA.
							</li><li class="listitem">
								You cannot disable or delete the IdM CA.
							</li></ul></div></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Make sure you have obtained the administrator’s credentials.
						</li><li class="listitem">
							You have disabled the sub-CA in the IdM CLI. See <a class="link" href="#proc_disabling-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs" title="22.1.4. Disabling a sub-CA from the IdM CLI">Disabling a sub-CA from the IdM CLI</a>
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the IdM WebUI, open the <code class="literal">Authentication</code> tab, and select the <code class="literal">Certificates</code> subtab.
						</li><li class="listitem">
							Select <code class="literal">Certificate Authorities</code>.
						</li><li class="listitem"><p class="simpara">
							Select the sub-CA to remove and click <code class="literal">Delete</code>.
						</p><div class="figure" id="idm140333359125248"><p class="title"><strong>Figure 22.1. Deleting a sub-CA in the IdM Web UI</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/a7c0503e43bce4a0d78b3f8fbef89f06/deletingsubca.png" alt="Screenshot of the &quot;Certificate Authorities&quot; screen where you can add and delete certificate authorities and subordinate certificate authorities."></div></div></div></li><li class="listitem">
							Click <code class="literal">Delete</code> to confirm.
						</li></ol></div><p>
					The sub-CA is removed from the list of <code class="literal">Certificate Authorities</code>.
				</p></section><section class="section" id="creating-a-sub-CA-from-IdM-CLI_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h4 class="title">22.1.3. Creating a sub-CA from the IdM CLI</h4></div></div></div><p class="_abstract _abstract">
					Follow this procedure to use the IdM CLI to create new sub-CAs named <span class="strong strong"><strong>webserver-ca</strong></span> and <span class="strong strong"><strong>webclient-ca</strong></span>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Make sure that you have obtained the administrator’s credentials.
						</li><li class="listitem">
							Make sure you are logged in to an IdM server that is a CA server.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Enter the <code class="literal">ipa ca-add</code> command, and specify the name of the <span class="strong strong"><strong>webserver-ca</strong></span> sub-CA and its Subject Distinguished Name (DN):
						</p><pre class="literallayout">[root@ipaserver ~]# <code class="literal">ipa ca-add <span class="emphasis"><em>webserver-ca</em></span> --subject="<span class="emphasis"><em>CN=WEBSERVER,O=IDM.EXAMPLE.COM</em></span>"</code>
-------------------
Created CA "webserver-ca"
-------------------
  Name: webserver-ca
  Authority ID: ba83f324-5e50-4114-b109-acca05d6f1dc
  Subject DN: CN=WEBSERVER,O=IDM.EXAMPLE.COM
  Issuer DN: CN=Certificate Authority,O=IDM.EXAMPLE.COM</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term">Name</span></dt><dd>
										Name of the CA.
									</dd><dt><span class="term">Authority ID</span></dt><dd>
										Automatically created, individual ID for the CA.
									</dd><dt><span class="term">Subject DN</span></dt><dd>
										Subject Distinguished Name (DN). The Subject DN must be unique in the IdM CA infrastructure.
									</dd><dt><span class="term">Issuer DN</span></dt><dd>
										Parent CA that issued the sub-CA certificate. All sub-CAs are created as a child of the IdM root CA.
									</dd></dl></div></li><li class="listitem"><p class="simpara">
							Create the <span class="strong strong"><strong>webclient-ca</strong></span> sub-CA for issuing certificates to web clients:
						</p><pre class="literallayout">[root@ipaserver ~]# <code class="literal">ipa ca-add <span class="emphasis"><em>webclient-ca</em></span> --subject="<span class="emphasis"><em>CN=WEBCLIENT,O=IDM.EXAMPLE.COM</em></span>"</code>
-------------------
Created CA "webclient-ca"
-------------------
  Name: webclient-ca
  Authority ID: 8a479f3a-0454-4a4d-8ade-fd3b5a54ab2e
  Subject DN: CN=WEBCLIENT,O=IDM.EXAMPLE.COM
  Issuer DN: CN=Certificate Authority,O=IDM.EXAMPLE.COM</pre></li><li class="listitem"><p class="simpara">
							Run the <span class="strong strong"><strong>ipa-certupdate</strong></span> command to create a <span class="strong strong"><strong>certmonger</strong></span> tracking request for the <span class="strong strong"><strong>webserver-ca</strong></span> and <span class="strong strong"><strong>webclient-ca</strong></span> sub-CAs certificates:
						</p><pre class="literallayout">[root@ipaserver ~]# <code class="literal">ipa-certupdate</code></pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
								If you forget to run the <span class="strong strong"><strong>ipa-certupdate</strong></span> command after creating a sub-CA and the sub-CA certificate expires, end-entity certificates issued by that sub-CA are considered invalid even though the end-entity certificate has not expired.
							</p></div></rh-alert></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Verify that the signing certificate of the new sub-CA has been added to the IdM database:
						</p><pre class="literallayout">[root@ipaserver ~]# <span class="strong strong"><strong>certutil -d /etc/pki/pki-tomcat/alias/ -L</strong></span>

Certificate Nickname                      Trust Attributes
                                          SSL,S/MIME,JAR/XPI

caSigningCert cert-pki-ca                 CTu,Cu,Cu
Server-Cert cert-pki-ca                   u,u,u
auditSigningCert cert-pki-ca              u,u,Pu
<span class="strong strong"><strong>caSigningCert cert-pki-ca ba83f324-5e50-4114-b109-acca05d6f1dc u,u,u</strong></span>
ocspSigningCert cert-pki-ca               u,u,u
subsystemCert cert-pki-ca                 u,u,u</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								The new sub-CA certificate is automatically transferred to all the replicas that have a certificate system instance installed.
							</p></div></rh-alert></li></ul></div></section><section class="section" id="proc_disabling-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h4 class="title">22.1.4. Disabling a sub-CA from the IdM CLI</h4></div></div></div><p class="_abstract _abstract">
					Follow this procedure to disable a sub-CA from the IdM CLI. If there are still non-expired certificates that were issued by a sub-CA, you should not delete it but you can disable it. If you delete the sub-CA, revocation checking for that sub-CA will no longer work.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Make sure you have obtained the administrator’s credentials.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the <code class="literal">ipa ca-find</code> command to determine the name of the sub-CA you are deleting:
						</p><pre class="literallayout">[root@ipaserver ~]# ipa ca-find
-------------
3 CAs matched
-------------
  Name: ipa
  Description: IPA CA
  Authority ID: 5195deaf-3b61-4aab-b608-317aff38497c
  Subject DN: CN=Certificate Authority,O=IPA.TEST
  Issuer DN: CN=Certificate Authority,O=IPA.TEST

  Name: webclient-ca
  Authority ID: 605a472c-9c6e-425e-b959-f1955209b092
  Subject DN: CN=WEBCLIENT,O=IDM.EXAMPLE.COM
  Issuer DN: CN=Certificate Authority,O=IPA.TEST

 <span class="strong strong"><strong>Name: webserver-ca</strong></span>
  Authority ID: 02d537f9-c178-4433-98ea-53aa92126fc3
  Subject DN: CN=WEBSERVER,O=IDM.EXAMPLE.COM
  Issuer DN: CN=Certificate Authority,O=IPA.TEST
----------------------------
Number of entries returned 3
----------------------------</pre></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">ipa ca-disable</code> command to disable your sub-CA, in this example, the <code class="literal">webserver-ca</code>:
						</p><pre class="literallayout">ipa ca-disable webserver-ca
--------------------------
Disabled CA "webserver-ca"
--------------------------</pre></li></ol></div></section><section class="section" id="proc_deleting-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h4 class="title">22.1.5. Deleting a sub-CA from the IdM CLI</h4></div></div></div><p class="_abstract _abstract">
					Follow this procedure to delete lightweight sub-CAs from the IdM CLI.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								If you delete a sub-CA, revocation checking for that sub-CA will no longer work. Only delete a sub-CA when there are no more certificates that were issued by that sub-CA whose <code class="literal">notAfter</code> expiration time is in the future.
							</li><li class="listitem">
								You should only disable sub-CAs while there are still non-expired certificates that were issued by that sub-CA. If all certificates that were issued by a sub-CA have expired, you can delete that sub-CA.
							</li><li class="listitem">
								You cannot disable or delete the IdM CA.
							</li></ul></div></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Make sure you have obtained the administrator’s credentials.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To display a list of sub-CAs and CAs, run the <code class="literal">ipa ca-find</code> command:
						</p><pre class="literallayout"># ipa ca-find
-------------
3 CAs matched
-------------
  Name: ipa
  Description: IPA CA
  Authority ID: 5195deaf-3b61-4aab-b608-317aff38497c
  Subject DN: CN=Certificate Authority,O=IPA.TEST
  Issuer DN: CN=Certificate Authority,O=IPA.TEST

  Name: webclient-ca
  Authority ID: 605a472c-9c6e-425e-b959-f1955209b092
  Subject DN: CN=WEBCLIENT,O=IDM.EXAMPLE.COM
  Issuer DN: CN=Certificate Authority,O=IPA.TEST

 <span class="strong strong"><strong>Name: webserver-ca</strong></span>
  Authority ID: 02d537f9-c178-4433-98ea-53aa92126fc3
  Subject DN: CN=WEBSERVER,O=IDM.EXAMPLE.COM
  Issuer DN: CN=Certificate Authority,O=IPA.TEST
----------------------------
Number of entries returned 3
----------------------------</pre></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">ipa ca-disable</code> command to disable your sub-CA, in this example, the <code class="literal">webserver-ca</code>:
						</p><pre class="literallayout"># ipa ca-disable webserver-ca
--------------------------
Disabled CA "webserver-ca"
--------------------------</pre></li><li class="listitem"><p class="simpara">
							Delete the sub-CA, in this example, the <code class="literal">webserver-ca</code>:
						</p><pre class="literallayout"># ipa ca-del webserver-ca
-------------------------
Deleted CA "webserver-ca"
-------------------------</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Run <code class="literal">ipa ca-find</code> to display the list of CAs and sub-CAs. The <code class="literal">webserver-ca</code> is no longer on the list.
						</p><pre class="literallayout"># ipa ca-find
-------------
2 CAs matched
-------------
  Name: ipa
  Description: IPA CA
  Authority ID: 5195deaf-3b61-4aab-b608-317aff38497c
  Subject DN: CN=Certificate Authority,O=IPA.TEST
  Issuer DN: CN=Certificate Authority,O=IPA.TEST

  Name: webclient-ca
  Authority ID: 605a472c-9c6e-425e-b959-f1955209b092
  Subject DN: CN=WEBCLIENT,O=IDM.EXAMPLE.COM
  Issuer DN: CN=Certificate Authority,O=IPA.TEST
----------------------------
Number of entries returned 2
----------------------------</pre></li></ul></div></section></section><section class="section" id="downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.2. Downloading the sub-CA certificate from IdM WebUI</h3></div></div></div><div class="itemizedlist _abstract"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist _abstract" type="disc"><li class="listitem">
						Make sure that you have obtained the IdM administrator’s credentials.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong>Authentication</strong></span> menu, click <span class="strong strong"><strong>Certificates</strong></span> &gt; <span class="strong strong"><strong>Certificates</strong></span>.
					</p><div class="figure" id="sub-CA-certificate-in-the-list-of-certificates_restricting-an-application-to-trust-a-subset-of-certs"><p class="title"><strong>Figure 22.2. sub-CA certificate in the list of certificates</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/44e0bd2d5c830f8525b228ccb8f84997/download-sub-CA-certificate.png" alt="Screenshot of a table displaying two certificates."></div></div></div></li><li class="listitem">
						Click the serial number of the sub-CA certificate to open the certificate information page.
					</li><li class="listitem">
						In the certificate information page, click <span class="strong strong"><strong>Actions</strong></span> &gt; <span class="strong strong"><strong>Download</strong></span>.
					</li><li class="listitem"><p class="simpara">
						In the CLI, move the sub-CA certificate to the <code class="literal">/etc/pki/tls/private/</code> directory:
					</p><pre class="literallayout"># <span class="strong strong"><strong>mv <span class="emphasis"><em>path/to/the/downloaded/certificate</em></span> /etc/pki/tls/private/sub-ca.crt</strong></span></pre></li></ol></div></section><section class="section" id="creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.3. Creating CA ACLs for web server and client authentication</h3></div></div></div><p class="_abstract _abstract">
				Certificate authority access control list (CA ACL) rules define which profiles can be used to issue certificates to which users, services, or hosts. By associating profiles, principals, and groups, CA ACLs permit principals or groups to request certificates using particular profiles.
			</p><p>
				For example, using CA ACLs, the administrator can restrict the use of a profile intended for employees working from an office located in London only to users that are members of the London office-related group.
			</p><section class="section" id="viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h4 class="title">22.3.1. Viewing CA ACLs in IdM CLI</h4></div></div></div><p class="_abstract _abstract">
					Follow this procedure to view the list of certificate authority access control lists (CA ACLs) available in your IdM deployment and the details of a specific CA ACL.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To view all the CA ACLs in your IdM environment, enter the <code class="literal">ipa caacl-find</code> command:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-find</strong></span>
-----------------
1 CA ACL matched
-----------------
  ACL name: hosts_services_caIPAserviceCert
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							To view the details of a CA ACL, enter the <code class="literal">ipa caacl-show</code> command, and specify the CA ACL name. For example, to view the details of the <span class="strong strong"><strong>hosts_services_caIPAserviceCert</strong></span> CA ACL, enter:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-show hosts_services_caIPAserviceCert</strong></span>
  ACL name: hosts_services_caIPAserviceCert
  Enabled: TRUE
  Host category: all
  Service category: all
  CAs: ipa
  Profiles: caIPAserviceCert
  Users: admin</pre></li></ol></div></section><section class="section" id="creating-a-CA-ACL-for-web-servers-authenticating-to-web-clients-using-certificates-issued-by-webserver-ca_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h4 class="title">22.3.2. Creating a CA ACL for web servers authenticating to web clients using certificates issued by webserver-ca</h4></div></div></div><p class="_abstract _abstract">
					Follow this procedure to create a CA ACL that requires the system administrator to use the <span class="strong strong"><strong>webserver-ca</strong></span> sub-CA and the <span class="strong strong"><strong>caIPAserviceCert</strong></span> profile when requesting a certificate for the <span class="strong strong"><strong>HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM</strong></span> service. If the user requests a certificate from a different sub-CA or of a different profile, the request fails. The only exception is when there is another matching CA ACL that is enabled. To view the available CA ACLs, see <a class="link" href="#viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs" title="22.3.1. Viewing CA ACLs in IdM CLI">Viewing CA ACLs in IdM CLI</a>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Make sure that the <span class="strong strong"><strong>HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM</strong></span> service is part of IdM.
						</li><li class="listitem">
							Make sure you have obtained IdM administrator’s credentials.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a CA ACL using the <code class="literal">ipa caacl</code> command, and specify its name:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add TLS_web_server_authentication</strong></span>
--------------------------------------------
Added CA ACL "TLS_web_server_authentication"
--------------------------------------------
  ACL name: TLS_web_server_authentication
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							Modify the CA ACL using the <code class="literal">ipa caacl-mod</code> command to specify the description of the CA ACL:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-mod TLS_web_server_authentication --desc="CAACL for web servers authenticating to web clients using certificates issued by webserver-ca"</strong></span>
-----------------------------------------------
Modified CA ACL "TLS_web_server_authentication"
-----------------------------------------------
  ACL name: TLS_web_server_authentication
  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							Add the <span class="strong strong"><strong>webserver-ca</strong></span> sub-CA to the CA ACL:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add-ca TLS_web_server_authentication --ca=webserver-ca</strong></span>
  ACL name: TLS_web_server_authentication
  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca
  Enabled: TRUE
  CAs: webserver-ca
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">ipa caacl-add-service</code> to specify the service whose principal will be able to request a certificate:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add-service TLS_web_server_authentication --service=HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM</strong></span>
  ACL name: TLS_web_server_authentication
  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca
  Enabled: TRUE
  CAs: webserver-ca
  Services: HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">ipa caacl-add-profile</code> command to specify the certificate profile for the requested certificate:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add-profile TLS_web_server_authentication --certprofiles=caIPAserviceCert</strong></span>
  ACL name: TLS_web_server_authentication
  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca
  Enabled: TRUE
  CAs: webserver-ca
  Profiles: caIPAserviceCert
  Services: HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM
-------------------------
Number of members added 1
-------------------------</pre><p class="simpara">
							You can use the newly-created CA ACL straight away. It is enabled after its creation by default.
						</p></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						The point of CA ACLs is to specify which CA and profile combinations are allowed for requests coming from particular principals or groups. CA ACLs do not affect certificate validation or trust. They do not affect how the issued certificates will be used.
					</p></div></rh-alert></section><section class="section" id="creating-a-CA-ACL-for-user-web-browsers-authenticating-to-web-servers-using-certificates-issued-by-webclient-ca_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h4 class="title">22.3.3. Creating a CA ACL for user web browsers authenticating to web servers using certificates issued by webclient-ca</h4></div></div></div><p class="_abstract _abstract">
					Follow this procedure to create a CA ACL that requires the system administrator to use the <span class="strong strong"><strong>webclient-ca</strong></span> sub-CA and the <span class="strong strong"><strong>IECUserRoles</strong></span> profile when requesting a certificate. If the user requests a certificate from a different sub-CA or of a different profile, the request fails. The only exception is when there is another matching CA ACL that is enabled. To view the available CA ACLs, see <a class="link" href="#viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs" title="22.3.1. Viewing CA ACLs in IdM CLI">Viewing CA ACLs in IdM CLI</a>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Make sure that you have obtained IdM administrator’s credentials.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a CA ACL using the <code class="literal">ipa caacl</code> command and specify its name:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add TLS_web_client_authentication</strong></span>
--------------------------------------------
Added CA ACL "TLS_web_client_authentication"
--------------------------------------------
  ACL name: TLS_web_client_authentication
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							Modify the CA ACL using the <code class="literal">ipa caacl-mod</code> command to specify the description of the CA ACL:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-mod TLS_web_client_authentication --desc="CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca"</strong></span>
-----------------------------------------------
Modified CA ACL "TLS_web_client_authentication"
-----------------------------------------------
  ACL name: TLS_web_client_authentication
  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
							Add the <span class="strong strong"><strong>webclient-ca</strong></span> sub-CA to the CA ACL:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add-ca TLS_web_client_authentication --ca=webclient-ca</strong></span>
  ACL name: TLS_web_client_authentication
  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca
  Enabled: TRUE
  CAs: webclient-ca
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
							Use the <code class="literal">ipa caacl-add-profile</code> command to specify the certificate profile for the requested certificate:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-add-profile TLS_web_client_authentication --certprofiles=IECUserRoles</strong></span>
  ACL name: TLS_web_client_authentication
  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca
  Enabled: TRUE
  CAs: webclient-ca
  Profiles: IECUserRoles
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
							Modify the CA ACL using the <code class="literal">ipa caacl-mod</code> command to specify that the CA ACL applies to all IdM users:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-mod TLS_web_client_authentication --usercat=all</strong></span>
-----------------------------------------------
Modified CA ACL "TLS_web_client_authentication"
-----------------------------------------------
  ACL name: TLS_web_client_authentication
  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca
  Enabled: TRUE
  User category: all
  CAs: webclient-ca
  Profiles: IECUserRoles</pre><p class="simpara">
							You can use the newly-created CA ACL straight away. It is enabled after its creation by default.
						</p></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						The point of CA ACLs is to specify which CA and profile combinations are allowed for requests coming from particular principals or groups. CA ACLs do not affect certificate validation or trust. They do not affect how the issued certificates will be used.
					</p></div></rh-alert></section></section><section class="section" id="obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.4. Obtaining an IdM certificate for a service using certmonger</h3></div></div></div><p>
				To ensure that communication between browsers and the web service running on your IdM client is secure and encrypted, use a TLS certificate. If you want to restrict web browsers to trust certificates issued by the <code class="literal">webserver-ca</code> sub-CA but no other IdM sub-CA, obtain the TLS certificate for your web service from the <code class="literal">webserver-ca</code> sub-CA.
			</p><p>
				Follow this procedure to use <code class="literal">certmonger</code> to obtain an IdM certificate for a service (<code class="literal">HTTP/my_company.idm.example.com</code>@<code class="literal">IDM.EXAMPLE.COM</code>) running on an IdM client.
			</p><p>
				Using <code class="literal">certmonger</code> to request the certificate automatically means that <code class="literal">certmonger</code> manages and renews the certificate when it is due for a renewal.
			</p><p>
				For a visual representation of what happens when <code class="literal">certmonger</code> requests a service certificate, see <a class="xref" href="#communication-flow-certmonger-requesting-service-cert_restricting-an-application-to-trust-a-subset-of-certs" title="22.5. Communication flow for certmonger requesting a service certificate">Section 22.5, “Communication flow for certmonger requesting a service certificate”</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The web server is enrolled as an IdM client.
					</li><li class="listitem">
						You have root access to the IdM client on which you are running the procedure.
					</li><li class="listitem">
						The service for which you are requesting a certificate does not have to pre-exist in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the <code class="literal">my_company.idm.example.com</code> IdM client on which the <code class="literal">HTTP</code> service is running, request a certificate for the service corresponding to the <code class="literal">HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM</code> principal, and specify that
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The certificate is to be stored in the local <code class="literal">/etc/pki/tls/certs/httpd.pem</code> file
							</li><li class="listitem">
								The private key is to be stored in the local <code class="literal">/etc/pki/tls/private/httpd.key</code> file
							</li><li class="listitem">
								The <code class="literal">webserver-ca</code> sub-CA is to be the issuing certificate authority
							</li><li class="listitem"><p class="simpara">
								That an extensionRequest for a <code class="literal">SubjectAltName</code> be added to the signing request with the DNS name of <code class="literal">my_company.idm.example.com</code>:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-getcert request -K HTTP/my_company.idm.example.com -k /etc/pki/tls/private/httpd.key -f /etc/pki/tls/certs/httpd.pem -g 2048 -D my_company.idm.example.com -X webserver-ca -C "systemctl restart httpd"</strong></span>
New signing request "20190604065735" added.</pre><p class="simpara">
								In the command above:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										The <code class="literal">ipa-getcert request</code> command specifies that the certificate is to be obtained from the IdM CA. The <code class="literal">ipa-getcert request</code> command is a shortcut for <code class="literal">getcert request -c IPA</code>.
									</li><li class="listitem">
										The <code class="literal">-g</code> option specifies the size of key to be generated if one is not already in place.
									</li><li class="listitem">
										The <code class="literal">-D</code> option specifies the <code class="literal">SubjectAltName</code> DNS value to be added to the request.
									</li><li class="listitem">
										The <code class="literal">-X</code> option specifies that the issuer of the certificate must be <code class="literal">webserver-ca</code>, not <code class="literal">ipa</code>.
									</li><li class="listitem">
										The <code class="literal">-C</code> option instructs <code class="literal">certmonger</code> to restart the <code class="literal">httpd</code> service after obtaining the certificate.
									</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										To specify that the certificate be issued with a particular profile, use the <code class="literal">-T</code> option.
									</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: To check the status of your request:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-getcert list -f /etc/pki/tls/certs/httpd.pem</strong></span>
Number of certificates and requests being tracked: 3.
Request ID '20190604065735':
    status: MONITORING
    stuck: no
    key pair storage: type=FILE,location='/etc/pki/tls/private/httpd.key'
    certificate: type=FILE,location='/etc/pki/tls/certs/httpd.crt'
    CA: IPA
    issuer: CN=WEBSERVER,O=IDM.EXAMPLE.COM

[...]</pre><p class="simpara">
						The output shows that the request is in the <code class="literal">MONITORING</code> status, which means that a certificate has been obtained. The locations of the key pair and the certificate are those requested.
					</p></li></ol></div></section><section class="section" id="communication-flow-certmonger-requesting-service-cert_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.5. Communication flow for certmonger requesting a service certificate</h3></div></div></div><p class="_abstract _abstract">
				These diagrams show the stages of what happens when <code class="literal">certmonger</code> requests a service certificate from Identity Management (IdM) certificate authority (CA) server. The sequence consists of these diagrams:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-1" title="Figure 22.3. Unencrypted communication">Unencrypted communication</a>
					</li><li class="listitem">
						<a class="link" href="#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-2" title="Figure 22.4. Certmonger requesting a service certificate">Certmonger requesting a service certificate</a>
					</li><li class="listitem">
						<a class="link" href="#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-3" title="Figure 22.5. IdM CA issuing the service certificate">IdM CA issuing the service certificate</a>
					</li><li class="listitem">
						<a class="link" href="#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-4" title="Figure 22.6. Certmonger applying the service certificate">Certmonger applying the service certificate</a>
					</li><li class="listitem">
						<a class="link" href="#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-5" title="Figure 22.7. Certmonger requesting a new certificate when the old one is nearing expiration">Certmonger requesting a new certificate when the old one is nearing expiration</a>
					</li></ul></div><p>
				In the diagrams, the <code class="literal">webserver-ca</code> sub-CA is represented by the generic <code class="literal">IdM CA server</code>.
			</p><p>
				<a class="link" href="#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-1" title="Figure 22.3. Unencrypted communication">Unencrypted communication</a> shows the initial situation: without an HTTPS certificate, the communication between the web server and the browser is unencrypted.
			</p><div class="figure" id="restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-1"><p class="title"><strong>Figure 22.3. Unencrypted communication</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/7f96cab7e5e718e3e2e3590b5afd83c1/84_RHEL_IdM_0420_1.png" alt="A diagram displaying an IdM client running an Apache web server and the certmonger service. There are arrows between a browser and the Apache webserver showing it is connecting over an unencrypted HTTP connection. There is an inactive connection from the certmonger service to an IdM CA server."></div></div></div><p>
				<br>
			</p><p>
				<a class="link" href="#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-2" title="Figure 22.4. Certmonger requesting a service certificate">Certmonger requesting a service certificate</a> shows the system administrator using <code class="literal">certmonger</code> to manually request an HTTPS certificate for the Apache web server. Note that when requesting a web server certificate, certmonger does not communicate directly with the CA. It proxies through IdM.
			</p><div class="figure" id="restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-2"><p class="title"><strong>Figure 22.4. Certmonger requesting a service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/9667aa246bcf76921969274115666533/84_RHEL_IdM_0420_2.png" alt="A diagram displaying an arrow between the certmonger service on the IdM client and the IdM CA server to show it is connecting via an ipa-getcert request."></div></div></div><p>
				<br>
			</p><p>
				<a class="link" href="#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-3" title="Figure 22.5. IdM CA issuing the service certificate">IdM CA issuing the service certificate</a> shows an IdM CA issuing an HTTPS certificate for the web server.
			</p><div class="figure" id="restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-3"><p class="title"><strong>Figure 22.5. IdM CA issuing the service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/760743dd58ac7f0566834b5657089cbe/84_RHEL_IdM_0420_3.png" alt="A diagram displaying an arrow between the IdM CA server and the certmonger service on the IdM client - showing it is connecting and sending an HTTPS certificate."></div></div></div><p>
				<br>
			</p><p>
				<a class="link" href="#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-4" title="Figure 22.6. Certmonger applying the service certificate">Certmonger applying the service certificate</a> shows <code class="literal">certmonger</code> placing the HTTPS certificate in appropriate locations on the IdM client and, if instructed to do so, restarting the <code class="literal">httpd</code> service. The Apache server subsequently uses the HTTPS certificate to encrypt the traffic between itself and the browser.
			</p><div class="figure" id="restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-4"><p class="title"><strong>Figure 22.6. Certmonger applying the service certificate</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/710c6fb955eeee2dd6fbc2cd2a0e4ff8/84_RHEL_IdM_0420_4.png" alt="A diagram displaying an image of an HTTPS certificate assigned to the Apache web server and one assigned to the certmonger service. There are arrows between the browser and the Apache webserver showing that the connection is now an encrypted HTTPS connection. The connection between the certmonger service and the IdM CA server is inactive."></div></div></div><p>
				<br>
			</p><p>
				<a class="link" href="#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-5" title="Figure 22.7. Certmonger requesting a new certificate when the old one is nearing expiration">Certmonger requesting a new certificate when the old one is nearing expiration</a> shows <code class="literal">certmonger</code> automatically requesting a renewal of the service certificate from the IdM CA before the expiration of the certificate. The IdM CA issues a new certificate.
			</p><div class="figure" id="restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-5"><p class="title"><strong>Figure 22.7. Certmonger requesting a new certificate when the old one is nearing expiration</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/419091544b0b5520f3b5c2e321fc2de7/84_RHEL_IdM_0420_5.png" alt="A diagram displaying an arrow from the certmonger service on the IdM client connecting to the IdM CA server to show it is performing an ipa-getcert request. An arrow from the IdM CA server to the Certmonger is labeled HTTPS certificate to show it is transferring an HTTPS certificate to the certmonger service."></div></div></div><p>
				<br>
			</p></section><section class="section" id="setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.6. Setting up a single-instance Apache HTTP Server</h3></div></div></div><p class="_abstract _abstract">
				You can set up a single-instance Apache HTTP Server to serve static HTML content.
			</p><p>
				Follow the procedure if the web server should provide the same content for all domains associated with the server. If you want to provide different content for different domains, set up name-based virtual hosts. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#configuring-apache-name-based-virtual-hosts_setting-apache-http-server">Configuring Apache name-based virtual hosts</a>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">httpd</code> package:
					</p><pre class="literallayout"># <span class="strong strong"><strong>dnf install httpd</strong></span></pre></li><li class="listitem"><p class="simpara">
						If you use <code class="literal">firewalld</code>, open the TCP port <code class="literal">80</code> in the local firewall:
					</p><pre class="literallayout"># <span class="strong strong"><strong>firewall-cmd --permanent --add-port=80/tcp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --reload</strong></span></pre></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl enable --now httpd</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Add HTML files to the <code class="literal filename">/var/www/html/</code> directory.
					</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							When adding content to <code class="literal filename">/var/www/html/</code>, files and directories must be readable by the user under which <code class="literal">httpd</code> runs by default. The content owner can be the either the <code class="literal">root</code> user and <code class="literal">root</code> user group, or another user or group of the administrator’s choice. If the content owner is the <code class="literal">root</code> user and <code class="literal">root</code> user group, the files must be readable by other users. The SELinux context for all the files and directories must be <code class="literal">httpd_sys_content_t</code>, which is applied by default to all content within the <code class="literal filename">/var/www</code> directory.
						</p></div></rh-alert></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Connect with a web browser to <code class="literal">http://my_company.idm.example.com/</code> or <code class="literal command">http://<span class="emphasis"><em>server_IP</em></span>/</code>.
					</p><p class="simpara">
						If the <code class="literal filename">/var/www/html/</code> directory is empty or does not contain an <code class="literal filename">index.html</code> or <code class="literal filename">index.htm</code> file, Apache displays the <code class="literal command">Red Hat Enterprise Linux Test Page</code>. If <code class="literal filename">/var/www/html/</code> contains HTML files with a different name, you can load them by entering the URL to that file, such as <code class="literal command">http://<span class="emphasis"><em>server_IP</em></span>/<span class="emphasis"><em>example.html</em></span></code> or <code class="literal">http://my_company.idm.example.com/<span class="emphasis"><em>example.html</em></span></code>.
					</p></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						Apache manual: <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server">Installing the Apache HTTP Server manual</a>.
					</li><li class="listitem">
						See the <code class="literal citetitle">httpd.service(8)</code> man page on your system.
					</li></ul></div></section><section class="section" id="proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.7. Adding TLS encryption to an Apache HTTP Server</h3></div></div></div><p class="_abstract _abstract">
				You can enable TLS encryption on the <code class="literal systemitem">my_company.idm.example.com</code> Apache HTTP Server for the <code class="literal systemitem">idm.example.com</code> domain.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal systemitem">my_company.idm.example.com</code> Apache HTTP Server is installed and running.
					</li><li class="listitem">
						You have obtained the TLS certificate from the <span class="strong strong"><strong>webserver-ca</strong></span> sub-CA, and stored it in the <code class="literal filename">/etc/pki/tls/certs/httpd.pem</code> file as described in <a class="link" href="#obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs" title="22.4. Obtaining an IdM certificate for a service using certmonger">Obtaining an IdM certificate for a service using certmonger</a>. If you use a different path, adapt the corresponding steps of the procedure.
					</li><li class="listitem">
						The corresponding private key is stored in the <code class="literal filename">/etc/pki/tls/private/httpd.key</code> file. If you use a different path, adapt the corresponding steps of the procedure.
					</li><li class="listitem">
						The <span class="strong strong"><strong>webserver-ca</strong></span> CA certificate is stored in the <code class="literal filename">/etc/pki/tls/private/sub-ca.crt</code> file. If you use a different path, adapt the corresponding steps of the procedure.
					</li><li class="listitem">
						Clients and the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> web server resolve the host name of the server to the IP address of the web server.
					</li><li class="listitem">
						If the server runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the <a class="link" href="https://access.redhat.com/solutions/7018256">TLS extension "Extended Master Secret" enforced</a> Knowledgebase article.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">mod_ssl</code> package:
					</p><pre class="literallayout"># <span class="strong strong"><strong>dnf install mod_ssl</strong></span></pre></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/httpd/conf.d/ssl.conf</code> file and add the following settings to the <code class="literal parameter">&lt;VirtualHost _default_:443&gt;</code> directive:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Set the server name:
							</p><pre class="literallayout"><span class="strong strong"><strong>ServerName <span class="emphasis"><em>my_company.idm.example.com</em></span></strong></span></pre></li></ol></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							The server name must match the entry set in the <code class="literal parameter">Common Name</code> field of the certificate.
						</p></div></rh-alert><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Optional: If the certificate contains additional host names in the <code class="literal parameter">Subject Alt Names</code> (SAN) field, you can configure <code class="literal systemitem">mod_ssl</code> to provide TLS encryption also for these host names. To configure this, add the <code class="literal parameter">ServerAliases</code> parameter with corresponding names:
							</p><pre class="literallayout"><span class="strong strong"><strong>ServerAlias <span class="emphasis"><em>www.my_company.idm.example.com</em></span> <span class="emphasis"><em>server.my_company.idm.example.com</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
								Set the paths to the private key, the server certificate, and the CA certificate:
							</p><pre class="literallayout"><span class="strong strong"><strong>SSLCertificateKeyFile "/etc/pki/tls/private/httpd.key"</strong></span>
<span class="strong strong"><strong>SSLCertificateFile "/etc/pki/tls/certs/httpd.pem"</strong></span>
<span class="strong strong"><strong>SSLCACertificateFile "/etc/pki/tls/certs/ca.crt"</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						For security reasons, configure that only the <code class="literal systemitem">root</code> user can access the private key file:
					</p><pre class="literallayout"># <span class="strong strong"><strong>chown root:root /etc/pki/tls/private/httpd.key</strong></span>
# <span class="strong strong"><strong>chmod 600 //etc/pki/tls/private/httpd.key</strong></span></pre><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
							If the private key was accessed by unauthorized users, revoke the certificate, create a new private key, and request a new certificate. Otherwise, the TLS connection is no longer secure.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						If you use <code class="literal">firewalld</code>, open port <code class="literal">443</code> in the local firewall:
					</p><pre class="literallayout"># <span class="strong strong"><strong>firewall-cmd --permanent --add-port=443/tcp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --reload</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart httpd</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							If you protected the private key file with a password, you must enter this password each time when the <code class="literal systemitem">httpd</code> service starts.
						</p></div></rh-alert><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Use a browser and connect to <code class="literal command">https://my_company.idm.example.com</code>.
							</li></ul></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/setting-apache-http-server_deploying-different-types-of-servers#installing-the-apache-http-server-manual_setting-apache-http-server">SSL/TLS Encryption</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/securing_networks/planning-and-implementing-tls_securing-networks#security-considerations-for-tls-in-rhel_planning-and-implementing-tls">Security considerations for TLS in RHEL 8</a>
					</li></ul></div></section><section class="section" id="setting-the-supported-tls-protocol-versions-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.8. Setting the supported TLS protocol versions on an Apache HTTP Server</h3></div></div></div><p class="_abstract _abstract">
				By default, the Apache HTTP Server on RHEL uses the system-wide crypto policy that defines safe default values, which are also compatible with recent browsers. For example, the <code class="literal systemitem">DEFAULT</code> policy defines that only the <code class="literal systemitem">TLSv1.2</code> and <code class="literal systemitem">TLSv1.3</code> protocol versions are enabled in apache.
			</p><p>
				You can manually configure which TLS protocol versions your <span class="strong strong"><strong>my_company.idm.example.com</strong></span> Apache HTTP Server supports. Follow the procedure if your environment requires to enable only specific TLS protocol versions, for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						If your environment requires that clients can also use the weak <code class="literal systemitem">TLS1</code> (TLSv1.0) or <code class="literal systemitem">TLS1.1</code> protocol.
					</li><li class="listitem">
						If you want to configure that Apache only supports the <code class="literal systemitem">TLSv1.2</code> or <code class="literal systemitem">TLSv1.3</code> protocol.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						TLS encryption is enabled on the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> server as described in <a class="link" href="#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs" title="22.7. Adding TLS encryption to an Apache HTTP Server">Adding TLS encryption to an Apache HTTP server</a>.
					</li><li class="listitem">
						If the server runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the <a class="link" href="https://access.redhat.com/solutions/7018256">TLS extension "Extended Master Secret" enforced</a> Knowledgebase article.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/httpd/conf/httpd.conf</code> file, and add the following setting to the <code class="literal parameter">&lt;VirtualHost&gt;</code> directive for which you want to set the TLS protocol version. For example, to enable only the <code class="literal systemitem">TLSv1.3</code> protocol:
					</p><pre class="literallayout"><span class="strong strong"><strong>SSLProtocol -All TLSv1.3</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart httpd</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Use the following command to verify that the server supports <code class="literal systemitem">TLSv1.3</code>:
					</p><pre class="literallayout"># <span class="strong strong"><strong>openssl s_client -connect <span class="emphasis"><em>example.com</em></span>:443 -tls1_3</strong></span></pre></li><li class="listitem"><p class="simpara">
						Use the following command to verify that the server does not support <code class="literal systemitem">TLSv1.2</code>:
					</p><pre class="literallayout"># <span class="strong strong"><strong>openssl s_client -connect <span class="emphasis"><em>example.com</em></span>:443 -tls1_2</strong></span></pre><p class="simpara">
						If the server does not support the protocol, the command returns an error:
					</p><pre class="literallayout">140111600609088:error:1409442E:SSL routines:ssl3_read_bytes:tlsv1 alert protocol version:ssl/record/rec_layer_s3.c:1543:SSL alert number 70</pre></li><li class="listitem">
						Optional: Repeat the command for other TLS protocol versions.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal citetitle">update-crypto-policies(8)</code> man page on your system
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide cryptographic policies</a>.
					</li><li class="listitem">
						For further details about the <code class="literal parameter">SSLProtocol</code> parameter, refer to the <code class="literal systemitem">mod_ssl</code> documentation in the Apache manual: <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server">Installing the Apache HTTP Server manual</a>.
					</li></ul></div></section><section class="section" id="setting-the-supported-ciphers-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.9. Setting the supported ciphers on an Apache HTTP Server</h3></div></div></div><p class="_abstract _abstract">
				By default, the Apache HTTP Server uses the system-wide crypto policy that defines safe default values, which are also compatible with recent browsers. For the list of ciphers the system-wide crypto allows, see the <code class="literal filename">/etc/crypto-policies/back-ends/openssl.config</code> file.
			</p><p>
				You can manually configure which ciphers the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> Apache HTTP server supports. Follow the procedure if your environment requires specific ciphers.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						TLS encryption is enabled on the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> server as described in <a class="link" href="#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs" title="22.7. Adding TLS encryption to an Apache HTTP Server">Adding TLS encryption to an Apache HTTP server</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/httpd/conf/httpd.conf</code> file, and add the <code class="literal parameter">SSLCipherSuite</code> parameter to the <code class="literal parameter">&lt;VirtualHost&gt;</code> directive for which you want to set the TLS ciphers:
					</p><pre class="literallayout"><span class="strong strong"><strong>SSLCipherSuite "EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH:!SHA1:!SHA256"</strong></span></pre><p class="simpara">
						This example enables only the <code class="literal systemitem">EECDH+AESGCM</code>, <code class="literal systemitem">EDH+AESGCM</code>, <code class="literal systemitem">AES256+EECDH</code>, and <code class="literal systemitem">AES256+EDH</code> ciphers and disables all ciphers which use the <code class="literal systemitem">SHA1</code> and <code class="literal systemitem">SHA256</code> message authentication code (MAC).
					</p></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart httpd</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To display the list of ciphers the Apache HTTP Server supports:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Install the <code class="literal package">nmap</code> package:
							</p><pre class="literallayout"># <span class="strong strong"><strong>dnf install nmap</strong></span></pre></li><li class="listitem"><p class="simpara">
								Use the <code class="literal systemitem">nmap</code> utility to display the supported ciphers:
							</p><pre class="literallayout"># <span class="strong strong"><strong>nmap --script ssl-enum-ciphers -p <span class="emphasis"><em>443</em></span> <span class="emphasis"><em>example.com</em></span></strong></span>
...
PORT    STATE SERVICE
443/tcp open  https
| ssl-enum-ciphers:
|   TLSv1.2:
|     ciphers:
|       TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (ecdh_x25519) - A
|       TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 (dh 2048) - A
|       TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 (ecdh_x25519) - A
...</pre></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal citetitle">update-crypto-policies(8)</code> man page on your system
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide cryptographic policies</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server">Installing the Apache HTTP Server manual - SSLCipherSuite</a>
					</li></ul></div></section><section class="section" id="configuring-tls-client-certificate-authentication_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.10. Configuring TLS client certificate authentication</h3></div></div></div><p class="_abstract _abstract">
				Client certificate authentication enables administrators to allow only users who authenticate using a certificate to access resources on the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> web server. You can configure client certificate authentication for the <code class="literal filename">/var/www/html/Example/</code> directory.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					If the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> Apache server uses the TLS 1.3 protocol, certain clients require additional configuration. For example, in Firefox, set the <code class="literal parameter">security.tls.enable_post_handshake_auth</code> parameter in the <code class="literal command">about:config</code> menu to <code class="literal command">true</code>. For further details, see <a class="link" href="https://www.redhat.com/en/blog/transport-layer-security-version-13-red-hat-enterprise-linux-8">Transport Layer Security version 1.3 in Red Hat Enterprise Linux 8</a>.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						TLS encryption is enabled on the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> server as described in <a class="link" href="#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs" title="22.7. Adding TLS encryption to an Apache HTTP Server">Adding TLS encryption to an Apache HTTP server</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal filename">/etc/httpd/conf/httpd.conf</code> file and add the following settings to the <code class="literal parameter">&lt;VirtualHost&gt;</code> directive for which you want to configure client authentication:
					</p><pre class="screen">&lt;Directory "/var/www/html/Example/"&gt;
  SSLVerifyClient require
&lt;/Directory&gt;</pre><p class="simpara">
						The <code class="literal command">SSLVerifyClient require</code> setting defines that the server must successfully validate the client certificate before the client can access the content in the <code class="literal filename">/var/www/html/Example/</code> directory.
					</p></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal systemitem">httpd</code> service:
					</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart httpd</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Use the <code class="literal systemitem">curl</code> utility to access the <code class="literal command">https://my_company.idm.example.com/Example/</code> URL without client authentication:
					</p><pre class="screen">$ <span class="strong strong"><strong>curl https://my_company.idm.example.com/Example/</strong></span>
curl: (56) OpenSSL SSL_read: error:1409445C:SSL routines:ssl3_read_bytes:tlsv13 alert certificate required, errno 0</pre><p class="simpara">
						The error indicates that the <span class="strong strong"><strong>my_company.idm.example.com</strong></span> web server requires a client certificate authentication.
					</p></li><li class="listitem"><p class="simpara">
						Pass the client private key and certificate, as well as the CA certificate to <code class="literal systemitem">curl</code> to access the same URL with client authentication:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>curl --cacert <span class="emphasis"><em>ca.crt</em></span> --key <span class="emphasis"><em>client.key</em></span> --cert <span class="emphasis"><em>client.crt</em></span> https://my_company.idm.example.com/Example/</strong></span></pre><p class="simpara">
						If the request succeeds, <code class="literal systemitem">curl</code> displays the <code class="literal filename">index.html</code> file stored in the <code class="literal filename">/var/www/html/Example/</code> directory.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server">Installing the Apache HTTP Server manual - mod_ssl configuration</a>
					</li></ul></div></section><section class="section" id="requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.11. Requesting a new user certificate and exporting it to the client</h3></div></div></div><p class="_abstract _abstract">
				As an Identity Management (IdM) administrator, you can configure a web server running on an IdM client to request users that use web browsers to access the server to authenticate with certificates issued by a specific IdM sub-CA. Follow this procedure to request a user certificate from a specific IdM sub-CA and to export the certificate and the corresponding private key on to the host from which the user wants to access the web server using a web browser. Afterwards, <a class="link" href="#configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs" title="22.12. Configuring a browser to enable certificate authentication">import the certificate and the private key into the browser</a>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Create a new directory, for example <code class="literal replaceable">~/certdb/</code>, and make it a temporary certificate database. When asked, create an NSS Certificate DB password to encrypt the keys to the certificate to be generated in a subsequent step:
					</p><pre class="literallayout"># mkdir <code class="literal replaceable">~/certdb/</code>
# certutil -N -d <code class="literal replaceable">~/certdb/</code>
Enter a password which will be used to encrypt your keys.
The password should be at least 8 characters long,
and should contain at least one non-alphabetic character.

Enter new password:
Re-enter password:</pre></li><li class="listitem"><p class="simpara">
						Create the certificate signing request (CSR) and redirect the output to a file. For example, to create a CSR with the name <code class="literal replaceable">certificate_request.csr</code> for a <code class="literal replaceable">4096</code> bit certificate for the <code class="literal replaceable">idm_user</code> user in the <code class="literal replaceable">IDM.EXAMPLE.COM</code> realm, setting the nickname of the certificate private keys to <code class="literal replaceable">idm_user</code> for easy findability, and setting the subject to <code class="literal replaceable">CN=idm_user,O=IDM.EXAMPLE.COM</code>:
					</p><pre class="literallayout"># certutil -R -d <code class="literal replaceable">~/certdb/</code> -a -g <code class="literal replaceable">4096</code> -n <code class="literal replaceable">idm_user</code> -s "CN=<code class="literal replaceable">idm_user</code>,O=IDM.EXAMPLE.COM" &gt; <code class="literal replaceable">certificate_request.csr</code></pre></li><li class="listitem"><p class="simpara">
						When prompted, enter the same password that you entered when using <code class="literal systemitem">certutil</code> to create the temporary database. Then continue typing randlomly until told to stop:
					</p><pre class="literallayout">Enter Password or Pin for "NSS Certificate DB":

A random seed must be generated that will be used in the
creation of your key.  One of the easiest ways to create a
random seed is to use the timing of keystrokes on a keyboard.

To begin, type keys on the keyboard until this progress meter
is full.  DO NOT USE THE AUTOREPEAT FUNCTION ON YOUR KEYBOARD!


Continue typing until the progress meter is full:</pre></li><li class="listitem"><p class="simpara">
						Submit the certificate request file to the server. Specify the Kerberos principal to associate with the newly-issued certificate, the output file to store the certificate, and optionally the certificate profile. Specify the IdM sub-CA that you want to issue the certificate. For example, to obtain a certificate of the <code class="literal replaceable">IECUserRoles</code> profile, a profile with added user roles extension, for the <code class="literal replaceable">idm_user</code>@<code class="literal replaceable">IDM.EXAMPLE.COM</code> principal from <code class="literal">webclient-ca</code>, and save the certificate in the <code class="literal replaceable">~/idm_user.pem</code> file:
					</p><pre class="literallayout"># ipa cert-request <code class="literal replaceable">certificate_request.csr</code> --principal=<code class="literal replaceable">idm_user</code>@<code class="literal replaceable">IDM.EXAMPLE.COM</code> --profile-id=<code class="literal replaceable">IECUserRoles</code> --ca=<code class="literal replaceable">webclient-ca</code> --certificate-out=<code class="literal replaceable">~/idm_user.pem</code></pre></li><li class="listitem"><p class="simpara">
						Add the certificate to the NSS database. Use the <code class="literal option">-n</code> option to set the same nickname that you used when creating the CSR previously so that the certificate matches the private key in the NSS database. The <code class="literal option">-t</code> option sets the trust level. For details, see the certutil(1) man page. The <code class="literal option">-i</code> option specifies the input certificate file. For example, to add to the NSS database a certificate with the <code class="literal replaceable">idm_user</code> nickname that is stored in the <code class="literal replaceable">~/idm_user.pem</code> file in the <code class="literal replaceable">~/certdb/</code> database:
					</p><pre class="literallayout"># certutil -A -d <code class="literal replaceable">~/certdb/</code> -n <code class="literal replaceable">idm_user</code> -t "P,," -i <code class="literal replaceable">~/idm_user.pem</code></pre></li><li class="listitem"><p class="simpara">
						Verify that the key in the NSS database does not show <code class="literal replaceable">(orphan)</code> as its nickname. For example, to verify that the certificate stored in the <code class="literal replaceable">~/certdb/</code> database is not orphaned:
					</p><pre class="literallayout"># certutil -K -d <code class="literal replaceable">~/certdb/</code>
&lt; 0&gt; rsa      5ad14d41463b87a095b1896cf0068ccc467df395   <span class="strong strong"><strong>NSS Certificate DB:idm_user</strong></span></pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal command">pk12util</code> command to export the certificate from the NSS database to the PKCS12 format. For example, to export the certificate with the <code class="literal replaceable">idm_user</code> nickname from the <code class="literal filename">/root/certdb</code> NSS database into the <code class="literal replaceable">~/idm_user.p12</code> file:
					</p><pre class="literallayout"># pk12util -d <code class="literal filename">~/certdb</code> -o <code class="literal replaceable">~/idm_user.p12</code> -n <code class="literal replaceable">idm_user</code>
Enter Password or Pin for "NSS Certificate DB":
Enter password for PKCS12 file:
Re-enter password:
pk12util: PKCS12 EXPORT SUCCESSFUL</pre></li><li class="listitem"><p class="simpara">
						Transfer the certificate to the host on which you want the certificate authentication for <code class="literal replaceable">idm_user</code> to be enabled:
					</p><pre class="literallayout"># scp <code class="literal replaceable">~/idm_user.p12</code> <code class="literal replaceable">idm_user@client.idm.example.com:/home/idm_user/</code></pre></li><li class="listitem"><p class="simpara">
						On the host to which the certificate has been transferred, make the directory in which the .pkcs12 file is stored inaccessible to the 'other' group for security reasons:
					</p><pre class="literallayout"># chmod o-rwx <code class="literal replaceable">/home/idm_user/</code></pre></li><li class="listitem"><p class="simpara">
						For security reasons, remove the temporary NSS database and the .pkcs12 file from the server:
					</p><pre class="literallayout"># rm <code class="literal replaceable">~/certdb/</code>
# rm <code class="literal replaceable">~/idm_user.p12</code></pre></li></ol></div></section><section class="section" id="configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs"><div class="titlepage"><div><div><h3 class="title">22.12. Configuring a browser to enable certificate authentication</h3></div></div></div><p class="_abstract _abstract">
				To be able to authenticate with a certificate when using the WebUI to log into Identity Management (IdM), you need to import the user and the relevant certificate authority (CA) certificates into the Mozilla Firefox or Google Chrome browser. The host itself on which the browser is running does not have to be part of the IdM domain.
			</p><p>
				IdM supports the following browsers for connecting to the WebUI:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Mozilla Firefox 38 and later
					</li><li class="listitem">
						Google Chrome 46 and later
					</li></ul></div><p>
				The following procedure shows how to configure the Mozilla Firefox 57.0.1 browser.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the <a class="link" href="#requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs" title="22.11. Requesting a new user certificate and exporting it to the client">user certificate</a> that you want to import to the browser at your disposal in the PKCS#12 format.
					</li><li class="listitem">
						You have <a class="link" href="#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" title="22.2. Downloading the sub-CA certificate from IdM WebUI">downloaded the sub-CA certificate</a> and have it at your disposal in the PEM format.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open Firefox, then navigate to <code class="literal gui">Preferences</code> → <code class="literal gui">Privacy &amp; Security</code>.
					</p><div class="figure" id="privacy-security_restricting-an-application-to-trust-a-subset-of-certs"><p class="title"><strong>Figure 22.8. Privacy and Security section in Preferences</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/c69e139faf91acb67d6b6a7faa65b410/privacy_and_security.png" alt="Screenshot of the Firefox settings page and the &quot;Privacy &amp; Security&quot; option is highlighted."></div></div></div></li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">View Certificates</span>.
					</p><div class="figure" id="view-certificates_restricting-an-application-to-trust-a-subset-of-certs"><p class="title"><strong>Figure 22.9. View Certificates in Privacy and Security</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/aa5fb25b2f4b3061fe69192d0af19b1c/view_certificates.png" alt="A screenshot of the &quot;Certificates&quot; section and the &quot;View Certificates&quot; button at the bottom right is highlighted."></div></div></div></li><li class="listitem">
						In the <code class="literal gui">Your Certificates</code> tab, click <span class="guibutton">Import</span>. Locate and open the certificate of the user in the PKCS12 format, then click <span class="guibutton">OK</span> and <span class="guibutton">OK</span>.
					</li><li class="listitem"><p class="simpara">
						To make sure that your IdM sub-CA is recognized by Firefox as a trusted authority, import the IdM sub-CA certificate that you saved in <a class="link" href="#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs" title="22.2. Downloading the sub-CA certificate from IdM WebUI">Downloading the sub-CA certificate from IdM WebUI</a> as a trusted certificate authority certificate:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Open Firefox, navigate to Preferences and click <span class="guibutton">Privacy &amp; Security</span>.
							</p><div class="figure" id="privacy-security-2_restricting-an-application-to-trust-a-subset-of-certs"><p class="title"><strong>Figure 22.10. Privacy and Security section in Preferences</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/c69e139faf91acb67d6b6a7faa65b410/privacy_and_security.png" alt="privacy and security"></div></div></div></li><li class="listitem"><p class="simpara">
								Click <span class="guibutton">View Certificates</span>.
							</p><div class="figure" id="view-certificates-2_restricting-an-application-to-trust-a-subset-of-certs"><p class="title"><strong>Figure 22.11. View Certificates in Privacy and Security</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/aa5fb25b2f4b3061fe69192d0af19b1c/view_certificates.png" alt="A screenshot of the &quot;Certificates&quot; section. The &quot;View Certificates&quot; button at the bottom right is highlighted."></div></div></div></li><li class="listitem">
								In the <code class="literal gui">Authorities</code> tab, click <span class="guibutton">Import</span>. Locate and open the sub-CA certificate. Trust the certificate to identify websites, then click <span class="guibutton">OK</span> and <span class="guibutton">OK</span>.
							</li></ol></div></li></ol></div></section></section><section class="chapter" id="invalidating-a-specific-group-of-related-certificates-quickly_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 23. Invalidating a specific group of related certificates quickly</h2></div></div></div><p class="_abstract _abstract">
			As a system administrator, if you want to be able to invalidate a specific group of related certificates quickly:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Design your applications so that they only trust certificates that were issued by a specific lightweight Identity Management (IdM) sub-CA. Afterwards, you will be able to invalidate all these certificates by only revoking the certificate of the Identity Management (IdM) sub-CA that issued these certificates. For details on how to create and use a lightweight sub-CA in IdM, see <a class="link" href="#restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm" title="Chapter 22. Restricting an application to trust only a subset of certificates">Invalidating a specific group of related certificates quickly</a>.
				</li><li class="listitem"><p class="simpara">
					To ensure that all the certificates that have been issued by the to-be-revoked IdM sub-CA are immediately invalid, configure applications that rely on such certificates to use the IdM OCSP responders. For example, to configure the Firefox browser to use OCSP responders, make sure that the <code class="literal">Query OCSP responder servers to confirm the current validity of certificates</code> checkbox is checked in Firefox Preferences.
				</p><p class="simpara">
					In IdM, the certificate revocation list (CRL) is updated every four hours. d To invalidate all the certificates issued by an IdM sub-CA, <a class="link" href="#revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm" title="7.5. Revoking certificates with the integrated IdM CAs">revoke the IdM sub-CA certificate</a>. In addition, <a class="link" href="#disabling-CA-ACLs-in-IdM-CLI_invalidating-a-specific-group-of-related-certificates-quickly" title="23.1. Disabling CA ACLs in IdM CLI">disable the relevant CA ACLs</a>, and consider <a class="link" href="#disabling-an-IdM-sub-CA_invalidating-a-specific-group-of-related-certificates-quickly" title="23.2. Disabling an IdM sub-CA">disabling the IdM sub-CA</a>. Disabling the sub-CA prevents the sub-CA from issuing new certificates, but allows Online Certificate Status Protocol (OCSP) responses to be produced for previously issued certificates because the sub-CA’s signing keys are retained.
				</p></li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
				Do not delete the sub-CA if you use OCSP in your environment. Deleting the sub-CA deletes the signing keys of the sub-CA, preventing production of OCSP responses for certificates issued by that sub-CA.
			</p><p>
				The only scenario when deleting a sub-CA is preferable to disabling it is when you want to create a new sub-CA with the same Subject distinguished name (DN) but a new signing key.
			</p></div></rh-alert><section class="section" id="disabling-CA-ACLs-in-IdM-CLI_invalidating-a-specific-group-of-related-certificates-quickly"><div class="titlepage"><div><div><h3 class="title">23.1. Disabling CA ACLs in IdM CLI</h3></div></div></div><p class="_abstract _abstract">
				When you want to retire an IdM service or a group of IdM services, consider disabling any existing corresponding CA ACLs.
			</p><p>
				Follow this procedure to disable the <a class="link" href="#creating-a-CA-ACL-for-web-servers-authenticating-to-web-clients-using-certificates-issued-by-webserver-ca_restricting-an-application-to-trust-a-subset-of-certs" title="22.3.2. Creating a CA ACL for web servers authenticating to web clients using certificates issued by webserver-ca">TLS_web_server_authentication</a> CA ACL that restricts the web server running on your IdM client to request a certificate to be issued by the <code class="literal">webserver-ca</code> IdM sub-CA, and to disable the <a class="link" href="#creating-a-CA-ACL-for-user-web-browsers-authenticating-to-web-servers-using-certificates-issued-by-webclient-ca_restricting-an-application-to-trust-a-subset-of-certs" title="22.3.3. Creating a CA ACL for user web browsers authenticating to web servers using certificates issued by webclient-ca">TLS_web_client_authentication</a> CA ACL that restricts IdM users to request a user certificate to be issued by the <code class="literal">webclient-ca</code> IdM sub-CA.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: To view all the CA ACLs in your IdM environment, enter the <code class="literal">ipa caacl-find</code> command:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-find</strong></span>
-----------------
3 CA ACLs matched
-----------------
  ACL name: hosts_services_caIPAserviceCert
  Enabled: TRUE

  ACL name: TLS_web_server_authentication
  Enabled: TRUE

  ACL name: TLS_web_client_authentication
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
						Optional: To view the details of a CA ACL, enter the <code class="literal">ipa caacl-show</code> command, and specify the CA ACL name:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-show TLS_web_server_authentication</strong></span>
  ACL name: TLS_web_server_authentication
  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca
  Enabled: TRUE
  CAs: webserver-ca
  Profiles: caIPAserviceCert
  Services: HTTP/rhel8server.idm.example.com@IDM.EXAMPLE.COM</pre></li><li class="listitem"><p class="simpara">
						To disable a CA ACL, enter the <code class="literal">ipa caacl-disable</code> command, and specify the CA ACL name.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To disable the <span class="strong strong"><strong>TLS_web_server_authentication</strong></span> CA ACL, enter:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-disable TLS_web_server_authentication</strong></span>
-------------------------------------------------
Disabled CA ACL "TLS_web_server_authentication"
-------------------------------------------------</pre></li><li class="listitem"><p class="simpara">
								To disable the <span class="strong strong"><strong>TLS_web_client_authentication</strong></span> CA ACL, enter:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa caacl-disable TLS_web_client_authentication</strong></span>
-------------------------------------------------
Disabled CA ACL "TLS_web_client_authentication"
-------------------------------------------------</pre></li></ul></div><p class="simpara">
						The only enabled CA ACL now is the <span class="strong strong"><strong>hosts_services_caIPAserviceCert</strong></span> CA ACL.
					</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							Be extremely careful about disabling the <code class="literal">hosts_services_caIPAserviceCert</code> CA ACL. Disabling <code class="literal">hosts_services_caIPAserviceCert</code>, without another CA ACL granting IdM servers use of the <code class="literal">ipa</code> CA with the <code class="literal">caIPAserviceCert</code> profile means that certificate renewal of the IdM <code class="literal">HTTP</code> and <code class="literal">LDAP</code> certificates will fail. The expired IdM <code class="literal">HTTP</code> and <code class="literal">LDAP</code> certificates will eventually cause IdM system failure.
						</p></div></rh-alert></li></ol></div></section><section class="section" id="disabling-an-IdM-sub-CA_invalidating-a-specific-group-of-related-certificates-quickly"><div class="titlepage"><div><div><h3 class="title">23.2. Disabling an IdM sub-CA</h3></div></div></div><p class="_abstract _abstract">
				After revoking the CA certificate of an IdM sub-CA to invalidate all the certificates issued by that sub-CA, consider disabling the IdM sub-CA if you no longer need it. You can re-enable the sub-CA at a later time.
			</p><p>
				Disabling the sub-CA prevents the sub-CA from issuing new certificates, but allows Online Certificate Status Protocol (OCSP) responses to be produced for previously issued certificates because the sub-CA’s signing keys are retained.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as IdM administrator.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Enter the <code class="literal">ipa ca-disable</code> command and specify the name of the sub-CA:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa ca-disable webserver-CA</strong></span>
--------------------
Disabled CA "webserver-CA"
--------------------</pre></li></ul></div></section></section><section class="chapter" id="verifying-certificates-using-idm-healthcheck_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 24. Verifying certificates using IdM Healthcheck</h2></div></div></div><p class="_abstract _abstract">
			Learn more about understanding and using the Healthcheck tool in Identity management (IdM) to identify issues with IPA certificates maintained by <code class="literal">certmonger</code>.
		</p><p>
			For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_idm_healthcheck_to_monitor_your_idm_environment/installing-and-running-the-ipa-healthcheck-tool_using-idm-healthcheck-to-monitor-your-idm-environment#healthcheck-in-idm_installing-and-running-the-ipa-healthcheck-tool">Healthcheck in IdM</a>.
		</p><section class="section" id="idm-certificates-healthcheck-tests_verifying-certificates-using-idm-healthcheck"><div class="titlepage"><div><div><h3 class="title">24.1. IdM certificates Healthcheck tests</h3></div></div></div><p class="_abstract _abstract">
				The Healthcheck tool includes several tests for verifying the status of certificates maintained by certmonger in Identity Management (IdM). For details about certmonger, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/using-certmonger_managing-certificates-in-idm">Obtaining an IdM certificate for a service using certmonger</a>.
			</p><p>
				This suite of tests checks expiration, validation, trust and other issues. Multiple errors may be thrown for the same underlying issue.
			</p><p>
				To see all certificate tests, run the <code class="literal">ipa-healthcheck</code> with the <code class="literal">--list-sources</code> option:
			</p><pre class="literallayout"># ipa-healthcheck --list-sources</pre><p>
				You can find all tests under the <code class="literal">ipahealthcheck.ipa.certs</code> source:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">IPACertmongerExpirationCheck</span></dt><dd><p class="simpara">
							This test checks expirations in <code class="literal">certmonger</code>.
						</p><p class="simpara">
							If an error is reported, the certificate has expired.
						</p><p class="simpara">
							If a warning appears, the certificate will expire soon. By default, this test applies within 28 days or fewer days before certificate expiration.
						</p><p class="simpara">
							You can configure the number of days in the <code class="literal">/etc/ipahealthcheck/ipahealthcheck.conf</code> file. After opening the file, change the <code class="literal">cert_expiration_days</code> option located in the default section.
						</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								Certmonger loads and maintains its own view of the certificate expiration. This check does not validate the on-disk certificate.
							</p></div></rh-alert></dd><dt><span class="term">IPACertfileExpirationCheck</span></dt><dd><p class="simpara">
							This test checks if the certificate file or NSS database cannot be opened. This test also checks expiration. Therefore, carefully read the <code class="literal">msg</code> attribute in the error or warning output. The message specifies the problem.
						</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								This test checks the on-disk certificate. If a certificate is missing, unreadable, etc a separate error can also be raised.
							</p></div></rh-alert></dd><dt><span class="term">IPACertNSSTrust</span></dt><dd>
							This test compares the trust for certificates stored in NSS databases. For the expected tracked certificates in NSS databases the trust is compared to an expected value and an error raised on a non-match.
						</dd><dt><span class="term">IPANSSChainValidation</span></dt><dd>
							This test validates the certificate chain of the NSS certificates. The test executes: <code class="literal">certutil -V -u V -e -d [dbdir] -n [nickname]</code>
						</dd><dt><span class="term">IPAOpenSSLChainValidation</span></dt><dd><p class="simpara">
							This test validates the certificate chain of the OpenSSL certificates. To be comparable to the <code class="literal">NSSChain</code> validation here is the OpenSSL command we execute:
						</p><pre class="literallayout">openssl verify -verbose -show_chain -CAfile /etc/ipa/ca.crt [cert file]</pre></dd><dt><span class="term">IPARAAgent</span></dt><dd>
							This test compares the certificate on disk with the equivalent record in LDAP in <code class="literal">uid=ipara,ou=People,o=ipaca</code>.
						</dd><dt><span class="term">IPACertRevocation</span></dt><dd>
							This test uses certmonger to verify that certificates have not been revoked. Therefore, the test can find issues connected with certificates maintained by certmonger only.
						</dd><dt><span class="term">IPACertmongerCA</span></dt><dd><p class="simpara">
							This test verifies the certmonger Certificate Authority (CA) configuration. IdM cannot issue certificates without CA.
						</p><p class="simpara">
							Certmonger maintains a set of CA helpers. In IdM, there is a CA named IPA which issues certificates through IdM, authenticating as a host or user principal, for host or service certs.
						</p><p class="simpara">
							There are also <code class="literal">dogtag-ipa-ca-renew-agent</code> and <code class="literal">dogtag-ipa-ca-renew-agent-reuse</code> which renew the CA subsystem certificates.
						</p></dd></dl></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Run these tests on all IdM servers when trying to check for issues.
				</p></div></rh-alert></section><section class="section" id="screening-certificates-using-the-healthcheck-tool_verifying-certificates-using-idm-healthcheck"><div class="titlepage"><div><div><h3 class="title">24.2. Screening certificates using the Healthcheck tool</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to run a standalone manual test of an Identity Management (IdM) certificate health check using the Healthcheck tool.
			</p><p>
				The Healthcheck tool includes many tests, therefore, you can shorten the results with:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Excluding all successful test: <code class="literal">--failures-only</code>
					</li><li class="listitem">
						Including only certificate tests: <code class="literal">--source=ipahealthcheck.ipa.certs</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You must perform Healthcheck tests as the <code class="literal">root</code> user.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To run Healthcheck with warnings, errors and critical issues regarding certificates, enter:
					</p><pre class="literallayout"># ipa-healthcheck --source=ipahealthcheck.ipa.certs --failures-only</pre></li></ul></div><p>
				Successful test displays empty brackets:
			</p><pre class="literallayout">[]</pre><p>
				Failed test shows you the following output:
			</p><pre class="literallayout">{
  "source": "ipahealthcheck.ipa.certs",
  "check": "IPACertfileExpirationCheck",
  "result": "ERROR",
  "kw": {
    "key": 1234,
    "dbdir": "/path/to/nssdb",
    "error": [error],
    "msg": "Unable to open NSS database '/path/to/nssdb': [error]"
  }
}</pre><p>
				This <code class="literal">IPACertfileExpirationCheck</code> test failed on opening the NSS database.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <code class="literal">man ipa-healthcheck</code>.
					</li></ul></div></section></section><section class="chapter" id="verifying-system-certificates-using-idm-healthcheck_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 25. Verifying system certificates using IdM Healthcheck</h2></div></div></div><p class="_abstract _abstract">
			Learn more about identifying issues with system certificates in Identity Management (IdM) by using the Healthcheck tool.
		</p><p>
			For details, see
		</p><p>
			<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_idm_healthcheck_to_monitor_your_idm_environment/installing-and-running-the-ipa-healthcheck-tool_using-idm-healthcheck-to-monitor-your-idm-environment#healthcheck-in-idm_installing-and-running-the-ipa-healthcheck-tool">Healthcheck in IdM</a>.
		</p><section class="section" id="system-certificates-healthcheck-tests_verifying-dogtag-certificates-using-healthcheck"><div class="titlepage"><div><div><h3 class="title">25.1. System certificates Healthcheck tests</h3></div></div></div><p class="_abstract _abstract">
				The Healthcheck tool includes several tests for verifying system (DogTag) certificates.
			</p><p>
				To see all tests, run the <code class="literal">ipa-healthcheck</code> with the <code class="literal">--list-sources</code> option:
			</p><pre class="literallayout"># ipa-healthcheck --list-sources</pre><p>
				You can find all tests under the <code class="literal">ipahealthcheck.dogtag.ca</code> source:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">DogtagCertsConfigCheck</span></dt><dd><p class="simpara">
							This test compares the CA (Certificate Authority) certificates in its NSS database to the same values stored in <code class="literal">CS.cfg</code>. If they do not match, the CA fails to start.
						</p><p class="simpara">
							Specifically, it checks:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">auditSigningCert cert-pki-ca</code> against <code class="literal">ca.audit_signing.cert</code>
								</li><li class="listitem">
									<code class="literal">ocspSigningCert cert-pki-ca</code> against <code class="literal">ca.ocsp_signing.cert</code>
								</li><li class="listitem">
									<code class="literal">caSigningCert cert-pki-ca</code> against <code class="literal">ca.signing.cert</code>
								</li><li class="listitem">
									<code class="literal">subsystemCert cert-pki-ca</code> against <code class="literal">ca.subsystem.cert</code>
								</li><li class="listitem">
									<code class="literal">Server-Cert cert-pki-ca</code> against <code class="literal">ca.sslserver.cert</code>
								</li></ul></div><p class="simpara">
							If Key Recovery Authority (KRA) is installed:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">transportCert cert-pki-kra</code> against <code class="literal">ca.connector.KRA.transportCert</code>
								</li></ul></div></dd><dt><span class="term">DogtagCertsConnectivityCheck</span></dt><dd><p class="simpara">
							This test verifies connectivity. This test is equivalent to the <code class="literal">ipa cert-show 1</code> command which checks:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The PKI proxy configuration in Apache
								</li><li class="listitem">
									IdM being able to find a CA
								</li><li class="listitem">
									The RA agent client certificate
								</li><li class="listitem">
									Correctness of CA replies to requests
								</li></ul></div><p class="simpara">
							Note that the test checks a certificate with serial #1 because you want to verify that a <code class="literal">cert-show</code> can be executed and get back an expected result from CA (either the certificate or a not found).
						</p></dd></dl></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Run these tests on all IdM servers when trying to find an issue.
				</p></div></rh-alert></section><section class="section" id="screening-system-certificates-using-healthcheck_verifying-dogtag-certificates-using-healthcheck"><div class="titlepage"><div><div><h3 class="title">25.2. Screening system certificates using Healthcheck</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to run a standalone manual test of Identity Management (IdM) certificates using the Healthcheck tool.
			</p><p>
				Since, the Healthcheck tool includes many tests, you can narrow the results by including only DogTag tests: <code class="literal">--source=ipahealthcheck.dogtag.ca</code>
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To run Healthcheck restricted to DogTag certificates, enter:
					</p><pre class="literallayout"># ipa-healthcheck --source=ipahealthcheck.dogtag.ca</pre></li></ul></div><p>
				An example of a successful test:
			</p><pre class="literallayout">{
  "source: ipahealthcheck.dogtag.ca",
  "check: DogtagCertsConfigCheck",
  "result: SUCCESS",
  "uuid: 9b366200-9ec8-4bd9-bb5e-9a280c803a9c",
  "when: 20191008135826Z",
  "duration: 0.252280",
  "kw:" {
    "key": "Server-Cert cert-pki-ca",
    "configfile":  "/var/lib/pki/pki-tomcat/conf/ca/CS.cfg"
    }
}</pre><p>
				An example of a failed test:
			</p><pre class="literallayout">{
  "source: ipahealthcheck.dogtag.ca",
  "check: DogtagCertsConfigCheck",
  "result: CRITICAL",
  "uuid: 59d66200-1447-4b3b-be01-89810c803a98",
  "when: 20191008135912Z",
  "duration: 0.002022",
  "kw:" {
    "exception": "NSDB /etc/pki/pki-tomcat/alias not initialized",
    }
}</pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <code class="literal">man ipa-healthcheck</code>.
					</li></ul></div></section></section><section class="chapter" id="understanding-what-certificates-are-used-by-idm_managing-certificates-in-idm"><div class="titlepage"><div><div><h2 class="title">Chapter 26. Understanding the certificates used internally by IdM</h2></div></div></div><p>
			You can install a Red Hat Identity Management (IdM) server with an integrated certificate authority (CA) or without a CA. The certificates necessary to access and administer IdM are managed differently depending on whether your CA is integrated or not:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Integrated CA: certificates are automatically created and tracked by <code class="literal">certmonger</code>. <code class="literal">certmonger</code> automatically renews the certificates, ensuring a continuing validity of your IdM service.
				</li><li class="listitem">
					Without a CA: certificates are requested from a third-party authority. In this case, you need to monitor their expiration and ensure they are renewed to ensure the continuing validity of your IdM service.
				</li></ul></div><section class="section" id="about-the-internal-certificates-in-idm_understanding-what-certificates-are-used-by-idm"><div class="titlepage"><div><div><h3 class="title">26.1. About the internal certificates in IdM</h3></div></div></div><p>
				Red Hat Identity Management (IdM) uses many services accessed by using a network, including an LDAP server and an HTTP server. You access these services by using an SSL/TLS port, which requires a server certificate. You require the HTTP and LDAP server certificates during the installation of the IdM server.
			</p><p>
				You can obtain certificates in multiple ways depending on how you install and configure IdM:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						With an integrated CA that can be either self-signed or signed by an external CA: IdM issues all the certificates for the users, hosts, and services managed by IdM and you do not need to provide a certificate file.
					</p><p class="simpara">
						<code class="literal">certmonger</code> automatically monitors the expiry dates of the certificates and they are automatically renewed when required.
					</p></li><li class="listitem"><p class="simpara">
						With an externally signed CA: the installation is a multiple step process.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You need to run the installation with the <code class="literal">--external-ca</code> option to generate a CSR.
							</li><li class="listitem">
								Submit the CSR to the external CA and retrieve the issued certificate and CA certificate chain as a PEM file or Base64 encoded certificate.
							</li><li class="listitem"><p class="simpara">
								Run the IdM server install again, specifying the location and names of the newly-issued CA certificate and CA chain file. Your IdM certificate authority is configured as a subCA of the external CA and this subCA issues the required HTTP and LDAP server certificates.
							</p><p class="simpara">
								<code class="literal">certmonger</code> automatically monitors the expiry dates of the certificates and they are automatically renewed when required.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						Without a CA: requires you to request the following certificates from a third-party authority:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								An LDAP server certificate
							</li><li class="listitem">
								An Apache server certificate
							</li><li class="listitem">
								A PKINIT certificate
							</li><li class="listitem"><p class="simpara">
								Full CA certificate chain of the CA that issued the LDAP and Apache server certificates
							</p><p class="simpara">
								These certificates are not tracked by <code class="literal">certmonger</code> and an administrator is responsible for renewing them before they reach their expiration date.
							</p></li></ul></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-your-ca-services_planning-identity-management">Planning your CA services</a>
					</li></ul></div></section><section class="section" id="certificates-internal-to-idm_understanding-what-certificates-are-used-by-idm"><div class="titlepage"><div><div><h3 class="title">26.2. Certificates internal to IdM</h3></div></div></div><p>
				Your internal certificates can depend on how you installed IdM and what components were included in that installation. Depending on that installation, you might have the following certificates stored on your system.
			</p><div class="formalpara"><p class="title"><strong>IdM CA certificate</strong></p><p>
					The IdM CA certificate is used by IdM to sign all other certificates. Note that it is not present in CA-less installations.
				</p></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333357667760" scope="col">caSigningCert</th><th align="left" valign="top" id="idm140333357666672" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333357667760"> <p>
								File system location
							</p>
							 </td><td align="left" valign="top" headers="idm140333357666672"> <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">nickname=caSigningCert cert-pki-ca</code> in <code class="literal">/etc/pki/pki-tomcat/alias</code> NSS database
									</li><li class="listitem">
										<code class="literal">nickname=REALM.NAME IPA CA</code> in <code class="literal">/etc/ipa/nssdb/</code> and <code class="literal">/etc/ipa/ca.crt</code> (populated from LDAP)
									</li></ul></div>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357667760"> <p>
								LDAP location
							</p>
							 </td><td align="left" valign="top" headers="idm140333357666672"> <p>
								<code class="literal">cn=REALM.NAME IPA CA,cn=certificates,cn=ipa,cn=etc,dc=realm,dc=name and ou=authorities,ou=ca,o=ipaca</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357667760"> <p>
								Issuer
							</p>
							 </td><td align="left" valign="top" headers="idm140333357666672"> <p>
								Self-signed or signed by an external CA
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357667760"> <p>
								Subject
							</p>
							 </td><td align="left" valign="top" headers="idm140333357666672"> <p>
								<code class="literal">O = REALM.NAME, CN = Certificate Authority</code>
							</p>
							 <p>
								Note that this is the default value but it can be customized during the IdM server installation.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357667760"> <p>
								Additional information
							</p>
							 </td><td align="left" valign="top" headers="idm140333357666672"> <p>
								Must have <code class="literal">CA:true</code> critical constraint and must have <code class="literal">CT,C,C</code> trust flags in the NSS database.
							</p>
							 </td></tr></tbody></table></rh-table><div class="formalpara"><p class="title"><strong>External CA certificate</strong></p><p>
					If you are using an external CA, the chain of external CAs must be available in IdM to validate IdM certificates. For a CA-less installation, the external CA certificate must be present in various locations, including LDAP and in the <code class="literal">/etc/ipa/ca.crt</code> directory to validate HTTPD and LDAP certificates.
				</p></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You do not have to manually add the external CA certificate to all the required locations as it is done automatically during the installation. However, if the external CA certificate is updated later, you should follow the steps in <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/managing_certificates_in_idm/index#renew-with-externally-signed-CA_managing-externally-signed-ca-certificates">Renewing the IdM CA renewal server certificate using an external CA</a> to ensure the new certificate is added to every location where it is required.
				</p></div></rh-alert><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333357786528" scope="col">External certificate</th><th align="left" valign="top" id="idm140333357785440" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333357786528"> <p>
								File system location
							</p>
							 </td><td align="left" valign="top" headers="idm140333357785440"> <p>
								<code class="literal">/etc/pki/pki-tomcat/alias nssdb</code> and as part of chain in <code class="literal">/etc/ipa/ca.crt</code> (populated from LDAP)
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357786528"> <p>
								LDAP location
							</p>
							 </td><td align="left" valign="top" headers="idm140333357785440"> <p>
								<code class="literal">cn=SUBJECT,cn=certificates,cn=ipa,cn=etc,dc=realm,dc=name and ou=authorities,ou=ca,o=ipaca</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357786528"> <p>
								Issuer
							</p>
							 </td><td align="left" valign="top" headers="idm140333357785440"> <p>
								External CA-signed
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357786528"> <p>
								Subject
							</p>
							 </td><td align="left" valign="top" headers="idm140333357785440"> <p>
								External CA subject
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357786528"> <p>
								Additional information
							</p>
							 </td><td align="left" valign="top" headers="idm140333357785440"> <p>
								You must have all the certificates in the chain in DER format and you must import them into LDAP. Must have <code class="literal">CT,C,C</code> trust flags in the NSS database.
							</p>
							 </td></tr></tbody></table></rh-table><div class="formalpara"><p class="title"><strong>Subsystem CA certificate</strong></p><p>
					This certificate is used to authenticate to the LDAP server when writing to the LDAP database. This certificate is not present in CA-less installations.
				</p></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333357756928" scope="col">subsystemCert</th><th align="left" valign="top" id="idm140333357755840" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333357756928"> <p>
								File system location
							</p>
							 </td><td align="left" valign="top" headers="idm140333357755840"> <p>
								<code class="literal">nickname=subsystemCert cert-pki-ca</code> in <code class="literal">/etc/pki/pki-tomcat/alias nssdb</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357756928"> <p>
								LDAP location
							</p>
							 </td><td align="left" valign="top" headers="idm140333357755840"> <p>
								<code class="literal">uid=pkidbuser,ou=people,o=ipaca</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357756928"> <p>
								Issuer
							</p>
							 </td><td align="left" valign="top" headers="idm140333357755840"> <p>
								IPA CA
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357756928"> <p>
								Subject
							</p>
							 </td><td align="left" valign="top" headers="idm140333357755840"> <p>
								<code class="literal">CN=CA Subsystem,O=REALM.NAME</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357756928"> <p>
								Additional information
							</p>
							 </td><td align="left" valign="top" headers="idm140333357755840"> <p>
								Be wary of a serial and blob mismatch in LDAP. For example, <code class="literal">2;SERIAL;CN=Certificate Authority,O=REALM.NAME;CN=CA Subsystem,O=REALM.NAME</code> and <code class="literal">userCertificate</code> must match the one on the file system.
							</p>
							 </td></tr></tbody></table></rh-table><div class="formalpara"><p class="title"><strong>Audit signing certificate</strong></p><p>
					This certificate is used to sign the audit logs. Note that it is not present in CA-less installations.
				</p></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333356689504" scope="col">auditSigningCert</th><th align="left" valign="top" id="idm140333356688416" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333356689504"> <p>
								File system location
							</p>
							 </td><td align="left" valign="top" headers="idm140333356688416"> <p>
								<code class="literal">nickname=auditSigningCert cert-pki-ca</code> in <code class="literal">/etc/pki/pki-tomcat/alias nssdb</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333356689504"> <p>
								LDAP location
							</p>
							 </td><td align="left" valign="top" headers="idm140333356688416"> <p>
								No dedicated LDAP location, shared via <code class="literal">ou=certificateRepository,ou=ca,o=ipaca</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333356689504"> <p>
								Issuer
							</p>
							 </td><td align="left" valign="top" headers="idm140333356688416"> <p>
								IPA CA
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333356689504"> <p>
								Subject
							</p>
							 </td><td align="left" valign="top" headers="idm140333356688416"> <p>
								<code class="literal">CN=CA Audit,O=REALM.NAME</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333356689504"> <p>
								Additional information
							</p>
							 </td><td align="left" valign="top" headers="idm140333356688416"> <p>
								Must have <code class="literal">,,P</code> trust flags in the NSS database.
							</p>
							 </td></tr></tbody></table></rh-table><div class="formalpara"><p class="title"><strong>OCSP signing certificate</strong></p><p>
					This certificate is used to provide Online Certificate Status Protocol (OCSP) services. Note that it is not present in CA-less installations.
				</p></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333356659584" scope="col">ocspSigningCert</th><th align="left" valign="top" id="idm140333356658496" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333356659584"> <p>
								File system location
							</p>
							 </td><td align="left" valign="top" headers="idm140333356658496"> <p>
								<code class="literal">nickname=ocspSigningCert cert-pki-ca</code> in <code class="literal">/etc/pki/pki-tomcat/alias nssdb</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333356659584"> <p>
								LDAP location
							</p>
							 </td><td align="left" valign="top" headers="idm140333356658496"> <p>
								No dedicated LDAP location, shared via <code class="literal">ou=certificateRepository,ou=ca,o=ipaca</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333356659584"> <p>
								Issuer
							</p>
							 </td><td align="left" valign="top" headers="idm140333356658496"> <p>
								IPA CA
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333356659584"> <p>
								Subject
							</p>
							 </td><td align="left" valign="top" headers="idm140333356658496"> <p>
								<code class="literal">CN=OCSP Subsystem,O=REALM.NAME</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333356659584"> <p>
								Additional information
							</p>
							 </td><td align="left" valign="top" headers="idm140333356658496"> </td></tr></tbody></table></rh-table><div class="formalpara"><p class="title"><strong>Tomcat servlet certificate</strong></p><p>
					This certificate is used when a client contacts the PKI. Note that this server certificate is specific to the host and it is not present in CA-less installations.
				</p></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333357563344" scope="col">Server-Cert</th><th align="left" valign="top" id="idm140333357562256" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333357563344"> <p>
								File system location
							</p>
							 </td><td align="left" valign="top" headers="idm140333357562256"> <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Nickname=Server-Cert cert-pki-ca in /etc/pki/pki-tomcat/alias nssdb+
									</li></ul></div>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357563344"> <p>
								LDAP location
							</p>
							 </td><td align="left" valign="top" headers="idm140333357562256"> </td></tr><tr><td align="left" valign="top" headers="idm140333357563344"> <p>
								Issuer
							</p>
							 </td><td align="left" valign="top" headers="idm140333357562256"> <p>
								IPA CA
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357563344"> <p>
								Subject
							</p>
							 </td><td align="left" valign="top" headers="idm140333357562256"> <p>
								CN=$HOSTNAME,O=REALM.NAME
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357563344"> <p>
								Additional information
							</p>
							 </td><td align="left" valign="top" headers="idm140333357562256"> </td></tr></tbody></table></rh-table><div class="formalpara"><p class="title"><strong>Registration authority certificate</strong></p><p>
					Certificate used by <code class="literal">certmonger</code> as well as by the IdM framework to authenticate to the PKI. For example, if you run <code class="literal">ipa cert-show 1</code>, HTTPD communicates with the PKI and authenticates with this certificate. Not present in CA-less installations.
				</p></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333357535168" scope="col">RA agent</th><th align="left" valign="top" id="idm140333357534080" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333357535168"> <p>
								File system location
							</p>
							 </td><td align="left" valign="top" headers="idm140333357534080"> <p>
								<code class="literal">/var/lib/ipa/ra-agent.pem</code> (used to be in <code class="literal">/etc/httpd/alias</code> before RHEL 7.4)
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357535168"> <p>
								LDAP location
							</p>
							 </td><td align="left" valign="top" headers="idm140333357534080"> <p>
								<code class="literal">uid=ipara,ou=people,o=ipaca</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357535168"> <p>
								Issuer
							</p>
							 </td><td align="left" valign="top" headers="idm140333357534080"> <p>
								IPA CA
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357535168"> <p>
								Subject
							</p>
							 </td><td align="left" valign="top" headers="idm140333357534080"> <p>
								<code class="literal">CN=IPA RA,O=REALM.NAME</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333357535168"> <p>
								Additional information
							</p>
							 </td><td align="left" valign="top" headers="idm140333357534080"> <p>
								Be wary of a serial and blob mismatch in LDAP. For example, <code class="literal">2;SERIAL;CN=Certificate Authority,O=REALM.NAME;CN=IPA RA,O=REALM.NAME</code> and <code class="literal">userCertificate</code> must match the one on the file system.
							</p>
							 </td></tr></tbody></table></rh-table><div class="formalpara"><p class="title"><strong>HTTPD front end certificate</strong></p><p>
					Certificate used for the HTTPD frontend to secure connections to the Web UI and API. Must be present.
				</p></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333355481728" scope="col">HTTPD</th><th align="left" valign="top" id="idm140333355480640" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333355481728"> <p>
								File system location
							</p>
							 </td><td align="left" valign="top" headers="idm140333355480640"> <p>
								<code class="literal">/var/lib/ipa/certs/httpd.crt</code> (used to be in <code class="literal">/etc/httpd/alias</code> before RHEL 8)
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333355481728"> <p>
								LDAP location
							</p>
							 </td><td align="left" valign="top" headers="idm140333355480640"> </td></tr><tr><td align="left" valign="top" headers="idm140333355481728"> <p>
								Issuer
							</p>
							 </td><td align="left" valign="top" headers="idm140333355480640"> <p>
								IPA CA or external CA in CA-less installations
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333355481728"> <p>
								Subject
							</p>
							 </td><td align="left" valign="top" headers="idm140333355480640"> <p>
								<code class="literal">CN=$HOSTNAME,O=REALM.NAME</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333355481728"> <p>
								Additional information
							</p>
							 </td><td align="left" valign="top" headers="idm140333355480640"> <p>
								Must contain a <code class="literal">Certificate Subject Alt Name</code> extension with principal name as <code class="literal">otherName = 1.3.6.1.4.1.311.20.2.3;UTF8:HTTP/$HOSTNAME@REALM, DNS name = $HOSTNAME</code>.
							</p>
							 </td></tr></tbody></table></rh-table><div class="formalpara"><p class="title"><strong>LDAP TLS and STARTTLS certificate</strong></p><p>
					Certificate used for LDAP TLS and STARTTLS connections. Must be present.
				</p></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333358758928" scope="col">LDAP</th><th align="left" valign="top" id="idm140333358757840" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333358758928"> <p>
								File system location
							</p>
							 </td><td align="left" valign="top" headers="idm140333358757840"> <p>
								<code class="literal">nickname=Server-Cert</code> in <code class="literal">/etc/dirsrv/slapd-DOMAIN</code> NSS database (can be other nickname, matching <code class="literal">nsSSLPersonalitySSL</code> in <code class="literal">dse.ldif</code>)
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333358758928"> <p>
								LDAP location
							</p>
							 </td><td align="left" valign="top" headers="idm140333358757840"> </td></tr><tr><td align="left" valign="top" headers="idm140333358758928"> <p>
								Issuer
							</p>
							 </td><td align="left" valign="top" headers="idm140333358757840"> <p>
								IPA CA or external CA in CA-less installations
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333358758928"> <p>
								Subject
							</p>
							 </td><td align="left" valign="top" headers="idm140333358757840"> <p>
								<code class="literal">CN=$HOSTNAME,O=REALM.NAME</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333358758928"> <p>
								Additional information
							</p>
							 </td><td align="left" valign="top" headers="idm140333358757840"> <p>
								Must contain a <code class="literal">Certificate Subject Alt Name</code> extension with principal name as <code class="literal">otherName = 1.3.6.1.4.1.311.20.2.3;UTF8:ldap/$HOSTNAME@REALM, DNS name = $HOSTNAME</code>.
							</p>
							 </td></tr></tbody></table></rh-table><div class="formalpara"><p class="title"><strong>KDC certificate</strong></p><p>
					Certificate used for PKINIT for the IdM KDC.
				</p></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140333358728720" scope="col">KDC</th><th align="left" valign="top" id="idm140333358727632" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140333358728720"> <p>
								File system location
							</p>
							 </td><td align="left" valign="top" headers="idm140333358727632"> <p>
								<code class="literal">/var/kerberos/krb5kdc/kdc.crt</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333358728720"> <p>
								LDAP location
							</p>
							 </td><td align="left" valign="top" headers="idm140333358727632"> </td></tr><tr><td align="left" valign="top" headers="idm140333358728720"> <p>
								Issuer
							</p>
							 </td><td align="left" valign="top" headers="idm140333358727632"> <p>
								IPA CA or external CA in CA-less installations
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333358728720"> <p>
								Subject
							</p>
							 </td><td align="left" valign="top" headers="idm140333358727632"> <p>
								<code class="literal">CN=$HOSTNAME,O=REALM.NAME</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140333358728720"> <p>
								Additional information
							</p>
							 </td><td align="left" valign="top" headers="idm140333358727632"> <p>
								Must have extended key usage <code class="literal">id-pkinit-KPkdc (1.3.6.1.5.2.3.5)</code>, principal name as <code class="literal">otherName = 1.3.6.1.4.1.311.20.2.3;UTF8:krbtgt/REALM@REALM, DNS name = $HOSTNAME</code>.
							</p>
							 </td></tr></tbody></table></rh-table></section><section class="section" id="idm-internal-certificate-renewal-process_understanding-what-certificates-are-used-by-idm"><div class="titlepage"><div><div><h3 class="title">26.3. IdM internal certificate renewal process</h3></div></div></div><p>
				By default, <code class="literal">certmonger</code> tracks the internal certificates and triggers the renewal and requests the IdM CA to issue a new certificate.
			</p><p>
				If you are using an external CA and your internal certificates were issued by this CA, they are not automatically renewed. In this case, you should monitor the expiry dates of your certificates to ensure you renew them before they expire. The renewal process is time consuming and if you do not track the expiry dates carefully, your certificates will expire and some services will no longer be available.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					If your internal Red Hat Identity Management (IdM) certificates expire, IdM fails to start.
				</p></div></rh-alert><p>
				The IdM CA renewal server renews the shared internal certificates 28 days before their expiration date. <code class="literal">certmonger</code> triggers this renewal and uploads the new certificate into <code class="literal">cn=&lt;nickname&gt;,cn=ca_renewal,cn=ipa,cn=etc,$BASEDN</code>. <code class="literal">certmonger</code> also triggers the renewal process on the other IdM servers but as it is executed on an non-CA renewal server, it does not request a new certificate but downloads the certificate from LDAP. Note that the <code class="literal">Server-Cert cert-pki-ca</code>, HTTP, LDAP, and PKINIT certificates are specific to each replica, containing the hostname in their subject.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If you manually renew a shared certificate with <code class="literal">getcert</code> before a certificate expires, the renewal process is not triggered on the other replicas and you must run <code class="literal">getcert</code> on the other replicas to perform the download of the renewed certificate from LDAP.
				</p></div></rh-alert></section><section class="section _additional-resources" id="additional_resources_4"><div class="titlepage"><div><div><h3 class="title">26.4. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/ipa-ca-renewal_managing-certificates-in-idm">Using IdM CA renewal server</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/renewing-expired-system-certificates-when-idm-is-offline_managing-certificates-in-idm">Renewing expired system certificates when IdM is offline</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-not-yet-expired-on-an-idm-replica_managing-certificates-in-idm">Replacing the web server and LDAP server certificates if they have not yet expired on an IdM replica</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-expired-in-the-whole-idm-deployment_managing-certificates-in-idm">Replacing the web server and LDAP server certificates if they have expired in the whole IdM deployment</a>
					</li></ul></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140333367899040"><h2 class="legalnotice">Legal Notice</h2><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2024 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></body></section><!----></div></article><aside id="layout" class="span-xs-12 span-sm-2 span-md-2 content-format-selectors" aria-label="Select page format" data-v-8589d091><div class="sticky-top page-layout-options" data-v-8589d091><label for="page-format" data-v-8589d091>Format</label><select id="page-format" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div><!----></aside></div><div class="btn-container hidden" data-v-8589d091><pf-button class="top-scroll-btn" icon="angle-up" icon-set="fas" icon-position="right" data-v-8589d091>Back to top</pf-button></div><!--]--><!--]--></main><rh-footer data-analytics-region="page-footer" data-v-97dd2752><a slot="logo" href="/en" data-analytics-category="Footer" data-analytics-text="Logo" data-v-97dd2752><img alt="Red Hat logo" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" loading="lazy" width="222" height="40" data-v-97dd2752></a><rh-footer-social-link slot="social-links" icon="github" data-v-97dd2752><a href="https://github.com/redhat-documentation" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="LinkedIn" data-v-97dd2752>Github</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="reddit" data-v-97dd2752><a href="https://www.reddit.com/r/redhat/" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="YouTube" data-v-97dd2752>Reddit</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="youtube" data-v-97dd2752><a href="https://www.youtube.com/@redhat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Facebook" data-v-97dd2752>Youtube</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="twitter" data-v-97dd2752><a href="https://twitter.com/RedHat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Twitter" data-v-97dd2752>Twitter</a></rh-footer-social-link><h3 slot="links" data-analytics-text="Learn" data-v-97dd2752>Learn</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://developers.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Developer resources" data-v-97dd2752>Developer resources</a></li><li data-v-97dd2752><a href="https://cloud.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Cloud learning hub" data-v-97dd2752>Cloud learning hub</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="Footer|Learn" data-analytics-text="Interactive labs" data-v-97dd2752>Interactive labs</a></li><li data-v-97dd2752><a href="https://www.redhat.com/services/training-and-certification" data-analytics-category="Footer|Learn" data-analytics-text="Training and certification" data-v-97dd2752>Training and certification</a></li><li data-v-97dd2752><a href="https://access.redhat.com/support" data-analytics-category="Footer|Learn" data-analytics-text="Customer support" data-v-97dd2752>Customer support</a></li><li data-v-97dd2752><a href="/products" data-analytics-category="Footer|Learn" data-analytics-text="See all documentation" data-v-97dd2752>See all documentation</a></li></ul><h3 slot="links" data-analytics-text="Try buy sell" data-v-97dd2752>Try, buy, &amp; sell</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/products/trials" data-analytics-category="Footer|Try buy sell" data-analytics-text="Product trial center" data-v-97dd2752>Product trial center</a></li><li data-v-97dd2752><a href="https://marketplace.redhat.com" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Marketplace" data-v-97dd2752>Red Hat Marketplace</a></li><li data-v-97dd2752><a href="https://catalog.redhat.com/" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Ecosystem Catalog" data-v-97dd2752>Red Hat Ecosystem Catalog</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/store" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Store" data-v-97dd2752>Red Hat Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/japan-buy" data-analytics-category="Footer|Try buy sell" data-analytics-text="Buy online (Japan)" data-v-97dd2752>Buy online (Japan)</a></li></ul><h3 slot="links" data-analytics-text="Communities" data-v-97dd2752>Communities</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://access.redhat.com/community" data-analytics-category="Footer|Communities" data-analytics-text="Customer Portal Community" data-v-97dd2752>Customer Portal Community</a></li><li data-v-97dd2752><a href="https://www.redhat.com/events" data-analytics-category="Footer|Communities" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/our-community-contributions" data-analytics-category="Footer|Communities" data-analytics-text="How we contribute" data-v-97dd2752>How we contribute</a></li></ul><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat Documentation" data-v-97dd2752>About Red Hat Documentation</h3><p data-v-97dd2752>We help Red Hat users innovate and achieve their goals with our products and services with content they can trust.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="Making open source more inclusive" data-v-97dd2752>Making open source more inclusive</h3><p data-v-97dd2752>Red Hat is committed to replacing problematic language in our code, documentation, and web properties. For more details, see the <a href=" https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language" data-analytics-category="Footer|Making open source more inclusive" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a>.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</h3><p data-v-97dd2752>We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.</p></rh-footer-block><rh-footer-universal slot="universal" data-v-97dd2752><h3 slot="links-primary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-primary" data-analytics-region="page-footer-bottom-primary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/company" data-analytics-category="Footer|Corporate" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/jobs" data-analytics-category="Footer|Corporate" data-analytics-text="Jobs" data-v-97dd2752>Jobs</a></li><li data-v-97dd2752><a href="https://redhat.com/en/events" data-analytics-category="Footer|Corporate" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/office-locations" data-analytics-category="Footer|Corporate" data-analytics-text="Locations" data-v-97dd2752>Locations</a></li><li data-v-97dd2752><a href="https://redhat.com/en/contact" data-analytics-category="Footer|Corporate" data-analytics-text="Contact Red Hat" data-v-97dd2752>Contact Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/blog" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/our-culture/diversity-equity-inclusion" data-analytics-category="Footer|Corporate" data-analytics-text="Diversity equity and inclusion" data-v-97dd2752>Diversity, equity, and inclusion</a></li><li data-v-97dd2752><a href="https://coolstuff.redhat.com/" data-analytics-category="Footer|Corporate" data-analytics-text="Cool Stuff Store" data-v-97dd2752>Cool Stuff Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/summit" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Summit" data-v-97dd2752>Red Hat Summit</a></li></ul><span data-v-97dd2752 data-v-5f538988></span><rh-footer-copyright slot="links-secondary" data-v-97dd2752>© 2024 Red Hat, Inc.</rh-footer-copyright><h3 slot="links-secondary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-secondary" data-analytics-region="page-footer-bottom-secondary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/privacy-policy" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Privacy statement" data-v-97dd2752>Privacy statement</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/terms-use" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Terms of use" data-v-97dd2752>Terms of use</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/all-policies-guidelines" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="All policies and guidelines" data-v-97dd2752>All policies and guidelines</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/digital-accessibility" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Digital accessibility" class="active" data-v-97dd2752>Digital accessibility</a></li><li data-v-97dd2752><span id="teconsent" data-v-97dd2752></span></li></ul></rh-footer-universal></rh-footer><div id="consent_blackbar" style="position:fixed;bottom:0;width:100%;z-index:5;padding:10px;"></div><!--]--><!--]--></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true">[["ShallowReactive",1],{"data":2,"state":959,"once":963,"_errors":964,"serverRendered":15,"path":966},["ShallowReactive",3],{"s8LoCEfG4A":4,"uUstF4AIyn":10,"Pn02PlJOas":887,"rFVLKcOK8e":958},[5,6,7,8,9],"fr-fr","en-us","zh-cn","ko-kr","ja-jp",{"name":11,"html":12,"type":-1,"toc":13,"breadcrumbs":792,"error":18,"title":800,"productName":794,"productVersions":809,"pagination":838,"redirect":868,"canonicalLinks":869,"openShiftProducts":871,"tocFromVolume":-1,"jumpLinks":886},"Managing certificates in IdM","\u003Cbody>\u003Cdiv xml:lang=\"en-US\" class=\"book\" id=\"idm140333374276784\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv class=\"producttitle\">\u003Cspan class=\"productname\">Red Hat Enterprise Linux\u003C/span> \u003Cspan class=\"productnumber\">9\u003C/span>\u003C/div>\u003Cdiv>\u003Ch3 class=\"subtitle\">Issuing certificates, configuring certificate-based authentication, and controlling certificate validity\u003C/h3>\u003C/div>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"authorgroup\">\u003Cspan class=\"orgname\">Red Hat\u003C/span> \u003Cspan class=\"orgdiv\">Customer Content Services\u003C/span>\u003C/div>\u003C/div>\u003Cdiv>\u003Ca href=\"#idm140333367899040\">Legal Notice\u003C/a>\u003C/div>\u003Cdiv>\u003Cdiv class=\"abstract\">\u003Cp class=\"title\">\u003Cstrong>Abstract\u003C/strong>\u003C/p>\u003Cdiv class=\"para\">\n\t\t\t\tAdministrators use X.509 certificates to authenticate users, hosts, and services, and to enable digital signing and encryption. In Red Hat Identity Management (IdM), you can manage certificates by using the integrated or an external Certificate Authority (CA).\n\t\t\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\t\tYou can request and renew certificates by using the \u003Ccode class=\"literal\">certmonger\u003C/code> service, the \u003Ccode class=\"literal\">certutil\u003C/code> tool, or Ansible Playbooks. To replace the web server and LDAP server certificates of IdM servers, you must perform manual actions.\n\t\t\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\t\tAdministrators can create lightweight sub-CAs to issue certificates for a specific purpose, such as user certificates for a VPN gateway. The administrator can then invalidate all certificates for this service by revoking the sub-CA's certificate when this VPN gateway is no longer needed.\n\t\t\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003Chr/>\u003C/div>\u003Csection class=\"preface\" id=\"proc_providing-feedback-on-red-hat-documentation_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Providing feedback on Red Hat documentation\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tWe appreciate your feedback on our documentation. Let us know how we can improve it.\n\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Submitting feedback through Jira (account required)\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\tLog in to the \u003Ca class=\"link\" href=\"https://issues.redhat.com/projects/RHELDOCS/issues\">Jira\u003C/a> website.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> in the top navigation bar\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter a descriptive title in the \u003Cspan class=\"strong strong\">\u003Cstrong>Summary\u003C/strong>\u003C/span> field.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter your suggestion for improvement in the \u003Cspan class=\"strong strong\">\u003Cstrong>Description\u003C/strong>\u003C/span> field. Include links to the relevant parts of the documentation.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> at the bottom of the dialogue.\n\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"cert-intro_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 1. Public key certificates in Identity Management\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tX.509 public key certificates are used to authenticate users, hosts and services in Identity Management (IdM). In addition to authentication, X.509 certificates also enable digital signing and encryption to provide privacy, integrity and non-repudiation.\n\t\t\u003C/p>\u003Cp>\n\t\t\tA certificate contains the following information:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tThe subject that the certificate authenticates.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe issuer, that is the CA that has signed the certificate.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe start and end date of the validity of the certificate.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe valid uses of the certificate.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe public key of the subject.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tA message encrypted by the public key can only be decrypted by a corresponding private key. While a certificate and the public key it includes can be made publicly available, the user, host or service must keep their private key secret.\n\t\t\u003C/p>\u003Cp>\n\t\t\t\u003Cspan id=\"con-cert-authority-idm_cert-intro\">\u003C!--Empty-->\u003C/span>\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"certificate_authorities_in_idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.1. Certificate authorities in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tCertificate authorities operate in a hierarchy of trust. In an IdM environment with an internal Certificate Authority (CA), all the IdM hosts, users and services trust certificates that have been signed by the CA. Apart from this root CA, IdM supports sub-CAs to which the root CA has granted the ability to sign certificates in their turn. Frequently, the certificates that such sub-CAs are able to sign are certificates of a specific kind, for example VPN certificates. Finally, IdM supports using external CAs. The table \u003Ca class=\"link\" href=\"#tab-comparison-of-using-integrated-and-external-cas-in-idm_cert-intro\" title=\"Table 1.1. Comparison of using integrated and external CAs in IdM\">below\u003C/a> presents the specifics of using the individual types of CA in IdM.\n\t\t\t\u003C/p>\u003Crh-table id=\"tab-comparison-of-using-integrated-and-external-cas-in-idm_cert-intro\">\u003Ctable class=\"gt-4-cols lt-7-rows\">\u003Ccaption>Table 1.1. Comparison of using integrated and external CAs in IdM\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 11%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 22%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_4\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333373583600\" scope=\"col\">Name of CA\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333373054000\" scope=\"col\">Description\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333373052912\" scope=\"col\">Use\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333373051824\" scope=\"col\">Useful links\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373583600\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipa\u003C/code> CA\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373054000\"> \u003Cp>\n\t\t\t\t\t\t\t\tAn integrated CA based on the Dogtag upstream project\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373052912\"> \u003Cp>\n\t\t\t\t\t\t\t\tIntegrated CAs can create, revoke, and issue certificates for users, hosts, and services.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373051824\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#requesting-and-exporting-a-user-certificate_dc-web-ui-auth\" title=\"11.2. Requesting a new user certificate and exporting it to the client\">Using the ipa CA to request a new user certificate and exporting it to the client\u003C/a>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373583600\"> \u003Cp>\n\t\t\t\t\t\t\t\tIdM sub-CAs\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373054000\"> \u003Cp>\n\t\t\t\t\t\t\t\tAn integrated CA that is subordinate to the \u003Ccode class=\"literal\">ipa\u003C/code> CA\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373052912\"> \u003Cp>\n\t\t\t\t\t\t\t\tIdM sub-CAs are CAs to which the \u003Ccode class=\"literal\">ipa\u003C/code> CA has granted the ability to sign certificates. Frequently, these certificates are of a specific kind, for example VPN certificates.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373051824\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm\" title=\"Chapter 22. Restricting an application to trust only a subset of certificates\">Restricting an application to trust only a subset of certificates\u003C/a>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373583600\"> \u003Cp>\n\t\t\t\t\t\t\t\tExternal CAs\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373054000\"> \u003Cp>\n\t\t\t\t\t\t\t\tAn external CA is a CA other than the integrated IdM CA or its sub-CAs.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373052912\"> \u003Cp>\n\t\t\t\t\t\t\t\tUsing IdM tools, you add certificates issued by these CAs to users, services, or hosts as well as remove them.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373051824\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#managing-externally-signed-certificates-for-idm-users-hosts-and-services_managing-certificates-in-idm\" title=\"Chapter 4. Managing externally signed certificates for IdM users, hosts, and services\">Managing externally signed certificates for IdM users, hosts, and services\u003C/a>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cp>\n\t\t\t\tFrom the certificate point of view, there is no difference between being signed by a self-signed IdM CA and being signed externally.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe role of the CA includes the following purposes:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIt issues digital certificates.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tBy signing a certificate, it certifies that the subject named in the certificate owns a public key. The subject can be a user, host or service.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIt can revoke certificates, and provides revocation status via Certificate Revocation Lists (CRLs) and Online Certificate Status Protocol (OCSP).\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-your-ca-services_planning-identity-management\">Planning your CA services\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cspan id=\"compare-certs-kerberos_cert-intro\">\u003C!--Empty-->\u003C/span>\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"comparison_of_certificates_and_kerberos\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.2. Comparison of certificates and Kerberos\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tCertificates perform a similar function to that performed by Kerberos tickets. Kerberos is a computer network authentication protocol that works on the basis of tickets to allow nodes communicating over a non-secure network to prove their identity to one another in a secure manner. The following table shows a comparison of Kerberos and X.509 certificates:\n\t\t\t\u003C/p>\u003Crh-table id=\"tab-compare-cert-kerberos_cert-intro\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 1.2. Comparison of certificates and Kerberos\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Characteristic\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Kerberos\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>X.509\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Authentication\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tYes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tYes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Privacy\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tOptional\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tYes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Integrity\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tOptional\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tYes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Type of cryptography involved\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tSymmetrical\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tAsymmetrical\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Default validity\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tShort (1 day)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tLong(2 years)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cp>\n\t\t\t\tBy default, Kerberos in Identity Management only ensures the identity of the communicating parties.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"using-certs-to-authenticate-users_cert-intro\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.3. The pros and cons of using certificates to authenticate users in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe advantages of using certificates to authenticate users in IdM include the following points:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA PIN that protects the private key on a smart card is typically less complex and easier to remember than a regular password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDepending on the device, a private key stored on a smart card cannot be exported. This provides additional security.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSmart cards can make logout automatic: IdM can be configured to log out users when they remove the smart card from the reader.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tStealing the private key requires actual physical access to a smart card, making smart cards secure against hacking attacks.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSmart card authentication is an example of two-factor authentication: it requires both something you have (the card) and something you know (the PIN).\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSmart cards are more flexible than passwords because they provide the keys that can be used for other purposes, such as encrypting email.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUsing smart cards use on shared machines that are IdM clients does not typically pose additional configuration problems for system administrators. In fact, smart card authentication is an ideal choice for shared machines.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe disadvantages of using certificates to authenticate users in IdM include the following points:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUsers might lose or forget to bring their smart card or certificate and be effectively locked out.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMistyping a PIN multiple times might result in a card becoming locked.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThere is generally an intermediate step between request and authorization by some sort of security officer or approver. In IdM, the security officer or administrator must run the \u003Cspan class=\"strong strong\">\u003Cstrong>ipa cert-request\u003C/strong>\u003C/span> command.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSmart cards and readers tend to be vendor and driver specific: although a lot of readers can be used for different cards, a smart card of a specific vendor might not work in the reader of another vendor or in the type of a reader for which it was not designed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCertificates and smart cards have a steep learning curve for administrators.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 2. Managing certificates for users, hosts, and services using the integrated IdM CA\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tTo learn more about how to manage certificates in Identity Management (IdM) using the integrated CA, the \u003Ccode class=\"literal\">ipa\u003C/code> CA, and its sub-CAs, see the following sections:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#requesting-new-certificates-for-a-user-host-or-service-using-idm-web-ui_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca\" title=\"2.1. Requesting new certificates for a user, host, or service using IdM Web UI\">Requesting new certificates for a user, host, or service using the IdM Web UI\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tRequesting new certificates for a user, host, or service from the IdM CA using the IdM CLI:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-certutil_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca\" title=\"2.2. Requesting new certificates for a user, host, or service from IdM CA using certutil\">Requesting new certificates for a user, host, or service from IdM CA using certutil\u003C/a>\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"square\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tFor a specific example of requesting a new user certificate from the IdM CA using the \u003Ccode class=\"literal\">certutil\u003C/code> utility and exporting it to an IdM client, see \u003Ca class=\"link\" href=\"#requesting-and-exporting-a-user-certificate_dc-web-ui-auth\" title=\"11.2. Requesting a new user certificate and exporting it to the client\">Requesting a new user certificate and exporting it to the client\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-openssl_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca\" title=\"2.3. Requesting new certificates for a user, host, or service from IdM CA using openssl\">Requesting new certificates for a user, host, or service from IdM CA using openssl\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tYou can also request new certificates for a service from the IdM CA using the \u003Ccode class=\"literal\">certmonger\u003C/code> utility. For more information, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/using-certmonger_managing-certificates-in-idm#obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs\">Requesting new certificates for a service from IdM CA using certmonger\u003C/a>.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tYour IdM deployment contains an integrated CA:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tFor information about how to plan your CA services in IdM, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-your-ca-services_planning-identity-management\">Planning your CA services\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tFor information about how to install an IdM server with integrated DNS and integrated CA as the root CA, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-with-integrated-dns_installing-identity-management\">Installing an IdM server: With integrated DNS, with an integrated CA as the root CA\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tFor information about how to install an IdM server with integrated DNS and an external CA as the root CA, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-with-external-ca_installing-identity-management\">Installing an IdM server: With integrated DNS, with an external CA as the root CA\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tFor information about how to install an IdM server without integrated DNS and with an integrated CA as the root CA, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-without-integrated-dns_installing-identity-management\">Installing an IdM server: Without integrated DNS, with an integrated CA as the root CA\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOptional: Your IdM deployment supports users authenticating with a certificate:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"square\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tFor information about how to configure your IdM deployment to support user authentication with a certificate stored in the IdM client filesystem, see \u003Ca class=\"link\" href=\"#dc-web-ui-auth_managing-certificates-in-idm\" title=\"Chapter 11. Configuring authentication with a certificate stored on the desktop of an IdM client\">Configuring authentication with a certificate stored on the desktop of an IdM client\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tFor information about how to configure your IdM deployment to support user authentication with a certificate stored on a smart card inserted into an IdM client, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication\">Configuring Identity Management for smart card authentication\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tFor information about how to configure your IdM deployment to support user authentication with smart cards issued by an Active Directory certificate system, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication\">Configuring certificates issued by ADCS for smart card authentication in IdM\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"requesting-new-certificates-for-a-user-host-or-service-using-idm-web-ui_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.1. Requesting new certificates for a user, host, or service using IdM Web UI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use the Identity Management (IdM) Web UI to request a new certificate for any IdM entity from the integrated IdM certificate authorities (CAs): the \u003Ccode class=\"literal\">ipa\u003C/code> CA or any of its sub-CAs.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIdM entities include:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUsers\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHosts\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tServices\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tServices typically run on dedicated service nodes on which the private keys are stored. Copying a service’s private key to the IdM server is considered insecure. Therefore, when requesting a certificate for a service, create the certificate signing request (CSR) on the service node.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM deployment contains an integrated CA.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged into the IdM Web UI as the IdM administrator.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUnder the \u003Ccode class=\"literal\">Identity\u003C/code> tab, select the \u003Ccode class=\"literal\">Users\u003C/code>, \u003Ccode class=\"literal\">Hosts\u003C/code>, or \u003Ccode class=\"literal\">Services\u003C/code> subtab.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tClick the name of the user, host, or service to open its configuration page.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"host-list-cert-request\">\u003Cp class=\"title\">\u003Cstrong>Figure 2.1. List of Hosts\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/873e3f03a7cab246c4fce6a1ae267599/hosts_list.png\" alt=\"A screenshot of the &quot;Hosts&quot; page displaying a table of hosts and their attributes: &quot;Host name&quot; - &quot;Description&quot; - &quot;Enrolled.&quot; The hostname for the first entry is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Cspan class=\"guimenu\">Actions\u003C/span> → \u003Cspan class=\"guimenuitem\">New Certificate\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: Select the issuing CA and profile ID.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFollow the instructions for using the \u003Ccode class=\"literal\">certutil\u003C/code> command-line (CLI) utility on the screen.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">Issue\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-certutil_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.2. Requesting new certificates for a user, host, or service from IdM CA using certutil\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">certutil\u003C/code> utility to request a certificate for an Identity Management (IdM) user, host or service in standard IdM situations. To ensure that a host or service Kerberos alias can use a certificate, \u003Ca class=\"link\" href=\"#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-openssl_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca\" title=\"2.3. Requesting new certificates for a user, host, or service from IdM CA using openssl\">use the openssl utility to request a certificate\u003C/a> instead.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to request a certificate for an IdM user, host, or service from \u003Ccode class=\"literal\">ipa\u003C/code>, the IdM certificate authority (CA), using \u003Ccode class=\"literal\">certutil\u003C/code>.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tServices typically run on dedicated service nodes on which the private keys are stored. Copying a service’s private key to the IdM server is considered insecure. Therefore, when requesting a certificate for a service, create the certificate signing request (CSR) on the service node.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM deployment contains an integrated CA.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged into the IdM command-line interface (CLI) as the IdM administrator.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a temporary directory for the certificate database:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># mkdir ~/certdb/\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a new temporary certificate database, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># certutil -N -d \u003Cspan class=\"emphasis\">\u003Cem>~/certdb/\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the CSR and redirect the output to a file. For example, to create a CSR for a 4096 bit certificate and to set the subject to \u003Cspan class=\"emphasis\">\u003Cem>CN=server.example.com,O=EXAMPLE.COM\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># certutil -R -d \u003Cspan class=\"emphasis\">\u003Cem>~/certdb/\u003C/em>\u003C/span> -a -g \u003Cspan class=\"emphasis\">\u003Cem>4096\u003C/em>\u003C/span> -s \"\u003Cspan class=\"emphasis\">\u003Cem>CN=server.example.com,O=EXAMPLE.COM\u003C/em>\u003C/span>\" -8 \u003Cspan class=\"emphasis\">\u003Cem>server.example.com\u003C/em>\u003C/span> &gt; \u003Cspan class=\"emphasis\">\u003Cem>certificate_request.csr\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSubmit the certificate request file to the CA running on the IdM server. Specify the Kerberos principal to associate with the newly-issued certificate:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa cert-request \u003Cspan class=\"emphasis\">\u003Cem>certificate_request.csr\u003C/em>\u003C/span> --principal=\u003Cspan class=\"emphasis\">\u003Cem>host/server.example.com\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal command\">ipa cert-request\u003C/code> command in IdM uses the following defaults:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">caIPAserviceCert\u003C/code> certificate profile\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo select a custom profile, use the \u003Ccode class=\"literal option\">--profile-id\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe integrated IdM root CA, \u003Ccode class=\"literal\">ipa\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo select a sub-CA, use the \u003Ccode class=\"literal option\">--ca\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the output of the \u003Ccode class=\"literal command\">ipa cert-request --help\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm\" title=\"Chapter 6. Creating and managing certificate profiles in Identity Management\">Creating and managing certificate profiles in Identity Management\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-openssl_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.3. Requesting new certificates for a user, host, or service from IdM CA using openssl\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">openssl\u003C/code> utility to request a certificate for an Identity Management (IdM) host or service if you want to ensure that the Kerberos alias of the host or service can use the certificate. In standard situations, consider \u003Ca class=\"link\" href=\"#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-certutil_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca\" title=\"2.2. Requesting new certificates for a user, host, or service from IdM CA using certutil\">requesting a new certificate using the certutil utility\u003C/a> instead.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to request a certificate for an IdM host, or service from \u003Ccode class=\"literal\">ipa\u003C/code>, the IdM certificate authority, using \u003Ccode class=\"literal\">openssl\u003C/code>.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tServices typically run on dedicated service nodes on which the private keys are stored. Copying a service’s private key to the IdM server is considered insecure. Therefore, when requesting a certificate for a service, create the certificate signing request (CSR) on the service node.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM deployment contains an integrated CA.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged into the IdM command-line interface (CLI) as the IdM administrator.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreate one or more aliases for your Kerberos principal \u003Cspan class=\"emphasis\">\u003Cem>test/server.example.com\u003C/em>\u003C/span>. For example, \u003Cspan class=\"emphasis\">\u003Cem>test1/server.example.com\u003C/em>\u003C/span> and \u003Cspan class=\"emphasis\">\u003Cem>test2/server.example.com\u003C/em>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the CSR, add a subjectAltName for dnsName (\u003Cspan class=\"emphasis\">\u003Cem>server.example.com\u003C/em>\u003C/span>) and otherName (\u003Cspan class=\"emphasis\">\u003Cem>test2/server.example.com\u003C/em>\u003C/span>). To do this, configure the \u003Ccode class=\"literal\">openssl.conf\u003C/code> file to include the following line specifying the UPN otherName and subjectAltName:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">otherName=\u003Cspan class=\"emphasis\">\u003Cem>1.3.6.1.4.1.311.20.2.3\u003C/em>\u003C/span>;UTF8:\u003Cspan class=\"emphasis\">\u003Cem>test2/server.example.com@EXAMPLE.COM\u003C/em>\u003C/span>\nDNS.1 = \u003Cspan class=\"emphasis\">\u003Cem>server.example.com\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a certificate request using \u003Ccode class=\"literal\">openssl\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">openssl req -new -newkey rsa:\u003Cspan class=\"emphasis\">\u003Cem>2048\u003C/em>\u003C/span> -keyout test2service.key -sha256 -nodes -out \u003Cspan class=\"emphasis\">\u003Cem>certificate_request.csr\u003C/em>\u003C/span> -config openssl.conf\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSubmit the certificate request file to the CA running on the IdM server. Specify the Kerberos principal to associate with the newly-issued certificate:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa cert-request \u003Cspan class=\"emphasis\">\u003Cem>certificate_request.csr\u003C/em>\u003C/span> --principal=\u003Cspan class=\"emphasis\">\u003Cem>host/server.example.com\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal command\">ipa cert-request\u003C/code> command in IdM uses the following defaults:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">caIPAserviceCert\u003C/code> certificate profile\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo select a custom profile, use the \u003Ccode class=\"literal option\">--profile-id\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe integrated IdM root CA, \u003Ccode class=\"literal\">ipa\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo select a sub-CA, use the \u003Ccode class=\"literal option\">--ca\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the output of the \u003Ccode class=\"literal command\">ipa cert-request --help\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm\" title=\"Chapter 6. Creating and managing certificate profiles in Identity Management\">Creating and managing certificate profiles in Identity Management\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.4. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm\" title=\"7.5. Revoking certificates with the integrated IdM CAs\">Revoking certificates with the integrated IdM CAs\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#restoring-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm\" title=\"7.6. Restoring certificates with the integrated IdM CAs\">Restoring certificates with the integrated IdM CAs\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm\" title=\"Chapter 22. Restricting an application to trust only a subset of certificates\">Restricting an application to trust only a subset of certificates\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-idm-certificates-using-ansible_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 3. Managing IdM certificates using Ansible\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipacert\u003C/code> module to request, revoke, and retrieve SSL certificates for Identity Management (IdM) users, hosts and services. You can also restore a certificate that has been put on hold.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.1. Using Ansible to request SSL certificates for IdM hosts, services and users\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipacert\u003C/code> module to request SSL certificates for Identity Management (IdM) users, hosts and services. They can then use these certificates to authenticate to IdM.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tComplete this procedure to request a certificate for an HTTP server from an IdM certificate authority (CA) using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.14 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM deployment has an integrated CA.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a certificate-signing request (CSR) for your user, host or service. For example, to use the \u003Ccode class=\"literal\">openssl\u003C/code> utility to generate a CSR for the \u003Ccode class=\"literal\">HTTP\u003C/code> service running on client.idm.example.com, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>openssl req -new -newkey rsa:2048 -days 365 -nodes -keyout new.key -out new.csr -subj '/CN=client.idm.example.com,O=IDM.EXAMPLE.COM'\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAs a result, the CSR is stored in \u003Cspan class=\"strong strong\">\u003Cstrong>new.csr\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>request-certificate.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">---\n- name: Playbook to request a certificate\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  - name: Request a certificate for a web server\n    ipacert:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      state: requested\n      csr: |\n        -----BEGIN CERTIFICATE REQUEST-----\n        MIGYMEwCAQAwGTEXMBUGA1UEAwwOZnJlZWlwYSBydWxlcyEwKjAFBgMrZXADIQBs\n        HlqIr4b/XNK+K8QLJKIzfvuNK0buBhLz3LAzY7QDEqAAMAUGAytlcANBAF4oSCbA\n        5aIPukCidnZJdr491G4LBE+URecYXsPknwYb+V+ONnf5ycZHyaFv+jkUBFGFeDgU\n        SYaXm/gF8cDYjQI=\n        -----END CERTIFICATE REQUEST-----\n      principal: HTTP/client.idm.example.com\n    register: cert\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace the certificate request with the CSR from \u003Cspan class=\"strong strong\">\u003Cstrong>new.csr\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRequest the certificate:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/request-certificate.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md\">The cert module in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream docs\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.2. Using Ansible to revoke SSL certificates for IdM hosts, services and users\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipacert\u003C/code> module to revoke SSL certificates used by Identity Management (IdM) users, hosts and services to authenticate to IdM.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tComplete this procedure to revoke a certificate for an HTTP server using an Ansible playbook. The reason for revoking the certificate is “keyCompromise”.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.14 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have obtained the serial number of the certificate, for example by entering the \u003Ccode class=\"literal\">openssl x509 -noout -text -in &lt;path_to_certificate&gt;\u003C/code> command. In this example, the serial number of the certificate is 123456789.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM deployment has an integrated CA.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>revoke-certificate.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">---\n- name: Playbook to revoke a certificate\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  - name: Revoke a certificate for a web server\n    ipacert:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      serial_number: 123456789\n      revocation_reason: \"keyCompromise\"\n      state: revoked\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRevoke the certificate:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/revoke-certificate.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md\">The cert module in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream docs\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://datatracker.ietf.org/doc/html/rfc5280#section-5.3.1\">Reason Code\u003C/a> in RFC 5280\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.3. Using Ansible to restore SSL certificates for IdM users, hosts, and services\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipacert\u003C/code> module to restore a revoked SSL certificate previously used by an Identity Management (IdM) user, host or a service to authenticate to IdM.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou can only restore a certificate that was put on hold. You may have put it on hold because, for example, you were not sure if the private key had been lost. However, now you have recovered the key and as you are certain that no-one has accessed it in the meantime, you want to reinstate the certificate.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tComplete this procedure to use an Ansible playbook to release a certificate for a service enrolled into IdM from hold. This example describes how to release a certificate for an HTTP service from hold.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.14 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM deployment has an integrated CA.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have obtained the serial number of the certificate, for example by entering the \u003Ccode class=\"literal\">openssl x509 -noout -text -in path/to/certificate\u003C/code> command. In this example, the certificate serial number is \u003Cspan class=\"strong strong\">\u003Cstrong>123456789\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>restore-certificate.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to restore a certificate\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  - name: Restore a certificate for a web service\n    ipacert:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>serial_number: 123456789\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: released\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/restore-certificate.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md\">The cert module in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream docs\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.4. Using Ansible to retrieve SSL certificates for IdM users, hosts, and services\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipacert\u003C/code> module to retrieve an SSL certificate issued for an Identity Management (IdM) user, host or a service, and store it in a file on the managed node.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.14 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have obtained the serial number of the certificate, for example by entering the \u003Ccode class=\"literal\">openssl x509 -noout -text -in &lt;path_to_certificate&gt;\u003C/code> command. In this example, the serial number of the certificate is 123456789, and the file in which you store the retrieved certificate is \u003Cspan class=\"strong strong\">\u003Cstrong>cert.pem\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>retrieve-certificate.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to retrieve a certificate and store it locally on the managed node\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  - name: Retrieve a certificate and save it to file 'cert.pem'\n    ipacert:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      serial_number: 123456789\n      certificate_out: cert.pem\n      state: retrieved\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRetrieve the certificate:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/retrieve-certificate.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md\">The cert module in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream docs\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-externally-signed-certificates-for-idm-users-hosts-and-services_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 4. Managing externally signed certificates for IdM users, hosts, and services\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tThis chapter describes how to use the Identity Management (IdM) command-line interface (CLI) and the IdM Web UI to add or remove user, host, or service certificates that were issued by an external certificate authority (CA).\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.1. Adding a certificate issued by an external CA to an IdM user, host, or service by using the IdM CLI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAs an Identity Management (IdM) administrator, you can add an externally signed certificate to the account of an IdM user, host, or service by using the Identity Management (IdM) CLI.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have obtained the ticket-granting ticket of an administrative user.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo add a certificate to an IdM user, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-add-cert \u003Cspan class=\"emphasis\">\u003Cem>user\u003C/em>\u003C/span> --certificate=\u003Cspan class=\"emphasis\">\u003Cem>MIQTPrajQAwg...\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe command requires you to specify the following information:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe name of the user\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe Base64-encoded DER certificate\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tInstead of copying and pasting the certificate contents into the command line, you can convert the certificate to the DER format and then re-encode it to Base64. For example, to add the \u003Ccode class=\"literal\">user_cert.pem\u003C/code> certificate to \u003Ccode class=\"literal\">user\u003C/code>, enter:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-add-cert \u003Cspan class=\"emphasis\">\u003Cem>user\u003C/em>\u003C/span> --certificate=\"$(openssl x509 -outform der -in \u003Cspan class=\"emphasis\">\u003Cem>user_cert.pem\u003C/em>\u003C/span> | base64 -w 0)\"\u003C/strong>\u003C/span>\u003C/pre>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tYou can run the \u003Ccode class=\"literal\">ipa user-add-cert\u003C/code> command interactively by executing it without adding any options.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo add a certificate to an IdM host, enter:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal command\">ipa host-add-cert\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tTo add a certificate to an IdM service, enter:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal command\">ipa service-add-cert\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm\" title=\"Chapter 2. Managing certificates for users, hosts, and services using the integrated IdM CA\">Managing certificates for users, hosts, and services using the integrated IdM CA\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.2. Adding a certificate issued by an external CA to an IdM user, host, or service by using the IdM Web UI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAs an Identity Management (IdM) administrator, you can add an externally signed certificate to the account of an IdM user, host, or service by using the Identity Management (IdM) Web UI.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the Identity Management (IdM) Web UI as an administrative user.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">Identity\u003C/code> tab, and select the \u003Ccode class=\"literal\">Users\u003C/code>, \u003Ccode class=\"literal\">Hosts\u003C/code>, or \u003Ccode class=\"literal\">Services\u003C/code> subtab.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick the name of the user, host, or service to open its configuration page.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">Add\u003C/span> next to the \u003Ccode class=\"literal\">Certificates\u003C/code> entry.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"idm140333367931440\">\u003Cp class=\"title\">\u003Cstrong>Figure 4.1. Adding a certificate to a user account\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/e379f8fc7f76ae285ab18d034ee34b47/user-add-cert.png\" alt=\"user add cert\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPaste the certificate in Base64 or PEM encoded format into the text field, and click \u003Cspan class=\"guibutton\">Add\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">Save\u003C/span> to store the changes.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.3. Removing a certificate issued by an external CA from an IdM user, host, or service account by using the IdM CLI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAs an Identity Management (IdM) administrator, you can remove an externally signed certificate from the account of an IdM user, host, or service by using the Identity Management (IdM) CLI .\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have obtained the ticket-granting ticket of an administrative user.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo remove a certificate from an IdM user, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-remove-cert \u003Cspan class=\"emphasis\">\u003Cem>user\u003C/em>\u003C/span> --certificate=\u003Cspan class=\"emphasis\">\u003Cem>MIQTPrajQAwg...\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe command requires you to specify the following information:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe name of the user\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe Base64-encoded DER certificate\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tInstead of copying and pasting the certificate contents into the command line, you can convert the certificate to the DER format and then re-encode it to Base64. For example, to remove the \u003Ccode class=\"literal\">user_cert.pem\u003C/code> certificate from \u003Ccode class=\"literal\">user\u003C/code>, enter:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-remove-cert \u003Cspan class=\"emphasis\">\u003Cem>user\u003C/em>\u003C/span> --certificate=\"$(openssl x509 -outform der -in \u003Cspan class=\"emphasis\">\u003Cem>user_cert.pem\u003C/em>\u003C/span> | base64 -w 0)\"\u003C/strong>\u003C/span>\u003C/pre>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tYou can run the \u003Ccode class=\"literal\">ipa user-remove-cert\u003C/code> command interactively by executing it without adding any options.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo remove a certificate from an IdM host, enter:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal command\">ipa host-remove-cert\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tTo remove a certificate from an IdM service, enter:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal command\">ipa service-remove-cert\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm\" title=\"Chapter 2. Managing certificates for users, hosts, and services using the integrated IdM CA\">Managing certificates for users, hosts, and services using the integrated IdM CA\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.4. Removing a certificate issued by an external CA from an IdM user, host, or service account by using the IdM Web UI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAs an Identity Management (IdM) administrator, you can remove an externally signed certificate from the account of an IdM user, host, or service by using the Identity Management (IdM) Web UI.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the Identity Management (IdM) Web UI as an administrative user.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">Identity\u003C/code> tab, and select the \u003Ccode class=\"literal\">Users\u003C/code>, \u003Ccode class=\"literal\">Hosts\u003C/code>, or \u003Ccode class=\"literal\">Services\u003C/code> subtab.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick the name of the user, host, or service to open its configuration page.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick the \u003Cspan class=\"guibutton\">Actions\u003C/span> next to the certificate to delete, and select \u003Cspan class=\"guibutton\">Delete\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">Save\u003C/span> to store the changes.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_2\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.5. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/using_ansible_to_install_and_manage_identity_management/index#ensuring-the-presence-of-an-externally-signed-certificate-in-an-idm-service-entry-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">Ensuring the presence of an externally signed certificate in an IdM service entry using an Ansible playbook\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"convert-cert-formats-idm_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 5. Converting certificate formats to work with IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tThis user story describes how to make sure that you as an IdM system administrator are using the correct format of a certificate with specific IdM commands. This is useful, for example, in the following situations:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tYou are loading an external certificate into a user profile. For details, see \u003Ca class=\"link\" href=\"#assembly_converting-an-external-certificate-to-load-into-an-idm-user-account_convert-cert-formats-idm\" title=\"5.2. Converting an external certificate to load into an IdM user account\">Converting an external certificate to load into an IdM user account\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou are using an external CA certificate when \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth\">configuring the IdM server for smart card authentication\u003C/a> or \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth\">configuring the IdM client for smart card authentication\u003C/a> so that users can authenticate to IdM using smart cards with certificates on them that have been issued by the external certificate authority.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou are exporting a certificate from an NSS database into a pkcs #12 format that includes both the certificate and the private key. For details, see \u003Ca class=\"link\" href=\"#proc_exporting-a-certificate-and-private-key-from-an-nss-database-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser\" title=\"5.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file\">Exporting a certificate and private key from an NSS database into a PKCS #12 file\u003C/a>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"cert-types-idm_convert-cert-formats-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.1. Certificate formats and encodings in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tCertificate authentication including smart card authentication in IdM proceeds by comparing the certificate that the user presents with the certificate, or certificate data, that are stored in the user’s IdM profile.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>System configuration\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tWhat is stored in the IdM profile is only the certificate, not the corresponding private key. During authentication, the user must also show that he is in possession of the corresponding private key. The user does that by either presenting a PKCS #12 file that contains both the certificate and the private key or by presenting two files: one that contains the certificate and the other containing the private key.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tTherefore, processes such as loading a certificate into a user profile only accept certificate files that do not contain the private key.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSimilarly, when a system administrator provides you with an external CA certificate, he will provide only the public data: the certificate without the private key. The \u003Ccode class=\"literal\">ipa-advise\u003C/code> utility for configuring the IdM server or the IdM client for smart card authentication expects the input file to contain the certificate of the external CA but not the private key.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Certificate encodings\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThere are two common certificate encodings: Privacy-enhanced Electronic Mail (\u003Ccode class=\"literal\">PEM\u003C/code>) and Distinguished Encoding Rules (\u003Ccode class=\"literal\">DER\u003C/code>). The \u003Ccode class=\"literal\">base64\u003C/code> format is almost identical to the \u003Ccode class=\"literal\">PEM\u003C/code> format but it does not contain the \u003Ccode class=\"literal\">-----BEGIN CERTIFICATE-----/-----END CERTIFICATE-----\u003C/code> header and footer.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tA certificate that has been encoded using \u003Ccode class=\"literal\">DER\u003C/code> is a binary X509 digital certificate file. As a binary file, the certificate is not human-readable. \u003Ccode class=\"literal\">DER\u003C/code> files sometimes use the \u003Ccode class=\"literal\">.der\u003C/code> filename extension, but files with the \u003Ccode class=\"literal\">.crt\u003C/code> and \u003Ccode class=\"literal\">.cer\u003C/code> filename extensions also sometimes contain \u003Ccode class=\"literal\">DER\u003C/code> certificates. \u003Ccode class=\"literal\">DER\u003C/code> files containing keys can be named \u003Ccode class=\"literal\">.key\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tA certificate that has been encoded using \u003Ccode class=\"literal\">PEM\u003C/code> Base64 is a human-readable file. The file contains ASCII (Base64) armored data prefixed with a “-----BEGIN …” line. \u003Ccode class=\"literal\">PEM\u003C/code> files sometimes use the \u003Ccode class=\"literal\">.pem\u003C/code> filename extension, but files with the \u003Ccode class=\"literal\">.crt\u003C/code> and \u003Ccode class=\"literal\">.cer\u003C/code> filename extensions also sometimes contain \u003Ccode class=\"literal\">PEM\u003C/code> certificates. \u003Ccode class=\"literal\">PEM\u003C/code> files containing keys can be named \u003Ccode class=\"literal\">.key\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDifferent \u003Ccode class=\"literal\">ipa\u003C/code> commands have different limitations regarding the types of certificates that they accept. For example, the \u003Ccode class=\"literal\">ipa user-add-cert\u003C/code> command only accepts certificates encoded in the \u003Ccode class=\"literal\">base64\u003C/code> format but \u003Ccode class=\"literal\">ipa-server-certinstall\u003C/code> accepts \u003Ccode class=\"literal\">PEM, DER, PKCS #7, PKCS #8\u003C/code> and \u003Ccode class=\"literal\">PKCS #12\u003C/code> certificates.\n\t\t\t\u003C/p>\u003Crh-table id=\"idm140333368040032\">\u003Ctable class=\"gt-4-cols lt-7-rows\">\u003Ccaption>Table 5.1. Certificate encodings\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 25%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 25%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 25%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 25%; \" class=\"col_4\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333368603184\" scope=\"col\">Encoding format\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333368602096\" scope=\"col\">Human-readable\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333368601008\" scope=\"col\">Common filename extensions\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333368599952\" scope=\"col\">Sample IdM commands accepting the encoding format\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368603184\"> \u003Cp>\n\t\t\t\t\t\t\t\tPEM/base64\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368602096\"> \u003Cp>\n\t\t\t\t\t\t\t\tYes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368601008\"> \u003Cp>\n\t\t\t\t\t\t\t\t.pem, .crt, .cer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368599952\"> \u003Cp>\n\t\t\t\t\t\t\t\tipa user-add-cert, ipa-server-certinstall, …​\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368603184\"> \u003Cp>\n\t\t\t\t\t\t\t\tDER\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368602096\"> \u003Cp>\n\t\t\t\t\t\t\t\tNo\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368601008\"> \u003Cp>\n\t\t\t\t\t\t\t\t.der, .crt, .cer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368599952\"> \u003Cp>\n\t\t\t\t\t\t\t\tipa-server-certinstall, …​\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#other-cert-commands_convert-cert-formats-idm\" title=\"5.4. Certificate-related commands and formats in IdM\">Certificate-related commands and formats in IdM\u003C/a> lists further \u003Ccode class=\"literal\">ipa\u003C/code> commands with the certificate formats that the commands accept.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>User authentication\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tWhen using the web UI to access IdM, the user proves that he is in possession of the private key corresponding to the certificate by having both stored in the browser’s database.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tWhen using the CLI to access IdM, the user proves that he is in possession of the private key corresponding to the certificate by one of the following methods:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe user adds, as the value of the \u003Ccode class=\"literal\">X509_user_identity\u003C/code> parameter of the \u003Ccode class=\"literal\">kinit -X\u003C/code> command, the path to the smart card module that is connected to the smart card that contains both the certificate and the key:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit -X X509_user_identity='PKCS11:opensc-pkcs11.so' \u003Ccode class=\"literal\">idm_user\u003C/code>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe user adds two files as the values of the \u003Ccode class=\"literal\">X509_user_identity\u003C/code> parameter of the \u003Ccode class=\"literal\">kinit -X\u003C/code> command, one containing the certificate and the other the private key:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit -X X509_user_identity='FILE:`/path/to/cert.pem,/path/to/cert.key`' \u003Ccode class=\"literal\">idm_user\u003C/code>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Useful certificate commands\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tTo view the certificate data, such as the subject and the issuer:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -noout -text -in ca.pem\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tTo compare in which lines two certificates differ:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>diff cert1.crt cert2.crt\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tTo compare in which lines two certificates differ with the output displayed in two columns:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>diff cert1.crt cert2.crt -y\u003C/strong>\u003C/span>\u003C/pre>\u003C/section>\u003Csection class=\"section\" id=\"assembly_converting-an-external-certificate-to-load-into-an-idm-user-account_convert-cert-formats-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.2. Converting an external certificate to load into an IdM user account\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThis section describes how to make sure that an external certificate is correctly encoded and formatted before adding it to a user entry.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"prerequisites\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.2.1. Prerequisites\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIf your certificate was issued by an Active Directory certificate authority and uses the \u003Ccode class=\"literal\">PEM\u003C/code> encoding, make sure that the \u003Ccode class=\"literal\">PEM\u003C/code> file has been converted into the \u003Ccode class=\"literal\">UNIX\u003C/code> format. To convert a file, use the \u003Ccode class=\"literal\">dos2unix\u003C/code> utility provided by the eponymous package.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_converting-an-external-certificate-in-the-idm-cli-and-loading-it-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.2.2. Converting an external certificate in the IdM CLI and loading it into an IdM user account\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">IdM CLI\u003C/code> only accepts a \u003Ccode class=\"literal\">PEM\u003C/code> certificate from which the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----) have been removed.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tFollow this procedure to convert an external certificate to \u003Ccode class=\"literal\">PEM\u003C/code> format and add it to an IdM user account using the IdM CLI.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tConvert the certificate to the \u003Ccode class=\"literal\">PEM\u003C/code> format:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf your certificate is in the \u003Ccode class=\"literal\">DER\u003C/code> format:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -in cert.crt -inform der -outform pem -out cert.pem\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf your file is in the \u003Ccode class=\"literal\">PKCS #12\u003C/code> format, whose common filename extensions are \u003Ccode class=\"literal\">.pfx\u003C/code> and \u003Ccode class=\"literal\">.p12\u003C/code>, and contains a certificate, a private key, and possibly other data, extract the certificate using the \u003Ccode class=\"literal\">openssl pkcs12\u003C/code> utility. When prompted, enter the password protecting the private key stored in the file:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl pkcs12 -in cert_and_key.p12 -clcerts -nokeys -out cert.pem\u003C/strong>\u003C/span>\nEnter Import Password:\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tObtain the administrator’s credentials:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAdd the certificate to the user account using the \u003Ccode class=\"literal\">IdM CLI\u003C/code> following one of the following methods:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tRemove the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----) of the \u003Ccode class=\"literal\">PEM\u003C/code> file using the \u003Ccode class=\"literal\">sed\u003C/code> utility before adding the string to the \u003Ccode class=\"literal\">ipa user-add-cert\u003C/code> command:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-add-cert some_user --certificate=\"$(sed -e '/BEGIN CERTIFICATE/d;/END CERTIFICATE/d' cert.pem)\"\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tCopy and paste the contents of the certificate file without the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----) into the \u003Ccode class=\"literal\">ipa user-add-cert\u003C/code> command:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-add-cert some_user --certificate=MIIDlzCCAn+gAwIBAgIBATANBgkqhki...\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\t\tYou cannot pass a \u003Ccode class=\"literal\">PEM\u003C/code> file containing the certificate as input to the \u003Ccode class=\"literal\">ipa user-add-cert\u003C/code> command directly, without first removing the first and last lines (-----BEGIN CERTIFICATE----- and -----END CERTIFICATE-----):\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-add-cert some_user --cert=some_user_cert.pem\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\t\t\t\t\t\t\tThis command results in the \"ipa: ERROR: Base64 decoding failed: Incorrect padding\" error message.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo check if the certificate was accepted by the system:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@r8server]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-show some_user\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_converting-an-external-certificate-in-the-idm-web-ui-for-loading-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.2.3. Converting an external certificate in the IdM web UI for loading into an IdM user account\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tFollow this procedure to convert an external certificate to \u003Ccode class=\"literal\">PEM\u003C/code> format and add it to an IdM user account in the IdM web UI.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUsing the \u003Ccode class=\"literal\">CLI\u003C/code>, convert the certificate to the \u003Ccode class=\"literal\">PEM\u003C/code> format:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf your certificate is in the \u003Ccode class=\"literal\">DER\u003C/code> format:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -in cert.crt -inform der -outform pem -out cert.pem\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf your file is in the \u003Ccode class=\"literal\">PKCS #12\u003C/code> format, whose common filename extensions are \u003Ccode class=\"literal\">.pfx\u003C/code> and \u003Ccode class=\"literal\">.p12\u003C/code>, and contains a certificate, a private key, and possibly other data, extract the certificate using the \u003Ccode class=\"literal\">openssl pkcs12\u003C/code> utility. When prompted, enter the password protecting the private key stored in the file:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl pkcs12 -in cert_and_key.p12 -clcerts -nokeys -out cert.pem\u003C/strong>\u003C/span>\nEnter Import Password:\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tOpen the certificate in an editor and copy the contents. You can include the \"-----BEGIN CERTIFICATE-----\" and \"-----END CERTIFICATE-----\" header and footer lines but you do not have to, as both the \u003Ccode class=\"literal\">PEM\u003C/code> and \u003Ccode class=\"literal\">base64\u003C/code> formats are accepted by the IdM web UI.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIn the IdM web UI, log in as security officer.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tGo to \u003Ccode class=\"literal\">Identity\u003C/code> → \u003Ccode class=\"literal\">Users\u003C/code> → \u003Ccode class=\"literal\">some_user\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code> next to \u003Ccode class=\"literal\">Certificates\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tPaste the PEM-formatted contents of the certificate into the window that opens.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\t\tIf the certificate was accepted by the system, you can see it listed among the \u003Ccode class=\"literal\">Certificates\u003C/code> in the user profile.\n\t\t\t\t\u003C/p>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"assembly_preparing-to-load-a-certificate-into-the-browser_convert-cert-formats-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.3. Preparing to load a certificate into the browser\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBefore importing a user certificate into the browser, make sure that the certificate and the corresponding private key are in a \u003Ccode class=\"literal\">PKCS #12\u003C/code> format. There are two common situations requiring extra preparatory work:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe certificate is located in an NSS database. For details how to proceed in this situation, see \u003Ca class=\"link\" href=\"#proc_exporting-a-certificate-and-private-key-from-an-nss-database-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser\" title=\"5.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file\">Exporting a certificate and private key from an NSS database into a PKCS #12 file\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe certificate and the private key are in two separate \u003Ccode class=\"literal\">PEM\u003C/code> files. For details how to proceed in this situation, see \u003Ca class=\"link\" href=\"#proc_combining-certificate-and-private-key-pem-files-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser\" title=\"5.3.2. Combining certificate and private key PEM files into a PKCS #12 file\">Combining certificate and private key PEM files into a PKCS #12 file\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tAfterwards, to import both the CA certificate in the \u003Ccode class=\"literal\">PEM\u003C/code> format and the user certificate in the \u003Ccode class=\"literal\">PKCS #12\u003C/code> format into the browser, follow the procedures in \u003Ca class=\"link\" href=\"#configuring-browser-for-cert-auth_dc-web-ui-auth\" title=\"11.4. Configuring a browser to enable certificate authentication\">Configuring a browser to enable certificate authentication\u003C/a> and \u003Ca class=\"link\" href=\"#cert-idm-users-auth-procedure_dc-web-ui-auth\" title=\"11.5. Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User\">Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User\u003C/a>.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"proc_exporting-a-certificate-and-private-key-from-an-nss-database-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal command\">pk12util\u003C/code> command to export the certificate from the NSS database to the \u003Ccode class=\"literal\">PKCS12\u003C/code> format. For example, to export the certificate with the \u003Ccode class=\"literal replaceable\">some_user\u003C/code> nickname from the NSS database stored in the \u003Ccode class=\"literal filename\">~/certdb\u003C/code> directory into the \u003Ccode class=\"literal replaceable\">~/some_user.p12\u003C/code> file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pk12util -d \u003Ccode class=\"literal filename\">~/certdb\u003C/code> -o \u003Ccode class=\"literal replaceable\">~/some_user.p12\u003C/code> -n some_user\u003C/strong>\u003C/span>\nEnter Password or Pin for \"NSS Certificate DB\":\nEnter password for PKCS12 file:\nRe-enter password:\npk12util: PKCS12 EXPORT SUCCESSFUL\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tSet appropriate permissions for the \u003Ccode class=\"literal\">.p12\u003C/code> file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>chmod 600 ~/some_user.p12\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBecause the \u003Ccode class=\"literal\">PKCS #12\u003C/code> file also contains the private key, it must be protected to prevent other users from using the file. Otherwise, they would be able to impersonate the user.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_combining-certificate-and-private-key-pem-files-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.3.2. Combining certificate and private key PEM files into a PKCS #12 file\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tFollow this procedure to combine a certificate and the corresponding key stored in separate \u003Ccode class=\"literal\">PEM\u003C/code> files into a \u003Ccode class=\"literal\">PKCS #12\u003C/code> file.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo combine a certificate stored in \u003Ccode class=\"literal\">certfile.cer\u003C/code> and a key stored in \u003Ccode class=\"literal\">certfile.key\u003C/code> into a \u003Ccode class=\"literal\">certfile.p12\u003C/code> file that contains both the certificate and the key:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl pkcs12 -export -in certfile.cer -inkey certfile.key -out certfile.p12\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"other-cert-commands_convert-cert-formats-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.4. Certificate-related commands and formats in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following table displays certificate-related commands in IdM with acceptable formats.\n\t\t\t\u003C/p>\u003Crh-table id=\"idm140333367914768\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 5.2. IdM certificate commands and formats\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333367909040\" scope=\"col\">Command\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333373910832\" scope=\"col\">Acceptable formats\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333373909744\" scope=\"col\">Notes\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333367909040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa user-add-cert some_user --certificate\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373910832\"> \u003Cp>\n\t\t\t\t\t\t\t\tbase64 PEM certificate\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373909744\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333367909040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa-server-certinstall\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373910832\"> \u003Cp>\n\t\t\t\t\t\t\t\tPEM and DER certificate; PKCS#7 certificate chain; PKCS#8 and raw private key; PKCS#12 certificate and private key\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373909744\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333367909040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa-cacert-manage install\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373910832\"> \u003Cp>\n\t\t\t\t\t\t\t\tDER; PEM; PKCS#7\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373909744\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333367909040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa-cacert-manage renew --external-cert-file\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373910832\"> \u003Cp>\n\t\t\t\t\t\t\t\tPEM and DER certificate; PKCS#7 certificate chain\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373909744\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333367909040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa-ca-install --external-cert-file\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373910832\"> \u003Cp>\n\t\t\t\t\t\t\t\tPEM and DER certificate; PKCS#7 certificate chain\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373909744\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333367909040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa cert-show &lt;cert serial&gt; --certificate-out /path/to/file.pem\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373910832\"> \u003Cp>\n\t\t\t\t\t\t\t\tN/A\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373909744\"> \u003Cp>\n\t\t\t\t\t\t\t\tCreates the PEM-encoded \u003Ccode class=\"literal\">file.pem\u003C/code> file with the certificate having the \u003Ccode class=\"literal\">&lt;cert_serial&gt;\u003C/code> serial number.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333367909040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa cert-show &lt;cert serial&gt; --certificate-out /path/to/file.pem\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373910832\"> \u003Cp>\n\t\t\t\t\t\t\t\tN/A\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373909744\"> \u003Cp>\n\t\t\t\t\t\t\t\tCreates the PEM-encoded \u003Ccode class=\"literal\">file.pem\u003C/code> file with the certificate having the \u003Ccode class=\"literal\">&lt;cert_serial&gt;\u003C/code> serial number. If the \u003Ccode class=\"literal\">--chain\u003C/code> option is used, the PEM file contains the certificate including the certificate chain.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333367909040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa cert-request --certificate-out=FILE /path/to/req.csr\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373910832\"> \u003Cp>\n\t\t\t\t\t\t\t\tN/A\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373909744\"> \u003Cp>\n\t\t\t\t\t\t\t\tCreates the \u003Ccode class=\"literal\">req.csr\u003C/code> file in the PEM format with the new certificate.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333367909040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa cert-request --certificate-out=FILE /path/to/req.csr\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373910832\"> \u003Cp>\n\t\t\t\t\t\t\t\tN/A\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333373909744\"> \u003Cp>\n\t\t\t\t\t\t\t\tCreates the \u003Ccode class=\"literal\">req.csr\u003C/code> file in the PEM format with the new certificate. If the \u003Ccode class=\"literal\">--chain\u003C/code> option is used, the PEM file contains the certificate including the certificate chain.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 6. Creating and managing certificate profiles in Identity Management\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tCertificate profiles are used by the Certificate Authority (CA) when signing certificates to determine if a certificate signing request (CSR) is acceptable, and if so what features and extensions are present on the certificate. A certificate profile is associated with issuing a particular type of certificate. By combining certificate profiles and CA access control lists (ACLs), you can define and control access to custom certificate profiles.\n\t\t\u003C/p>\u003Cp>\n\t\t\tIn describing how to create certificate profiles, the procedures use S/MIME certificates as an example. Some email programs support digitally signed and encrypted email using the Secure Multipurpose Internet Mail Extension (S/MIME) protocol. Using S/MIME to sign or encrypt email messages requires the sender of the message to have an S/MIME certificate.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#what-is-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management\" title=\"6.1. What is a certificate profile?\">What is a certificate profile\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#creating-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management\" title=\"6.2. Creating a certificate profile\">Creating a certificate profile\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#what-is-a-ca-access-control-list_creating-and-managing-certificate-profiles-in-identity-management\" title=\"6.3. What is a CA access control list?\">What is a CA access control list\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#defining-a-ca-acl-to-control-access-to-certificate-profiles_creating-and-managing-certificate-profiles-in-identity-management\" title=\"6.4. Defining a CA ACL to control access to certificate profiles\">Defining a CA ACL to control access to certificate profiles\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-certificate-profiles-and-ca-acls-to-issue-certificates_creating-and-managing-certificate-profiles-in-identity-management\" title=\"6.5. Using certificate profiles and CA ACLs to issue certificates\">Using certificate profiles and CA ACLs to issue certificates\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#modifying-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management\" title=\"6.6. Modifying a certificate profile\">Modifying a certificate profile\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#certificate-profile-configuration-parameters_creating-and-managing-certificate-profiles-in-identity-management\" title=\"6.7. Certificate profile configuration parameters\">Certificate profile configuration parameters\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"what-is-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.1. What is a certificate profile?\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use certificate profiles to determine the content of certificates, as well as constraints for issuing the certificates, such as the following:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe signing algorithm to use to encipher the certificate signing request.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe default validity of the certificate.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe revocation reasons that can be used to revoke a certificate.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf the common name of the principal is copied to the subject alternative name field.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe features and extensions that should be present on the certificate.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tA single certificate profile is associated with issuing a particular type of certificate. You can define different certificate profiles for users, services, and hosts in IdM. IdM includes the following certificate profiles by default:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">caIPAserviceCert\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">IECUserRoles\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">KDCs_PKINIT_Certs\u003C/code> (used internally)\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIn addition, you can create and import custom profiles, which allow you to issue certificates for specific purposes. For example, you can restrict the use of a particular profile to only one user or one group, preventing other users and groups from using that profile to issue a certificate for authentication. To create custom certificate profiles, use the \u003Ccode class=\"literal\">ipa certprofile\u003C/code> command.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">ipa help certprofile\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.2. Creating a certificate profile\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to create a certificate profile through the command line by creating a profile configuration file for requesting S/MIME certificates.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a custom profile by copying an existing default profile:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa certprofile-show --out smime.cfg caIPAserviceCert\n------------------------------------------------\nProfile configuration stored in file 'smime.cfg'\n------------------------------------------------\n  Profile ID: caIPAserviceCert\n  Profile description: Standard profile for network services\n  Store issued certificates: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the newly created profile configuration file in a text editor.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ vi  smime.cfg\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">Profile ID\u003C/code> to a name that reflects the usage of the profile, for example \u003Ccode class=\"literal\">smime\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tWhen you are importing a newly created profile, the \u003Ccode class=\"literal\">profileId\u003C/code> field, if present, must match the ID specified on the command line.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUpdate the Extended Key Usage configuration. The default Extended Key Usage extension configuration is for TLS server and client authentication. For example for S/MIME, the Extended Key Usage must be configured for email protection:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">policyset.serverCertSet.7.default.params.exKeyUsageOIDs=1.3.6.1.5.5.7.3.4\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tImport the new profile:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa certprofile-import smime --file smime.cfg \\\n  --desc \"S/MIME certificates\" --store TRUE\n\n------------------------\nImported profile \"smime\"\n------------------------\n  Profile ID: smime\n  Profile description: S/MIME certificates\n  Store issued certificates: TRUE\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the new certificate profile has been imported:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa certprofile-find\n\n------------------\n4 profiles matched\n------------------\n  Profile ID: caIPAserviceCert\n  Profile description: Standard profile for network services\n  Store issued certificates: TRUE\n\n  Profile ID: IECUserRoles\n  Profile description: User profile that includes IECUserRoles extension from request\n  Store issued certificates: TRUE\n\n  Profile ID: KDCs_PKINIT_Certs\n  Profile description: Profile for PKINIT support by KDCs\n  Store issued certificates: TRUE\n\n  Profile ID: smime\n  Profile description: S/MIME certificates\n  Store issued certificates: TRUE\n----------------------------\nNumber of entries returned 4\n----------------------------\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">ipa help certprofile\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"https://tools.ietf.org/html/rfc5280#section-4.2.1.12\">RFC 5280, section 4.2.1.12\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"what-is-a-ca-access-control-list_creating-and-managing-certificate-profiles-in-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.3. What is a CA access control list?\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tCertificate Authority access control list (CA ACL) rules define which profiles can be used to issue certificates to which principals. You can use CA ACLs to do this, for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDetermine which user, host, or service can be issued a certificate with a particular profile\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDetermine which IdM certificate authority or sub-CA is permitted to issue the certificate\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tFor example, using CA ACLs, you can restrict use of a profile intended for employees working from an office located in London only to users that are members of the London office-related IdM user group.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">ipa caacl\u003C/code> utility for management of CA ACL rules allows privileged users to add, display, modify, or delete a specified CA ACL.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">ipa help caacl\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"defining-a-ca-acl-to-control-access-to-certificate-profiles_creating-and-managing-certificate-profiles-in-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.4. Defining a CA ACL to control access to certificate profiles\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use the \u003Ccode class=\"literal\">caacl\u003C/code> utility to define a CA Access Control List (ACL) rule to allow users in a group access to a custom certificate profile. In this case, the procedure describes how to create an S/MIME user’s group and a CA ACL to allow users in that group access to the \u003Ccode class=\"literal\">smime\u003C/code> certificate profile.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMake sure that you have obtained IdM administrator’s credentials.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a new group for the users of the certificate profile:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa group-add smime_users_group\n---------------------------------\nAdded group \"smime users group\"\n---------------------------------\n  Group name: smime_users_group\n  GID: 75400001\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a new user to add to the \u003Ccode class=\"literal\">smime_user_group\u003C/code> group:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa user-add smime_user\nFirst name: smime\nLast name: user\n----------------------\nAdded user \"smime_user\"\n----------------------\n  User login: smime_user\n  First name: smime\n  Last name: user\n  Full name: smime user\n  Display name: smime user\n  Initials: TU\n  Home directory: /home/smime_user\n  GECOS: smime user\n  Login shell: /bin/sh\n  Principal name: smime_user@IDM.EXAMPLE.COM\n  Principal alias: smime_user@IDM.EXAMPLE.COM\n  Email address: smime_user@idm.example.com\n  UID: 1505000004\n  GID: 1505000004\n  Password: False\n  Member of groups: ipausers\n  Kerberos keys available: False\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">smime_user\u003C/code> to the \u003Ccode class=\"literal\">smime_users_group\u003C/code> group:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa group-add-member smime_users_group --users=smime_user\n  Group name: smime_users_group\n  GID: 1505000003\n  Member users: smime_user\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the CA ACL to allow users in the group to access the certificate profile:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa caacl-add smime_acl\n------------------------\nAdded CA ACL \"smime_acl\"\n------------------------\n  ACL name: smime_acl\n  Enabled: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the user group to the CA ACL:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa caacl-add-user smime_acl --group smime_users_group\n  ACL name: smime_acl\n  Enabled: TRUE\n  User Groups: smime_users_group\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the certificate profile to the CA ACL:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa caacl-add-profile smime_acl --certprofile smime\n  ACL name: smime_acl\n  Enabled: TRUE\n  Profiles: smime\n  User Groups: smime_users_group\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tView the details of the CA ACL you created:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa caacl-show smime_acl\n  ACL name: smime_acl\n  Enabled: TRUE\n  Profiles: smime\n  User Groups: smime_users_group\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">ipa\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">ipa help caacl\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-certificate-profiles-and-ca-acls-to-issue-certificates_creating-and-managing-certificate-profiles-in-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.5. Using certificate profiles and CA ACLs to issue certificates\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can request certificates using a certificate profile when permitted by the Certificate Authority access control lists (CA ACLs). Follow this procedure to request an S/MIME certificate for a user using a custom certificate profile which has been granted access through a CA ACL.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour certificate profile has been created.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn CA ACL has been created which permits the user to use the required certificate profile to request a certificate.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou can bypass the CA ACL check if the user performing the \u003Ccode class=\"literal\">cert-request\u003C/code> command:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIs the \u003Ccode class=\"literal\">admin\u003C/code> user.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tHas the \u003Ccode class=\"literal\">Request Certificate ignoring CA ACLs\u003C/code> permission.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a certificate request for the user. For example, using OpenSSL:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ openssl req -new -newkey rsa:2048 -days 365 -nodes -keyout \u003Cspan class=\"emphasis\">\u003Cem>private.key\u003C/em>\u003C/span> -out \u003Cspan class=\"emphasis\">\u003Cem>cert.csr\u003C/em>\u003C/span> -subj '/CN=\u003Cspan class=\"emphasis\">\u003Cem>smime_user\u003C/em>\u003C/span>'\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRequest a new certificate for the user from the IdM CA:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa cert-request \u003Cspan class=\"emphasis\">\u003Cem>cert.csr\u003C/em>\u003C/span> --principal=\u003Cspan class=\"emphasis\">\u003Cem>smime_user\u003C/em>\u003C/span> --profile-id=\u003Cspan class=\"emphasis\">\u003Cem>smime\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptionally pass the --ca \u003Cspan class=\"emphasis\">\u003Cem>sub-CA_name\u003C/em>\u003C/span> option to the command to request the certificate from a sub-CA instead of the root CA.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the newly-issued certificate is assigned to the user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa user-show \u003Cspan class=\"emphasis\">\u003Cem>user\u003C/em>\u003C/span>\n  User login: \u003Cspan class=\"emphasis\">\u003Cem>user\u003C/em>\u003C/span>\n  ...\n  Certificate: MIICfzCCAWcCAQA...\n  ...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa(a)\u003C/code> and \u003Ccode class=\"literal\">openssl(lssl)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa help user-show\u003C/code> command\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa help cert-request\u003C/code> command\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"modifying-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.6. Modifying a certificate profile\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to modify certificate profiles directly through the command line using the \u003Ccode class=\"literal\">ipa certprofile-mod\u003C/code> command.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDetermine the certificate profile ID for the certificate profile you are modifying. To display all certificate profiles currently stored in IdM:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa certprofile-find\n\n------------------\n4 profiles matched\n------------------\n  Profile ID: caIPAserviceCert\n  Profile description: Standard profile for network services\n  Store issued certificates: TRUE\n\n  Profile ID: IECUserRoles\n  ...\n\n  Profile ID: smime\n  Profile description: S/MIME certificates\n  Store issued certificates: TRUE\n--------------------------\nNumber of entries returned\n--------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tModify the certificate profile description. For example, if you created a custom certificate profile for S/MIME certificates using an existing profile, change the description in line with the new usage:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa certprofile-mod smime --desc \"New certificate profile description\"\n------------------------------------\nModified Certificate Profile \"smime\"\n------------------------------------\n    Profile ID: smime\n    Profile description: New certificate profile description\n    Store issued certificates: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your customer certificate profile file in a text editor and modify to suit your requirements:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># vi smime.cfg\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details on the options which can be configured in the certificate profile configuration file, see \u003Ca class=\"link\" href=\"#certificate-profile-configuration-parameters_creating-and-managing-certificate-profiles-in-identity-management\" title=\"6.7. Certificate profile configuration parameters\">Certificate profile configuration parameters\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUpdate the existing certificate profile configuration file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa certprofile-mod _profile_ID_ --file=smime.cfg\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the certificate profile has been updated:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa certprofile-show smime\n  Profile ID: smime\n  Profile description: New certificate profile description\n  Store issued certificates: TRUE\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">ipa(a)\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">ipa help certprofile-mod\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"certificate-profile-configuration-parameters_creating-and-managing-certificate-profiles-in-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.7. Certificate profile configuration parameters\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tCertificate profile configuration parameters are stored in a \u003Cspan class=\"emphasis\">\u003Cem>profile_name\u003C/em>\u003C/span>.cfg file in the CA profile directory, \u003Ccode class=\"literal\">/var/lib/pki/pki-tomcat/ca/profiles/ca\u003C/code>. All of the parameters for a profile - defaults, inputs, outputs, and constraints - are configured within a single policy set. A policy set for a certificate profile has the name \u003Ccode class=\"literal\">policyset.\u003Cspan class=\"emphasis\">\u003Cem>policyName.policyNumber\u003C/em>\u003C/span>.\u003C/code> For example, for policy set \u003Ccode class=\"literal\">serverCertSet\u003C/code>:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">policyset.list=serverCertSet\npolicyset.serverCertSet.list=1,2,3,4,5,6,7,8\npolicyset.serverCertSet.1.constraint.class_id=subjectNameConstraintImpl\npolicyset.serverCertSet.1.constraint.name=Subject Name Constraint\npolicyset.serverCertSet.1.constraint.params.pattern=CN=[^,]+,.+\npolicyset.serverCertSet.1.constraint.params.accept=true\npolicyset.serverCertSet.1.default.class_id=subjectNameDefaultImpl\npolicyset.serverCertSet.1.default.name=Subject Name Default\npolicyset.serverCertSet.1.default.params.name=CN=$request.req_subject_name.cn$, OU=pki-ipa, O=IPA\npolicyset.serverCertSet.2.constraint.class_id=validityConstraintImpl\npolicyset.serverCertSet.2.constraint.name=Validity Constraint\npolicyset.serverCertSet.2.constraint.params.range=740\npolicyset.serverCertSet.2.constraint.params.notBeforeCheck=false\npolicyset.serverCertSet.2.constraint.params.notAfterCheck=false\npolicyset.serverCertSet.2.default.class_id=validityDefaultImpl\npolicyset.serverCertSet.2.default.name=Validity Default\npolicyset.serverCertSet.2.default.params.range=731\npolicyset.serverCertSet.2.default.params.startTime=0\u003C/pre>\u003Cp>\n\t\t\t\tEach policy set contains a list of policies configured for the certificate profile by policy ID number in the order in which they should be evaluated. The server evaluates each policy set for each request it receives. When a single certificate request is received, one set is evaluated, and any other sets in the profile are ignored. When dual key pairs are issued, the first policy set is evaluated for the first certificate request, and the second set is evaluated for the second certificate request. You do not need more than one policy set when issuing single certificates or more than two sets when issuing dual key pairs.\n\t\t\t\u003C/p>\u003Crh-table id=\"idm140333373746528\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 6.1. Certificate profile configuration file parameters\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333366583296\" scope=\"col\">Parameter\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333366582208\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tdesc\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tA free text description of the certificate profile, which is shown on the end-entities page. For example, \u003Ccode class=\"literal\">desc=This certificate profile is for enrolling server certificates with agent authentication\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tenable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnables the profile so it is accessible through the end-entities page. For example, \u003Ccode class=\"literal\">enable=true\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tauth.instance_id\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the authentication manager plug-in to use to authenticate the certificate request. For automatic enrollment, the CA issues a certificate immediately if the authentication is successful. If authentication fails or there is no authentication plug-in specified, the request is queued to be manually approved by an agent. For example, \u003Ccode class=\"literal\">auth.instance_id=AgentCertAuth\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tauthz.acl\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tSpecifies the authorization constraint. This is predominantly used to set the group evaluation Access Control List (ACL). For example, the \u003Ccode class=\"literal\">caCMCUserCert\u003C/code> parameter requires that the signer of the CMC request belongs to the Certificate Manager Agents group:\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">authz.acl=group=\"Certificate Manager Agents\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tIn directory-based user certificate renewal, this option is used to ensure that the original requester and the currently-authenticated user are the same. An entity must authenticate (bind or, essentially, log into the system) before authorization can be evaluated.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe name of the certificate profile. For example, \u003Ccode class=\"literal\">name=Agent-Authenticated Server Certificate Enrollment\u003C/code>. This name is displayed on the end users enrollment or renewal page.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tinput.list\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tLists the allowed inputs for the certificate profile by name. For example, \u003Ccode class=\"literal\">input.list=i1,i2\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tinput.input_id.class_id\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tIndicates the java class name for the input by input ID (the name of the input listed in input.list). For example, \u003Ccode class=\"literal\">input.i1.class_id=certReqInputImpl\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\toutput.list\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tLists the possible output formats for the certificate profile by name. For example, \u003Ccode class=\"literal\">output.list=o1\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\toutput.output_id.class_id\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tSpecifies the java class name for the output format named in output.list. For example, \u003Ccode class=\"literal\">output.o1.class_id=certOutputImpl\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tpolicyset.list\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tLists the configured certificate profile rules. For dual certificates, one set of rules applies to the signing key and the other to the encryption key. Single certificates use only one set of certificate profile rules. For example, \u003Ccode class=\"literal\">policyset.list=serverCertSet\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tpolicyset.policyset_id.list\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tLists the policies within the policy set configured for the certificate profile by policy ID number in the order in which they should be evaluated. For example, \u003Ccode class=\"literal\">policyset.serverCertSet.list=1,2,3,4,5,6,7,8\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tpolicyset.policyset_id.policy_number.constraint.class_id\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tIndicates the java class name of the constraint plug-in set for the default configured in the profile rule. For example, policyset.serverCertSet.1.constraint.class_id=subjectNameConstraintImpl.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tpolicyset.policyset_id.policy_number.constraint.name\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tGives the user-defined name of the constraint. For example, policyset.serverCertSet.1.constraint.name=Subject Name Constraint.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tpolicyset.policyset_id.policy_number.constraint.params.attribute\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tSpecifies a value for an allowed attribute for the constraint. The possible attributes vary depending on the type of constraint. For example, policyset.serverCertSet.1.constraint.params.pattern=CN=.*.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tpolicyset.policyset_id.policy_number.default.class_id\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tGives the java class name for the default set in the profile rule. For example, policyset.serverCertSet.1.default.class_id=userSubjectNameDefaultImpl\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tpolicyset.policyset_id.policy_number.default.name\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tGives the user-defined name of the default. For example, policyset.serverCertSet.1.default.name=Subject Name Default\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366583296\"> \u003Cp>\n\t\t\t\t\t\t\t\tpolicyset.policyset_id.policy_number.default.params.attribute\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333366582208\"> \u003Cp>\n\t\t\t\t\t\t\t\tSpecifies a value for an allowed attribute for the default. The possible attributes vary depending on the type of default. For example, policyset.serverCertSet.1.default.params.name=CN=(Name)$request.requestor_name$.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-the-validity-of-certificates-in-idm_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 7. Managing the validity of certificates in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tIn Identity Management (IdM), you can manage the validity of both already existing certificates and certificates you want to issue in the future, but the methods are different.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"proc_managing-the-validity-of-an-existing-certificate-that-was-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.1. Managing the validity of an existing certificate that was issued by IdM CA\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn IdM, the following methods of viewing the expiry date of a certificate are available:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#viewing-the-expiry-date-of-a-certificate-in-IdM-WebUI_managing-the-validity-of-certificates-in-idm\" title=\"7.3. Viewing the expiry date of a certificate in IdM WebUI\">Viewing the expiry date in IdM WebUI\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#viewing-the-expiry-date-of-a-certificate-in-the-CLI_managing-the-validity-of-certificates-in-idm\" title=\"7.4. Viewing the expiry date of a certificate in the CLI\">Viewing the expiry date in the CLI\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tYou can manage the validity of an already existing certificate that was issued by IdM CA in the following ways:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRenew a certificate by requesting a new certificate using either the original certificate signing request (CSR) or a new CSR generated from the private key. You can request a new certificate using the following utilities:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">certmonger\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tYou can use \u003Ccode class=\"literal\">certmonger\u003C/code> to request a service certificate. Before the certificate is due to expire, \u003Ccode class=\"literal\">certmonger\u003C/code> will automatically renew the certificate, thereby ensuring a continuing validity of the service certificate. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/using-certmonger_managing-certificates-in-idm\">Obtaining an IdM certificate for a service using certmonger\u003C/a>;\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">certutil\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tYou can use \u003Ccode class=\"literal\">certutil\u003C/code> to renew user, host, and service certificates. For details on requesting a user certificate, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/dc-web-ui-auth_managing-certificates-in-idm#requesting-and-exporting-a-user-certificate_dc-web-ui-auth\">Requesting a new user certificate and exporting it to the client\u003C/a>;\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">openssl\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tYou can use \u003Ccode class=\"literal\">openssl\u003C/code> to renew user, host, and service certificates.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRevoke a certificate. For details, see:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_revoking-certificates\" title=\"7.5.2. Revoking certificates with the integrated IdM CAs using IdM WebUI\">Revoking certificates with the integrated IdM CAs using IdM WebUI\u003C/a>;\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_revoking-certificates\" title=\"7.5.3. Revoking certificates with the integrated IdM CAs using IdM CLI\">Revoking certificates with the integrated IdM CAs using IdM CLI\u003C/a>;\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestore a certificate if it has been temporarily revoked. For details, see:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates\" title=\"7.6.1. Restoring certificates with the integrated IdM CAs using IdM WebUI\">Restoring certificates with the integrated IdM CAs using IdM WebUI\u003C/a>;\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates\" title=\"7.6.1. Restoring certificates with the integrated IdM CAs using IdM WebUI\">Restoring certificates with the integrated IdM CAs using IdM CLI\u003C/a>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_managing-the-validity-of-future-certificates-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.2. Managing the validity of future certificates issued by IdM CA\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo manage the validity of future certificates issued by IdM CA, modify, import, or create a certificate profile. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/creating-and-managing-certificate-profiles-in-identity-management_configuring-and-managing-idm\">Creating and managing certificate profiles in Identity Management\u003C/a>.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"viewing-the-expiry-date-of-a-certificate-in-IdM-WebUI_managing-the-validity-of-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.3. Viewing the expiry date of a certificate in IdM WebUI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use IdM WebUI to view the expiry date of all the certificates that have been issued by IdM CA.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnsure that you have obtained the administrator’s credentials.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">Authentication\u003C/code> menu, click \u003Ccode class=\"literal\">Certificates\u003C/code> &gt; \u003Ccode class=\"literal\">Certificates\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tClick the serial number of the certificate to open the certificate information page.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"list-of-certificates_managing-the-validity-of-certificates-in-idm\">\u003Cp class=\"title\">\u003Cstrong>Figure 7.1. List of Certificates\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/640df33ed730c373f7dc773dd02b9e93/host_cert_list.png\" alt=\"A screenshot of the &quot;Certificates&quot; page of the IdM Web UI displaying a table of certificates. The certificates are organized by their Serial Numbers and their Subject. The Serial Number &quot;3&quot; is highlighted for the third certificate in the table.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the certificate information page, locate the \u003Ccode class=\"literal\">Expires On\u003C/code> information.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"viewing-the-expiry-date-of-a-certificate-in-the-CLI_managing-the-validity-of-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.4. Viewing the expiry date of a certificate in the CLI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the command-line interface (CLI) to view the expiry date of a certificate.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">openssl\u003C/code> utility to open the file in a human-readable format:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ openssl x509 -noout -text -in ca.pem\nCertificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number: 1 (0x1)\n        Signature Algorithm: sha256WithRSAEncryption\n        Issuer: O = IDM.EXAMPLE.COM, CN = Certificate Authority\n        Validity\n            Not Before: Oct 30 19:39:14 2017 GMT\n            Not After : Oct 30 19:39:14 2037 GMT\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.5. Revoking certificates with the integrated IdM CAs\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Csection class=\"section _abstract\" id=\"certificate-revocation-reasons_revoking-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">7.5.1. Certificate revocation reasons\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tA revoked certificate is invalid and cannot be used for authentication. All revocations are permanent, except for reason 6: \u003Ccode class=\"literal\">Certificate Hold\u003C/code>.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThe default revocation reason is 0: \u003Ccode class=\"literal\">unspecified\u003C/code>.\n\t\t\t\t\u003C/p>\u003Crh-table id=\"idm140333368779536\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.1. Revocation Reasons\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 8%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 31%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 61%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333368824288\" scope=\"col\">ID\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333368823200\" scope=\"col\">Reason\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333368822112\" scope=\"col\">Explanation\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368824288\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368823200\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tUnspecified\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368822112\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368824288\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t1\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368823200\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tKey Compromised\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368822112\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tThe key that issued the certificate is no longer trusted.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t\tPossible causes: lost token, improperly accessed file.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368824288\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t2\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368823200\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tCA Compromised\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368822112\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tThe CA that issued the certificate is no longer trusted.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368824288\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t3\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368823200\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tAffiliation Changed\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368822112\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tPossible causes:\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t\t* A person has left the company or moved to another department.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t\t* A host or service is being retired.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368824288\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t4\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368823200\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tSuperseded\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368822112\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tA newer certificate has replaced the current certificate.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368824288\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t5\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368823200\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tCessation of Operation\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368822112\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tThe host or service is being decommissioned.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368824288\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t6\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368823200\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tCertificate Hold\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368822112\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tThe certificate is temporarily revoked. You can restore the certificate later.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368824288\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t8\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368823200\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tRemove from CRL\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368822112\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tThe certificate is not included in the certificate revocation list (CRL).\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368824288\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t9\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368823200\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tPrivilege Withdrawn\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368822112\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tThe user, host, or service is no longer permitted to use the certificate.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368824288\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t10\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368823200\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tAttribute Authority (AA) Compromise\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333368822112\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tThe AA certificate is no longer trusted.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003Csection class=\"section\" id=\"revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_revoking-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">7.5.2. Revoking certificates with the integrated IdM CAs using IdM WebUI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tIf you know you have lost the private key for your certificate, you must revoke the certificate to prevent its abuse. Complete this procedure to use the IdM WebUI to revoke a certificate issued by the IdM CA.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Authentication\u003C/code> &gt; \u003Ccode class=\"literal\">Certificates\u003C/code> &gt; \u003Ccode class=\"literal\">Certificates\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tClick the serial number of the certificate to open the certificate information page.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"host-cert-list-revoke_revoking-certificates\">\u003Cp class=\"title\">\u003Cstrong>Figure 7.2. List of Certificates\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/640df33ed730c373f7dc773dd02b9e93/host_cert_list.png\" alt=\"A screenshot of the &quot;Certificates&quot; page of the IdM Web UI displaying a table of certificates. The certificates are organized by their Serial Numbers and their Subject. The Serial Number &quot;3&quot; is highlighted for the third certificate in the table.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIn the certificate information page, click \u003Cspan class=\"guimenu\">Actions\u003C/span> → \u003Cspan class=\"guimenuitem\">Revoke Certificate\u003C/span>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSelect the reason for revoking and click \u003Cspan class=\"guibutton\">Revoke\u003C/span>. See \u003Ca class=\"link\" href=\"#certificate-revocation-reasons_revoking-certificates\" title=\"7.5.1. Certificate revocation reasons\">Certificate revocation reasons\u003C/a> for details.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_revoking-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">7.5.3. Revoking certificates with the integrated IdM CAs using IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tIf you know you have lost the private key for your certificate, you must revoke the certificate to prevent its abuse. Complete this procedure to use the IdM CLI to revoke a certificate issued by the IdM CA.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal command\">ipa cert-revoke\u003C/code> command, and specify:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tthe certificate serial number\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tthe ID number for the revocation reason; see \u003Ca class=\"link\" href=\"#certificate-revocation-reasons_revoking-certificates\" title=\"7.5.1. Certificate revocation reasons\">Certificate revocation reasons\u003C/a> for details\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\tFor example, to revoke the certificate with serial number \u003Ccode class=\"literal\">1032\u003C/code> because of reason 1: \u003Ccode class=\"literal\">Key Compromised\u003C/code>, enter:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa cert-revoke 1032 --revocation-reason=1\u003C/pre>\u003Cp>\n\t\t\t\t\tFor details on requesting a new certificate, see the following documentation:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/dc-web-ui-auth_managing-certificates-in-idm#requesting-and-exporting-a-user-certificate_dc-web-ui-auth\">Requesting a new user certificate and exporting it to the client\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/using-certmonger_managing-certificates-in-idm\">Obtaining an IdM certificate for a service using certmonger\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"restoring-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.6. Restoring certificates with the integrated IdM CAs\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIf you have revoked a certificate because of reason 6: \u003Ccode class=\"literal\">Certificate Hold\u003C/code>, you can restore it again if the private key for the certificate has not been compromised. To restore a certificate, use one of the following procedures:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates\" title=\"7.6.1. Restoring certificates with the integrated IdM CAs using IdM WebUI\">Restore certificates with the integrated IdM CAs using IdM WebUI\u003C/a>;\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_restoring-certificates\" title=\"7.6.2. Restoring certificates with the integrated IdM CAs using IdM CLI\">Restore certificates with the integrated IdM CAs using IdM CLI\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">7.6.1. Restoring certificates with the integrated IdM CAs using IdM WebUI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tComplete this procedure to use the IdM WebUI to restore an IdM certificate that has been revoked because of Reason 6: \u003Ccode class=\"literal\">Certificate Hold\u003C/code>.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">Authentication\u003C/code> menu, click \u003Ccode class=\"literal\">Certificates\u003C/code> &gt; \u003Ccode class=\"literal\">Certificates\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tClick the serial number of the certificate to open the certificate information page.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"list-of-certificates_restoring-certificates\">\u003Cp class=\"title\">\u003Cstrong>Figure 7.3. List of Certificates\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/640df33ed730c373f7dc773dd02b9e93/host_cert_list.png\" alt=\"A screenshot of the &quot;Certificates&quot; page of the IdM Web UI displaying a table of certificates. The certificates are organized by their Serial Numbers and their Subject. The Serial Number &quot;3&quot; is highlighted for the third certificate in the table.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIn the certificate information page, click \u003Cspan class=\"guimenu\">Actions\u003C/span> → \u003Cspan class=\"guimenuitem\">Restore Certificate\u003C/span>.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_restoring-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">7.6.2. Restoring certificates with the integrated IdM CAs using IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tComplete this procedure to use the IdM CLI to restore an IdM certificate that has been revoked because of Reason 6: \u003Ccode class=\"literal\">Certificate Hold\u003C/code>.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal command\">ipa cert-remove-hold\u003C/code> command and specify the certificate serial number. For example:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa cert-remove-hold 1032\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-idm-for-smart-card-auth_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 8. Configuring Identity Management for smart card authentication\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tIdentity Management (IdM) supports smart card authentication with:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tUser certificates issued by the IdM certificate authority\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tUser certificates issued by an external certificate authority\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tYou can configure smart card authentication in IdM for both types of certificates. In this scenario, the \u003Ccode class=\"literal\">rootca.pem\u003C/code> CA certificate is the file containing the certificate of a trusted external certificate authority.\n\t\t\u003C/p>\u003Cp>\n\t\t\tFor information about smart card authentication in IdM, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/assembly_understanding-smart-card-authentication_managing-smart-card-authentication\">Understanding smart card authentication\u003C/a>.\n\t\t\u003C/p>\u003Cp>\n\t\t\tFor more details on configuring smart card authentication:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth\">Configuring the IdM server for smart card authentication\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth\">Configuring the IdM client for smart card authentication\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#proc-add-cert-idm-user-webui_configuring-idm-for-smart-card-auth\">Adding a certificate to a user entry in the IdM Web UI\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#proc-add-cert-idm-user-cli_configuring-idm-for-smart-card-auth\">Adding a certificate to a user entry in the IdM CLI\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth\">Installing tools for managing and using smart cards\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth\">Storing a certificate on a smart card\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth\">Logging in to IdM with smart cards\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#configuring-gdm-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth\">Configuring GDM access using smart card authentication\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#configuring-su-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth\">Configuring su access using smart card authentication\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.1. Configuring the IdM server for smart card authentication\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIf you want to enable smart card authentication for users whose certificates have been issued by the certificate authority (CA) of the &lt;EXAMPLE.ORG&gt; domain that your Identity Management (IdM) CA trusts, you must obtain the following certificates so that you can add them when running the \u003Ccode class=\"literal\">ipa-advise\u003C/code> script that configures the IdM server:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe certificate of the root CA that has either issued the certificate for the &lt;EXAMPLE.ORG&gt; CA directly, or through one or more of its sub-CAs. You can download the certificate chain from a web page whose certificate has been issued by the authority. For details, see Steps 1 - 4a in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/dc-web-ui-auth_managing-certificates-in-idm#configuring-browser-for-cert-auth_dc-web-ui-auth\">Configuring a browser to enable certificate authentication\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM CA certificate. You can obtain the CA certificate from the \u003Ccode class=\"literal\">/etc/ipa/ca.crt\u003C/code> file on the IdM server on which an IdM CA instance is running.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe certificates of all of the intermediate CAs; that is, intermediate between the &lt;EXAMPLE.ORG&gt; CA and the IdM CA.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tTo configure an IdM server for smart card authentication:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tObtain files with the CA certificates in the PEM format.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRun the built-in \u003Ccode class=\"literal\">ipa-advise\u003C/code> script.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tReload the system configuration.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have root access to the IdM server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the root CA certificate and all the intermediate CA certificates.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a directory in which you will do the configuration:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server]# \u003Cspan class=\"strong strong\">\u003Cstrong>mkdir ~/SmartCard/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server]# \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/SmartCard/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tObtain the relevant CA certificates stored in files in PEM format. If your CA certificate is stored in a file of a different format, such as DER, convert it to PEM format. The IdM Certificate Authority certificate is in PEM format and is located in the \u003Ccode class=\"literal\">/etc/ipa/ca.crt\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConvert a DER file to a PEM file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># openssl x509 -in &lt;filename&gt;.der -inform DER -out &lt;filename&gt;.pem -outform PEM\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor convenience, copy the certificates to the directory in which you want to do the configuration:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>cp /tmp/rootca.pem ~/SmartCard/\u003C/strong>\u003C/span>\n[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>cp /tmp/subca.pem ~/SmartCard/\u003C/strong>\u003C/span>\n[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>cp /tmp/issuingca.pem ~/SmartCard/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: If you use certificates of external certificate authorities, use the \u003Ccode class=\"literal\">openssl x509\u003C/code> utility to view the contents of the files in the \u003Ccode class=\"literal\">PEM\u003C/code> format to check that the \u003Ccode class=\"literal\">Issuer\u003C/code> and \u003Ccode class=\"literal\">Subject\u003C/code> values are correct:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -noout -text -in rootca.pem | more\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a configuration script with the in-built \u003Ccode class=\"literal\">ipa-advise\u003C/code> utility, using the administrator’s privileges:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\n[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-advise config-server-for-smart-card-auth &gt; config-server-for-smart-card-auth.sh\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">config-server-for-smart-card-auth.sh\u003C/code> script performs the following actions:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt configures the IdM Apache HTTP Server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt enables Public Key Cryptography for Initial Authentication in Kerberos (PKINIT) on the Key Distribution Center (KDC).\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt configures the IdM Web UI to accept smart card authorization requests.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tExecute the script, adding the PEM files containing the root CA and sub CA certificates as arguments:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>chmod +x config-server-for-smart-card-auth.sh\u003C/strong>\u003C/span>\n[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>./config-server-for-smart-card-auth.sh rootca.pem subca.pem issuingca.pem\u003C/strong>\u003C/span>\nTicket cache:KEYRING:persistent:0:0\nDefault principal: admin@IDM.EXAMPLE.COM\n[...]\nSystemwide CA database updated.\nThe ipa-certupdate command was successful\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tEnsure that you add the root CA’s certificate as an argument before any sub CA certificates and that the CA or sub CA certificates have not expired.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: If the certificate authority that issued the user certificate does not provide any Online Certificate Status Protocol (OCSP) responder, you may need to disable OCSP check for authentication to the IdM Web UI:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">SSLOCSPEnable\u003C/code> parameter to \u003Ccode class=\"literal\">off\u003C/code> in the \u003Ccode class=\"literal\">/etc/httpd/conf.d/ssl.conf\u003C/code> file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>SSLOCSPEnable off\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRestart the Apache daemon (httpd) for the changes to take effect immediately:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart httpd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tDo not disable the OCSP check if you only use user certificates issued by the IdM CA. OCSP responders are part of IdM.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor instructions on how to keep the OCSP check enabled, and yet prevent a user certificate from being rejected by the IdM server if it does not contain the information about the location at which the CA that issued the user certificate listens for OCSP service requests, see the \u003Ccode class=\"literal\">SSLOCSPDefaultResponder\u003C/code> directive in \u003Ca class=\"link\" href=\"http://httpd.apache.org/docs/trunk/en/mod/mod_ssl.html\">Apache mod_ssl configuration options\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe server is now configured for smart card authentication.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo enable smart card authentication in the whole topology, run the procedure on each IdM server.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-ansible-to-configure-the-idm-server-for-smart-card-authentication_configuring-idm-for-smart-card-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.2. Using Ansible to configure the IdM server for smart card authentication\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use Ansible to enable smart card authentication for users whose certificates have been issued by the certificate authority (CA) of the &lt;EXAMPLE.ORG&gt; domain that your Identity Management (IdM) CA trusts. To do that, you must obtain the following certificates so that you can use them when running an Ansible playbook with the \u003Ccode class=\"literal\">ipasmartcard_server\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> role script:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe certificate of the root CA that has either issued the certificate for the &lt;EXAMPLE.ORG&gt; CA directly, or through one or more of its sub-CAs. You can download the certificate chain from a web page whose certificate has been issued by the authority. For details, see Step 4 in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/dc-web-ui-auth_managing-certificates-in-idm#configuring-browser-for-cert-auth_dc-web-ui-auth\">Configuring a browser to enable certificate authentication\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM CA certificate. You can obtain the CA certificate from the \u003Ccode class=\"literal\">/etc/ipa/ca.crt\u003C/code> file on any IdM CA server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe certificates of all of the CAs that are intermediate between the &lt;EXAMPLE.ORG&gt; CA and the IdM CA.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> access to the IdM server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the root CA certificate, the IdM CA certificate, and all the intermediate CA certificates.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.14 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf your CA certificates are stored in files of a different format, such as \u003Ccode class=\"literal\">DER\u003C/code>, convert them to \u003Ccode class=\"literal\">PEM\u003C/code> format:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -in &lt;filename&gt;.der -inform DER -out &lt;filename&gt;.pem -outform PEM\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe IdM Certificate Authority certificate is in \u003Ccode class=\"literal\">PEM\u003C/code> format and is located in the \u003Ccode class=\"literal\">/etc/ipa/ca.crt\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Use the \u003Ccode class=\"literal\">openssl x509\u003C/code> utility to view the contents of the files in the \u003Ccode class=\"literal\">PEM\u003C/code> format to check that the \u003Ccode class=\"literal\">Issuer\u003C/code> and \u003Ccode class=\"literal\">Subject\u003C/code> values are correct:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -noout -text -in root-ca.pem | more\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a subdirectory dedicated to the CA certificates:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>mkdir SmartCard/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor convenience, copy all the required certificates to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks/SmartCard/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp /tmp/root-ca.pem ~/MyPlaybooks/SmartCard/\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>cp /tmp/intermediate-ca.pem ~/MyPlaybooks/SmartCard/\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>cp /etc/ipa/ca.crt ~/MyPlaybooks/SmartCard/ipa-ca.crt\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn your Ansible inventory file, specify the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe IdM servers that you want to configure for smart card authentication.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe paths to the certificates of the CAs in the following order:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe root CA certificate file\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe intermediate CA certificates files\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe IdM CA certificate file\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe file can look as follows:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>[ipaserver]\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaserver.idm.example.com\u003C/strong>\u003C/span>\n\n[ipareplicas]\nipareplica1.idm.example.com\nipareplica2.idm.example.com\n\n[ipacluster:children]\nipaserver\nipareplicas\n\n[ipacluster:vars]\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password= \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipasmartcard_server_ca_certs=/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/root-ca.pem,/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/intermediate-ca.pem,/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/ipa-ca.crt\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an \u003Ccode class=\"literal\">install-smartcard-server.yml\u003C/code> playbook with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to set up smart card authentication for an IdM server\n  \u003Cspan class=\"strong strong\">\u003Cstrong>hosts: ipaserver\u003C/strong>\u003C/span>\n  become: true\n\n  roles:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>role: ipasmartcard_server\u003C/strong>\u003C/span>\n    state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory install-smartcard-server.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipasmartcard_server\u003C/code> Ansible role performs the following actions:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt configures the IdM Apache HTTP Server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt enables Public Key Cryptography for Initial Authentication in Kerberos (PKINIT) on the Key Distribution Center (KDC).\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt configures the IdM Web UI to accept smart card authorization requests.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: If the certificate authority that issued the user certificate does not provide any Online Certificate Status Protocol (OCSP) responder, you may need to disable OCSP check for authentication to the IdM Web UI:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tConnect to the IdM server as \u003Ccode class=\"literal\">root\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>ssh root@ipaserver.idm.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">SSLOCSPEnable\u003C/code> parameter to \u003Ccode class=\"literal\">off\u003C/code> in the \u003Ccode class=\"literal\">/etc/httpd/conf.d/ssl.conf\u003C/code> file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>SSLOCSPEnable off\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRestart the Apache daemon (httpd) for the changes to take effect immediately:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart httpd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tDo not disable the OCSP check if you only use user certificates issued by the IdM CA. OCSP responders are part of IdM.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor instructions on how to keep the OCSP check enabled, and yet prevent a user certificate from being rejected by the IdM server if it does not contain the information about the location at which the CA that issued the user certificate listens for OCSP service requests, see the \u003Ccode class=\"literal\">SSLOCSPDefaultResponder\u003C/code> directive in \u003Ca class=\"link\" href=\"http://httpd.apache.org/docs/trunk/en/mod/mod_ssl.html\">Apache mod_ssl configuration options\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe server listed in the inventory file is now configured for smart card authentication.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo enable smart card authentication in the whole topology, set the \u003Ccode class=\"literal\">hosts\u003C/code> variable in the Ansible playbook to \u003Ccode class=\"literal\">ipacluster\u003C/code>:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to setup smartcard for IPA server and replicas\n  \u003Cspan class=\"strong strong\">\u003Cstrong>hosts: ipacluster\u003C/strong>\u003C/span>\n[...]\u003C/pre>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks using the \u003Ccode class=\"literal\">ipasmartcard_server\u003C/code> role in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.3. Configuring the IdM client for smart card authentication\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to configure IdM clients for smart card authentication. The procedure needs to be run on each IdM system, a client or a server, to which you want to connect while using a smart card for authentication. For example, to enable an \u003Ccode class=\"literal\">ssh\u003C/code> connection from host A to host B, the script needs to be run on host B.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAs an administrator, run this procedure to enable smart card authentication using\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ssh\u003C/code> protocol\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-and-importing-local-certificates-to-a-smart-card_managing-smart-card-authentication#configuring-ssh-access-using-smart-card-authentication_configuring-and-importing-local-certificates-to-a-smart-card\">Configuring SSH access using smart card authentication\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe console login\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe GNOME Display Manager (GDM)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">su\u003C/code> command\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThis procedure is not required for authenticating to the IdM Web UI. Authenticating to the IdM Web UI involves two hosts, neither of which needs to be an IdM client:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe machine on which the browser is running. The machine can be outside of the IdM domain.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM server on which \u003Ccode class=\"literal\">httpd\u003C/code> is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe following procedure assumes that you are configuring smart card authentication on an IdM client, not an IdM server. For this reason you need two computers: an IdM server to generate the configuration script, and the IdM client on which to run the script.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM server has been configured for smart card authentication, as described in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth\">Configuring the IdM server for smart card authentication\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have root access to the IdM server and the IdM client.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the root CA certificate and all the intermediate CA certificates.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou installed the IdM client with the \u003Ccode class=\"literal\">--mkhomedir\u003C/code> option to ensure remote users can log in successfully. If you do not create a home directory, the default login location is the root of the directory structure, \u003Ccode class=\"literal\">/\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn an IdM server, generate a configuration script with \u003Ccode class=\"literal\">ipa-advise\u003C/code> using the administrator’s privileges:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\n[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-advise config-client-for-smart-card-auth &gt; config-client-for-smart-card-auth.sh\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">config-client-for-smart-card-auth.sh\u003C/code> script performs the following actions:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt configures the smart card daemon.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt sets the system-wide truststore.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt configures the System Security Services Daemon (SSSD) to allow users to authenticate with either their user name and password or with their smart card. For more details on SSSD profile options for smart card authentication, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/assembly_understanding-smart-card-authentication_managing-smart-card-authentication#con_smart-card-authentication-options-in-rhel_assembly_understanding-smart-card-authentication\">Smart card authentication options in RHEL\u003C/a>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFrom the IdM server, copy the script to a directory of your choice on the IdM client machine:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>scp config-client-for-smart-card-auth.sh root\u003Cspan class=\"strong strong\">\u003Cstrong>@\u003C/strong>\u003C/span>client.idm.example.com:/root/SmartCard/\u003C/strong>\u003C/span>\nPassword:\nconfig-client-for-smart-card-auth.sh        100%   2419       3.5MB/s   00:00\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFrom the IdM server, copy the CA certificate files in PEM format for convenience to the same directory on the IdM client machine as used in the previous step:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>scp {rootca.pem,subca.pem,issuingca.pem} root\u003Cspan class=\"strong strong\">\u003Cstrong>@\u003C/strong>\u003C/span>client.idm.example.com:/root/SmartCard/\u003C/strong>\u003C/span>\nPassword:\nrootca.pem                          100%   1237     9.6KB/s   00:00\nsubca.pem                           100%   2514    19.6KB/s   00:00\nissuingca.pem                       100%   2514    19.6KB/s   00:00\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the client machine, execute the script, adding the PEM files containing the CA certificates as arguments:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@client SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\n[root@client SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>chmod +x config-client-for-smart-card-auth.sh\u003C/strong>\u003C/span>\n[root@client SmartCard]# \u003Cspan class=\"strong strong\">\u003Cstrong>./config-client-for-smart-card-auth.sh rootca.pem subca.pem issuingca.pem\u003C/strong>\u003C/span>\nTicket cache:KEYRING:persistent:0:0\nDefault principal: admin@IDM.EXAMPLE.COM\n[...]\nSystemwide CA database updated.\nThe ipa-certupdate command was successful\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tEnsure that you add the root CA’s certificate as an argument before any sub CA certificates and that the CA or sub CA certificates have not expired.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe client is now configured for smart card authentication.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-ansible-to-configure-idm-clients-for-smart-card-authentication_configuring-idm-for-smart-card-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.4. Using Ansible to configure IdM clients for smart card authentication\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipasmartcard_client\u003C/code> module to configure specific Identity Management (IdM) clients to permit IdM users to authenticate with a smart card. Run this procedure to enable smart card authentication for IdM users that use any of the following to access IdM:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ssh\u003C/code> protocol\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-and-importing-local-certificates-to-a-smart-card_managing-smart-card-authentication#configuring-ssh-access-using-smart-card-authentication_configuring-and-importing-local-certificates-to-a-smart-card\">Configuring SSH access using smart card authentication\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe console login\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe GNOME Display Manager (GDM)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">su\u003C/code> command\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThis procedure is not required for authenticating to the IdM Web UI. Authenticating to the IdM Web UI involves two hosts, neither of which needs to be an IdM client:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe machine on which the browser is running. The machine can be outside of the IdM domain.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe IdM server on which \u003Ccode class=\"literal\">httpd\u003C/code> is running.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM server has been configured for smart card authentication, as described in \u003Ca class=\"link\" href=\"#proc_using-ansible-to-configure-the-idm-server-for-smart-card-authentication_configuring-idm-for-smart-card-auth\" title=\"8.2. Using Ansible to configure the IdM server for smart card authentication\">Using Ansible to configure the IdM server for smart card authentication\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have root access to the IdM server and the IdM client.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the root CA certificate, the IdM CA certificate, and all the intermediate CA certificates.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.14 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf your CA certificates are stored in files of a different format, such as \u003Ccode class=\"literal\">DER\u003C/code>, convert them to \u003Ccode class=\"literal\">PEM\u003C/code> format:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -in &lt;filename&gt;.der -inform DER -out &lt;filename&gt;.pem -outform PEM\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe IdM CA certificate is in \u003Ccode class=\"literal\">PEM\u003C/code> format and is located in the \u003Ccode class=\"literal\">/etc/ipa/ca.crt\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Use the \u003Ccode class=\"literal\">openssl x509\u003C/code> utility to view the contents of the files in the \u003Ccode class=\"literal\">PEM\u003C/code> format to check that the \u003Ccode class=\"literal\">Issuer\u003C/code> and \u003Ccode class=\"literal\">Subject\u003C/code> values are correct:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -noout -text -in root-ca.pem | more\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your Ansible control node, navigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a subdirectory dedicated to the CA certificates:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>mkdir SmartCard/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor convenience, copy all the required certificates to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks/SmartCard/\u003C/strong>\u003C/span> directory, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp /tmp/root-ca.pem ~/MyPlaybooks/SmartCard/\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>cp /tmp/intermediate-ca.pem ~/MyPlaybooks/SmartCard/\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>cp /etc/ipa/ca.crt ~/MyPlaybooks/SmartCard/ipa-ca.crt\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn your Ansible inventory file, specify the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe IdM clients that you want to configure for smart card authentication.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe paths to the certificates of the CAs in the following order:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe root CA certificate file\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe intermediate CA certificates files\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe IdM CA certificate file\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe file can look as follows:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>[ipaclients]\u003C/strong>\u003C/span>\nipaclient1.example.com\nipaclient2.example.com\n\n[ipaclients:vars]\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password=SomeADMINpassword\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipasmartcard_client_ca_certs=/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/root-ca.pem,/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/intermediate-ca.pem,/home/&lt;user_name&gt;/MyPlaybooks/SmartCard/ipa-ca.crt\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an \u003Ccode class=\"literal\">install-smartcard-clients.yml\u003C/code> playbook with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to set up smart card authentication for an IdM client\n  \u003Cspan class=\"strong strong\">\u003Cstrong>hosts: ipaclients\u003C/strong>\u003C/span>\n  become: true\n\n  roles:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>role: ipasmartcard_client\u003C/strong>\u003C/span>\n    state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook and inventory files:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory install-smartcard-clients.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipasmartcard_client\u003C/code> Ansible role performs the following actions:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt configures the smart card daemon.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt sets the system-wide truststore.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt configures the System Security Services Daemon (SSSD) to allow users to authenticate with either their user name and password or their smart card. For more details on SSSD profile options for smart card authentication, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/assembly_understanding-smart-card-authentication_managing-smart-card-authentication#con_smart-card-authentication-options-in-rhel_assembly_understanding-smart-card-authentication\">Smart card authentication options in RHEL\u003C/a>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe clients listed in the \u003Cspan class=\"strong strong\">\u003Cstrong>ipaclients\u003C/strong>\u003C/span> section of the inventory file are now configured for smart card authentication.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you have installed the IdM clients with the \u003Ccode class=\"literal\">--mkhomedir\u003C/code> option, remote users will be able to log in to their home directories. Otherwise, the default login location is the root of the directory structure, \u003Ccode class=\"literal\">/\u003C/code>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks using the \u003Ccode class=\"literal\">ipasmartcard_server\u003C/code> role in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc-add-cert-idm-user-webui_configuring-idm-for-smart-card-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.5. Adding a certificate to a user entry in the IdM Web UI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to add an external certificate to a user entry in IdM Web UI.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tInstead of uploading the whole certificate, it is also possible to upload certificate mapping data to a user entry in IdM. User entries containing either full certificates or certificate mapping data can be used in conjunction with corresponding certificate mapping rules to facilitate the configuration of smart card authentication for system administrators. For details, see\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#con-idm-certmapdata_conf-certmap-idm\">Certificate mapping rules for configuring authentication\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf the user’s certificate has been issued by the IdM Certificate Authority, the certificate is already stored in the user entry, and you do not need to follow this procedure.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the certificate that you want to add to the user entry at your disposal.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog into the IdM Web UI as an administrator if you want to add a certificate to another user. For adding a certificate to your own profile, you do not need the administrator’s credentials.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Users\u003C/code> → \u003Ccode class=\"literal\">Active users\u003C/code> → \u003Ccode class=\"literal\">sc_user\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFind the \u003Ccode class=\"literal\">Certificate\u003C/code> option and click \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the command-line interface, display the certificate in the \u003Ccode class=\"literal\">PEM\u003C/code> format using the \u003Ccode class=\"literal\">cat\u003C/code> utility or a text editor:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@client SmartCard]$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat testuser.crt\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCopy and paste the certificate from the CLI into the window that has opened in the Web UI.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"configuring-idm-for-smart-card-auth-new-certmaprule-add\">\u003Cp class=\"title\">\u003Cstrong>Figure 8.1. Adding a new certificate in the IdM Web UI\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/1f589affb4e3eb5c0a47755352e5bcd6/idm-add-cert.png\" alt=\"Screenshot of the &quot;New Certificate&quot; pop-up window with one large field for the Certificate in base64 of PEM format. The &quot;Add&quot; button at the bottom right is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">sc_user\u003C/code> entry now contains an external certificate.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"proc-add-cert-idm-user-cli_configuring-idm-for-smart-card-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.6. Adding a certificate to a user entry in the IdM CLI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to add an external certificate to a user entry in IdM CLI.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tInstead of uploading the whole certificate, it is also possible to upload certificate mapping data to a user entry in IdM. User entries containing either full certificates or certificate mapping data can be used in conjunction with corresponding certificate mapping rules to facilitate the configuration of smart card authentication for system administrators. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#con-idm-certmapdata_conf-certmap-idm\">Certificate mapping rules for configuring authentication\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf the user’s certificate has been issued by the IdM Certificate Authority, the certificate is already stored in the user entry, and you do not need to follow this procedure.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the certificate that you want to add to the user entry at your disposal.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into the IdM CLI as an administrator if you want to add a certificate to another user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@client SmartCard]$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor adding a certificate to your own profile, you do not need the administrator’s credentials:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@client SmartCard]$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit sc_user\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an environment variable containing the certificate with the header and footer removed and concatenated into a single line, which is the format expected by the \u003Ccode class=\"literal\">ipa user-add-cert\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@client SmartCard]$ \u003Cspan class=\"strong strong\">\u003Cstrong>export CERT=`openssl x509 -outform der -in testuser.crt | base64 -w0 -`\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that certificate in the \u003Ccode class=\"literal\">testuser.crt\u003C/code> file must be in the \u003Ccode class=\"literal\">PEM\u003C/code> format.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the certificate to the profile of sc_user using the \u003Ccode class=\"literal\">ipa user-add-cert\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@client SmartCard]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-add-cert sc_user --certificate=$CERT\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">sc_user\u003C/code> entry now contains an external certificate.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.7. Installing tools for managing and using smart cards\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">gnutls-utils\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">opensc\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">pcscd\u003C/code> service is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBefore you can configure your smart card, you must install the corresponding tools, which can generate certificates and start the \u003Ccode class=\"literal\">pscd\u003C/code> service.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">opensc\u003C/code> and \u003Ccode class=\"literal\">gnutls-utils\u003C/code> packages:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf -y install opensc gnutls-utils\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the \u003Ccode class=\"literal\">pcscd\u003C/code> service.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl start pcscd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the \u003Ccode class=\"literal\">pcscd\u003C/code> service is up and running\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status pcscd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.8. Preparing your smart card and uploading your certificates and keys to your smart card\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to configure your smart card with the \u003Ccode class=\"literal\">pkcs15-init\u003C/code> tool, which helps you to configure:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tErasing your smart card\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSetting new PINs and optional PIN Unblocking Keys (PUKs)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreating a new slot on the smart card\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tStoring the certificate, private key, and public key in the slot\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf required, locking the smart card settings as certain smart cards require this type of finalization\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">pkcs15-init\u003C/code> tool may not work with all smart cards. You must use the tools that work with the smart card you are using.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">opensc\u003C/code> package, which includes the \u003Ccode class=\"literal\">pkcs15-init\u003C/code> tool, is installed.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor more details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth\">Installing tools for managing and using smart cards\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe card is inserted in the reader and connected to the computer.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have a private key, a public key, and a certificate to store on the smart card. In this procedure, \u003Ccode class=\"literal\">testuser.key\u003C/code>, \u003Ccode class=\"literal\">testuserpublic.key\u003C/code>, and \u003Ccode class=\"literal\">testuser.crt\u003C/code> are the names used for the private key, public key, and the certificate.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have your current smart card user PIN and Security Officer PIN (SO-PIN).\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tErase your smart card and authenticate yourself with your PIN:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --erase-card --use-default-transport-keys\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\nPIN [Security Officer PIN] required.\nPlease enter PIN [Security Officer PIN]:\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe card has been erased.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInitialize your smart card, set your user PIN and PUK, and your Security Officer PIN and PUK:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --create-pkcs15 --use-default-transport-keys \\ --pin \u003Cspan class=\"emphasis\">\u003Cem>963214\u003C/em>\u003C/span> --puk \u003Cspan class=\"emphasis\">\u003Cem>321478\u003C/em>\u003C/span> --so-pin \u003Cspan class=\"emphasis\">\u003Cem>65498714\u003C/em>\u003C/span> --so-puk \u003Cspan class=\"emphasis\">\u003Cem>784123\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">pcks15-init\u003C/code> tool creates a new slot on the smart card.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSet a label and the authentication ID for the slot:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --store-pin --label testuser \\ --auth-id 01 --so-pin \u003Cspan class=\"emphasis\">\u003Cem>65498714\u003C/em>\u003C/span> --pin \u003Cspan class=\"emphasis\">\u003Cem>963214\u003C/em>\u003C/span> --puk \u003Cspan class=\"emphasis\">\u003Cem>321478\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe label is set to a human-readable value, in this case, \u003Ccode class=\"literal\">testuser\u003C/code>. The \u003Ccode class=\"literal\">auth-id\u003C/code> must be two hexadecimal values, in this case it is set to \u003Ccode class=\"literal\">01\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore and label the private key in the new slot on the smart card:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --store-private-key testuser.key --label testuser_key \\ --auth-id 01 --id 01 --pin \u003Cspan class=\"emphasis\">\u003Cem>963214\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe value you specify for \u003Ccode class=\"literal\">--id\u003C/code> must be the same when storing your private key and storing your certificate in the next step. Specifying your own value for \u003Ccode class=\"literal\">--id\u003C/code> is recommended as otherwise a more complicated value is calculated by the tool.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore and label the certificate in the new slot on the smart card:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --store-certificate testuser.crt --label testuser_crt \\ --auth-id 01 --id 01 --format pem --pin \u003Cspan class=\"emphasis\">\u003Cem>963214\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Store and label the public key in the new slot on the smart card:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --store-public-key testuserpublic.key --label testuserpublic_key --auth-id 01 --id 01 --pin \u003Cspan class=\"emphasis\">\u003Cem>963214\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIf the public key corresponds to a private key or certificate, specify the same ID as the ID of the private key or certificate.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Certain smart cards require you to finalize the card by locking the settings:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init -F\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAt this stage, your smart card includes the certificate, private key, and public key in the newly created slot. You have also created your user PIN and PUK and the Security Officer PIN and PUK.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.9. Logging in to IdM with smart cards\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use smart cards for logging in to the IdM Web UI.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe web browser is configured for using smart card authentication.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM server is configured for smart card authentication.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe certificate installed on your smart card is either issued by the IdM server or has been added to the user entry in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the PIN required to unlock the smart card.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe smart card has been inserted into the reader.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the IdM Web UI in the browser.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Log In Using Certificate\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"inlinemediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/e2df8c824273dc927cde799f821b8c6c/ipa-login-smart-card.png\" alt=\"A screenshot of the IdM Web UI displaying an empty &quot;Username&quot; field and an empty &quot;Password&quot; field. Below those two fields the &quot;Log in using a Certificate&quot; option has been highlighted.\"/>\u003C/span>\n\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the \u003Cspan class=\"strong strong\">\u003Cstrong>Password Required\u003C/strong>\u003C/span> dialog box opens, add the PIN to unlock the smart card and click the \u003Cspan class=\"strong strong\">\u003Cstrong>OK\u003C/strong>\u003C/span> button.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>User Identification Request\u003C/strong>\u003C/span> dialog box opens.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the smart card contains more than one certificate, select the certificate you want to use for authentication in the drop down list below \u003Cspan class=\"strong strong\">\u003Cstrong>Choose a certificate to present as identification\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick the \u003Cspan class=\"strong strong\">\u003Cstrong>OK\u003C/strong>\u003C/span> button.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tNow you are successfully logged in to the IdM Web UI.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Cspan class=\"inlinemediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/62db8da1055ce6a2efadfd397d26a6fe/web_ui_users.png\" alt=\"A screenshot of the first screen visible after logging in to the IdM Web UI. There are 5 tabs listed along the top of the screen: Identity - Policy - Authentication - Network Services - IPA Server. The Identity tab has been selected and it is displaying the Users page which is the first menu item among 6 choices just below the tabs: Users - Hosts - Services - Groups - ID Views - Automember. The Active users page displays a table of user logins and their information: First name - Last name - Status - UID - Email address - Telephone number - Job Title.\"/>\u003C/span>\n\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"configuring-gdm-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.10. Logging in to GDM using smart card authentication on an IdM client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe GNOME Desktop Manager (GDM) requires authentication. You can use your password; however, you can also use a smart card for authentication.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to use smart card authentication to access GDM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe system has been configured for smart card authentication. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth\">Configuring the IdM client for smart card authentication\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe smart card contains your certificate and private key.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user account is a member of the IdM domain.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe certificate on the smart card maps to the user entry through:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAssigning the certificate to a particular user entry. For details, see, \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#proc-add-cert-idm-user-webui_configuring-idm-for-smart-card-auth\">Adding a certificate to a user entry in the IdM Web UI\u003C/a> or \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#proc-add-cert-idm-user-cli_configuring-idm-for-smart-card-auth\">Adding a certificate to a user entry in the IdM CLI\u003C/a>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe certificate mapping data being applied to the account. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/con-idm-certmapdata_managing-smart-card-authentication\">Certificate mapping rules for configuring authentication on smart cards\u003C/a>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tInsert the smart card in the reader.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnter the smart card PIN.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Sign In\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tYou are successfully logged in to the RHEL system and you have a TGT provided by the IdM server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Terminal\u003C/strong>\u003C/span> window, enter \u003Ccode class=\"literal\">klist\u003C/code> and check the result:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ klist\nTicket cache: KEYRING:persistent:1358900015:krb_cache_TObtNMd\nDefault principal: example.user@REDHAT.COM\n\nValid starting       Expires              Service principal\n04/20/2020 13:58:24  04/20/2020 23:58:24  krbtgt/EXAMPLE.COM@EXAMPLE.COM\n\trenew until 04/27/2020 08:58:15\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-su-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.11. Using smart card authentication with the su command\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tChanging to a different user requires authentication. You can use a password or a certificate. Follow this procedure to use your smart card with the \u003Ccode class=\"literal\">su\u003C/code> command. It means that after entering the \u003Ccode class=\"literal\">su\u003C/code> command, you are prompted for the smart card PIN.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYour IdM server and client have been configured for smart card authentication.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth\">Configuring the IdM server for smart card authentication\u003C/a>\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth\">Configuring the IdM client for smart card authentication\u003C/a>\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe smart card contains your certificate and private key. See \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth\">Storing a certificate on a smart card\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe card is inserted in the reader and connected to the computer.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn a terminal window, change to a different user with the \u003Ccode class=\"literal\">su\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ su - example.user\nPIN for smart_card\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the configuration is correct, you are prompted to enter the smart card PIN.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 9. Configuring certificates issued by ADCS for smart card authentication in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tTo configure smart card authentication in IdM for users whose certificates are issued by Active Directory (AD) certificate services:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tYour deployment is based on cross-forest trust between Identity Management (IdM) and Active Directory (AD).\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou want to allow smart card authentication for users whose accounts are stored in AD.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tCertificates are created and stored in Active Directory Certificate Services (ADCS).\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tFor an overview of smart card authentication, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/assembly_understanding-smart-card-authentication_managing-smart-card-authentication\">Understanding smart card authentication\u003C/a>.\n\t\t\u003C/p>\u003Cp>\n\t\t\tConfiguration is accomplished in the following steps:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication#copying-certificates-from-active-directory-using-sftp_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">Copying CA and user certificates from Active Directory to the IdM server and client\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication#configuring-the-idm-server-and-clients-for-smart-card-authentication-using-adcs-certificates_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">Configuring the IdM server and clients for smart card authentication using ADCS certificates\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication#converting-the-pfx-file_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">Converting a PFX (PKCS#12) file to be able to store the certificate and private key into the smart card\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication#configuring-timeouts-in-sssd-conf_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">Configuring timeouts in the sssd.conf file\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-smart-card-authentication#certificate-mapping-rules-for-smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">Creating certificate mapping rules for smart card authentication\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tIdentity Management (IdM) and Active Directory (AD) trust is installed\n\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\tFor details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_trust_between_idm_and_ad/index\">Installing trust between IdM and AD\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tActive Directory Certificate Services (ADCS) is installed and certificates for users are generated\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"windows-server-settings-required-for-trust-configuration-and-certificate-usage_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.1. Windows Server settings required for trust configuration and certificate usage\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou must configure the following on the Windows Server:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tActive Directory Certificate Services (ADCS) is installed\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCertificate Authority is created\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: If you are using Certificate Authority Web Enrollment, the Internet Information Services (IIS) must be configured\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tExport the certificate:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tKey must have \u003Ccode class=\"literal\">2048\u003C/code> bits or more\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tInclude a private key\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou will need a certificate in the following format: Personal Information Exchange — \u003Ccode class=\"literal\">PKCS #12(.PFX)\u003C/code>\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnable certificate privacy\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"copying-certificates-from-active-directory-using-sftp_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.2. Copying certificates from Active Directory using sftp\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo be able to use smart card authetication, you need to copy the following certificate files:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA root CA certificate in the \u003Ccode class=\"literal\">CER\u003C/code> format: \u003Ccode class=\"literal\">adcs-winserver-ca.cer\u003C/code> on your IdM server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA user certificate with a private key in the \u003Ccode class=\"literal\">PFX\u003C/code> format: \u003Ccode class=\"literal\">aduser1.pfx\u003C/code> on an IdM client.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThis procedure expects SSH access is allowed. If SSH is unavailable the user must copy the file from the AD Server to the IdM server and client.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConnect from \u003Cspan class=\"strong strong\">\u003Cstrong>the IdM server\u003C/strong>\u003C/span> and copy the \u003Ccode class=\"literal\">adcs-winserver-ca.cer\u003C/code> root certificate to the IdM server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">root@idmserver ~]# sftp Administrator@winserver.ad.example.com\nAdministrator@winserver.ad.example.com's password:\nConnected to Administrator@winserver.ad.example.com.\nsftp&gt; cd &lt;Path to certificates&gt;\nsftp&gt; ls\nadcs-winserver-ca.cer    aduser1.pfx\nsftp&gt;\nsftp&gt; get adcs-winserver-ca.cer\nFetching &lt;Path to certificates&gt;/adcs-winserver-ca.cer to adcs-winserver-ca.cer\n&lt;Path to certificates&gt;/adcs-winserver-ca.cer                 100%  1254    15KB/s 00:00\nsftp quit\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConnect from \u003Cspan class=\"strong strong\">\u003Cstrong>the IdM client\u003C/strong>\u003C/span> and copy the \u003Ccode class=\"literal\">aduser1.pfx\u003C/code> user certificate to the client:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@client1 ~]# sftp Administrator@winserver.ad.example.com\nAdministrator@winserver.ad.example.com's password:\nConnected to Administrator@winserver.ad.example.com.\nsftp&gt; cd /&lt;Path to certificates&gt;\nsftp&gt; get aduser1.pfx\nFetching &lt;Path to certificates&gt;/aduser1.pfx to aduser1.pfx\n&lt;Path to certificates&gt;/aduser1.pfx                 100%  1254    15KB/s 00:00\nsftp quit\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tNow the CA certificate is stored in the IdM server and the user certificates is stored on the client machine.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"configuring-the-idm-server-and-clients-for-smart-card-authentication-using-adcs-certificates_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.3. Configuring the IdM server and clients for smart card authentication using ADCS certificates\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou must configure the IdM (Identity Management) server and clients to be able to use smart card authentication in the IdM environment. IdM includes the \u003Ccode class=\"literal\">ipa-advise\u003C/code> scripts which makes all necessary changes:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tInstall necessary packages\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tConfigure IdM server and clients\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCopy the CA certificates into the expected locations\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tYou can run \u003Ccode class=\"literal\">ipa-advise\u003C/code> on your IdM server.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to configure your server and clients for smart card authentication:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOn an IdM server: Preparing the \u003Ccode class=\"literal\">ipa-advise\u003C/code> script to configure your IdM server for smart card authentication.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOn an IdM server: Preparing the \u003Ccode class=\"literal\">ipa-advise\u003C/code> script to configure your IdM client for smart card authentication.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOn an IdM server: Applying the the \u003Ccode class=\"literal\">ipa-advise\u003C/code> server script on the IdM server using the AD certificate.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMoving the client script to the IdM client machine.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOn an IdM client: Applying the the \u003Ccode class=\"literal\">ipa-advise\u003C/code> client script on the IdM client using the AD certificate.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe certificate has been copied to the IdM server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tObtain the Kerberos ticket.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in as a user with administration rights.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the IdM server, use the \u003Ccode class=\"literal\">ipa-advise\u003C/code> script for configuring a client:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmserver ~]# ipa-advise config-client-for-smart-card-auth &gt; sc_client.sh\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the IdM server, use the \u003Ccode class=\"literal\">ipa-advise\u003C/code> script for configuring a server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmserver ~]# ipa-advise config-server-for-smart-card-auth &gt; sc_server.sh\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the IdM server, execute the script:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmserver ~]# sh -x sc_server.sh adcs-winserver-ca.cer\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt configures the IdM Apache HTTP Server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt enables Public Key Cryptography for Initial Authentication in Kerberos (PKINIT) on the Key Distribution Center (KDC).\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIt configures the IdM Web UI to accept smart card authorization requests.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">sc_client.sh\u003C/code> script to the client system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmserver ~]# scp sc_client.sh root@client1.idm.example.com:/root\nPassword:\nsc_client.sh                  100%  2857   1.6MB/s   00:00\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the Windows certificate to the client system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmserver ~]# scp adcs-winserver-ca.cer root@client1.idm.example.com:/root\nPassword:\nadcs-winserver-ca.cer                 100%  1254   952.0KB/s   00:00\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the client system, run the client script:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient1 ~]# sh -x sc_client.sh adcs-winserver-ca.cer\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe CA certificate is installed in the correct format on the IdM server and client systems and next step is to copy the user certificates onto the smart card itself.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"converting-the-pfx-file_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.4. Converting the PFX file\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBefore you store the PFX (PKCS#12) file into the smart card, you must:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tConvert the file to the PEM format\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tExtract the private key and the certificate to two different files\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe PFX file is copied into the IdM client machine.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the IdM client, into the PEM format:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient1 ~]# openssl pkcs12 -in aduser1.pfx -out aduser1_cert_only.pem -clcerts -nodes\nEnter Import Password:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tExtract the key into the separate file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient1 ~]# openssl pkcs12 -in adduser1.pfx -nocerts -out adduser1.pem &gt; aduser1.key\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tExtract the public certificate into the separate file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient1 ~]# openssl pkcs12 -in adduser1.pfx -clcerts -nokeys -out aduser1_cert_only.pem &gt; aduser1.crt\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tAt this point, you can store the \u003Ccode class=\"literal\">aduser1.key\u003C/code> and \u003Ccode class=\"literal\">aduser1.crt\u003C/code> into the smart card.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"installing-tools-for-managing-and-using-smart-cards_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.5. Installing tools for managing and using smart cards\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">gnutls-utils\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">opensc\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">pcscd\u003C/code> service is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBefore you can configure your smart card, you must install the corresponding tools, which can generate certificates and start the \u003Ccode class=\"literal\">pscd\u003C/code> service.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">opensc\u003C/code> and \u003Ccode class=\"literal\">gnutls-utils\u003C/code> packages:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf -y install opensc gnutls-utils\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the \u003Ccode class=\"literal\">pcscd\u003C/code> service.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl start pcscd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the \u003Ccode class=\"literal\">pcscd\u003C/code> service is up and running\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status pcscd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"storing-a-certificate-on-the-smart-card_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.6. Preparing your smart card and uploading your certificates and keys to your smart card\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to configure your smart card with the \u003Ccode class=\"literal\">pkcs15-init\u003C/code> tool, which helps you to configure:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tErasing your smart card\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSetting new PINs and optional PIN Unblocking Keys (PUKs)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreating a new slot on the smart card\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tStoring the certificate, private key, and public key in the slot\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf required, locking the smart card settings as certain smart cards require this type of finalization\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">pkcs15-init\u003C/code> tool may not work with all smart cards. You must use the tools that work with the smart card you are using.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">opensc\u003C/code> package, which includes the \u003Ccode class=\"literal\">pkcs15-init\u003C/code> tool, is installed.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor more details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth\">Installing tools for managing and using smart cards\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe card is inserted in the reader and connected to the computer.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have a private key, a public key, and a certificate to store on the smart card. In this procedure, \u003Ccode class=\"literal\">testuser.key\u003C/code>, \u003Ccode class=\"literal\">testuserpublic.key\u003C/code>, and \u003Ccode class=\"literal\">testuser.crt\u003C/code> are the names used for the private key, public key, and the certificate.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have your current smart card user PIN and Security Officer PIN (SO-PIN).\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tErase your smart card and authenticate yourself with your PIN:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --erase-card --use-default-transport-keys\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\nPIN [Security Officer PIN] required.\nPlease enter PIN [Security Officer PIN]:\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe card has been erased.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInitialize your smart card, set your user PIN and PUK, and your Security Officer PIN and PUK:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --create-pkcs15 --use-default-transport-keys \\ --pin \u003Cspan class=\"emphasis\">\u003Cem>963214\u003C/em>\u003C/span> --puk \u003Cspan class=\"emphasis\">\u003Cem>321478\u003C/em>\u003C/span> --so-pin \u003Cspan class=\"emphasis\">\u003Cem>65498714\u003C/em>\u003C/span> --so-puk \u003Cspan class=\"emphasis\">\u003Cem>784123\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">pcks15-init\u003C/code> tool creates a new slot on the smart card.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSet a label and the authentication ID for the slot:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --store-pin --label testuser \\ --auth-id 01 --so-pin \u003Cspan class=\"emphasis\">\u003Cem>65498714\u003C/em>\u003C/span> --pin \u003Cspan class=\"emphasis\">\u003Cem>963214\u003C/em>\u003C/span> --puk \u003Cspan class=\"emphasis\">\u003Cem>321478\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe label is set to a human-readable value, in this case, \u003Ccode class=\"literal\">testuser\u003C/code>. The \u003Ccode class=\"literal\">auth-id\u003C/code> must be two hexadecimal values, in this case it is set to \u003Ccode class=\"literal\">01\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore and label the private key in the new slot on the smart card:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --store-private-key testuser.key --label testuser_key \\ --auth-id 01 --id 01 --pin \u003Cspan class=\"emphasis\">\u003Cem>963214\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe value you specify for \u003Ccode class=\"literal\">--id\u003C/code> must be the same when storing your private key and storing your certificate in the next step. Specifying your own value for \u003Ccode class=\"literal\">--id\u003C/code> is recommended as otherwise a more complicated value is calculated by the tool.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore and label the certificate in the new slot on the smart card:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --store-certificate testuser.crt --label testuser_crt \\ --auth-id 01 --id 01 --format pem --pin \u003Cspan class=\"emphasis\">\u003Cem>963214\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Store and label the public key in the new slot on the smart card:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init --store-public-key testuserpublic.key --label testuserpublic_key --auth-id 01 --id 01 --pin \u003Cspan class=\"emphasis\">\u003Cem>963214\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nUsing reader with a card: \u003Cspan class=\"emphasis\">\u003Cem>Reader name\u003C/em>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIf the public key corresponds to a private key or certificate, specify the same ID as the ID of the private key or certificate.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Certain smart cards require you to finalize the card by locking the settings:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>pkcs15-init -F\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAt this stage, your smart card includes the certificate, private key, and public key in the newly created slot. You have also created your user PIN and PUK and the Security Officer PIN and PUK.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-timeouts-in-sssd-conf_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.7. Configuring timeouts in sssd.conf\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAuthentication with a smart card certificate might take longer than the default timeouts used by SSSD. Time out expiration can be caused by:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSlow reader\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA forwarding form a physical device into a virtual environment\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tToo many certificates stored on the smart card\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSlow response from the OCSP (Online Certificate Status Protocol) responder if OCSP is used to verify the certificates\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIn this case you can prolong the following timeouts in the \u003Ccode class=\"literal\">sssd.conf\u003C/code> file, for example, to 60 seconds:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">p11_child_timeout\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">krb5_auth_timeout\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou must be logged in as root.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">sssd.conf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient1 ~]# vim /etc/sssd/sssd.conf\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the value of \u003Ccode class=\"literal\">p11_child_timeout\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[pam]\np11_child_timeout = 60\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the value of \u003Ccode class=\"literal\">krb5_auth_timeout\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[domain/IDM.EXAMPLE.COM]\nkrb5_auth_timeout = 60\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the settings.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tNow, the interaction with the smart card is allowed to run for 1 minute (60 seconds) before authentication will fail with a timeout.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"certificate-mapping-rules-for-smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.8. Creating certificate mapping rules for smart card authentication\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIf you want to use one certificate for a user who has accounts in AD (Active Directory) and in IdM (Identity Management), you can create a certificate mapping rule on the IdM server.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAfter creating such a rule, the user is able to authenticate with their smart card in both domains.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor details about certificate mapping rules, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/con-idm-certmapdata_managing-smart-card-authentication\">Certificate mapping rules for configuring authentication\u003C/a>.\n\t\t\t\u003C/p>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"conf-certmap-idm_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 10. Configuring certificate mapping rules in Identity Management\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tCertificate mapping rules are a convenient way of allowing users to authenticate using certificates in scenarios when the Identity Management (IdM) administrator does not have access to certain users' certificates. This is typically because the certificates have been issued by an external certificate authority.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"con-idm-certmapdata_conf-certmap-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.1. Certificate mapping rules for configuring authentication\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou might need to configure certificate mapping rules in the following scenarios:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCertificates have been issued by the Certificate System of the Active Directory (AD) with which the IdM domain is in a trust relationship.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCertificates have been issued by an external certificate authority.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM environment is large with many users using smart cards. In this case, adding full certificates can be complicated. The subject and issuer are predictable in most scenarios and therefore easier to add ahead of time than the full certificate.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tAs a system administrator, you can create a certificate mapping rule and add certificate mapping data to a user entry even before a certificate is issued to a particular user. Once the certificate is issued, the user can log in using the certificate even though the full certificate has not yet been uploaded to the user entry.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn addition, as certificates are renewed at regular intervals, certificate mapping rules reduce administrative overhead. When a user’s certificate is renewed, the administrator does not have to update the user entry. For example, if the mapping is based on the \u003Ccode class=\"literal\">Subject\u003C/code> and \u003Ccode class=\"literal\">Issuer\u003C/code> values, and if the new certificate has the same subject and issuer as the old one, the mapping still applies. If, in contrast, the full certificate was used, then the administrator would have to upload the new certificate to the user entry to replace the old one.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo set up certificate mapping:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn administrator has to load the certificate mapping data or the full certificate into a user account.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn administrator has to create a certificate mapping rule to allow successful logging into IdM for a user whose account contains a certificate mapping data entry that matches the information on the certificate.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tOnce the certificate mapping rules have been created, when the end-user presents the certificate, stored either on a \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/dc-web-ui-auth_managing-certificates-in-idm\">filesystem\u003C/a> or a \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication#logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth\">smart card\u003C/a>, authentication is successful.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe Key Distribution Center (KDC) has a cache for certificate mapping rules. The cache is populated on the first \u003Ccode class=\"literal\">certauth\u003C/code> request and it has a hard-coded timeout of 300 seconds. KDC will not see any changes to certificate mapping rules unless it is restarted or the cache expires.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tFor details on the individual components that make up a mapping rule and how to obtain and use them, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#sc-id-mapping_conf-certmap-idm\">Components of an identity mapping rule in IdM\u003C/a> and \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#sc-id-issuer-obtain-example_conf-certmap-idm\">Obtaining the issuer from a certificate for use in a matching rule\u003C/a>.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYour certificate mapping rules can depend on the use case for which you are using the certificate. For example, if you are using SSH with certificates, you must have the full certificate to extract the public key from the certificate.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"sc-id-mapping_conf-certmap-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.2. Components of an identity mapping rule in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou configure different components when creating an \u003Cspan class=\"emphasis\">\u003Cem>identity mapping rule\u003C/em>\u003C/span> in IdM. Each component has a default value that you can override. You can define the components in either the web UI or the CLI. In the CLI, the identity mapping rule is created using the \u003Ccode class=\"literal\">ipa certmaprule-add\u003C/code> command.\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Mapping rule\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe mapping rule component associates (or \u003Cspan class=\"emphasis\">\u003Cem>maps\u003C/em>\u003C/span>) a certificate with one or more user accounts. The rule defines an LDAP search filter that associates a certificate with the intended user account.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCertificates issued by different certificate authorities (CAs) might have different properties and might be used in different domains. Therefore, IdM does not apply mapping rules unconditionally, but only to the appropriate certificates. The appropriate certificates are defined using \u003Cspan class=\"emphasis\">\u003Cem>matching rules\u003C/em>\u003C/span>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that if you leave the mapping rule option empty, the certificates are searched in the \u003Ccode class=\"literal\">userCertificate\u003C/code> attribute as a DER encoded binary file.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDefine the mapping rule in the CLI using the \u003Ccode class=\"literal\">--maprule\u003C/code> option.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Matching rule\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe matching rule component selects a certificate to which you want to apply the mapping rule. The default matching rule matches certificates with the \u003Ccode class=\"literal\">digitalSignature key\u003C/code> usage and \u003Ccode class=\"literal\">clientAuth extended key\u003C/code> usage.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDefine the matching rule in the CLI using the \u003Ccode class=\"literal\">--matchrule\u003C/code> option.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Domain list\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe domain list specifies the identity domains in which you want IdM to search the users when processing identity mapping rules. If you leave the option unspecified, IdM searches the users only in the local domain to which the IdM client belongs.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDefine the domain in the CLI using the \u003Ccode class=\"literal\">--domain\u003C/code> option.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Priority\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tWhen multiple rules are applicable to a certificate, the rule with the highest priority takes precedence. All other rules are ignored.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe lower the numerical value, the higher the priority of the identity mapping rule. For example, a rule with a priority 1 has higher priority than a rule with a priority 2.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tIf a rule has no priority value defined, it has the lowest priority.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDefine the mapping rule priority in the CLI using the \u003Ccode class=\"literal\">--priority\u003C/code> option.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Certificate mapping rule example\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tTo define, using the CLI, a certificate mapping rule called \u003Ccode class=\"literal\">simple_rule\u003C/code> that allows authentication for a certificate issued by the \u003Ccode class=\"literal\">Smart Card CA\u003C/code> of the \u003Ccode class=\"literal\">EXAMPLE.ORG\u003C/code> organization if the \u003Ccode class=\"literal\">Subject\u003C/code> on that certificate matches a \u003Ccode class=\"literal\">certmapdata\u003C/code> entry in a user account in IdM:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa certmaprule-add simple_rule --matchrule '&lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG' --maprule '(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})'\u003C/strong>\u003C/span>\u003C/pre>\u003C/section>\u003Csection class=\"section\" id=\"sc-id-issuer-obtain-example_conf-certmap-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.3. Obtaining data from a certificate for use in a matching rule\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThis procedure describes how to obtain data from a certificate so that you can copy and paste it into the matching rule of a certificate mapping rule. To get data required by a matching rule, use the \u003Ccode class=\"literal\">sssctl cert-show\u003C/code> or \u003Ccode class=\"literal\">sssctl cert-eval-rule\u003C/code> commands.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the user certificate in PEM format.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a variable pointing to your certificate that also ensures it is correctly encoded so you can retrieve the required data.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># CERT=$(openssl x509 -in /path/to/certificate -outform der|base64 -w0)\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">sssctl cert-eval-rule\u003C/code> to determine the matching data. In the following example the certificate serial number is used.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># sssctl cert-eval-rule $CERT --match='&lt;ISSUER&gt;CN=adcs19-WIN1-CA,DC=AD,DC=EXAMPLE,DC=COM' --map='LDAPU1:(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;SR&gt;{serial_number!hex_ur})'\nCertificate matches rule.\nMapping filter:\n\n    (altSecurityIdentities=X509:&lt;I&gt;DC=com,DC=example,DC=ad,CN=adcs19-WIN1-CA&lt;SR&gt;0F0000000000DB8852DD7B246C9C0F0000003B)\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn this case, add everything after \u003Ccode class=\"literal\">altSecurityIdentities=\u003C/code> to the \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> attribute in AD for the user. If using SKI mapping, use \u003Ccode class=\"literal\">--map='LDAPU1:(altSecurityIdentities=X509:&lt;SKI&gt;{subject_key_id!hex_u})'\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To create a new mapping rule in the CLI based on a matching rule which specifies that the certificate issuer must match \u003Ccode class=\"literal\">adcs19-WIN1-CA\u003C/code> of the \u003Ccode class=\"literal\">ad.example.com\u003C/code> domain and the serial number of the certificate must match the \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> entry in a user account:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa certmaprule-add simple_rule --matchrule '&lt;ISSUER&gt;CN=adcs19-WIN1-CA,DC=AD,DC=EXAMPLE,DC=COM' --maprule 'LDAPU1:(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;SR&gt;{serial_number!hex_ur})'\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"conf-certmap-for-users-in-idm_conf-certmap-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.4. Configuring certificate mapping for users stored in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo enable certificate mapping in IdM if the user for whom certificate authentication is being configured is stored in IdM, a system administrator must complete the following tasks:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSet up a certificate mapping rule so that IdM users with certificates that match the conditions specified in the mapping rule and in their certificate mapping data entries can authenticate to IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnter certificate mapping data to an IdM user entry so that the user can authenticate using multiple certificates provided that they all contain the values specified in the certificate mapping data entry.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user has an account in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe administrator has either the whole certificate or the certificate mapping data to add to the user entry.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"proc-add-maprule-webui_conf-certmap-for-users-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.4.1. Adding a certificate mapping rule in the IdM web UI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tLog in to the IdM web UI as an administrator.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Authentication\u003C/code> → \u003Ccode class=\"literal\">Certificate Identity Mapping Rules\u003C/code> → \u003Ccode class=\"literal\">Certificate Identity Mapping Rules\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"conf-certmap-for-users-in-idm-new-certmaprule-add\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.1. Adding a new certificate mapping rule in the IdM web UI\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/72c74881008431b50032e8e3f9bec734/new-certmaprule-add.png\" alt=\"Screenshot of the IdM Web UI displaying the &quot;Certificate Identity Mapping Rules&quot; sub-tab from the Authentication tab. The &quot;Add&quot; button at the right of the page is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tEnter the rule name.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the mapping rule. For example, to make IdM search for the \u003Ccode class=\"literal\">Issuer\u003C/code> and \u003Ccode class=\"literal\">Subject\u003C/code> entries in any certificate presented to them, and base its decision to authenticate or not on the information found in these two entries of the presented certificate:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the matching rule. For example, to only allow certificates issued by the \u003Ccode class=\"literal\">Smart Card CA\u003C/code> of the \u003Ccode class=\"literal\">EXAMPLE.ORG\u003C/code> organization to authenticate users to IdM:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>&lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"figure\" id=\"conf-certmap-for-users-in-idm-certmaprule-add-details\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.2. Entering the details for a certificate mapping rule in the IdM web UI\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/c96905d9c2af05053c843cba58f6a92e/certmaprule-add-details1.png\" alt=\"Screenshot of the &quot;Add Certificate Identity Mapping Rule&quot; pop-up window with the following fields filled in: Rule name (which is required) - Mapping rule - Matching rule. The Priority field is blank and there is also an Add button next to the Domain name label.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code> at the bottom of the dialog box to add the rule and close the box.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sssd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\t\tNow you have a certificate mapping rule set up that compares the type of data specified in the mapping rule that it finds on a smart card certificate with the certificate mapping data in your IdM user entries. Once it finds a match, it authenticates the matching user.\n\t\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"proc-add-maprule-cli_conf-certmap-for-users-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.4.2. Adding a certificate mapping rule in the IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tObtain the administrator’s credentials:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the mapping rule and the matching rule the mapping rule is based on. For example, to make IdM search for the \u003Ccode class=\"literal\">Issuer\u003C/code> and \u003Ccode class=\"literal\">Subject\u003C/code> entries in any certificate presented, and base its decision to authenticate or not on the information found in these two entries of the presented certificate, recognizing only certificates issued by the \u003Ccode class=\"literal\">Smart Card CA\u003C/code> of the \u003Ccode class=\"literal\">EXAMPLE.ORG\u003C/code> organization:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa certmaprule-add \u003Ccode class=\"literal\">rule_name\u003C/code> --matchrule '&lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG' --maprule '(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})'\u003C/strong>\u003C/span>\n-------------------------------------------------------\nAdded Certificate Identity Mapping Rule \"rule_name\"\n-------------------------------------------------------\n  Rule name: rule_name\n  Mapping rule: (ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})\n  Matching rule: &lt;ISSUER&gt;CN=Smart Card CA,O=EXAMPLE.ORG\n  Enabled: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sssd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\t\tNow you have a certificate mapping rule set up that compares the type of data specified in the mapping rule that it finds on a smart card certificate with the certificate mapping data in your IdM user entries. Once it finds a match, it authenticates the matching user.\n\t\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"proc-add-certmapdata-to-user-webui_conf-certmap-for-users-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.4.3. Adding certificate mapping data to a user entry in the IdM web UI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tLog into the IdM web UI as an administrator.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Users\u003C/code> → \u003Ccode class=\"literal\">Active users\u003C/code> → \u003Ccode class=\"literal\">idm_user\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tFind the \u003Ccode class=\"literal\">Certificate mapping data\u003C/code> option and click \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tChoose one of the following options:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you have the certificate of \u003Ccode class=\"literal\">idm_user\u003C/code>:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tIn the command-line interface, display the certificate using the \u003Ccode class=\"literal\">cat\u003C/code> utility or a text editor:\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>cat idm_user_certificate.pem\u003C/strong>\u003C/span>\n-----BEGIN CERTIFICATE-----\nMIIFFTCCA/2gAwIBAgIBEjANBgkqhkiG9w0BAQsFADA6MRgwFgYDVQQKDA9JRE0u\nRVhBTVBMRS5DT00xHjAcBgNVBAMMFUNlcnRpZmljYXRlIEF1dGhvcml0eTAeFw0x\nODA5MDIxODE1MzlaFw0yMDA5MDIxODE1MzlaMCwxGDAWBgNVBAoMD0lETS5FWEFN\n[...output truncated...]\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tCopy the certificate.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tIn the IdM web UI, click \u003Ccode class=\"literal\">Add\u003C/code> next to \u003Ccode class=\"literal\">Certificate\u003C/code> and paste the certificate into the window that opens up.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"conf-certmap-for-users-in-idm-add-user-certmapdata-cert\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.3. Adding a user’s certificate mapping data: certificate\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/e379f8fc7f76ae285ab18d034ee34b47/user-add-cert.png\" alt=\"Screenshot of a page displaying settings for the user &quot;demouser&quot; with an Identity Settings column on the left with entries such as Job Title - First name - Last name - Full name - Display name. The &quot;Account Settings&quot; column is on the right with entries such as User login - Password - UID - GID. The &quot;Add&quot; button for the &quot;Certificates&quot; entry is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tIf you do not have the certificate of \u003Ccode class=\"literal\">idm_user\u003C/code> at your disposal but know the \u003Ccode class=\"literal\">Issuer\u003C/code> and the \u003Ccode class=\"literal\">Subject\u003C/code> of the certificate, check the radio button of \u003Ccode class=\"literal\">Issuer and subject\u003C/code> and enter the values in the two respective boxes.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"figure\" id=\"conf-certmap-for-users-in-idm-add-user-certmapdata-data\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.4. Adding a user’s certificate mapping data: issuer and subject\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/3485df444832373a38a8aa2a047bbf71/user-add-certdata.png\" alt=\"Screenshot of the &quot;Add Certificate Mapping Data&quot; pop-up window with two radial button options: &quot;Certificate mapping data&quot; and &quot;Issuer and subject.&quot; &quot;Issuer and subject&quot; is selected and its two fields (Issuer and Subject) have been filled out.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\tIf you have access to the whole certificate in the \u003Ccode class=\"literal\">.pem\u003C/code> format, verify that the user and certificate are linked:\n\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">sss_cache\u003C/code> utility to invalidate the record of \u003Ccode class=\"literal\">idm_user\u003C/code> in the SSSD cache and force a reload of the \u003Ccode class=\"literal\">idm_user\u003C/code> information:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>sss_cache -u idm_user\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the \u003Ccode class=\"literal\">ipa certmap-match\u003C/code> command with the name of the file containing the certificate of the IdM user:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa certmap-match idm_user_cert.pem\u003C/strong>\u003C/span>\n--------------\n1 user matched\n--------------\n Domain: IDM.EXAMPLE.COM\n User logins: idm_user\n----------------------------\nNumber of entries returned 1\n----------------------------\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe output confirms that now you have certificate mapping data added to \u003Ccode class=\"literal\">idm_user\u003C/code> and that a corresponding mapping rule exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as \u003Ccode class=\"literal\">idm_user\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc-add-certmapdata-to-user-cli_conf-certmap-for-users-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.4.4. Adding certificate mapping data to a user entry in the IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tObtain the administrator’s credentials:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tChoose one of the following options:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tIf you have the certificate of \u003Ccode class=\"literal\">idm_user\u003C/code>, add the certificate to the user account using the \u003Ccode class=\"literal\">ipa user-add-cert\u003C/code> command:\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>CERT=$(openssl x509 -in idm_user_cert.pem -outform der|base64 -w0)\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-add-certmapdata idm_user --certificate $CERT\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you do not have the certificate of \u003Ccode class=\"literal\">idm_user\u003C/code> but know the \u003Ccode class=\"literal\">Issuer\u003C/code> and the \u003Ccode class=\"literal\">Subject\u003C/code> of the user’s certificate:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-add-certmapdata idm_user --subject \"O=EXAMPLE.ORG,CN=test\" --issuer \"CN=Smart Card CA,O=EXAMPLE.ORG\"\u003C/strong>\u003C/span>\n--------------------------------------------\nAdded certificate mappings to user \"idm_user\"\n--------------------------------------------\n  User login: idm_user\n  Certificate mapping data: X509:&lt;I&gt;O=EXAMPLE.ORG,CN=Smart Card CA&lt;S&gt;CN=test,O=EXAMPLE.ORG\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\tIf you have access to the whole certificate in the \u003Ccode class=\"literal\">.pem\u003C/code> format, verify that the user and certificate are linked:\n\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">sss_cache\u003C/code> utility to invalidate the record of \u003Ccode class=\"literal\">idm_user\u003C/code> in the SSSD cache and force a reload of the \u003Ccode class=\"literal\">idm_user\u003C/code> information:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>sss_cache -u idm_user\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the \u003Ccode class=\"literal\">ipa certmap-match\u003C/code> command with the name of the file containing the certificate of the IdM user:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa certmap-match idm_user_cert.pem\u003C/strong>\u003C/span>\n--------------\n1 user matched\n--------------\n Domain: IDM.EXAMPLE.COM\n User logins: idm_user\n----------------------------\nNumber of entries returned 1\n----------------------------\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe output confirms that now you have certificate mapping data added to \u003Ccode class=\"literal\">idm_user\u003C/code> and that a corresponding mapping rule exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as \u003Ccode class=\"literal\">idm_user\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"con-idm-ad-certmapdata_conf-certmap-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.5. Certificate mapping rules for trusts with Active Directory domains\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tDifferent certificate mapping use cases are possible if an IdM deployment is in a trust relationship with an Active Directory (AD) domain.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDepending on the AD configuration, the following scenarios are possible:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf the certificate is issued by AD Certificate System but the user and the certificate are stored in IdM, the mapping and the whole processing of the authentication request takes place on the IdM side. For details of configuring this scenario, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-users-in-idm_conf-certmap-idm\">Configuring certificate mapping for users stored in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the user is stored in AD, the processing of the authentication request takes place in AD. There are three different subcases:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe AD user entry contains the whole certificate. For details how to configure IdM in this scenario, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-ad-certs_conf-certmap-idm\">Configuring certificate mapping for users whose AD user entry contains the whole certificate\u003C/a>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAD is configured to map user certificates to user accounts. In this case, the AD user entry does not contain the whole certificate but instead contains an attribute called \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code>. For details how to configure IdM in this scenario, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-ad-map_conf-certmap-idm\">Configuring certificate mapping if AD is configured to map user certificates to user accounts\u003C/a>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe AD user entry contains neither the whole certificate nor the mapping data. In this case, there are two options:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"square\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIf the user certificate is issued by AD Certificate System, the certificate either contains the user principal name as the Subject Alternative Name (SAN) or, if the latest updates are applied to AD, the SID of the user in the SID extension of the certificate. Both of these can be used to map the certificate to the user.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIf the user certificate is on a smart card, to enable SSH with smart cards, SSSD must derive the public SSH key from the certificate and therefore the full certificate is required. The only solution is to use the \u003Ccode class=\"literal\">ipa idoverrideuser-add\u003C/code> command to add the whole certificate to the AD user’s ID override in IdM. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map\">Configuring certificate mapping if AD user entry contains no certificate or mapping data\u003C/a>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tAD domain administrators can manually map certificates to a user in AD using the \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> attribute. There are six supported values for this attribute, though three mappings are considered insecure. As part of \u003Ca class=\"link\" href=\"https://support.microsoft.com/en-us/topic/kb5014754-certificate-based-authentication-changes-on-windows-domain-controllers-ad2c23b0-15d8-4340-a468-4d4f3b188f16\">May 10,2022 security update\u003C/a>, once it is installed, all devices are in compatibility mode and if a certificate is weakly mapped to a user, authentication occurs as expected. However, warning messages are logged identifying any certificates that are not compatible with full enforcement mode. As of November 14, 2023 or later, all devices will be updated to full enforcement mode and if a certificate fails the strong mapping criteria, authentication will be denied.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor example, when an AD user requests an IdM Kerberos ticket with a certificate (PKINIT), AD needs to map the certificate to a user internally and uses the new mapping rules for this. However in IdM, the previous rules continue to work if IdM is used to map a certificate to a user on an IdM client, .\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIdM supports the new mapping templates, making it easier for an AD administrator to use the new rules and not maintain both. IdM now supports the new mapping templates added to Active Directory to include:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSerial Number: LDAPU1:(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;SR&gt;{serial_number!hex_ur})\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSubject Key Id: LDAPU1:(altSecurityIdentities=X509:&lt;SKI&gt;{subject_key_id!hex_u})\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUser SID: LDAPU1:(objectsid={sid})\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIf you do not want to reissue certificates with the new SID extension, you can create a manual mapping by adding the appropriate mapping string to a user’s \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> attribute in AD.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"conf-certmap-for-ad-certs_conf-certmap-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.6. Configuring certificate mapping for users whose AD user entry contains the whole certificate\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThis user story describes the steps necessary for enabling certificate mapping in IdM if the IdM deployment is in trust with Active Directory (AD), the user is stored in AD and the user entry in AD contains the whole certificate.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user does not have an account in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user has an account in AD which contains a certificate.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM administrator has access to data on which the IdM certificate mapping rule can be based.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo ensure PKINIT works for a user, one of the following conditions must apply:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe certificate in the user entry includes the user principal name or the SID extension for the user.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe user entry in AD has a suitable entry in the \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> attribute.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Csection class=\"section\" id=\"proc-add-maprule-webui-ad-cert_conf-certmap-for-ad-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.6.1. Adding a certificate mapping rule in the IdM web UI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tLog into the IdM web UI as an administrator.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Authentication\u003C/code> → \u003Ccode class=\"literal\">Certificate Identity Mapping Rules\u003C/code> → \u003Ccode class=\"literal\">Certificate Identity Mapping Rules\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"conf-certmap-for-ad-certs-new-certmaprule-add-ad-cert\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.5. Adding a new certificate mapping rule in the IdM web UI\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/72c74881008431b50032e8e3f9bec734/new-certmaprule-add.png\" alt=\"Screenshot of the IdM Web UI displaying the &quot;Certificate Identity Mapping Rules&quot; sub-page from the Authentication tab. The &quot;Add&quot; button to the right is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tEnter the rule name.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the mapping rule. To have the whole certificate that is presented to IdM for authentication compared to what is available in AD:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>(userCertificate;binary={cert!bin})\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tIf mapping using the full certificate, if you renew the certificate, you must ensure that you add the new certificate to the AD user object.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the matching rule. For example, to only allow certificates issued by the \u003Ccode class=\"literal\">AD-ROOT-CA\u003C/code> of the \u003Ccode class=\"literal\">AD.EXAMPLE.COM\u003C/code> domain to authenticate:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"figure\" id=\"conf-certmap-for-ad-certs-certmaprule-add-details-ad-cert\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.6. Certificate mapping rule for a user with a certificate stored in AD\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/fc7ffb80cb1b02342a6f849e01be408a/certmaprule-add-details-ad-cert.png\" alt=\"Screenshot of the &quot;Add Certificate Identity Mapping Rule&quot; pop-up window with the following fields filled in: Rule name (which is required) - Mapping rule - Matching rule. The Priority field is blank and there is also an &quot;Add&quot; button next to the &quot;Domain name&quot; label.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD in the CLI::\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sssd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc-add-maprule-cli-ad-cert_conf-certmap-for-ad-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.6.2. Adding a certificate mapping rule in the IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tObtain the administrator’s credentials:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the mapping rule and the matching rule the mapping rule is based on. To have the whole certificate that is presented for authentication compared to what is available in AD, only allowing certificates issued by the \u003Ccode class=\"literal\">AD-ROOT-CA\u003C/code> of the \u003Ccode class=\"literal\">AD.EXAMPLE.COM\u003C/code> domain to authenticate:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa certmaprule-add \u003Ccode class=\"literal\">simpleADrule\u003C/code> --matchrule '&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' --maprule '(userCertificate;binary={cert!bin})' --domain ad.example.com\u003C/strong>\u003C/span>\n-------------------------------------------------------\nAdded Certificate Identity Mapping Rule \"simpleADrule\"\n-------------------------------------------------------\n  Rule name: simpleADrule\n  Mapping rule: (userCertificate;binary={cert!bin})\n  Matching rule: &lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com\n  Domain name: ad.example.com\n  Enabled: TRUE\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tIf mapping using the full certificate, if you renew the certificate, you must ensure that you add the new certificate to the AD user object.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sssd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"conf-certmap-for-ad-map_conf-certmap-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.7. Configuring certificate mapping if AD is configured to map user certificates to user accounts\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThis user story describes the steps necessary for enabling certificate mapping in IdM if the IdM deployment is in trust with Active Directory (AD), the user is stored in AD, and the user entry in AD contains certificate mapping data.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user does not have an account in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user has an account in AD which contains the \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> attribute, the AD equivalent of the IdM \u003Ccode class=\"literal\">certmapdata\u003C/code> attribute.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM administrator has access to data on which the IdM certificate mapping rule can be based.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"proc-add-ad-maprule-webui_conf-certmap-for-ad-map\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.7.1. Adding a certificate mapping rule in the IdM web UI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tLog into the IdM web UI as an administrator.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Authentication\u003C/code> → \u003Ccode class=\"literal\">Certificate Identity Mapping Rules\u003C/code> → \u003Ccode class=\"literal\">Certificate Identity Mapping Rules\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"conf-certmap-for-ad-map-new-certmaprule-add-ad-map\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.7. Adding a new certificate mapping rule in the IdM web UI\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/72c74881008431b50032e8e3f9bec734/new-certmaprule-add.png\" alt=\"Screenshot of the IdM Web UI displaying the &quot;Certificate Identity Mapping Rules&quot; sub-tab from the Authentication tab. The &quot;Add&quot; button at the right of the page is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tEnter the rule name.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the mapping rule. For example, to make AD DC search for the \u003Ccode class=\"literal\">Issuer\u003C/code> and \u003Ccode class=\"literal\">Subject\u003C/code> entries in any certificate presented, and base its decision to authenticate or not on the information found in these two entries of the presented certificate:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500})\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the matching rule. For example, to only allow certificates issued by the \u003Ccode class=\"literal\">AD-ROOT-CA\u003C/code> of the \u003Ccode class=\"literal\">AD.EXAMPLE.COM\u003C/code> domain to authenticate users to IdM:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the domain:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>ad.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"figure\" id=\"conf-certmap-for-ad-map-certmaprule-add-details-ad-map\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.8. Certificate mapping rule if AD is configured for mapping\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/ed680029d040c1716bf14840355019b8/certmaprule-add-details-ad-map.png\" alt=\"Screenshot of the &quot;Add Certificate Identity Mapping Rule&quot; pop-up window with the following fields filled in: Rule name (which is required) - Mapping rule - Matching rule. The &quot;Priority&quot; field is blank and there is also an &quot;Add&quot; button next to the &quot;Domain name&quot; label.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD in the CLI::\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sssd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc-add-ad-maprule-cli_conf-certmap-for-ad-map\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.7.2. Adding a certificate mapping rule in the IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tObtain the administrator’s credentials:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the mapping rule and the matching rule the mapping rule is based on. For example, to make AD search for the \u003Ccode class=\"literal\">Issuer\u003C/code> and \u003Ccode class=\"literal\">Subject\u003C/code> entries in any certificate presented, and only allow certificates issued by the \u003Ccode class=\"literal\">AD-ROOT-CA\u003C/code> of the \u003Ccode class=\"literal\">AD.EXAMPLE.COM\u003C/code> domain:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa certmaprule-add ad_configured_for_mapping_rule --matchrule '&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' --maprule '(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500})' --domain=ad.example.com\u003C/strong>\u003C/span>\n-------------------------------------------------------\nAdded Certificate Identity Mapping Rule \"ad_configured_for_mapping_rule\"\n-------------------------------------------------------\n  Rule name: ad_configured_for_mapping_rule\n  Mapping rule: (altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500})\n  Matching rule: &lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com\n  Domain name: ad.example.com\n  Enabled: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sssd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"check-if-ad-maprule-exists_conf-certmap-for-ad-map\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.7.3. Checking certificate mapping data on the AD side\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tThe \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> attribute is the Active Directory (AD) equivalent of \u003Ccode class=\"literal\">certmapdata\u003C/code> user attribute in IdM. When configuring certificate mapping in IdM in the scenario when a trusted AD domain is configured to map user certificates to user accounts, the IdM system administrator needs to check that the \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> attribute is set correctly in the user entries in AD.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe user account must have user administration access.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo check that AD contains the right information for the user stored in AD, use the \u003Ccode class=\"literal\">ldapsearch\u003C/code> command. For example, enter the command below to check with the \u003Ccode class=\"literal\">adserver.ad.example.com\u003C/code> server that the following conditions apply:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> attribute is set in the user entry of \u003Ccode class=\"literal\">ad_user\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tThe matchrule stipulates that the following conditions apply:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"square\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tThe certificate that \u003Ccode class=\"literal\">ad_user\u003C/code> uses to authenticate to AD was issued by \u003Ccode class=\"literal\">AD-ROOT-CA\u003C/code> of the \u003Ccode class=\"literal\">ad.example.com\u003C/code> domain.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tThe subject is \u003Ccode class=\"literal\">&lt;S&gt;DC=com,DC=example,DC=ad,CN=Users,CN=ad_user\u003C/code>:\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ldapsearch -o ldif-wrap=no -LLL -h adserver.ad.example.com\u003C/strong>\u003C/span> \\\n\u003Cspan class=\"strong strong\">\u003Cstrong>-p 389 -D cn=Administrator,cn=users,dc=ad,dc=example,dc=com\u003C/strong>\u003C/span> \\\n\u003Cspan class=\"strong strong\">\u003Cstrong>-W -b cn=users,dc=ad,dc=example,dc=com \"(cn=ad_user)\"\u003C/strong>\u003C/span> \\\n\u003Cspan class=\"strong strong\">\u003Cstrong>altSecurityIdentities\u003C/strong>\u003C/span>\nEnter LDAP Password:\ndn: CN=ad_user,CN=Users,DC=ad,DC=example,DC=com\naltSecurityIdentities: X509:&lt;I&gt;DC=com,DC=example,DC=ad,CN=AD-ROOT-CA&lt;S&gt;DC=com,DC=example,DC=ad,CN=Users,CN=ad_user\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.8. Configuring certificate mapping if AD user entry contains no certificate or mapping data\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThis user story describes the steps necessary for enabling certificate mapping in IdM if the IdM deployment is in trust with Active Directory (AD), the user is stored in AD and the user entry in AD contains neither the whole certificate nor certificate mapping data.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user does not have an account in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user has an account in AD which contains neither the whole certificate nor the \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> attribute, the AD equivalent of the IdM \u003Ccode class=\"literal\">certmapdata\u003C/code> attribute.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe IdM administrator has done one of the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdded the whole AD user certificate to the AD user’s \u003Ccode class=\"literal\">user ID override\u003C/code> in IdM.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tCreated a certificate mapping rule that maps to an alternative field in the certificate, such as Subject Alternative Name or the SID of the user.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"proc-add-certmaprule-ad-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.8.1. Adding a certificate mapping rule in the IdM web UI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tLog into the IdM web UI as an administrator.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Authentication\u003C/code> → \u003Ccode class=\"literal\">Certificate Identity Mapping Rules\u003C/code> → \u003Ccode class=\"literal\">Certificate Identity Mapping Rules\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"conf-certmap-ad-no-cert-no-map-new-certmaprule-add-ad-no-cert-no-map\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.9. Adding a new certificate mapping rule in the IdM web UI\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/72c74881008431b50032e8e3f9bec734/new-certmaprule-add.png\" alt=\"Screenshot of the IdM Web UI displaying the &quot;Certificate Identity Mapping Rules&quot; sub-page from the Authentication tab. The &quot;Add&quot; button to the right is highlighted\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tEnter the rule name.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the mapping rule. To have the whole certificate that is presented to IdM for authentication compared to the certificate stored in the user ID override entry of the AD user entry in IdM:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>(userCertificate;binary={cert!bin})\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tAs the certificate also contains the user principal name as the SAN, or with the latest updates, the SID of the user in the SID extension of the certificate, you can also use these fields to map the certificate to the user. For example, if using the SID of the user, replace this mapping rule with \u003Ccode class=\"literal\">LDAPU1:(objectsid={sid})\u003C/code>. For more information on certificate mapping, see the \u003Ccode class=\"literal\">sss-certmap\u003C/code> man page on your system.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the matching rule. For example, to only allow certificates issued by the \u003Ccode class=\"literal\">AD-ROOT-CA\u003C/code> of the \u003Ccode class=\"literal\">AD.EXAMPLE.COM\u003C/code> domain to authenticate:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the domain name. For example, to search for users in the \u003Ccode class=\"literal\">ad.example.com\u003C/code> domain:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"conf-certmap-ad-no-cert-no-map-certmaprule-add-details-ad-no-cert-no-map\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.10. Certificate mapping rule for a user with no certificate or mapping data stored in AD\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/fc7ffb80cb1b02342a6f849e01be408a/certmaprule-add-details-ad-cert.png\" alt=\"Screenshot of the &quot;Add Certificate Identity Mapping Rule&quot; pop-up window with the following fields filled in: Rule name (which is required) - Mapping rule - Matching rule. The &quot;Priority&quot; field is blank and there is also an Add button next to the &quot;Domain name&quot; label.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD in the CLI:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sssd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc-add-certmaprule-ad-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.8.2. Adding a certificate mapping rule in the IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tObtain the administrator’s credentials:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the mapping rule and the matching rule the mapping rule is based on. To have the whole certificate that is presented for authentication compared to the certificate stored in the user ID override entry of the AD user entry in IdM, only allowing certificates issued by the \u003Ccode class=\"literal\">AD-ROOT-CA\u003C/code> of the \u003Ccode class=\"literal\">AD.EXAMPLE.COM\u003C/code> domain to authenticate:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa certmaprule-add \u003Ccode class=\"literal\">simpleADrule\u003C/code> --matchrule '&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' --maprule '(userCertificate;binary={cert!bin})' --domain ad.example.com\u003C/strong>\u003C/span>\n-------------------------------------------------------\nAdded Certificate Identity Mapping Rule \"simpleADrule\"\n-------------------------------------------------------\n  Rule name: simpleADrule\n  Mapping rule: (userCertificate;binary={cert!bin})\n  Matching rule: &lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com\n  Domain name: ad.example.com\n  Enabled: TRUE\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tAs the certificate also contains the user principal name as the SAN, or with the latest updates, the SID of the user in the SID extension of the certificate, you can also use these fields to map the certificate to the user. For example, if using the SID of the user, replace this mapping rule with \u003Ccode class=\"literal\">LDAPU1:(objectsid={sid})\u003C/code>. For more information on certificate mapping, see the \u003Ccode class=\"literal\">sss-certmap\u003C/code> man page on your system.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe System Security Services Daemon (SSSD) periodically re-reads the certificate mapping rules. To force the newly-created rule to be loaded immediately, restart SSSD:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sssd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc-add-certmapdata-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.8.3. Adding a certificate to an AD user’s ID override in the IdM web UI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Identity\u003C/code> → \u003Ccode class=\"literal\">ID Views\u003C/code> → \u003Ccode class=\"literal\">Default Trust View\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"conf-certmap-ad-no-cert-no-map-new-useridoverride-add\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.11. Adding a new user ID override in the IdM web UI\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/e2cda7ac50cef2d6ce4cf2df7dff34a6/new-useridoverride-add.png\" alt=\"Screenshot of the IdM Web UI displaying the &quot;ID Views&quot; page from the Identity tab. The Add button on the right is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">User to override\u003C/code> field, enter \u003Ccode class=\"literal\">ad_user@ad.example.com\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCopy and paste the certificate of \u003Ccode class=\"literal\">ad_user\u003C/code> into the \u003Ccode class=\"literal\">Certificate\u003C/code> field.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"conf-certmap-ad-no-cert-no-map-useridoverride-add-details\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.12. Configuring the User ID override for an AD user\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/e089e03fcdb76a3eb2dd295322c51f54/useridoverride-add-details.png\" alt=\"Screenshot displaying the &quot;Add User ID override&quot; pop-up window with the following fields: User to override (which is required) - User login - GECOS - UID - GID - Certificate (which has been filled in with the plaintext version of a certificate).\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\tVerify that the user and certificate are linked:\n\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">sss_cache\u003C/code> utility to invalidate the record of \u003Ccode class=\"literal\">ad_user@ad.example.com\u003C/code> in the SSSD cache and force a reload of the \u003Ccode class=\"literal\">ad_user@ad.example.com\u003C/code> information:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>sss_cache -u ad_user@ad.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the \u003Ccode class=\"literal\">ipa certmap-match\u003C/code> command with the name of the file containing the certificate of the AD user:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa certmap-match ad_user_cert.pem\u003C/strong>\u003C/span>\n--------------\n1 user matched\n--------------\n Domain: AD.EXAMPLE.COM\n User logins: ad_user@ad.example.com\n----------------------------\nNumber of entries returned 1\n----------------------------\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\t\tThe output confirms that you have certificate mapping data added to \u003Ccode class=\"literal\">ad_user@ad.example.com\u003C/code> and that a corresponding mapping rule defined in \u003Ca class=\"link\" href=\"#conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map\" title=\"10.8. Configuring certificate mapping if AD user entry contains no certificate or mapping data\">Adding a certificate mapping rule if the AD user entry contains no certificate or mapping data\u003C/a> exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as \u003Ccode class=\"literal\">ad_user@ad.example.com\u003C/code>.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"_additional-resources _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/assembly_using-id-views-for-active-directory-users_managing-users-groups-hosts\">Using ID views for Active Directory users\u003C/a>\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc-add-certmapdata-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.8.4. Adding a certificate to an AD user’s ID override in the IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"orderedlist _abstract\">\u003Col class=\"orderedlist _abstract\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tObtain the administrator’s credentials:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tStore the certificate blob in a new variable called \u003Ccode class=\"literal\">CERT\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>CERT=$(openssl x509 -in /path/to/certificate -outform der|base64 -w0)\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAdd the certificate of \u003Ccode class=\"literal\">ad_user@ad.example.com\u003C/code> to the user account using the \u003Ccode class=\"literal\">ipa idoverrideuser-add-cert\u003C/code> command:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa idoverrideuser-add-cert ad_user@ad.example.com --certificate $CERT\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\tVerify that the user and certificate are linked:\n\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">sss_cache\u003C/code> utility to invalidate the record of \u003Ccode class=\"literal\">ad_user@ad.example.com\u003C/code> in the SSSD cache and force a reload of the \u003Ccode class=\"literal\">ad_user@ad.example.com\u003C/code> information:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>sss_cache -u ad_user@ad.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the \u003Ccode class=\"literal\">ipa certmap-match\u003C/code> command with the name of the file containing the certificate of the AD user:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa certmap-match ad_user_cert.pem\u003C/strong>\u003C/span>\n--------------\n1 user matched\n--------------\n Domain: AD.EXAMPLE.COM\n User logins: ad_user@ad.example.com\n----------------------------\nNumber of entries returned 1\n----------------------------\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\t\tThe output confirms that you have certificate mapping data added to \u003Ccode class=\"literal\">ad_user@ad.example.com\u003C/code> and that a corresponding mapping rule defined in \u003Ca class=\"link\" href=\"#conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map\" title=\"10.8. Configuring certificate mapping if AD user entry contains no certificate or mapping data\">Adding a certificate mapping rule if the AD user entry contains no certificate or mapping data\u003C/a> exists. This means that you can use any certificate that matches the defined certificate mapping data to authenticate as \u003Ccode class=\"literal\">ad_user@ad.example.com\u003C/code>.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"_additional-resources _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/assembly_using-id-views-for-active-directory-users_managing-users-groups-hosts\">Using ID views for Active Directory users\u003C/a>\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"sc-cert-mapping-rule-examples_conf-certmap-for-ad-map\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.9. Combining several identity mapping rules into one\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo combine several identity mapping rules into one combined rule, use the \u003Ccode class=\"literal\">|\u003C/code> (or) character to precede the individual mapping rules, and separate them using \u003Ccode class=\"literal\">()\u003C/code> brackets, for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Certificate mapping filter example 1\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\n\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa certmaprule-add ad_cert_for_ipa_and_ad_users \\ --maprule='(|(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}))' \\ --matchrule='&lt;ISSUER&gt;CN=AD-ROOT-CA,DC=ad,DC=example,DC=com' \\ --domain=ad.example.com\u003C/strong>\u003C/span>\u003C/pre>\n\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tIn the above example, the filter definition in the \u003Ccode class=\"literal option\">--maprule\u003C/code> option includes these criteria:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500}\u003C/code> is a filter that links the subject and issuer from a smart card certificate to the value of the \u003Ccode class=\"literal\">ipacertmapdata\u003C/code> attribute in an IdM user account, as described in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#proc-add-maprule-cli_conf-certmap-for-users-in-idm\">Adding a certificate mapping rule in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}\u003C/code> is a filter that links the subject and issuer from a smart card certificate to the value of the \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> attribute in an AD user account, as described in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-ad-map_conf-certmap-idm\">Adding a certificate mapping rule if the trusted AD domain is configured to map user certificates\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe addition of the \u003Ccode class=\"literal\">--domain=ad.example.com\u003C/code> option means that users mapped to a given certificate are not only searched in the local \u003Ccode class=\"literal\">idm.example.com\u003C/code> domain but also in the \u003Ccode class=\"literal\">ad.example.com\u003C/code> domain\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe filter definition in the \u003Ccode class=\"literal option\">--maprule\u003C/code> option accepts the logical operator \u003Ccode class=\"literal\">|\u003C/code> (or), so that you can specify multiple criteria. In this case, the rule maps all user accounts that meet at least one of the criteria.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Certificate mapping filter example 2\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\n\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa certmaprule-add ipa_cert_for_ad_users\u003C/strong>\u003C/span> \\\n  \u003Cspan class=\"strong strong\">\u003Cstrong>--maprule='(|(userCertificate;binary={cert!bin})(ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500})(altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}))'\u003C/strong>\u003C/span> \\\n  \u003Cspan class=\"strong strong\">\u003Cstrong>--matchrule='&lt;ISSUER&gt;CN=Certificate Authority,O=REALM.EXAMPLE.COM'\u003C/strong>\u003C/span> \\\n  \u003Cspan class=\"strong strong\">\u003Cstrong>--domain=idm.example.com --domain=ad.example.com\u003C/strong>\u003C/span>\u003C/pre>\n\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tIn the above example, the filter definition in the \u003Ccode class=\"literal option\">--maprule\u003C/code> option includes these criteria:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">userCertificate;binary={cert!bin}\u003C/code> is a filter that returns user entries that include the whole certificate. For AD users, creating this type of filter is described in detail in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map\">Adding a certificate mapping rule if the AD user entry contains no certificate or mapping data\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ipacertmapdata=X509:&lt;I&gt;{issuer_dn!nss_x500}&lt;S&gt;{subject_dn!nss_x500}\u003C/code> is a filter that links the subject and issuer from a smart card certificate to the value of the \u003Ccode class=\"literal\">ipacertmapdata\u003C/code> attribute in an IdM user account, as described in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-users-in-idm_conf-certmap-idm\">Adding a certificate mapping rule in IdM\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">altSecurityIdentities=X509:&lt;I&gt;{issuer_dn!ad_x500}&lt;S&gt;{subject_dn!ad_x500}\u003C/code> is a filter that links the subject and issuer from a smart card certificate to the value of the \u003Ccode class=\"literal\">altSecurityIdentities\u003C/code> attribute in an AD user account, as described in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm#conf-certmap-for-ad-map_conf-certmap-idm\">Adding a certificate mapping rule if the trusted AD domain is configured to map user certificates\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe filter definition in the \u003Ccode class=\"literal option\">--maprule\u003C/code> option accepts the logical operator \u003Ccode class=\"literal\">|\u003C/code> (or), so that you can specify multiple criteria. In this case, the rule maps all user accounts that meet at least one of the criteria.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_3\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.10. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sss-certmap(5)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"dc-web-ui-auth_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 11. Configuring authentication with a certificate stored on the desktop of an IdM client\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tBy configuring Identity Management (IdM), IdM system administrators can enable users to authenticate to the IdM web UI and command-line interface (CLI) using a certificate that a Certificate Authority (CA) has issued to the users. The certificate is stored on the desktop of an IdM client.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThe web browser can run on a system that is not part of the IdM domain.\n\t\t\u003C/p>\u003Cp>\n\t\t\tNote the following while configuring authentication with a certificate:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tyou can skip \u003Ca class=\"link\" href=\"#requesting-and-exporting-a-user-certificate_dc-web-ui-auth\" title=\"11.2. Requesting a new user certificate and exporting it to the client\">Requesting a new user certificate and exporting it to the client\u003C/a> if the user you want to authenticate using a certificate already has a certificate;\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tyou can skip \u003Ca class=\"link\" href=\"#proc_making-sure-the-certificate-and-user-are-linked-together_dc-web-ui-auth\" title=\"11.3. Making sure the certificate and user are linked together\">Making sure the certificate and user are linked together\u003C/a> if the user’s certificate has been issued by the IdM CA.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tOnly Identity Management users can log into the web UI using a certificate. Active Directory users can log in with their user name and password.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Csection class=\"section\" id=\"cert-idm-users-auth-preparing-the-server_dc-web-ui-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.1. Configuring the Identity Management Server for Certificate Authentication in the Web UI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs an Identity Management (IdM) administrator, you can allow users to use certificates to authenticate to your IdM environment.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tAs the Identity Management administrator:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn an Identity Management server, obtain administrator privileges and create a shell script to configure the server.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRun the \u003Ccode class=\"literal command\">ipa-advise config-server-for-smart-card-auth\u003C/code> command, and save its output to a file, for example \u003Ccode class=\"literal replaceable\">server_certificate_script.sh\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># kinit admin\n# ipa-advise config-server-for-smart-card-auth &gt; \u003Ccode class=\"literal replaceable\">server_certificate_script.sh\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd execute permissions to the file using the \u003Ccode class=\"literal\">chmod\u003C/code> utility:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># chmod +x \u003Ccode class=\"literal replaceable\">server_certificate_script.sh\u003C/code>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn all the servers in the Identity Management domain, run the \u003Ccode class=\"literal replaceable\">server_certificate_script.sh\u003C/code> script\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\twith the path of the IdM Certificate Authority certificate, \u003Ccode class=\"literal filename\">/etc/ipa/ca.crt\u003C/code>, as input if the IdM CA is the only certificate authority that has issued the certificates of the users you want to enable certificate authentication for:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Ccode class=\"literal replaceable\">./server_certificate_script.sh\u003C/code> \u003Ccode class=\"literal filename\">/etc/ipa/ca.crt\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\twith the paths leading to the relevant CA certificates as input if different external CAs signed the certificates of the users who you want to enable certificate authentication for:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Ccode class=\"literal replaceable\">./server_certificate_script.sh\u003C/code> \u003Ccode class=\"literal replaceable\">/tmp/ca1.pem\u003C/code> \u003Ccode class=\"literal replaceable\">/tmp/ca2.pem\u003C/code>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDo not forget to run the script on each new replica that you add to the system in the future if you want to have certificate authentication for users enabled in the whole topology.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"requesting-and-exporting-a-user-certificate_dc-web-ui-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.2. Requesting a new user certificate and exporting it to the client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs an Identity Management (IdM) administrator, you can create certificates for users in your IdM environment and export them to the IdM clients on which you want to enable certificate authentication for users.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou do not need to follow this procedure if the user you want to authenticate using a certificate already has a certificate.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Create a new directory, for example \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code>, and make it a temporary certificate database. When asked, create an NSS Certificate DB password to encrypt the keys to the certificate to be generated in a subsequent step:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># mkdir \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code>\n# certutil -N -d \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code>\nEnter a password which will be used to encrypt your keys.\nThe password should be at least 8 characters long,\nand should contain at least one non-alphabetic character.\n\nEnter new password:\nRe-enter password:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the certificate signing request (CSR) and redirect the output to a file. For example, to create a CSR with the name \u003Ccode class=\"literal replaceable\">certificate_request.csr\u003C/code> for a \u003Ccode class=\"literal replaceable\">4096\u003C/code> bit certificate for the \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> user in the \u003Ccode class=\"literal replaceable\">IDM.EXAMPLE.COM\u003C/code> realm, setting the nickname of the certificate private keys to \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> for easy findability, and setting the subject to \u003Ccode class=\"literal replaceable\">CN=idm_user,O=IDM.EXAMPLE.COM\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># certutil -R -d \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code> -a -g \u003Ccode class=\"literal replaceable\">4096\u003C/code> -n \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> -s \"CN=\u003Ccode class=\"literal replaceable\">idm_user\u003C/code>,O=IDM.EXAMPLE.COM\" &gt; \u003Ccode class=\"literal replaceable\">certificate_request.csr\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhen prompted, enter the same password that you entered when using \u003Ccode class=\"literal systemitem\">certutil\u003C/code> to create the temporary database. Then continue typing randlomly until told to stop:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Enter Password or Pin for \"NSS Certificate DB\":\n\nA random seed must be generated that will be used in the\ncreation of your key.  One of the easiest ways to create a\nrandom seed is to use the timing of keystrokes on a keyboard.\n\nTo begin, type keys on the keyboard until this progress meter\nis full.  DO NOT USE THE AUTOREPEAT FUNCTION ON YOUR KEYBOARD!\n\n\nContinue typing until the progress meter is full:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSubmit the certificate request file to the server. Specify the Kerberos principal to associate with the newly-issued certificate, the output file to store the certificate, and optionally the certificate profile. For example, to obtain a certificate of the \u003Ccode class=\"literal replaceable\">IECUserRoles\u003C/code> profile, a profile with added user roles extension, for the \u003Ccode class=\"literal replaceable\">idm_user\u003C/code>@\u003Ccode class=\"literal replaceable\">IDM.EXAMPLE.COM\u003C/code> principal, and save it in the \u003Ccode class=\"literal replaceable\">~/idm_user.pem\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa cert-request \u003Ccode class=\"literal replaceable\">certificate_request.csr\u003C/code> --principal=\u003Ccode class=\"literal replaceable\">idm_user\u003C/code>@\u003Ccode class=\"literal replaceable\">IDM.EXAMPLE.COM\u003C/code> --profile-id=\u003Ccode class=\"literal replaceable\">IECUserRoles\u003C/code> --certificate-out=\u003Ccode class=\"literal replaceable\">~/idm_user.pem\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the certificate to the NSS database. Use the \u003Ccode class=\"literal option\">-n\u003C/code> option to set the same nickname that you used when creating the CSR previously so that the certificate matches the private key in the NSS database. The \u003Ccode class=\"literal option\">-t\u003C/code> option sets the trust level. For details, see the certutil(1) man page. The \u003Ccode class=\"literal option\">-i\u003C/code> option specifies the input certificate file. For example, to add to the NSS database a certificate with the \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> nickname that is stored in the \u003Ccode class=\"literal replaceable\">~/idm_user.pem\u003C/code> file in the \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code> database:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># certutil -A -d \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code> -n \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> -t \"P,,\" -i \u003Ccode class=\"literal replaceable\">~/idm_user.pem\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the key in the NSS database does not show \u003Ccode class=\"literal replaceable\">(orphan)\u003C/code> as its nickname. For example, to verify that the certificate stored in the \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code> database is not orphaned:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># certutil -K -d \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code>\n&lt; 0&gt; rsa      5ad14d41463b87a095b1896cf0068ccc467df395   \u003Cspan class=\"strong strong\">\u003Cstrong>NSS Certificate DB:idm_user\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal command\">pk12util\u003C/code> command to export the certificate from the NSS database to the PKCS12 format. For example, to export the certificate with the \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> nickname from the \u003Ccode class=\"literal filename\">/root/certdb\u003C/code> NSS database into the \u003Ccode class=\"literal replaceable\">~/idm_user.p12\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># pk12util -d \u003Ccode class=\"literal filename\">~/certdb\u003C/code> -o \u003Ccode class=\"literal replaceable\">~/idm_user.p12\u003C/code> -n \u003Ccode class=\"literal replaceable\">idm_user\u003C/code>\nEnter Password or Pin for \"NSS Certificate DB\":\nEnter password for PKCS12 file:\nRe-enter password:\npk12util: PKCS12 EXPORT SUCCESSFUL\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTransfer the certificate to the host on which you want the certificate authentication for \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> to be enabled:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># scp \u003Ccode class=\"literal replaceable\">~/idm_user.p12\u003C/code> \u003Ccode class=\"literal replaceable\">idm_user@client.idm.example.com:/home/idm_user/\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the host to which the certificate has been transferred, make the directory in which the .pkcs12 file is stored inaccessible to the 'other' group for security reasons:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># chmod o-rwx \u003Ccode class=\"literal replaceable\">/home/idm_user/\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor security reasons, remove the temporary NSS database and the .pkcs12 file from the server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># rm \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code>\n# rm \u003Ccode class=\"literal replaceable\">~/idm_user.p12\u003C/code>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_making-sure-the-certificate-and-user-are-linked-together_dc-web-ui-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.3. Making sure the certificate and user are linked together\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Crh-alert class=\"admonition note _abstract\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou do not need to follow this procedure if the user’s certificate has been issued by the IdM CA.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tFor certificate authentication to work, you need to make sure that the certificate is linked to the user that will use it to authenticate to Identity Management (IdM).\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf the certificate is provided by a Certificate Authority that is not part of your Identity Management environment, link the user and the certificate following the procedure described in \u003Ca class=\"link\" href=\"#conf-certmap-for-users-in-idm_conf-certmap-idm\" title=\"10.4. Configuring certificate mapping for users stored in IdM\">Linking User Accounts to Certificates\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf the certificate is provided by Identity Management CA, the certificate is already automatically added in the user entry and you do not have to link the certificate to the user account. For details on creating a new certificate in IdM, see \u003Ca class=\"link\" href=\"#requesting-and-exporting-a-user-certificate_dc-web-ui-auth\" title=\"11.2. Requesting a new user certificate and exporting it to the client\">Requesting a new user certificate and exporting it to the client\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-browser-for-cert-auth_dc-web-ui-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.4. Configuring a browser to enable certificate authentication\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo be able to authenticate with a certificate when using the WebUI to log into Identity Management (IdM), you need to import the user and the relevant certificate authority (CA) certificates into the Mozilla Firefox or Google Chrome browser. The host itself on which the browser is running does not have to be part of the IdM domain.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIdM supports the following browsers for connecting to the WebUI:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMozilla Firefox 38 and later\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tGoogle Chrome 46 and later\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe following procedure shows how to configure the Mozilla Firefox 57.0.1 browser.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the \u003Ca class=\"link\" href=\"#requesting-and-exporting-a-user-certificate_dc-web-ui-auth\" title=\"11.2. Requesting a new user certificate and exporting it to the client\">user certificate\u003C/a> that you want to import to the browser at your disposal in the PKCS#12 format.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen Firefox, then navigate to \u003Ccode class=\"literal gui\">Preferences\u003C/code> → \u003Ccode class=\"literal gui\">Privacy &amp; Security\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"privacy-security_dc-web-ui-auth\">\u003Cp class=\"title\">\u003Cstrong>Figure 11.1. Privacy and Security section in Preferences\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/c69e139faf91acb67d6b6a7faa65b410/privacy_and_security.png\" alt=\"Screenshot of the Firefox settings page and the &quot;Privacy &amp; Security&quot; option is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">View Certificates\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"view-certificates_dc-web-ui-auth\">\u003Cp class=\"title\">\u003Cstrong>Figure 11.2. View Certificates in Privacy and Security\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/aa5fb25b2f4b3061fe69192d0af19b1c/view_certificates.png\" alt=\"A screenshot of the &quot;Certificates&quot; section and the &quot;View Certificates&quot; button at the bottom right is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal gui\">Your Certificates\u003C/code> tab, click \u003Cspan class=\"guibutton\">Import\u003C/span>. Locate and open the certificate of the user in the PKCS12 format, then click \u003Cspan class=\"guibutton\">OK\u003C/span> and \u003Cspan class=\"guibutton\">OK\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake sure that the Identity Management Certificate Authority is recognized by Firefox as a trusted authority:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSave the IdM CA certificate locally:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tNavigate to the IdM web UI by writing the name of your IdM server in the Firefox address bar. Click \u003Ccode class=\"literal gui\">Advanced\u003C/code> on the Insecure Connection warning page.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"connection-not-secure-idm_dc-web-ui-auth\">\u003Cp class=\"title\">\u003Cstrong>Figure 11.3. Insecure Connection\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/3aeddaa6fb1e422625f6a9c6acf7427d/connection-not-secure-idm.png\" alt=\"A screenshot of a warning dialog box with the title &quot;Your connection is not secure.&quot; The error message says &quot;The owner of idm.lab.example.net has configured their website improperly. To protect your information from being stolen Firefox has not connected to this website.&quot; There are two buttons below the error message: &quot;Go Back&quot; and &quot;Advanced.&quot; The &quot;Advanced&quot; button has been highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal gui\">Add Exception\u003C/code>. Click \u003Ccode class=\"literal gui\">View\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"view-ca-certificate-idm_dc-web-ui-auth\">\u003Cp class=\"title\">\u003Cstrong>Figure 11.4. View the Details of a Certificate\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/a658b28045cc4481f8235356c39ed8d3/view-ca-certificate-idm.png\" alt=\"A screenshot showing a text entry field for &quot;Location&quot; with the URL for the IdM Web UI and a &quot;Certificate Status&quot; entry labeled as &quot;This site attempts to identify itself with invalid information.&quot; A &quot;View&quot; button to the right has been highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal gui\">Details\u003C/code> tab, highlight the \u003Ccode class=\"literal gui\">Certificate Authority\u003C/code> fields.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"exporting-ca-cert-idm_dc-web-ui-auth\">\u003Cp class=\"title\">\u003Cstrong>Figure 11.5. Exporting the CA Certificate\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/59d8bc504687f45d88843d1512904c15/exporting-ca-cert-idm.png\" alt=\"A screenshot displaying information for the idm.lab.example.net Certificate Authority. &quot;Certificate Authority&quot; has been highlighted in the &quot;Certificate Fields&quot; expanding tree. The &quot;Export…​&quot; button at the bottom has also been highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">Export\u003C/span>. Save the CA certificate, for example as the \u003Ccode class=\"literal filename\">CertificateAuthority.crt\u003C/code> file, then click \u003Cspan class=\"guibutton\">Close\u003C/span>, and \u003Cspan class=\"guibutton\">Cancel\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tImport the IdM CA certificate to Firefox as a trusted certificate authority certificate:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tOpen Firefox, navigate to Preferences and click \u003Cspan class=\"guibutton\">Privacy &amp; Security\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"privacy-security-2_dc-web-ui-auth\">\u003Cp class=\"title\">\u003Cstrong>Figure 11.6. Privacy and Security section in Preferences\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/c69e139faf91acb67d6b6a7faa65b410/privacy_and_security.png\" alt=\"Screenshot of the Firefox settings page. The &quot;Privacy &amp; Security&quot; option is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">View Certificates\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"view-certificates-2_dc-web-ui-auth\">\u003Cp class=\"title\">\u003Cstrong>Figure 11.7. View Certificates in Privacy and Security\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/aa5fb25b2f4b3061fe69192d0af19b1c/view_certificates.png\" alt=\"A screenshot of the &quot;Certificates&quot; section. The &quot;View Certificates&quot; button at the bottom right is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal gui\">Authorities\u003C/code> tab, click \u003Cspan class=\"guibutton\">Import\u003C/span>. Locate and open the CA certificate that you saved in the previous step in the \u003Ccode class=\"literal filename\">CertificateAuthority.crt\u003C/code> file. Trust the certificate to identify websites, then click \u003Cspan class=\"guibutton\">OK\u003C/span> and \u003Cspan class=\"guibutton\">OK\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tContinue to \u003Ca class=\"link\" href=\"#cert-idm-users-auth-procedure_dc-web-ui-auth\" title=\"11.5. Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User\">Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"cert-idm-users-auth-procedure_dc-web-ui-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.5. Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to authenticate as a user to the Identity Management (IdM) web UI using a certificate stored on the desktop of an Identity Management client.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the browser, navigate to the Identity Management web UI at, for example, \u003Ccode class=\"literal\">https:\u003C/code>//\u003Ccode class=\"literal\">server.idm.example.com/ipa/ui\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">Login Using Certificate\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"idm140333357506096\">\u003Cp class=\"title\">\u003Cstrong>Figure 11.8. \u003Cspan class=\"guibutton\">Login Using Certificate\u003C/span> in the Identity Management web UI\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/af9fb598140f6857d0dfaf5408f3e2e9/smart_card_login.png\" alt=\"Screenshot of the Identity Management Web UI login page highlighting the &quot;Login Using Certificate&quot; button below the password prompt\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user’s certificate should already be selected. Uncheck \u003Cspan class=\"guibutton\">Remember this decision\u003C/span>, then click \u003Cspan class=\"guibutton\">OK\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tYou are now authenticated as the user who corresponds to the certificate.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication\">Configuring Identity Management for smart card authentication\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"authenticating-idm-cli-user-certificate_dc-web-ui-auth\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.6. Configuring an IdM client to enable authenticating to the CLI using a certificate\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo make certificate authentication work for an IdM user in the Command Line Interface (CLI) of your IdM client, import the IdM user’s certificate and the private key to the IdM client. For details on creating and transferring the user certificate, see \u003Ca class=\"link\" href=\"#requesting-and-exporting-a-user-certificate_dc-web-ui-auth\" title=\"11.2. Requesting a new user certificate and exporting it to the client\">Requesting a new user certificate and exporting it to the client\u003C/a>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into the IdM client and have the .p12 file containing the user’s certificate and the private key ready. To obtain and cache the Kerberos ticket granting ticket (TGT), run the \u003Ccode class=\"literal command\">kinit\u003C/code> command with the user’s principal, using the \u003Ccode class=\"literal replaceable\">-X\u003C/code> option with the \u003Ccode class=\"literal replaceable\">X509_username:/path/to/file.p12\u003C/code> attribute to specify where to find the user’s X509 identity information. For example, to obtain the TGT for \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> using the user’s identity information stored in the \u003Ccode class=\"literal replaceable\">~/idm_user.p12\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit -X X509_idm_user='PKCS12:~/idm_user.p12' idm_user\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe command also supports the .pem file format: \u003Cspan class=\"strong strong\">\u003Cstrong>kinit -X X509_username='FILE:/path/to/cert.pem,/path/to/key' user_principal\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"ipa-ca-renewal_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 12. Using IdM CA renewal server\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Csection class=\"section\" id=\"ca-renewal-server_ipa-ca-renewal\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.1. Explanation of IdM CA renewal server\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn an Identity Management (IdM) deployment that uses an embedded certificate authority (CA), the CA renewal server maintains and renews IdM system certificates. It ensures robust IdM deployments.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIdM system certificates include:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">IdM CA\u003C/code> certificate\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">OCSP\u003C/code> signing certificate\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">IdM CA subsystem\u003C/code> certificates\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">IdM CA audit signing\u003C/code> certificate\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">IdM renewal agent\u003C/code> (RA) certificate\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">KRA\u003C/code> transport and storage certificates\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tWhat characterizes system certificates is that their keys are shared by all CA replicas. In contrast, the IdM service certificates (for example, \u003Ccode class=\"literal\">LDAP\u003C/code>, \u003Ccode class=\"literal\">HTTP\u003C/code> and \u003Ccode class=\"literal\">PKINIT\u003C/code> certificates), have different keypairs and subject names on different IdM CA servers.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn IdM topology, by default, the first IdM CA server is the CA renewal server.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIn upstream documentation, the IdM CA is called \u003Ccode class=\"literal\">Dogtag\u003C/code>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>The role of the CA renewal server\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">IdM CA\u003C/code>, \u003Ccode class=\"literal\">IdM CA subsystem\u003C/code>, and \u003Ccode class=\"literal\">IdM RA\u003C/code> certificates are crucial for IdM deployment. Each certificate is stored in an NSS database in the \u003Ccode class=\"literal\">/etc/pki/pki-tomcat/\u003C/code> directory and also as an LDAP database entry. The certificate stored in LDAP must match the certificate stored in the NSS database. If they do not match, authentication failures occur between the IdM framework and IdM CA, and between IdM CA and LDAP.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tAll IdM CA replicas have tracking requests for every system certificate. If an IdM deployment with integrated CA does not contain a CA renewal server, each IdM CA server requests the renewal of system certificates independently. This results in different CA replicas having various system certificates and authentication failures occurring.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAppointing one CA replica as the renewal server allows the system certificates to be renewed exactly once, when required, and thus prevents authentication failures.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>The role of the \u003Ccode class=\"literal\">certmonger\u003C/code> service on CA replicas\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">certmonger\u003C/code> service running on all IdM CA replicas uses the \u003Ccode class=\"literal\">dogtag-ipa-ca-renew-agent\u003C/code> renewal helper to keep track of IdM system certificates. The renewal helper program reads the CA renewal server configuration. On each CA replica that is not the CA renewal server, the renewal helper retrieves the latest system certificates from the \u003Ccode class=\"literal\">ca_renewal\u003C/code> LDAP entries. Due to non-determinism in when exactly \u003Ccode class=\"literal\">certmonger\u003C/code> renewal attempts occur, the \u003Ccode class=\"literal\">dogtag-ipa-ca-renew-agent\u003C/code> helper sometimes attempts to update a system certificate before the CA renewal server has actually renewed the certificate. If this happens, the old, soon-to-expire certificate is returned to the \u003Ccode class=\"literal\">certmonger\u003C/code> service on the CA replica. The \u003Ccode class=\"literal\">certmonger\u003C/code> service, realizing it is the same certificate that is already stored in its database, keeps attempting to renew the certificate with some delay between individual attempts until it can retrieve the updated certificate from the CA renewal server.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>The correct functioning of IdM CA renewal server\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tAn IdM deployment with an embedded CA is an IdM deployment that was installed with an IdM CA - or whose IdM CA server was installed later. An IdM deployment with an embedded CA must at all times have exactly one CA replica configured as the renewal server. The renewal server must be online and fully functional, and must replicate properly with the other servers.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tIf the current CA renewal server is being deleted using the \u003Ccode class=\"literal\">ipa server-del\u003C/code>, \u003Ccode class=\"literal\">ipa-replica-manage del\u003C/code>, \u003Ccode class=\"literal\">ipa-csreplica-manage del\u003C/code> or \u003Ccode class=\"literal\">ipa-server-install --uninstall\u003C/code> commands, another CA replica is automatically assigned as the CA renewal server. This policy ensures that the renewal server configuration remains valid.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis policy does not cover the following situations:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Offline renewal server\u003C/strong>\u003C/span>\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the renewal server is offline for an extended duration, it may miss a renewal window. In this situation, all nonrenewal CA servers keep reinstalling the current system certificates until the certificates expire. When this occurs, the IdM deployment is disrupted because even one expired certificate can cause renewal failures for other certificates.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Replication problems\u003C/strong>\u003C/span>\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf replication problems exist between the renewal server and other CA replicas, renewal might succeed, but the other CA replicas might not be able to retrieve the updated certificates before they expire.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo prevent this situation, make sure that your replication agreements are working correctly. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/linux_domain_identity_authentication_and_policy_guide/trouble-gen-replication\">general\u003C/a> or \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/linux_domain_identity_authentication_and_policy_guide/trouble-replica\">specific\u003C/a> replication troubleshooting guidelines in the RHEL 7 \u003Cspan class=\"emphasis\">\u003Cem>Linux Domain Identity, Authentication, and Policy Guide\u003C/em>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"changing-ca-renewal_ipa-ca-renewal\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.2. Changing and resetting IdM CA renewal server\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tWhen a certificate authority (CA) renewal server is being decommissioned, Identity Management (IdM) automatically selects a new CA renewal server from the list of IdM CA servers. The system administrator cannot influence the selection.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo be able to select the new IdM CA renewal server, the system administrator must perform the replacement manually. Choose the new CA renewal server before starting the process of decommissioning the current renewal server.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf the current CA renewal server configuration is invalid, reset the IdM CA renewal server.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tComplete this procedure to change or reset the CA renewal server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the IdM administrator credentials.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tObtain the IdM administrator credentials:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\nPassword for admin@IDM.EXAMPLE.COM:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To find out which IdM servers in the deployment have the CA role necessary to be eligible to become the new CA renewal server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa server-role-find --role 'CA server'\u003C/strong>\u003C/span>\n----------------------\n2 server roles matched\n----------------------\n  Server name: server.idm.example.com\n  Role name: \u003Cspan class=\"strong strong\">\u003Cstrong>CA server\u003C/strong>\u003C/span>\n  Role status: enabled\n\n  Server name: replica.idm.example.com\n  Role name: \u003Cspan class=\"strong strong\">\u003Cstrong>CA server\u003C/strong>\u003C/span>\n  Role status: enabled\n----------------------------\nNumber of entries returned 2\n----------------------------\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThere are two CA servers in the deployment.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptionall: To find out which CA server is the current CA renewal server, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa config-show | grep 'CA renewal'\u003C/strong>\u003C/span>\n  IPA CA renewal master: server.idm.example.com\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe current renewal server is \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo change the renewal server configuration, use the \u003Ccode class=\"literal\">ipa config-mod\u003C/code> utility with the \u003Ccode class=\"literal\">--ca-renewal-master-server\u003C/code> option:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa config-mod --ca-renewal-master-server replica.idm.example.com | grep 'CA renewal'\u003C/strong>\u003C/span>\n  IPA CA renewal master: replica.idm.example.com\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tYou can also switch to a new CA renewal server using:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipa-cacert-manage --renew\u003C/code> command. This command both renews the CA certificate \u003Cspan class=\"emphasis\">\u003Cem>and\u003C/em>\u003C/span> makes the CA server on which you execute the command the new CA renewal server.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> command. This command recovers the deployment when expired certificates are causing failures. It also makes the CA server on which you execute the command the new CA renewal server.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor details, see \u003Ca class=\"link\" href=\"#renewing-expired-system-certificates-on-a-ca_renewing-expired-system-certificates-when-idm-is-offline\" title=\"14.1. Renewing expired system certificates on a CA renewal server\">Renewing expired system certificates when IdM is offline\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-externally-signed-ca-certificates_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 13. Managing externally-signed CA certificates\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tIdentity Management (IdM) provides different types of certificate authority (CA) configurations. You can chose to install IdM with an integrated CA or with an external CA. You must specify the type of CA you are using during the installation. However, once installed you can move from an externally-signed CA to a self-signed CA and vice versa. Additionally, while a self-signed CA is automatically renewed, you must ensure that you renew your externally-signed CA certificate. Refer to the relevant sections as required to manage your externally-signed CA certificates.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tInstalling IdM with an externally-signed CA:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-ipa-server-with-external-ca_installing-identity-management\">Installing an IdM server with integrated DNS and with an external CA as the root CA.\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_installing-an-ipa-server-without-dns-with-external-ca_installing-identity-management\">Installing an IdM server without integrated DNS and with an external CA as the root CA.\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#switch-from-externally-to-self-signed-ca_managing-externally-signed-ca-certificates\" title=\"13.1. Switching from an externally-signed to a self-signed CA in IdM\">Switching from an externally-signed CA to a self-signed CA.\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#switching-from-a-self-signed-to-an-externally-signed-ca-in-idm_managing-externally-signed-ca-certificates\" title=\"13.2. Switching from a self-signed to an externally-signed CA in IdM\">Switching from a self-signed CA to an externally-signed CA.\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#renew-with-externally-signed-CA_managing-externally-signed-ca-certificates\" title=\"13.3. Renewing the IdM CA renewal server certificate using an external CA\">Renewing the externally-signed CA certificate.\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"switch-from-externally-to-self-signed-ca_managing-externally-signed-ca-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.1. Switching from an externally-signed to a self-signed CA in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tComplete this procedure to switch from an externally-signed to a self-signed certificate of the Identity Management (IdM) certificate authority (CA). With a self-signed CA, the renewal of the CA certificate is managed automatically: a system administrator does not need to submit a certificate signing request (CSR) to an external authority.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSwitching from an externally-signed to a self-signed CA replaces only the CA certificate. The certificates signed by the previous CA are still valid and still in use. For example, the certificate chain for the \u003Ccode class=\"literal\">LDAP\u003C/code> certificate remains unchanged even after you have moved to a self-signed CA:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Ccode class=\"literal\">external_CA\u003C/code> certificate &gt; \u003Ccode class=\"literal\">IdM CA\u003C/code> certificate &gt; \u003Ccode class=\"literal\">LDAP\u003C/code> certificate\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> access to the IdM CA renewal server and all IdM clients and servers.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the IdM CA renewal server, renew the CA certificate as self-signed:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-cacert-manage renew --self-signed\u003C/strong>\u003C/span>\nRenewing CA certificate, please wait\nCA certificate successfully renewed\nThe ipa-cacert-manage command was successful\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">SSH\u003C/code> to all the remaining IdM servers and clients as \u003Ccode class=\"literal\">root\u003C/code>. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ssh root@idmclient01.idm.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the IdM client, update the local IdM certificate databases with the certificates from the server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idmclient01 ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-certupdate\u003C/strong>\u003C/span>\nSystemwide CA database updated.\nSystemwide CA database updated.\nThe ipa-certupdate command was successful\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo check if your update has been successful and the new CA certificate has been added to the \u003Ccode class=\"literal\">/etc/ipa/ca.crt\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idmclient01 ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl crl2pkcs7 -nocrl -certfile /etc/ipa/ca.crt | openssl pkcs7 -print_certs -text -noout\u003C/strong>\u003C/span>\n[...]\nCertificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number: 39 (0x27)\n        Signature Algorithm: sha256WithRSAEncryption\n        Issuer: O=IDM.EXAMPLE.COM, CN=Certificate Authority\n        Validity\n            Not Before: Jul  1 16:32:45 2019 GMT\n            Not After : Jul  1 16:32:45 2039 GMT\n        Subject: O=IDM.EXAMPLE.COM, CN=Certificate Authority\n[...]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe output shows that the update has been successful as the new CA certificate is listed with the older CA certificates.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"switching-from-a-self-signed-to-an-externally-signed-ca-in-idm_managing-externally-signed-ca-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.2. Switching from a self-signed to an externally-signed CA in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can switch from a self-signed CA to an externally-signed CA in IdM. Once you switch to an externally-signed CA in IdM, your IdM CA server becomes a subCA of the external CA. Also, the renewal of the CA certificate is not managed automatically and a system administrator must submit a certificate signing request (CSR) to the external authority.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo switch to an externally-signed CA, a CSR must be signed by the external CA. Follow the steps in \u003Ca class=\"link\" href=\"#renew-with-externally-signed-CA_managing-externally-signed-ca-certificates\" title=\"13.3. Renewing the IdM CA renewal server certificate using an external CA\">Renewing the IdM CA renewal server certificate using an external CA\u003C/a> to switch to a self-signed CA in IdM.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"renew-with-externally-signed-CA_managing-externally-signed-ca-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.3. Renewing the IdM CA renewal server certificate using an external CA\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to renew the Identity Management (IdM) certificate authority (CA) certificate using an external CA to sign the certificate signing request (CSR). In this configuration, your IdM CA server is a subCA of the external CA. The external CA can, but does not have to, be an Active Directory Certificate Server (AD CS).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf the external certificate authority is AD CS, you can specify the template you want for the IdM CA certificate in the CSR. A certificate template defines the policies and rules that a CA uses when a certificate request is received. Certificate templates in AD correspond to certificate profiles in IdM.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can define a specific AD CS template by its Object Identifier (OID). OIDs are unique numeric values issued by various issuing authorities to uniquely identify data elements, syntaxes, and other parts of distributed applications.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAlternatively, you can define a specific AD CS template by its name. For example, the name of the default profile used in a CSR submitted by an IdM CA to an AD CS is \u003Ccode class=\"literal\">subCA\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo define a profile by specifying its OID or name in the CSR, use the \u003Ccode class=\"literal\">external-ca-profile\u003C/code> option. For details, see the \u003Ccode class=\"literal\">ipa-cacert-manage\u003C/code> man page on your system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tApart from using a ready-made certificate template, you can also create a custom certificate template in the AD CS, and use it in the CSR.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have root access to the IdM CA renewal server.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tComplete this procedure to renew the certificate of the IdM CA with external signing, regardless of whether current CA certificate is self-signed or externally-signed.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a CSR to be submitted to the external CA:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the external CA is an AD CS, use the \u003Ccode class=\"literal\">--external-ca-type=ms-cs\u003C/code> option. If you want a different template than the default \u003Ccode class=\"literal\">subCA\u003C/code> template, specify it using the \u003Ccode class=\"literal\">--external-ca-profile\u003C/code> option:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">~]# \u003Ccode class=\"literal\">ipa-cacert-manage renew --external-ca --external-ca-type=ms-cs [--external-ca-profile=PROFILE]\u003C/code>\nExporting CA certificate signing request, please wait\nThe next step is to get /var/lib/ipa/ca.csr signed by your CA and re-run ipa-cacert-manage as:\nipa-cacert-manage renew --external-cert-file=/path/to/signed_certificate --external-cert-file=/path/to/external_ca_certificate\nThe ipa-cacert-manage command was successful\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the external CA is not an AD CS:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">~]# \u003Ccode class=\"literal\">ipa-cacert-manage renew --external-ca\u003C/code>\nExporting CA certificate signing request, please wait\nThe next step is to get /var/lib/ipa/ca.csr signed by your CA and re-run ipa-cacert-manage as:\nipa-cacert-manage renew --external-cert-file=/path/to/signed_certificate --external-cert-file=/path/to/external_ca_certificate\nThe ipa-cacert-manage command was successful\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe output shows that a CSR has been created and is stored in the \u003Ccode class=\"literal\">/var/lib/ipa/ca.csr\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSubmit the CSR located in \u003Ccode class=\"literal\">/var/lib/ipa/ca.csr\u003C/code> to the external CA. The process differs depending on the service to be used as the external CA.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRetrieve the issued certificate and the CA certificate chain for the issuing CA in a base 64-encoded blob, which is:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tA PEM file if the external CA is not an AD CS.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tA Base_64 certificate if the external CA is an AD CS.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe process differs for every certificate service. Usually, a download link on a web page or in the notification email allows the administrator to download all the required certificates.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the external CA is an AD CS and you have submitted the CSR with a known template through the Microsoft Windows Certification Authority management window, the AD CS issues the certificate immediately and the Save Certificate dialog appears in the AD CS web interface, asking where to save the issued certificate.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the \u003Ccode class=\"literal\">ipa-cacert-manage renew\u003C/code> command again, adding all the CA certificate files required to supply a full certificate chain. Specify as many files as you need, using the \u003Ccode class=\"literal\">--external-cert-file\u003C/code> option multiple times:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">~]# \u003Ccode class=\"literal\">ipa-cacert-manage renew --external-cert-file=/path/to/signed_certificate --external-cert-file=/path/to/external_ca_certificate_1 --external-cert-file=/path/to/external_ca_certificate_2\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn all the IdM servers and clients, update the local IdM certificate databases with the certificates from the server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[client ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-certupdate\u003C/strong>\u003C/span>\nSystemwide CA database updated.\nSystemwide CA database updated.\nThe ipa-certupdate command was successful\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo check if your update has been successful and the new CA certificate has been added to the \u003Ccode class=\"literal\">/etc/ipa/ca.crt\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[client ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl crl2pkcs7 -nocrl -certfile /etc/ipa/ca.crt | openssl pkcs7 -print_certs -text -noout\u003C/strong>\u003C/span>\n[...]\nCertificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number: 39 (0x27)\n        Signature Algorithm: sha256WithRSAEncryption\n        Issuer: O=IDM.EXAMPLE.COM, CN=Certificate Authority\n        Validity\n            Not Before: Jul  1 16:32:45 2019 GMT\n            Not After : Jul  1 16:32:45 2039 GMT\n        Subject: O=IDM.EXAMPLE.COM, CN=Certificate Authority\n[...]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe output shows that the update has been successful as the new CA certificate is listed with the older CA certificates.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"renewing-expired-system-certificates-when-idm-is-offline_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 14. Renewing expired system certificates when IdM is offline\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tIf a system certificate has expired, Identity Management (IdM) fails to start. IdM supports renewing system certificates even in this situation by using the \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> tool.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tEnsure that the LDAP service is running by entering the \u003Ccode class=\"literal\">ipactl start --ignore-service-failures\u003C/code> command on the host.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"renewing-expired-system-certificates-on-a-ca_renewing-expired-system-certificates-when-idm-is-offline\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.1. Renewing expired system certificates on a CA renewal server\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to apply the \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> tool on expired IdM certificates.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you run the \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> tool on a CA (Certificate Authority) host that is not the CA renewal server, and the utility renews shared certificates, that host automatically becomes the new CA renewal server in the domain. There must always be only one CA renewal server in the domain to avoid inconsistencies.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in to the server with administration rights\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: Backup the system. This is heavily recommended, as \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> makes irreversible changes to \u003Ccode class=\"literal\">nssdbs\u003C/code>. Because \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> also makes changes to the LDAP, it is recommended to backup the entire cluster as well.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> tool to analyze the system and list expired certificates that require renewal:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa-cert-fix\n...\nThe following certificates will be renewed:\n\nDogtag sslserver certificate:\n  Subject: CN=ca1.example.com,O=EXAMPLE.COM 201905222205\n  Serial:  13\n  Expires: 2019-05-12 05:55:47\n...\nEnter \"yes\" to proceed:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnter \u003Ccode class=\"literal\">yes\u003C/code> to start the renewal process:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Enter \"yes\" to proceed: true\nProceeding.\nRenewed Dogtag sslserver certificate:\n  Subject: CN=ca1.example.com,O=EXAMPLE.COM 201905222205\n  Serial:  268369925\n  Expires: 2021-08-14 02:19:33\n...\n\nBecoming renewal master.\nThe ipa-cert-fix command was successful\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIt can take up to one minute before \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> renews all expired certificates.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that all services are now running:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipactl status\nDirectory Service: RUNNING\nkrb5kdc Service: RUNNING\nkadmin Service: RUNNING\nhttpd Service: RUNNING\nipa-custodia Service: RUNNING\npki-tomcatd Service: RUNNING\nipa-otpd Service: RUNNING\nipa: INFO: The ipactl command was successful\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tAt this point, certificates have been renewed and services are running. The next step is to check other servers in the IdM domain.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you need to repair certificates across multiple CA servers:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tAfter ensuring that LDAP replication is working across the topology, first run \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> on one CA server, according to the above procedure.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tBefore you run \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> on another CA server, trigger Certmonger renewals for shared certificates via \u003Ccode class=\"literal\">getcert-resubmit\u003C/code> (on the other CA server), to avoid unnecessary renewal of shared certificates.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"verifying-other-idm-servers-in-the-domain-after-renewal_renewing-expired-system-certificates-when-idm-is-offline\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.2. Verifying other IdM servers in the IdM domain after renewal\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAfter the renewing the CA renewal server’s certificates with the \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> tool, you must:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRestart all other Identity Management (IdM) servers in the domain.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCheck if certmonger renewed certificates.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf there are other Certificate Authority (CA) replicas with expired system certificates, renew those certificates with the \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> tool as well.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in to the server with administration rights.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart IdM with the \u003Ccode class=\"literal\">--force\u003C/code> parameter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipactl restart --force\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWith the \u003Ccode class=\"literal\">--force\u003C/code> parameter, the \u003Ccode class=\"literal\">ipactl\u003C/code> utility ignores individual service startup failures. For example, if the server is also a CA with expired certificates, the \u003Ccode class=\"literal\">pki-tomcat\u003C/code> service fails to start. This is expected and ignored because of using the \u003Ccode class=\"literal\">--force\u003C/code> parameter.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter the restart, verify that the \u003Ccode class=\"literal\">certmonger\u003C/code> service renewed the certificates (certificate status says MONITORING):\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># getcert list | egrep '^Request|status:|subject:'\nRequest ID '20190522120745':\n        status: MONITORING\n        subject: CN=IPA RA,O=EXAMPLE.COM 201905222205\nRequest ID '20190522120834':\n        status: MONITORING\n        subject: CN=Certificate Authority,O=EXAMPLE.COM 201905222205\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIt can take some time before \u003Ccode class=\"literal\">certmonger\u003C/code> renews the shared certificates on the replica.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the server is also a CA, the previous command reports \u003Ccode class=\"literal\">CA_UNREACHABLE\u003C/code> for the certificate the \u003Ccode class=\"literal\">pki-tomcat\u003C/code> service uses:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Request ID '20190522120835':\n        status: CA_UNREACHABLE\n        subject: CN=ca2.example.com,O=EXAMPLE.COM 201905222205\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo renew this certificate, use the \u003Ccode class=\"literal\">ipa-cert-fix\u003C/code> utility:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa-cert-fix\nDogtag sslserver certificate:\n  Subject: CN=ca2.example.com,O=EXAMPLE.COM\n  Serial:  3\n  Expires: 2019-05-11 12:07:11\n\nEnter \"yes\" to proceed: true\nProceeding.\nRenewed Dogtag sslserver certificate:\n  Subject: CN=ca2.example.com,O=EXAMPLE.COM 201905222205\n  Serial:  15\n  Expires: 2019-08-14 04:25:05\n\nThe ipa-cert-fix command was successful\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tNow, all IdM certificates have been renewed and work correctly.\n\t\t\t\u003C/p>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-not-yet-expired-on-an-idm-replica_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 15. Replacing the web server and LDAP server certificates if they have not yet expired on an IdM replica\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tAs an Identity Management (IdM) system administrator, you can manually replace the certificates for the web (or \u003Ccode class=\"literal\">httpd\u003C/code>) and LDAP (or \u003Ccode class=\"literal\">Directory\u003C/code>) services running on an IdM server. For example, this might be necessary if the certificates are nearing expiration and if the \u003Ccode class=\"literal\">certmonger\u003C/code> utility is either not configured to renew the certificates automatically or if the certificates are signed by an external certificate authority (CA).\n\t\t\u003C/p>\u003Cp>\n\t\t\tThe example installs the certificates for the services running on the \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span> IdM server. You obtain the certificates from an external CA.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tThe HTTP and LDAP service certificates have different keypairs and subject names on different IdM servers and so you must renew the certificates on each IdM server individually.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tOn at least one other IdM replica in the topology with which the IdM server has a replication agreement, the web and LDAP certificates are still valid. This is a prerequisite for the \u003Ccode class=\"literal\">ipa-server-certinstall\u003C/code> command. The command requires a \u003Ccode class=\"literal\">TLS\u003C/code> connection to communicate with other IdM replicas. However, with invalid certificates, such a connection could not be established, and the \u003Ccode class=\"literal\">ipa-server-certinstall\u003C/code> command would fail. In that case, see \u003Ca class=\"link\" href=\"#proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-expired-in-the-whole-idm-deployment_managing-certificates-in-idm\" title=\"Chapter 16. Replacing the web server and LDAP server certificates if they have expired in the whole IdM deployment\">Replacing the web server and LDAP server certificates if they have expired in the whole IdM deployment\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> access to the IdM server.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou know the \u003Ccode class=\"literal\">Directory Manager\u003C/code> password.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou have access to a file storing the CA certificate chain of the external CA, \u003Cspan class=\"emphasis\">\u003Cem>ca_certificate_chain_file.crt\u003C/em>\u003C/span>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tInstall the certificates contained in \u003Cspan class=\"emphasis\">\u003Cem>ca_certificate_chain_file.crt\u003C/em>\u003C/span> as additional CA certificates to IdM:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-cacert-manage install\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tUpdate the local IdM certificate databases with certificates from \u003Cspan class=\"emphasis\">\u003Cem>ca_certicate_chain_file.crt\u003C/em>\u003C/span>:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-certupdate\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tGenerate a private key and a certificate signing request (CSR) using the \u003Ccode class=\"literal\">OpenSSL\u003C/code> utility:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl req -new -newkey rsa:4096 -days 365 -nodes -keyout new.key -out new.csr -addext \"subjectAltName = DNS:server.idm.example.com\" -subj '/CN=\u003Cspan class=\"emphasis\">\u003Cem>server.idm.example.com\u003C/em>\u003C/span>,O=\u003Cspan class=\"emphasis\">\u003Cem>IDM.EXAMPLE.COM\u003C/em>\u003C/span>'\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\tSubmit the CSR to the external CA. The process differs depending on the service to be used as the external CA. After the CA signs the certificate, import the certificate to the IdM server.\n\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tOn the IdM server, replace the Apache web server’s old private key and certificate with the new key and the newly-signed certificate:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-server-certinstall -w --pin=\u003Cspan class=\"emphasis\">\u003Cem>password\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>new.key\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>new.crt\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\tIn the command above:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-w\u003C/code> option specifies that you are installing a certificate into the web server.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">--pin\u003C/code> option specifies the password protecting the private key.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tWhen prompted, enter the \u003Ccode class=\"literal\">Directory Manager\u003C/code> password.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tReplace the LDAP server’s old private key and certificate with the new key and the newly-signed certificate:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-server-certinstall -d --pin=\u003Cspan class=\"emphasis\">\u003Cem>password\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>new.key\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>new.cert\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\tIn the command above:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-d\u003C/code> option specifies that you are installing a certificate into the LDAP server.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">--pin\u003C/code> option specifies the password protecting the private key.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tWhen prompted, enter the \u003Ccode class=\"literal\">Directory Manager\u003C/code> password.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tRestart the \u003Ccode class=\"literal\">httpd\u003C/code> service:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart httpd.service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tRestart the \u003Ccode class=\"literal\">Directory\u003C/code> service:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart dirsrv@IDM.EXAMPLE.COM.service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tIf a subCA has been removed or replaced on the servers, update the clients:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-certupdate\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/convert-cert-formats-idm_managing-certificates-in-idm\">Converting certificate formats to work with IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ccode class=\"literal\">ipa-server-certinstall(1)\u003C/code> man page on your system\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-expired-in-the-whole-idm-deployment_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 16. Replacing the web server and LDAP server certificates if they have expired in the whole IdM deployment\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tIdentity Management (IdM) uses the following service certificates:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tThe LDAP (or \u003Ccode class=\"literal\">Directory\u003C/code>) server certificate\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe web (or \u003Ccode class=\"literal\">httpd\u003C/code>) server certificate\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe PKINIT certificate\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tIn an IdM deployment without a CA, \u003Ccode class=\"literal\">certmonger\u003C/code> does not by default track IdM service certificates or notify of their expiration. If the IdM system administrator does not manually set up notifications for these certificates, or configure \u003Ccode class=\"literal\">certmonger\u003C/code> to track them, the certificates will expire without notice.\n\t\t\u003C/p>\u003Cp>\n\t\t\tFollow this procedure to manually replace expired certificates for the \u003Ccode class=\"literal\">httpd\u003C/code> and LDAP services running on the \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span> IdM server.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tThe HTTP and LDAP service certificates have different keypairs and subject names on different IdM servers. Therefore, you must renew the certificates on each IdM server individually.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tThe HTTP and LDAP certificates have expired on \u003Cspan class=\"emphasis\">\u003Cem>all\u003C/em>\u003C/span> IdM replicas in the topology. If not, see \u003Ca class=\"link\" href=\"#proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-not-yet-expired-on-an-idm-replica_managing-certificates-in-idm\" title=\"Chapter 15. Replacing the web server and LDAP server certificates if they have not yet expired on an IdM replica\">Replacing the web server and LDAP server certificates if they have not yet expired on an IdM replica\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> access to the IdM server and replicas.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou know the \u003Ccode class=\"literal\">Directory Manager\u003C/code> password.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tYou have created backups of the following directories and files:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/etc/dirsrv/slapd-\u003Cspan class=\"emphasis\">\u003Cem>IDM-EXAMPLE-COM\u003C/em>\u003C/span>/\u003C/code>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/etc/httpd/alias\u003C/code>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/var/lib/certmonger\u003C/code>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/var/lib/ipa/certs/\u003C/code>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\tOptional: Perform a backup of \u003Ccode class=\"literal\">/var/lib/ipa/private\u003C/code> and \u003Ccode class=\"literal\">/var/lib/ipa/passwds\u003C/code>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tIf you are not using the same CA to sign the new certificates or if the already installed CA certificate is no longer valid, update the information about the external CA in your local database with a file that contains a valid CA certificate chain of the external CA. The file is accepted in PEM and DER certificate, PKCS#7 certificate chain, PKCS#8 and raw private key and PKCS#12 formats.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tInstall the certificates available in \u003Cspan class=\"emphasis\">\u003Cem>ca_certificate_chain_file.crt\u003C/em>\u003C/span> as additional CA certificates into IdM:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-cacert-manage install ca_certificate_chain_file.crt\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUpdate the local IdM certificate databases with certificates from \u003Cspan class=\"emphasis\">\u003Cem>ca_certicate_chain_file.crt\u003C/em>\u003C/span>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-certupdate\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tRequest the certificates for \u003Ccode class=\"literal\">httpd\u003C/code> and LDAP:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a certificate signing request (CSR) for the Apache web server running on your IdM instances to your third party CA using the \u003Ccode class=\"literal\">OpenSSL\u003C/code> utility.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tThe creation of a new private key is optional. If you still have the original private key, you can use the \u003Ccode class=\"literal\">-in\u003C/code> option with the \u003Ccode class=\"literal\">openssl req\u003C/code> command to specify the input file name to read the request from:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl req -new -nodes -in /var/lib/ipa/private/httpd.key -out /tmp/http.csr -addext 'subjectAltName = DNS:_server.idm.example.com_, otherName:1.3.6.1.4.1.311.20.2.3;UTF8:HTTP/\u003Cspan class=\"emphasis\">\u003Cem>server.idm.example.com@IDM.EXAMPLE.COM\u003C/em>\u003C/span>' -subj '/O=\u003Cspan class=\"emphasis\">\u003Cem>IDM.EXAMPLE.COM/CN=server.idm.example.com\u003C/em>\u003C/span>'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you want to create a new key:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl req -new -newkey rsa:2048 -nodes -keyout /var/lib/ipa/private/httpd.key -out /tmp/http.csr -addext 'subjectAltName = DNS:\u003Cspan class=\"emphasis\">\u003Cem>server.idm.example.com\u003C/em>\u003C/span>, otherName:1.3.6.1.4.1.311.20.2.3;UTF8:HTTP/\u003Cspan class=\"emphasis\">\u003Cem>server.idm.example.com@IDM.EXAMPLE.COM\u003C/em>\u003C/span>' -subj '/O=\u003Cspan class=\"emphasis\">\u003Cem>IDM.EXAMPLE.COM\u003C/em>\u003C/span>/CN=\u003Cspan class=\"emphasis\">\u003Cem>server.idm.example.com\u003C/em>\u003C/span>'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a certificate signing request (CSR) for the LDAP server running on your IdM instances to your third party CA using the \u003Ccode class=\"literal\">OpenSSL\u003C/code> utility:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl req -new -newkey rsa:2048 -nodes -keyout ~/ldap.key -out /tmp/ldap.csr -addext 'subjectAltName = DNS:\u003Cspan class=\"emphasis\">\u003Cem>server.idm.example.com\u003C/em>\u003C/span>, otherName:1.3.6.1.4.1.311.20.2.3;UTF8:ldap/\u003Cspan class=\"emphasis\">\u003Cem>server.idm.example.com@IDM.EXAMPLE.COM\u003C/em>\u003C/span>' -subj '/O=\u003Cspan class=\"emphasis\">\u003Cem>IDM.EXAMPLE.COM\u003C/em>\u003C/span>/CN=\u003Cspan class=\"emphasis\">\u003Cem>server.idm.example.com\u003C/em>\u003C/span>'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSubmit the CSRs, \u003Cspan class=\"strong strong\">\u003Cstrong>/tmp/http.csr\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>tmp/ldap.csr\u003C/strong>\u003C/span>, to the external CA, and obtain a certificate for \u003Ccode class=\"literal\">httpd\u003C/code> and a certificate for LDAP. The process differs depending on the service to be used as the external CA.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tInstall the certificate for \u003Ccode class=\"literal\">httpd\u003C/code> :\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp /path/to/httpd.crt /var/lib/ipa/certs/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tInstall the LDAP certificate into an NSS database:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOptional: List the available certificates:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>certutil -d /etc/dirsrv/slapd-\u003Cspan class=\"emphasis\">\u003Cem>IDM-EXAMPLE-COM\u003C/em>\u003C/span>/ -L\u003C/strong>\u003C/span>\nCertificate Nickname                                         Trust Attributes\n                                                             SSL,S/MIME,JAR/XPI\n\n\u003Cspan class=\"strong strong\">\u003Cstrong>Server-Cert\u003C/strong>\u003C/span>                                                  u,u,u\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe default certificate nickname is \u003Cspan class=\"strong strong\">\u003Cstrong>Server-Cert\u003C/strong>\u003C/span>, but it is possible that a different name was applied.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRemove the old invalid certificate from the NSS database (\u003Ccode class=\"literal\">NSSDB\u003C/code>) by using the certificate nickname from the previous step:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>certutil -D -d /etc/dirsrv/slapd-\u003Cspan class=\"emphasis\">\u003Cem>IDM-EXAMPLE-COM\u003C/em>\u003C/span>/ -n 'Server-Cert' -f /etc/dirsrv/slapd-\u003Cspan class=\"emphasis\">\u003Cem>IDM-EXAMPLE-COM\u003C/em>\u003C/span>/pwdfile.txt\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a PKCS12 file to ease the import process into \u003Ccode class=\"literal\">NSSDB\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>openssl pkcs12 -export -in ldap.crt -inkey ldap.key -out ldap.p12 -name Server-Cert\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tInstall the created PKCS#12 file into the \u003Ccode class=\"literal\">NSSDB\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>pk12util -i ldap.p12 -d /etc/dirsrv/slapd-\u003Cspan class=\"emphasis\">\u003Cem>IDM-EXAMPLE-COM\u003C/em>\u003C/span>/ -k /etc/dirsrv/slapd-\u003Cspan class=\"emphasis\">\u003Cem>IDM-EXAMPLE-COM\u003C/em>\u003C/span>/pwdfile.txt\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCheck that the new certificate has been successfully imported:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>certutil -L -d /etc/dirsrv/slapd-\u003Cspan class=\"emphasis\">\u003Cem>IDM-EXAMPLE-COM\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tRestart the \u003Ccode class=\"literal\">httpd\u003C/code> service:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart httpd.service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tRestart the \u003Ccode class=\"literal\">Directory\u003C/code> service:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart dirsrv@\u003Cspan class=\"emphasis\">\u003Cem>IDM-EXAMPLE-COM\u003C/em>\u003C/span>.service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tPerform all the previous steps on all your IdM replicas. This is a prerequisite for establishing \u003Ccode class=\"literal\">TLS\u003C/code> connections between the replicas.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tEnroll the new certificates to LDAP storage:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tReplace the Apache web server’s old private key and certificate with the new key and the newly-signed certificate:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-server-certinstall -w --pin=password /var/lib/ipa/private/httpd.key /var/lib/ipa/certs/httpd.crt\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIn the command above:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-w\u003C/code> option specifies that you are installing a certificate into the web server.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">--pin\u003C/code> option specifies the password protecting the private key.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tWhen prompted, enter the \u003Ccode class=\"literal\">Directory Manager\u003C/code> password.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tReplace the LDAP server’s old private key and certificate with the new key and the newly-signed certificate:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-server-certinstall -d --pin=password /etc/dirsrv/slapd-\u003Cspan class=\"emphasis\">\u003Cem>IDM-EXAMPLE-COM\u003C/em>\u003C/span>/ldap.key /path/to/ldap.crt\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIn the command above:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-d\u003C/code> option specifies that you are installing a certificate into the LDAP server.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">--pin\u003C/code> option specifies the password protecting the private key.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tWhen prompted, enter the \u003Ccode class=\"literal\">Directory Manager\u003C/code> password.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">httpd\u003C/code> service:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart httpd.service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">Directory\u003C/code> service:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart dirsrv@\u003Cspan class=\"emphasis\">\u003Cem>IDM-EXAMPLE-COM\u003C/em>\u003C/span>.service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tExecute the commands from the previous step on all the other affected replicas.\n\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/convert-cert-formats-idm_managing-certificates-in-idm\">Converting certificate formats to work with IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tman \u003Ccode class=\"literal\">ipa-server-certinstall(1)\u003C/code>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/6765131\">How do I manually renew Identity Management (IPA) certificates on RHEL 8 after they have expired? (CA-less IPA)\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"generating-crl-on-the-idm-ca-server_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 17. Generating CRL on the IdM CA server\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tIf your IdM deployment uses an embedded certificate authority (CA), you may need to move generating the Certificate Revocation List (CRL) from one Identity Management (IdM) server to another. It can be necessary, for example, when you want to migrate the server to another system.\n\t\t\u003C/p>\u003Cp>\n\t\t\tOnly configure one server to generate the CRL. The IdM server that performs the CRL publisher role is usually the same server that performs the CA renewal server role, but this is not mandatory. Before you decommission the CRL publisher server, select and configure another server to perform the CRL publisher server role.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"stopping-crl-generation-on-idm-server_generating-crl-on-the-idm-ca-server\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.1. Stopping CRL generation on an IdM server\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo stop generating the Certificate Revocation List (CRL) on the IdM CRL publisher server, use the \u003Ccode class=\"literal\">ipa-crlgen-manage\u003C/code> command. Before you disable the generation, verify that the server really generates CRL. You can then disable it.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou must be logged in as root.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck if your server is generating the CRL:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-crlgen-manage status\u003C/strong>\u003C/span>\nCRL generation: \u003Cspan class=\"strong strong\">\u003Cstrong>enabled\u003C/strong>\u003C/span>\nLast CRL update: 2019-10-31 12:00:00\nLast CRL Number: 6\nThe ipa-crlgen-manage command was successful\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStop generating the CRL on the server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-crlgen-manage disable\u003C/strong>\u003C/span>\nStopping pki-tomcatd\nEditing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg\nStarting pki-tomcatd\nEditing /etc/httpd/conf.d/ipa-pki-proxy.conf\nRestarting httpd\nCRL generation disabled on the local host. Please make sure to configure CRL generation on another master with ipa-crlgen-manage enable.\nThe ipa-crlgen-manage command was successful\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck if the server stopped generating CRL:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-crlgen-manage status\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe server stopped generating the CRL. The next step is to enable CRL generation on the IdM replica.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"starting-crl-generation-on-idm-replica-server_generating-crl-on-the-idm-ca-server\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.2. Starting CRL generation on an IdM replica server\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can start generating the Certificate Revocation List (CRL) on an IdM CA server with the \u003Ccode class=\"literal\">ipa-crlgen-manage\u003C/code> command.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe RHEL system must be an IdM Certificate Authority server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou must be logged in as root.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart generating the CRL:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@replica1 ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-crlgen-manage enable\u003C/strong>\u003C/span>\nStopping pki-tomcatd\nEditing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg\nStarting pki-tomcatd\nEditing /etc/httpd/conf.d/ipa-pki-proxy.conf\nRestarting httpd\nForcing CRL update\nCRL generation enabled on the local host. Please make sure to have only a single CRL generation master.\nThe ipa-crlgen-manage command was successful\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck if the CRL is generated:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@replica1 ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-crlgen-manage status\u003C/strong>\u003C/span>\nCRL generation: \u003Cspan class=\"strong strong\">\u003Cstrong>enabled\u003C/strong>\u003C/span>\nLast CRL update: 2019-10-31 12:10:00\nLast CRL Number: 7\nThe ipa-crlgen-manage command was successful\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"changing-the-crl-update-interval_generating-crl-on-the-idm-ca-server\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.3. Changing the CRL update interval\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe Certificate Revocation List (CRL) file is automatically generated by the Identity Management Certificate Authority (Idm CA) every four hours by default. You can change this interval with the following procedure.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStop the CRL generation server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop pki-tomcatd@pki-tomcat.service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/var/lib/pki/pki-tomcat/conf/ca/CS.cfg\u003C/code> file, and change the \u003Ccode class=\"literal\">ca.crl.MasterCRL.autoUpdateInterval\u003C/code> value to the new interval setting. For example, to generate the CRL every 60 minutes:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">ca.crl.MasterCRL.autoUpdateInterval=\u003Cspan class=\"strong strong\">\u003Cstrong>60\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIf you update the \u003Ccode class=\"literal\">ca.crl.MasterCRL.autoUpdateInterval\u003C/code> parameter, the change will become effective after the next already scheduled CRL update.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the CRL generation server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl start pki-tomcatd@pki-tomcat.service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about the CRL generation on an IdM replica server, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_certificates_in_idm/index#starting-crl-generation-on-idm-replica-server_generating-crl-on-the-idm-ca-server\">Starting CRL generation on an IdM replica server\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"proc_decommissioning-a-server-that-performs-the-ca-renewal-server-and-crl-publisher-roles_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 18. Decommissioning a server that performs the CA renewal server and CRL publisher roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tYou might have one server performing both the Certificate Authority (CA) renewal server role and the Certificate Revocation List (CRL) publisher role. If you need to take this server offline or decommission it, select and configure another CA server to perform these roles.\n\t\t\u003C/p>\u003Cp>\n\t\t\tIn this example, the host \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, which fulfills the CA renewal server and CRL publisher roles, must be decommissioned. This procedure transfers the CA renewal server and CRL publisher roles to the host \u003Ccode class=\"literal\">replica.idm.example.com\u003C/code> and removes \u003Ccode class=\"literal\">server.idm.example.com\u003C/code> from the IdM environment.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tYou do not need to configure the same server to perform both CA renewal server and CRL publisher roles.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tYou have the IdM administrator credentials.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou have the root password for the server you are decommissioning.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou have at least two CA replicas in your IdM environment.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tObtain the IdM administrator credentials:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@server ~]$ kinit admin\nPassword for admin@IDM.EXAMPLE.COM:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tOptional: If you are not sure which servers perform the CA renewal server and CRL publisher roles:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDisplay the current CA renewal server. You can run the following command from any IdM server:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@server ~]$ ipa config-show | grep 'CA renewal'\n  IPA CA renewal master: server.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTest if a host is the current CRL publisher.\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@server ~]$ ipa-crlgen-manage status\n\u003Cspan class=\"strong strong\">\u003Cstrong>CRL generation: enabled\u003C/strong>\u003C/span>\nLast CRL update: 2019-10-31 12:00:00\nLast CRL Number: 6\nThe ipa-crlgen-manage command was successful\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tA CA server that does not generate the CRL displays \u003Ccode class=\"literal\">CRL generation: disabled\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@replica ~]$ ipa-crlgen-manage status\n\u003Cspan class=\"strong strong\">\u003Cstrong>CRL generation: disabled\u003C/strong>\u003C/span>\nThe ipa-crlgen-manage command was successful\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tContinue entering this command on CA servers until you find the CRL publisher server.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDisplay all other CA servers you can promote to fulfill these roles. This environment has two CA servers.\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@server ~]$ ipa server-role-find --role 'CA server'\n----------------------\n2 server roles matched\n----------------------\n  Server name: server.idm.example.com\n  Role name: CA server\n  Role status: enabled\n  Server name: replica.idm.example.com\n  Role name: CA server\n  Role status: enabled\n----------------------------\nNumber of entries returned 2\n----------------------------\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tSet \u003Ccode class=\"literal\">replica.idm.example.com\u003C/code> as the CA renewal server.\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@server ~]$ ipa config-mod --ca-renewal-master-server replica.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tOn \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDisable the certificate updater task:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server ~]# pki-server ca-config-set ca.certStatusUpdateInterval 0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRestart IdM services:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server ~]# ipactl restart\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tOn \u003Ccode class=\"literal\">replica.idm.example.com\u003C/code>:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnable the certificate updater task:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@replica ~]# pki-server ca-config-unset ca.certStatusUpdateInterval\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRestart IdM services:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@replica ~]# ipactl restart\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tOn \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, stop generating the CRL.\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@server ~]$ ipa-crlgen-manage disable\nStopping pki-tomcatd\nEditing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg\nStarting pki-tomcatd\nEditing /etc/httpd/conf.d/ipa-pki-proxy.conf\nRestarting httpd\nCRL generation disabled on the local host. Please make sure to configure CRL generation on another master with ipa-crlgen-manage enable.\nThe ipa-crlgen-manage command was successful\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tOn \u003Ccode class=\"literal\">replica.idm.example.com\u003C/code>, start generating the CRL.\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@replica ~]$ ipa-crlgen-manage enable\nStopping pki-tomcatd\nEditing /var/lib/pki/pki-tomcat/conf/ca/CS.cfg\nStarting pki-tomcatd\nEditing /etc/httpd/conf.d/ipa-pki-proxy.conf\nRestarting httpd\nForcing CRL update\nCRL generation enabled on the local host. Please make sure to have only a single CRL generation master.\nThe ipa-crlgen-manage command was successful\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tStop IdM services on \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server ~]# ipactl stop\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tOn \u003Ccode class=\"literal\">replica.idm.example.com\u003C/code>, delete \u003Ccode class=\"literal\">server.idm.example.com\u003C/code> from the IdM environment.\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@replica ~]$ ipa server-del server.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tOn \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, use the \u003Ccode class=\"literal\">ipa-server-install --uninstall\u003C/code> command as the root account:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server ~]# ipa-server-install --uninstall\n...\nAre you sure you want to continue with the uninstall procedure? [no]: \u003Cspan class=\"strong strong\">\u003Cstrong>yes\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tDisplay the current CA renewal server.\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@replica ~]$ ipa config-show | grep 'CA renewal'\n  IPA CA renewal master: \u003Cspan class=\"strong strong\">\u003Cstrong>replica.idm.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tConfirm that the \u003Ccode class=\"literal\">replica.idm.example.com\u003C/code> host is generating the CRL.\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@replica ~]$ ipa-crlgen-manage status\n\u003Cspan class=\"strong strong\">\u003Cstrong>CRL generation: enabled\u003C/strong>\u003C/span>\nLast CRL update: 2019-10-31 12:10:00\nLast CRL Number: 7\nThe ipa-crlgen-manage command was successful\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/ipa-ca-renewal_managing-certificates-in-idm#changing-ca-renewal_ipa-ca-renewal\">Changing and resetting IdM CA renewal server\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/generating-crl-on-the-idm-ca-server_managing-certificates-in-idm\">Generating CRL on the IdM CA server\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-idm-replica_installing-identity-management\">Uninstalling an IdM replica\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"using-certmonger_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 19. Obtaining an IdM certificate for a service using certmonger\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Csection class=\"section _abstract\" id=\"certmonger_certmonger-for-issuing-renewing-service-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.1. Certmonger overview\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tWhen Identity Management (IdM) is installed with an integrated IdM Certificate Authority (CA), it uses the \u003Ccode class=\"literal\">certmonger\u003C/code> service to track and renew system and service certificates. When the certificate is reaching its expiration date, \u003Ccode class=\"literal\">certmonger\u003C/code> manages the renewal process by:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRegenerating a certificate-signing request (CSR) using the options provided in the original request.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSubmitting the CSR to the IdM CA using the IdM API \u003Ccode class=\"literal\">cert-request\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tReceiving the certificate from the IdM CA.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tExecuting a pre-save command if specified by the original request.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tInstalling the new certificate in the location specified in the renewal request: either in an \u003Ccode class=\"literal\">NSS\u003C/code> database or in a file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tExecuting a post-save command if specified by the original request. For example, the post-save command can instruct \u003Ccode class=\"literal\">certmonger\u003C/code> to restart a relevant service, so that the service picks up the new certificate.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Types of certificates \u003Ccode class=\"literal\">certmonger\u003C/code> tracks\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tCertificates can be divided into system and service certificates.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tUnlike service certificates (for example, for \u003Ccode class=\"literal\">HTTP\u003C/code>, \u003Ccode class=\"literal\">LDAP\u003C/code> and \u003Ccode class=\"literal\">PKINIT\u003C/code>), which have different keypairs and subject names on different servers, IdM system certificates and their keys are shared by all CA replicas. The IdM system certificates include:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">IdM CA\u003C/code> certificate\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">OCSP\u003C/code> signing certificate\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">IdM CA subsystem\u003C/code> certificates\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">IdM CA audit signing\u003C/code> certificate\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">IdM renewal agent\u003C/code> (RA) certificate\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">KRA\u003C/code> transport and storage certificates\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">certmonger\u003C/code> service tracks the IdM system and service certificates that were requested during the installation of IdM environment with an integrated CA. \u003Ccode class=\"literal\">Certmonger\u003C/code> also tracks certificates that have been requested manually by the system administrator for other services running on the IdM host. \u003Ccode class=\"literal\">Certmonger\u003C/code> does not track external CA certificates or user certificates.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Certmonger components\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">certmonger\u003C/code> service consists of two main components:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">certmonger daemon\u003C/code>, which is the engine tracking the list of certificates and launching renewal commands\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">getcert\u003C/code> utility for the \u003Ccode class=\"literal\">command-line interface\u003C/code> (CLI), which allows the system administrator to actively send commands to the \u003Ccode class=\"literal\">certmonger\u003C/code> daemon.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tMore specifically, the system administrator can use the \u003Ccode class=\"literal\">getcert\u003C/code> utility to:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs\" title=\"19.2. Obtaining an IdM certificate for a service using certmonger\">Request a new certificate\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#viewing-cert-tracked-by-certmonger_certmonger-for-issuing-renewing-service-certs\" title=\"19.4. Viewing the details of a certificate request tracked by certmonger\">View the list of certificates that \u003Ccode class=\"literal\">certmonger\u003C/code> tracks\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#start-stop-cert-tracking_certmonger-for-issuing-renewing-service-certs\" title=\"19.5. Starting and stopping certificate tracking\">Start or stop tracking a certificate\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#renew-cert_certmonger-for-issuing-renewing-service-certs\" title=\"19.6. Renewing a certificate manually\">Renew a certificate\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.2. Obtaining an IdM certificate for a service using certmonger\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo ensure that communication between browsers and the web service running on your Identity Management (IdM) client is secure and encrypted, use a TLS certificate. Obtain the TLS certificate for your web service from the IdM Certificate Authority (CA).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to use \u003Ccode class=\"literal\">certmonger\u003C/code> to obtain an IdM certificate for a service (\u003Ccode class=\"literal\">HTTP/my_company.idm.example.com\u003C/code>@\u003Ccode class=\"literal\">IDM.EXAMPLE.COM\u003C/code>) running on an IdM client.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUsing \u003Ccode class=\"literal\">certmonger\u003C/code> to request the certificate automatically means that \u003Ccode class=\"literal\">certmonger\u003C/code> manages and renews the certificate when it is due for a renewal.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor a visual representation of what happens when \u003Ccode class=\"literal\">certmonger\u003C/code> requests a service certificate, see \u003Ca class=\"xref\" href=\"#communication-flow-certmonger-requesting-service-cert_certmonger-for-issuing-renewing-service-certs\" title=\"19.3. Communication flow for certmonger requesting a service certificate\">Section 19.3, “Communication flow for certmonger requesting a service certificate”\u003C/a>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe web server is enrolled as an IdM client.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have root access to the IdM client on which you are running the procedure.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe service for which you are requesting a certificate does not have to pre-exist in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the \u003Ccode class=\"literal\">my_company.idm.example.com\u003C/code> IdM client on which the \u003Ccode class=\"literal\">HTTP\u003C/code> service is running, request a certificate for the service corresponding to the \u003Ccode class=\"literal\">HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM\u003C/code> principal, and specify that\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe certificate is to be stored in the local \u003Ccode class=\"literal\">/etc/pki/tls/certs/httpd.pem\u003C/code> file\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe private key is to be stored in the local \u003Ccode class=\"literal\">/etc/pki/tls/private/httpd.key\u003C/code> file\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThat an extensionRequest for a \u003Ccode class=\"literal\">SubjectAltName\u003C/code> be added to the signing request with the DNS name of \u003Ccode class=\"literal\">my_company.idm.example.com\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-getcert request -K HTTP/my_company.idm.example.com -k /etc/pki/tls/private/httpd.key -f /etc/pki/tls/certs/httpd.pem -g 2048 -D my_company.idm.example.com -C \"systemctl restart httpd\"\u003C/strong>\u003C/span>\nNew signing request \"20190604065735\" added.\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the command above:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipa-getcert request\u003C/code> command specifies that the certificate is to be obtained from the IdM CA. The \u003Ccode class=\"literal\">ipa-getcert request\u003C/code> command is a shortcut for \u003Ccode class=\"literal\">getcert request -c IPA\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-g\u003C/code> option specifies the size of key to be generated if one is not already in place.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-D\u003C/code> option specifies the \u003Ccode class=\"literal\">SubjectAltName\u003C/code> DNS value to be added to the request.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-C\u003C/code> option instructs \u003Ccode class=\"literal\">certmonger\u003C/code> to restart the \u003Ccode class=\"literal\">httpd\u003C/code> service after obtaining the certificate.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tTo specify that the certificate be issued with a particular profile, use the \u003Ccode class=\"literal\">-T\u003C/code> option.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tTo request a certificate using the named issuer from the specified CA, use the \u003Ccode class=\"literal\">-X ISSUER\u003C/code> option.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To check the status of your request:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-getcert list -f /etc/pki/tls/certs/httpd.pem\u003C/strong>\u003C/span>\nNumber of certificates and requests being tracked: 3.\nRequest ID '20190604065735':\n    status: MONITORING\n    stuck: no\n    key pair storage: type=FILE,location='/etc/pki/tls/private/httpd.key'\n    certificate: type=FILE,location='/etc/pki/tls/certs/httpd.crt'\n    CA: IPA\n[...]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe output shows that the request is in the \u003Ccode class=\"literal\">MONITORING\u003C/code> status, which means that a certificate has been obtained. The locations of the key pair and the certificate are those requested.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"communication-flow-certmonger-requesting-service-cert_certmonger-for-issuing-renewing-service-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.3. Communication flow for certmonger requesting a service certificate\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThese diagrams show the stages of what happens when \u003Ccode class=\"literal\">certmonger\u003C/code> requests a service certificate from Identity Management (IdM) certificate authority (CA) server. The sequence consists of these diagrams:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-1\" title=\"Figure 19.1. Unencrypted communication\">Unencrypted communication\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-2\" title=\"Figure 19.2. Certmonger requesting a service certificate\">Certmonger requesting a service certificate\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-3\" title=\"Figure 19.3. IdM CA issuing the service certificate\">IdM CA issuing the service certificate\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-4\" title=\"Figure 19.4. Certmonger applying the service certificate\">Certmonger applying the service certificate\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-5\" title=\"Figure 19.5. Certmonger requesting a new certificate when the old one is nearing expiration\">Certmonger requesting a new certificate when the old one is nearing expiration\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-1\" title=\"Figure 19.1. Unencrypted communication\">Unencrypted communication\u003C/a> shows the initial situation: without an HTTPS certificate, the communication between the web server and the browser is unencrypted.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-1\">\u003Cp class=\"title\">\u003Cstrong>Figure 19.1. Unencrypted communication\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/7f96cab7e5e718e3e2e3590b5afd83c1/84_RHEL_IdM_0420_1.png\" alt=\"A diagram displaying an IdM client running an Apache web server and the certmonger service. There are arrows between a browser and the Apache webserver showing it is connecting over an unencrypted HTTP connection. There is an inactive connection from the certmonger service to an IdM CA server.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cbr/>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-2\" title=\"Figure 19.2. Certmonger requesting a service certificate\">Certmonger requesting a service certificate\u003C/a> shows the system administrator using \u003Ccode class=\"literal\">certmonger\u003C/code> to manually request an HTTPS certificate for the Apache web server. Note that when requesting a web server certificate, certmonger does not communicate directly with the CA. It proxies through IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-2\">\u003Cp class=\"title\">\u003Cstrong>Figure 19.2. Certmonger requesting a service certificate\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/9667aa246bcf76921969274115666533/84_RHEL_IdM_0420_2.png\" alt=\"A diagram displaying an arrow between the certmonger service on the IdM client and the IdM CA server to show it is connecting via an ipa-getcert request.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cbr/>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-3\" title=\"Figure 19.3. IdM CA issuing the service certificate\">IdM CA issuing the service certificate\u003C/a> shows an IdM CA issuing an HTTPS certificate for the web server.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-3\">\u003Cp class=\"title\">\u003Cstrong>Figure 19.3. IdM CA issuing the service certificate\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/760743dd58ac7f0566834b5657089cbe/84_RHEL_IdM_0420_3.png\" alt=\"A diagram displaying an arrow between the IdM CA server and the certmonger service on the IdM client - showing it is connecting and sending an HTTPS certificate.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cbr/>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-4\" title=\"Figure 19.4. Certmonger applying the service certificate\">Certmonger applying the service certificate\u003C/a> shows \u003Ccode class=\"literal\">certmonger\u003C/code> placing the HTTPS certificate in appropriate locations on the IdM client and, if instructed to do so, restarting the \u003Ccode class=\"literal\">httpd\u003C/code> service. The Apache server subsequently uses the HTTPS certificate to encrypt the traffic between itself and the browser.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-4\">\u003Cp class=\"title\">\u003Cstrong>Figure 19.4. Certmonger applying the service certificate\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/710c6fb955eeee2dd6fbc2cd2a0e4ff8/84_RHEL_IdM_0420_4.png\" alt=\"A diagram displaying an image of an HTTPS certificate assigned to the Apache web server and one assigned to the certmonger service. There are arrows between the browser and the Apache webserver showing that the connection is now an encrypted HTTPS connection. The connection between the certmonger service and the IdM CA server is inactive.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cbr/>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-5\" title=\"Figure 19.5. Certmonger requesting a new certificate when the old one is nearing expiration\">Certmonger requesting a new certificate when the old one is nearing expiration\u003C/a> shows \u003Ccode class=\"literal\">certmonger\u003C/code> automatically requesting a renewal of the service certificate from the IdM CA before the expiration of the certificate. The IdM CA issues a new certificate.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"certmonger-for-issuing-renewing-service-certs_certmonger-service-cert-5\">\u003Cp class=\"title\">\u003Cstrong>Figure 19.5. Certmonger requesting a new certificate when the old one is nearing expiration\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/419091544b0b5520f3b5c2e321fc2de7/84_RHEL_IdM_0420_5.png\" alt=\"A diagram displaying an arrow from the certmonger service on the IdM client connecting to the IdM CA server to show it is performing an ipa-getcert request. An arrow from the IdM CA server to the Certmonger is labeled HTTPS certificate to show it is transferring an HTTPS certificate to the certmonger service.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cbr/>\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"viewing-cert-tracked-by-certmonger_certmonger-for-issuing-renewing-service-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.4. Viewing the details of a certificate request tracked by certmonger\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal\">certmonger\u003C/code> service monitors certificate requests. When a request for a certificate is successfully signed, it results in a certificate. \u003Ccode class=\"literal\">Certmonger\u003C/code> manages certificate requests including the resulting certificates. Follow this procedure to view the details of a particular certificate request managed by \u003Ccode class=\"literal\">certmonger\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you know how to specify the certificate request, list the details of only that particular certificate request. You can, for example, specify:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe request ID\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe location of the certificate\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe certificate nickname\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFor example, to view the details of the certificate whose request ID is 20190408143846, using the \u003Ccode class=\"literal\">-v\u003C/code> option to view all the details of errors in case your request for a certificate was unsuccessful:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>getcert list -i 20190408143846 -v\u003C/strong>\u003C/span>\nNumber of certificates and requests being tracked: 16.\nRequest ID '20190408143846':\n\tstatus: MONITORING\n\tstuck: no\n\tkey pair storage: type=NSSDB,location='/etc/dirsrv/slapd-IDM-EXAMPLE-COM',nickname='Server-Cert',token='NSS Certificate DB',pinfile='/etc/dirsrv/slapd-IDM-EXAMPLE-COM/pwdfile.txt'\n\tcertificate: type=NSSDB,location='/etc/dirsrv/slapd-IDM-EXAMPLE-COM',nickname='Server-Cert',token='NSS Certificate DB'\n\tCA: IPA\n\tissuer: CN=Certificate Authority,O=IDM.EXAMPLE.COM\n\tsubject: CN=r8server.idm.example.com,O=IDM.EXAMPLE.COM\n\texpires: 2021-04-08 16:38:47 CEST\n\tdns: r8server.idm.example.com\n\tprincipal name: ldap/server.idm.example.com@IDM.EXAMPLE.COM\n\tkey usage: digitalSignature,nonRepudiation,keyEncipherment,dataEncipherment\n\teku: id-kp-serverAuth,id-kp-clientAuth\n\tpre-save command:\n\tpost-save command: /usr/libexec/ipa/certmonger/restart_dirsrv IDM-EXAMPLE-COM\n\ttrack: true\n\tauto-renew: true\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe output displays several pieces of information about the certificate, for example:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tthe certificate location; in the example above, it is the NSS database in the \u003Ccode class=\"literal\">/etc/dirsrv/slapd-IDM-EXAMPLE-COM\u003C/code> directory\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tthe certificate nickname; in the example above, it is \u003Ccode class=\"literal\">Server-Cert\u003C/code>\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tthe file storing the pin; in the example above, it is \u003Ccode class=\"literal\">/etc/dirsrv/slapd-IDM-EXAMPLE-COM/pwdfile.txt\u003C/code>\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tthe Certificate Authority (CA) that will be used to renew the certificate; in the example above, it is the \u003Ccode class=\"literal\">IPA\u003C/code> CA\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tthe expiration date; in the example above, it is \u003Ccode class=\"literal\">2021-04-08 16:38:47 CEST\u003C/code>\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tthe status of the certificate; in the example above, the \u003Ccode class=\"literal\">MONITORING\u003C/code> status means that the certificate is valid and it is being tracked\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tthe post-save command; in the example above, it is the restart of the \u003Ccode class=\"literal\">LDAP\u003C/code> service\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you do not know how to specify the certificate request, list the details of all the certificates that \u003Ccode class=\"literal\">certmonger\u003C/code> is monitoring or attempting to obtain:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>getcert list\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">getcert list\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"start-stop-cert-tracking_certmonger-for-issuing-renewing-service-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.5. Starting and stopping certificate tracking\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use the \u003Ccode class=\"literal\">getcert stop-tracking\u003C/code> and \u003Ccode class=\"literal\">getcert start-tracking\u003C/code> commands to monitor certificates. The two commands are provided by the \u003Ccode class=\"literal\">certmonger\u003C/code> service. Enabling certificate tracking is especially useful if you have imported a certificate issued by the Identity Management (IdM) certificate authority (CA) onto the machine from a different IdM client. Enabling certificate tracking can also be the final step of the following provisioning scenario:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOn the IdM server, you create a certificate for a system that does not exist yet.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou create the new system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou enroll the new system as an IdM client.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou import the certificate and the key from the IdM server on to the IdM client.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou start tracking the certificate using \u003Ccode class=\"literal\">certmonger\u003C/code> to ensure that it gets renewed when it is due to expire.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo disable the monitoring of a certificate with the Request ID of 20190408143846:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>getcert stop-tracking -i 20190408143846\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor more options, see the \u003Ccode class=\"literal\">getcert stop-tracking\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo enable the monitoring of a certificate stored in the \u003Ccode class=\"literal\">/tmp/some_cert.crt\u003C/code> file, whose private key is stored in the \u003Ccode class=\"literal\">/tmp/some_key.key\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>getcert start-tracking -c IPA -f /tmp/some_cert.crt -k /tmp/some_key.key\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">Certmonger\u003C/code> cannot automatically identify the CA type that issued the certificate. For this reason, add the \u003Ccode class=\"literal\">-c\u003C/code> option with the \u003Ccode class=\"literal\">IPA\u003C/code> value to the \u003Ccode class=\"literal\">getcert start-tracking\u003C/code> command if the certificate was issued by the IdM CA. Omitting to add the \u003Ccode class=\"literal\">-c\u003C/code> option results in \u003Ccode class=\"literal\">certmonger\u003C/code> entering the NEED_CA state.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor more options, see the \u003Ccode class=\"literal\">getcert start-tracking\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe two commands do not manipulate the certificate. For example, \u003Ccode class=\"literal\">getcert stop-tracking\u003C/code> does not delete the certificate or remove it from the NSS database or from the filesystem but simply removes the certificate from the list of monitored certificates. Similarly, \u003Ccode class=\"literal\">getcert start-tracking\u003C/code> only adds a certificate to the list of monitored certificates.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"renew-cert_certmonger-for-issuing-renewing-service-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.6. Renewing a certificate manually\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tWhen a certificate is near its expiration date, the \u003Ccode class=\"literal\">certmonger\u003C/code> daemon automatically issues a renewal command using the certificate authority (CA) helper, obtains a renewed certificate and replaces the previous certificate with the new one.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can also manually renew a certificate in advance by using the \u003Ccode class=\"literal\">getcert resubmit\u003C/code> command. This way, you can update the information the certificate contains, for example, by adding a Subject Alternative Name (SAN).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to renew a certificate manually.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo renew a certificate with the Request ID of 20190408143846:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>getcert resubmit -i 20190408143846\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo obtain the Request ID for a specific certificate, use the \u003Ccode class=\"literal\">getcert list\u003C/code> command. For details, see the \u003Ccode class=\"literal\">getcert list\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"add-tracking-back-to-idm-certs_certmonger-for-issuing-renewing-service-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.7. Making certmonger resume tracking of IdM certificates on a CA replica\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThis procedure shows how to make \u003Ccode class=\"literal\">certmonger\u003C/code> resume the tracking of Identity Management (IdM) system certificates that are crucial for an IdM deployment with an integrated certificate authority after the tracking of certificates was interrupted. The interruption may have been caused by the IdM host being unenrolled from IdM during the renewal of the system certificates or by replication topology not working properly. The procedure also shows how to make \u003Ccode class=\"literal\">certmonger\u003C/code> resume the tracking of the IdM service certificates, namely the \u003Ccode class=\"literal\">HTTP\u003C/code>, \u003Ccode class=\"literal\">LDAP\u003C/code> and \u003Ccode class=\"literal\">PKINIT\u003C/code> certificates.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host on which you want to resume tracking system certificates is an IdM server that is also an IdM certificate authority (CA) but not the IdM CA renewal server.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGet the PIN for the subsystem CA certificates:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>grep 'internal=' /var/lib/pki/pki-tomcat/conf/password.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd tracking to the subsystem CA certificates, replacing \u003Ccode class=\"literal\">[internal PIN]\u003C/code> in the commands below with the PIN obtained in the previous step:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n \"caSigningCert cert-pki-ca\" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert \"caSigningCert cert-pki-ca\"' -T caCACert\u003C/strong>\u003C/span>\n\n# \u003Cspan class=\"strong strong\">\u003Cstrong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n \"auditSigningCert cert-pki-ca\" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert \"auditSigningCert cert-pki-ca\"' -T caSignedLogCert\u003C/strong>\u003C/span>\n\n# \u003Cspan class=\"strong strong\">\u003Cstrong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n \"ocspSigningCert cert-pki-ca\" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert \"ocspSigningCert cert-pki-ca\"' -T caOCSPCert\u003C/strong>\u003C/span>\n\n# \u003Cspan class=\"strong strong\">\u003Cstrong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n \"subsystemCert cert-pki-ca\" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert \"subsystemCert cert-pki-ca\"' -T caSubsystemCert\u003C/strong>\u003C/span>\n\n# \u003Cspan class=\"strong strong\">\u003Cstrong>getcert start-tracking -d /etc/pki/pki-tomcat/alias -n \"Server-Cert cert-pki-ca\" -c 'dogtag-ipa-ca-renew-agent' -P [internal PIN] -B /usr/libexec/ipa/certmonger/stop_pkicad -C '/usr/libexec/ipa/certmonger/renew_ca_cert \"Server-Cert cert-pki-ca\"' -T caServerCert\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd tracking for the remaining IdM certificates, the \u003Ccode class=\"literal\">HTTP\u003C/code>, \u003Ccode class=\"literal\">LDAP\u003C/code>, \u003Ccode class=\"literal\">IPA renewal agent\u003C/code> and \u003Ccode class=\"literal\">PKINIT\u003C/code> certificates:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>getcert start-tracking -f /var/lib/ipa/certs/httpd.crt -k /var/lib/ipa/private/httpd.key -p /var/lib/ipa/passwds/idm.example.com-443-RSA -c IPA -C /usr/libexec/ipa/certmonger/restart_httpd -T caIPAserviceCert\u003C/strong>\u003C/span>\n\n# \u003Cspan class=\"strong strong\">\u003Cstrong>getcert start-tracking -d /etc/dirsrv/slapd-IDM-EXAMPLE-COM -n \"Server-Cert\" -c IPA -p /etc/dirsrv/slapd-IDM-EXAMPLE-COM/pwdfile.txt -C '/usr/libexec/ipa/certmonger/restart_dirsrv \"IDM-EXAMPLE-COM\"' -T caIPAserviceCert\u003C/strong>\u003C/span>\n\n# \u003Cspan class=\"strong strong\">\u003Cstrong>getcert start-tracking -f /var/lib/ipa/ra-agent.pem -k /var/lib/ipa/ra-agent.key -c dogtag-ipa-ca-renew-agent -B /usr/libexec/ipa/certmonger/renew_ra_cert_pre -C /usr/libexec/ipa/certmonger/renew_ra_cert -T caSubsystemCert\u003C/strong>\u003C/span>\n\n# \u003Cspan class=\"strong strong\">\u003Cstrong>getcert start-tracking -f /var/kerberos/krb5kdc/kdc.crt -k /var/kerberos/krb5kdc/kdc.key -c dogtag-ipa-ca-renew-agent -B /usr/libexec/ipa/certmonger/renew_ra_cert_pre -C /usr/libexec/ipa/certmonger/renew_kdc_cert -T KDCs_PKINIT_Certs\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart \u003Ccode class=\"literal\">certmonger\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart certmonger\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWait for one minute after \u003Ccode class=\"literal\">certmonger\u003C/code> has started and then check the statuses of the new certificates:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>getcert list\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf your IdM system certificates have all expired, see \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/3357261\">this Knowledge Centered Support (KCS) solution\u003C/a> to manually renew IdM system certificates on the IdM CA server that is also the CA renewal server and the CRL publisher server. Then follow the procedure described in \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/3357331\">this KCS solution\u003C/a> to manually renew IdM system certificates on all the other CA servers in the topology.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"assembly_using-scep-with-certmonger_certmonger-for-issuing-renewing-service-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.8. Using SCEP with certmonger\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe Simple Certificate Enrollment Protocol (SCEP) is a certificate management protocol that you can use across different devices and operating systems. If you are using a SCEP server as an external certificate authority (CA) in your environment, you can use \u003Ccode class=\"literal\">certmonger\u003C/code> to obtain a certificate for an Identity Management (IdM) client.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"con_scep-overview_assembly_using-scep-with-certmonger\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">19.8.1. SCEP overview\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tThe Simple Certificate Enrollment Protocol (SCEP) is a certificate management protocol that you can use across different devices and operating systems. You can use a SCEP server as an external certificate authority (CA).\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tYou can configure an Identity Management (IdM) client to request and retrieve a certificate over HTTP directly from the CA SCEP service. This process is secured by a shared secret that is usually valid only for a limited time.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tOn the client side, SCEP requires you to provide the following components:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSCEP URL: the URL of the CA SCEP interface.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSCEP shared secret: a \u003Ccode class=\"literal\">challengePassword\u003C/code> PIN shared between the CA and the SCEP client, used to obtain the certificate.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\tThe client then retrieves the CA certificate chain over SCEP and sends a certificate signing request to the CA.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tWhen configuring SCEP with \u003Ccode class=\"literal\">certmonger\u003C/code>, you create a new CA configuration profile that specifies the issued certificate parameters.\n\t\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"proc_requesting-an-idm-ca-signed-certificate-through-scep_assembly_using-scep-with-certmonger\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">19.8.2. Requesting an IdM CA-signed certificate through SCEP\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tThe following example adds a \u003Ccode class=\"literal\">SCEP_example\u003C/code> SCEP CA configuration to \u003Ccode class=\"literal\">certmonger\u003C/code> and requests a new certificate on the \u003Ccode class=\"literal\">client.idm.example.com\u003C/code> IdM client. \u003Ccode class=\"literal\">certmonger\u003C/code> supports both the NSS certificate database format and file-based (PEM) formats, such as OpenSSL.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou know the SCEP URL.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou have the \u003Ccode class=\"literal\">challengePassword\u003C/code> PIN shared secret.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAdd the CA configuration to \u003Ccode class=\"literal\">certmonger\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@client.idm.example.com ~]# getcert add-scep-ca -c \u003Cspan class=\"emphasis\">\u003Cem>SCEP_example\u003C/em>\u003C/span> -u \u003Cspan class=\"emphasis\">\u003Cem>SCEP_URL\u003C/em>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-c\u003C/code>: Mandatory nickname for the CA configuration. The same value can later be used with other \u003Ccode class=\"literal\">getcert\u003C/code> commands.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-u\u003C/code>: URL of the server’s SCEP interface.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\t\tWhen using an HTTPS URL, you must also specify the location of the PEM-formatted copy of the SCEP server CA certificate using the \u003Ccode class=\"literal\">-R\u003C/code> option.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify that the CA configuration has been successfully added:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@client.idm.example.com ~]# getcert list-cas -c SCEP_example\nCA 'SCEP_example':\n       is-default: no\n       ca-type: EXTERNAL\n       helper-location: /usr/libexec/certmonger/scep-submit -u http://SCEP_server_enrollment_interface_URL\n       SCEP CA certificate thumbprint (MD5): A67C2D4B 771AC186 FCCA654A 5E55AAF7\n       SCEP CA certificate thumbprint (SHA1): FBFF096C 6455E8E9 BD55F4A5 5787C43F 1F512279\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf the configuration was successfully added, certmonger retrieves the CA chain from the remote CA. The CA chain then appears as thumbprints in the command output. When accessing the server over unencrypted HTTP, manually compare the thumbprints with the ones displayed at the SCEP server to prevent a man-in-the-middle attack.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRequest a certificate from the CA:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you are using NSS:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@client.idm.example.com ~]# getcert request -I \u003Cspan class=\"emphasis\">\u003Cem>Example_Task\u003C/em>\u003C/span> -c \u003Cspan class=\"emphasis\">\u003Cem>SCEP_example\u003C/em>\u003C/span> -d /etc/pki/nssdb -n \u003Cspan class=\"emphasis\">\u003Cem>ExampleCert\u003C/em>\u003C/span> -N cn=\"\u003Cspan class=\"emphasis\">\u003Cem>client.idm.example.com\u003C/em>\u003C/span>\" -L \u003Cspan class=\"emphasis\">\u003Cem>one-time_PIN\u003C/em>\u003C/span> -D \u003Cspan class=\"emphasis\">\u003Cem>client.idm.example.com\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tYou can use the options to specify the following parameters of the certificate request:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-I\u003C/code>: \u003Cspan class=\"emphasis\">\u003Cem>(Optional)\u003C/em>\u003C/span> Name of the task: the tracking ID for the request. The same value can later be used with the \u003Ccode class=\"literal\">getcert list\u003C/code> command.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-c\u003C/code>: CA configuration to submit the request to.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-d\u003C/code>: Directory with the NSS database to store the certificate and key.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-n\u003C/code>: Nickname of the certificate, used in the NSS database.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-N\u003C/code>: Subject name in the CSR.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-L\u003C/code>: Time-limited one-time \u003Ccode class=\"literal\">challengePassword\u003C/code> PIN issued by the CA.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-D\u003C/code>: Subject Alternative Name for the certificate, usually the same as the host name.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you are using OpenSSL:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@client.idm.example.com ~]# getcert request -I \u003Cspan class=\"emphasis\">\u003Cem>Example_Task\u003C/em>\u003C/span> -c \u003Cspan class=\"emphasis\">\u003Cem>SCEP_example\u003C/em>\u003C/span> -f /etc/pki/tls/certs/server.crt -k /etc/pki/tls/private/private.key -N cn=\"\u003Cspan class=\"emphasis\">\u003Cem>client.idm.example.com\u003C/em>\u003C/span>\" -L \u003Cspan class=\"emphasis\">\u003Cem>one-time_PIN\u003C/em>\u003C/span> -D \u003Cspan class=\"emphasis\">\u003Cem>client.idm.example.com\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tYou can use the options to specify the following parameters of the certificate request:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-I\u003C/code>: \u003Cspan class=\"emphasis\">\u003Cem>(Optional)\u003C/em>\u003C/span> Name of the task: the tracking ID for the request. The same value can later be used with the \u003Ccode class=\"literal\">getcert list\u003C/code> command.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-c\u003C/code>: CA configuration to submit the request to.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-f\u003C/code>: Storage path to the certificate.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-k\u003C/code>: Storage path to the key.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-N\u003C/code>: Subject name in the CSR.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-L\u003C/code>: Time-limited one-time \u003Ccode class=\"literal\">challengePassword\u003C/code> PIN issued by the CA.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-D\u003C/code>: Subject Alternative Name for the certificate, usually the same as the host name.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify that a certificate was issued and correctly stored in the local database:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you used NSS, enter:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[root@client.idm.example.com ~]# getcert list -I Example_Task\n\tRequest ID 'Example_Task':\n        status: MONITORING\n        stuck: no\n        key pair storage: type=NSSDB,location='/etc/pki/nssdb',nickname='ExampleCert',token='NSS Certificate DB'\n        certificate: type=NSSDB,location='/etc/pki/nssdb',nickname='ExampleCert',token='NSS Certificate DB'\n        signing request thumbprint (MD5): 503A8EDD DE2BE17E 5BAA3A57 D68C9C1B\n        signing request thumbprint (SHA1): B411ECE4 D45B883A 75A6F14D 7E3037F1 D53625F4\n        CA: IPA\n        issuer: CN=Certificate Authority,O=EXAMPLE.COM\n        subject: CN=client.idm.example.com,O=EXAMPLE.COM\n        expires: 2018-05-06 10:28:06 UTC\n        key usage: digitalSignature,keyEncipherment\n        eku: iso.org.dod.internet.security.mechanisms.8.2.2\n        certificate template/profile: IPSECIntermediateOffline\n        pre-save command:\n        post-save command:\n        track: true\n\tauto-renew: true\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you used OpenSSL, enter:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[root@client.idm.example.com ~]# getcert list -I Example_Task\nRequest ID 'Example_Task':\n       status: MONITORING\n       stuck: no\n       key pair storage: type=FILE,location='/etc/pki/tls/private/private.key'\n       certificate: type=FILE,location='/etc/pki/tls/certs/server.crt'\n       CA: IPA\n       issuer: CN=Certificate Authority,O=EXAMPLE.COM\n       subject: CN=client.idm.example.com,O=EXAMPLE.COM\n       expires: 2018-05-06 10:28:06 UTC\n       eku: id-kp-serverAuth,id-kp-clientAuth\n       pre-save command:\n       post-save command:\n       track: true\n       auto-renew: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tThe status \u003Cspan class=\"strong strong\">\u003Cstrong>MONITORING\u003C/strong>\u003C/span> signifies a successful retrieval of the issued certificate. The \u003Ccode class=\"literal\">getcert-list(1)\u003C/code> man page lists other possible states and their meanings.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tFor more options when requesting a certificate, see the \u003Ccode class=\"literal\">getcert-request(1)\u003C/code> man page on your system.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_automatically-renewing-ad-scep-certificates-with-certmonger_assembly_using-scep-with-certmonger\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">19.8.3. Automatically renewing AD SCEP certificates with certmonger\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tWhen \u003Ccode class=\"literal\">certmonger\u003C/code> sends a SCEP certificate renewal request, this request is signed using the existing certificate private key. However, renewal requests sent by \u003Ccode class=\"literal\">certmonger\u003C/code> by default also include the \u003Ccode class=\"literal\">challengePassword\u003C/code> PIN that was used to originally obtain the certificates.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tAn Active Directory (AD) Network Device Enrollment Service (NDES) server that works as the SCEP server automatically rejects any requests for renewal that contain the original \u003Ccode class=\"literal\">challengePassword\u003C/code> PIN. Consequently, the renewal fails.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tFor renewal with AD to work, you need to configure \u003Ccode class=\"literal\">certmonger\u003C/code> to send the signed renewal requests without the \u003Ccode class=\"literal\">challengePassword\u003C/code> PIN. You also need to configure the AD server so that it does not compare the subject name at renewal.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tThere may be SCEP servers other than AD that also refuse requests containing the \u003Ccode class=\"literal\">challengePassword\u003C/code>. In those cases, you may also need to change the \u003Ccode class=\"literal\">certmonger\u003C/code> configuration in this way.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe RHEL server has to be running RHEL 8.6 or newer.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tOpen \u003Ccode class=\"literal\">regedit\u003C/code> on the AD server.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MSCEP\u003C/strong>\u003C/span> subkey, add a new 32-bit REG_DWORD entry \u003Ccode class=\"literal\">DisableRenewalSubjectNameMatch\u003C/code> and set its value to \u003Ccode class=\"literal\">1\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOn the server where \u003Ccode class=\"literal\">certmonger\u003C/code> is running, open the \u003Ccode class=\"literal\">/etc/certmonger/certmonger.conf\u003C/code> file and add the following section:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[scep]\nchallenge_password_otp = yes\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRestart certmonger:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># systemctl restart certmonger\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"deploying-and-managing-the-acme-service-in-idm_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 20. Deploying and managing the ACME service in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tThis feature is a technology preview.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\tAutomated Certificate Management Environment (ACME) is a protocol for automated identifier validation and certificate issuance. Its goal is to improve security by reducing certificate lifetimes and avoiding manual processes in certificate lifecycle management.\n\t\t\u003C/p>\u003Cp>\n\t\t\tUsing RHEL Identity Management (IdM), the administrator can easily deploy and manage the ACME service topology-wide from a single system.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.1. The ACME service in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThis feature is a technology preview.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIdM currently supports ACME only in RHEL 9.2 or newer with Random Certificate Serial Numbers (RSNv3) enabled.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tACME uses a challenge and response authentication mechanism to prove that a client has control of an identifier. In ACME, an identifier is a proof of ownership used to obtain a certificate by solving a challenge. In Identity Management (IdM), ACME currently supports the following challenges:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">dns-01\u003C/code> where the client creates DNS records to prove it has control of the identifier\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">http-01\u003C/code> where the client provisions an HTTP resource to prove it has control of the identifier\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIn IdM, the ACME service uses the PKI ACME responder. The ACME subsystem is automatically deployed on every CA server in the IdM deployment, but it will not service requests until the administrator enables it. The servers are discovered using the name \u003Ccode class=\"literal\">ipa-ca.DOMAIN\u003C/code>. All IdM CA servers are registered with this DNS name so requests are load balanced via round-robin to them.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tACME is also deployed, but disabled, when the administrator upgrades a server using the \u003Ccode class=\"literal\">ipa-server-upgrade\u003C/code> command.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tACME runs as a separate service within Apache Tomcat. The ACME configuration files are stored in \u003Ccode class=\"literal\">/etc/pki/pki-tomcat/acme\u003C/code> and PKI logs ACME information to \u003Ccode class=\"literal\">/var/log/pki/pki-tomcat/acme/\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIdM uses the \u003Ccode class=\"literal\">acmeIPAServerCert\u003C/code> profile when issuing ACME certificates. The validity period of issued certificates is 90 days. For this reason, it is strongly recommended to set ACME to automatically remove expired certificates so that they do not accumulate in the CA, as this could negatively affect performance.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThere are different ACME clients available. For use with RHEL, the chosen client must support either of the \u003Ccode class=\"literal\">dns-01\u003C/code> and \u003Ccode class=\"literal\">http-01\u003C/code> challenges. Currently, the following clients have been tested and are known to work with ACME in RHEL:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">certbot\u003C/code> with both the \u003Ccode class=\"literal\">http-01\u003C/code> and \u003Ccode class=\"literal\">dns-01\u003C/code> challenges\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">mod_md\u003C/code>, which supports only the \u003Ccode class=\"literal\">http-01\u003C/code> challenge\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"enabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.2. Enabling the ACME service in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThis feature is a technology preview.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tBy default, the ACME service is deployed, but disabled. Enabling the ACME service enables it on all IdM CA servers across the entire IdM deployment. This is handled via replication.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn this example, you enable ACME and set it to automatically remove expired certificates on the first day of every month at midnight.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tServers in the IdM deployment are running RHEL 9.2 or newer with Random Certificate Serial Numbers (RSNv3) enabled.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have root privileges on the IdM server on which you are running the procedure.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnable ACME across the whole IdM deployment:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># ipa-acme-manage enable\nThe ipa-acme-manage command was successful\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSet ACME to automatically remove expired certificates from the CA:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># ipa-acme-manage pruning --enable --cron \"0 0 1 * *\"\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tExpired certificates are removed after their retention period. By default, this is 30 days after expiry.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo check if the ACME service is installed and enabled, use the \u003Ccode class=\"literal command\">ipa-acme-manage status\u003C/code> command:\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"screen\"># ipa-acme-manage status\nACME is enabled\nThe ipa-acme-manage command was successful\u003C/pre>\u003C/section>\u003Csection class=\"section\" id=\"disabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.3. Disabling the ACME service in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThis feature is a technology preview.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tDisabling the ACME service disables it across the entire IdM deployment. This is handled via replication.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tServers in the IdM deployment are running RHEL 9.2 or newer with Random Certificate Serial Numbers (RSNv3) enabled.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have root privileges on the IdM server on which you are running the procedure.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisable ACME across the whole IdM deployment:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># ipa-acme-manage disable\nThe ipa-acme-manage command was successful\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Disable automatic removal of expired certificates:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">ipa-acme-manage pruning --disable\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo check if the ACME service is installed, but disabled, use the \u003Ccode class=\"literal command\">ipa-acme-manage status\u003C/code> command:\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"screen\"># ipa-acme-manage status\nACME is disabled\nThe ipa-acme-manage command was successful\u003C/pre>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"requesting-certificates-using-rhel-system-roles_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 21. Requesting certificates by using the RHEL system role\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tYou can use the \u003Ccode class=\"literal\">certificate\u003C/code> system role to issue and manage certificates.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"the-certificate-system-role_requesting-certificates-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">21.1. The \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUsing the \u003Ccode class=\"literal\">certificate\u003C/code> system role, you can manage issuing and renewing TLS and SSL certificates using Ansible Core.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe role uses \u003Ccode class=\"literal\">certmonger\u003C/code> as the certificate provider, and currently supports issuing and renewing self-signed certificates and using the IdM integrated certificate authority (CA).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the following variables in your Ansible playbook with the \u003Ccode class=\"literal\">certificate\u003C/code> system role:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">certificate_wait\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tto specify if the task should wait for the certificate to be issued.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">certificate_requests\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tto represent each certificate to be issued and its parameters.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/certificate/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">21.2. Requesting a new self-signed certificate by using the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWith the \u003Ccode class=\"literal\">certificate\u003C/code> system role, you can use Ansible Core to issue self-signed certificates.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis process uses the \u003Ccode class=\"literal\">certmonger\u003C/code> provider and requests the certificate through the \u003Ccode class=\"literal\">getcert\u003C/code> command.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- hosts: managed-node-01.example.com\n  roles:\n    - rhel-system-roles.certificate\n  vars:\n    certificate_requests:\n      - name: mycert\n        dns: \"*.example.com\"\n        ca: self-sign\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> parameter to the desired name of the certificate, such as \u003Ccode class=\"literal\">mycert\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">dns\u003C/code> parameter to the domain to be included in the certificate, such as \u003Ccode class=\"literal\">*.example.com\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ca\u003C/code> parameter to \u003Ccode class=\"literal\">self-sign\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBy default, \u003Ccode class=\"literal\">certmonger\u003C/code> automatically tries to renew the certificate before it expires. You can disable this by setting the \u003Ccode class=\"literal\">auto_renew\u003C/code> parameter in the Ansible playbook to \u003Ccode class=\"literal\">no\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/certificate/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">21.3. Requesting a new certificate from IdM CA by using the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWith the \u003Ccode class=\"literal\">certificate\u003C/code> system role, you can use \u003Ccode class=\"literal\">anible-core\u003C/code> to issue certificates while using an IdM server with an integrated certificate authority (CA). Therefore, you can efficiently and consistently manage the certificate trust chain for multiple systems when using IdM as the CA.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis process uses the \u003Ccode class=\"literal\">certmonger\u003C/code> provider and requests the certificate through the \u003Ccode class=\"literal\">getcert\u003C/code> command.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- hosts: managed-node-01.example.com\n  roles:\n    - rhel-system-roles.certificate\n  vars:\n    certificate_requests:\n      - name: mycert\n        dns: www.example.com\n        principal: HTTP/www.example.com@EXAMPLE.COM\n        ca: ipa\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> parameter to the desired name of the certificate, such as \u003Ccode class=\"literal\">mycert\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">dns\u003C/code> parameter to the domain to be included in the certificate, such as \u003Ccode class=\"literal\">www.example.com\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">principal\u003C/code> parameter to specify the Kerberos principal, such as \u003Ccode class=\"literal\">HTTP/www.example.com@EXAMPLE.COM\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ca\u003C/code> parameter to \u003Ccode class=\"literal\">ipa\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBy default, \u003Ccode class=\"literal\">certmonger\u003C/code> automatically tries to renew the certificate before it expires. You can disable this by setting the \u003Ccode class=\"literal\">auto_renew\u003C/code> parameter in the Ansible playbook to \u003Ccode class=\"literal\">no\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/certificate/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"specifying-commands-to-run-before-or-after-certificate-issuance-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">21.4. Specifying commands to run before or after certificate issuance by using the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWith the \u003Ccode class=\"literal\">certificate\u003C/code> Role, you can use Ansible Core to execute a command before and after a certificate is issued or renewed.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn the following example, the administrator ensures stopping the \u003Ccode class=\"literal\">httpd\u003C/code> service before a self-signed certificate for \u003Ccode class=\"literal\">www.example.com\u003C/code> is issued or renewed, and restarting it afterwards.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- hosts: managed-node-01.example.com\n  roles:\n    - rhel-system-roles.certificate\n  vars:\n    certificate_requests:\n      - name: mycert\n        dns: www.example.com\n        ca: self-sign\n        run_before: systemctl stop httpd.service\n        run_after: systemctl start httpd.service\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> parameter to the desired name of the certificate, such as \u003Ccode class=\"literal\">mycert\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">dns\u003C/code> parameter to the domain to be included in the certificate, such as \u003Ccode class=\"literal\">www.example.com\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ca\u003C/code> parameter to the CA you want to use to issue the certificate, such as \u003Ccode class=\"literal\">self-sign\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">run_before\u003C/code> parameter to the command you want to execute before this certificate is issued or renewed, such as \u003Ccode class=\"literal\">systemctl stop httpd.service\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">run_after\u003C/code> parameter to the command you want to execute after this certificate is issued or renewed, such as \u003Ccode class=\"literal\">systemctl start httpd.service\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBy default, \u003Ccode class=\"literal\">certmonger\u003C/code> automatically tries to renew the certificate before it expires. You can disable this by setting the \u003Ccode class=\"literal\">auto_renew\u003C/code> parameter in the Ansible playbook to \u003Ccode class=\"literal\">no\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/certificate/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 22. Restricting an application to trust only a subset of certificates\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tIf your Identity Management (IdM) installation is configured with the integrated Certificate System (CS) certificate authority (CA), you are able to create lightweight sub-CAs. All sub-CAs you create are subordinated to the primary CA of the certificate system, the \u003Cspan class=\"strong strong\">\u003Cstrong>ipa\u003C/strong>\u003C/span> CA.\n\t\t\u003C/p>\u003Cp>\n\t\t\tA \u003Cspan class=\"emphasis\">\u003Cem>lightweight sub-CA\u003C/em>\u003C/span> in this context means \u003Cspan class=\"emphasis\">\u003Cem>a sub-CA issuing certificates for a specific purpose\u003C/em>\u003C/span>. For example, a lightweight sub-CA enables you to configure a service, such as a virtual private network (VPN) gateway and a web browser, to accept only certificates issued by \u003Cspan class=\"emphasis\">\u003Cem>sub-CA A\u003C/em>\u003C/span>. By configuring other services to accept certificates only issued by \u003Cspan class=\"emphasis\">\u003Cem>sub-CA B\u003C/em>\u003C/span>, you prevent them from accepting certificates issued by \u003Cspan class=\"emphasis\">\u003Cem>sub-CA A\u003C/em>\u003C/span>, the primary CA, that is the \u003Ccode class=\"literal\">ipa\u003C/code> CA, and any intermediate sub-CA between the two.\n\t\t\u003C/p>\u003Cp>\n\t\t\tIf you revoke the intermediate certificate of a sub-CA, \u003Ca class=\"link\" href=\"#invalidating-a-specific-group-of-related-certificates-quickly_managing-certificates-in-idm\" title=\"Chapter 23. Invalidating a specific group of related certificates quickly\">all certificates issued by this sub-CA are automatically considered invalid\u003C/a> by correctly configured clients. All the other certificates issued directly by the root CA, \u003Cspan class=\"strong strong\">\u003Cstrong>ipa\u003C/strong>\u003C/span>, or another sub-CA, remain valid.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThis section uses the example of the Apache web server to illustrate how to restrict an application to trust only a subset of certificates. Complete this section to restrict the web server running on your IdM client to use a certificate issued by the \u003Cspan class=\"strong strong\">\u003Cstrong>webserver-ca\u003C/strong>\u003C/span> IdM sub-CA, and to require the users to authenticate to the web server using user certificates issued by the \u003Cspan class=\"strong strong\">\u003Cstrong>webclient-ca\u003C/strong>\u003C/span> IdM sub-CA.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThe steps you need to take are:\n\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.1. Managing lightweight sub-CAs\">Create an IdM sub-CA\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.2. Downloading the sub-CA certificate from IdM WebUI\">Download the sub-CA certificate from IdM WebUI\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.3. Creating CA ACLs for web server and client authentication\">Create a CA ACL specifying the correct combination of users, services and CAs, and the certificate profile used\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.4. Obtaining an IdM certificate for a service using certmonger\">Request a certificate for the web service running on an IdM client from the IdM sub-CA\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.6. Setting up a single-instance Apache HTTP Server\">Set up a single-instance Apache HTTP Server\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.7. Adding TLS encryption to an Apache HTTP Server\">Add TLS encryption to the Apache HTTP Server\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#setting-the-supported-tls-protocol-versions-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.8. Setting the supported TLS protocol versions on an Apache HTTP Server\">Set the supported TLS protocol versions on an Apache HTTP Server\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#setting-the-supported-ciphers-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.9. Setting the supported ciphers on an Apache HTTP Server\">Set the supported ciphers on the Apache HTTP Server\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-tls-client-certificate-authentication_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.10. Configuring TLS client certificate authentication\">Configure TLS client certificate authentication on the web server\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.11. Requesting a new user certificate and exporting it to the client\">Request a certificate for the user from the IdM sub-CA and export it to the client\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.12. Configuring a browser to enable certificate authentication\">Import the user certificate into the browser and configure the browser to trust the sub-CA certificate\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Csection class=\"section\" id=\"creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.1. Managing lightweight sub-CAs\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThis section describes how to manage lightweight subordinate certificate authorities (sub-CAs). All sub-CAs you create are subordinated to the primary CA of the certificate system, the \u003Ccode class=\"literal\">ipa\u003C/code> CA. You can also disable and delete sub-CAs.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIf you delete a sub-CA, revocation checking for that sub-CA will no longer work. Only delete a sub-CA when there are no more certificates that were issued by that sub-CA whose \u003Ccode class=\"literal\">notAfter\u003C/code> expiration time is in the future.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou should only disable sub-CAs while there are still non-expired certificates that were issued by that sub-CA. If all certificates that were issued by a sub-CA have expired, you can delete that sub-CA.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou cannot disable or delete the IdM CA.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tFor details on managing sub-CAs, see:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#creating-a-sub-CA-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.1.1. Creating a sub-CA from the IdM WebUI\">Creating a sub-CA from the IdM WebUI\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_deleting-a-sub-ca-from-the-idm-webui_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.1.2. Deleting a sub-CA from the IdM WebUI\">Deleting a sub-CA from the IdM WebUI\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#creating-a-sub-CA-from-IdM-CLI_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.1.3. Creating a sub-CA from the IdM CLI\">Creating a sub-CA from the IdM CLI\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_disabling-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.1.4. Disabling a sub-CA from the IdM CLI\">Disabling a sub-CA from the IdM CLI\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_deleting-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.1.5. Deleting a sub-CA from the IdM CLI\">Deleting a sub-CA from the IdM CLI \u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"creating-a-sub-CA-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">22.1.1. Creating a sub-CA from the IdM WebUI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tFollow this procedure to use the IdM WebUI to create new sub-CAs named \u003Cspan class=\"strong strong\">\u003Cstrong>webserver-ca\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>webclient-ca\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tMake sure you have obtained the administrator’s credentials.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Authentication\u003C/strong>\u003C/span> menu, click \u003Cspan class=\"strong strong\">\u003Cstrong>Certificates\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSelect \u003Cspan class=\"strong strong\">\u003Cstrong>Certificate Authorities\u003C/strong>\u003C/span> and click \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tEnter the name of the \u003Cspan class=\"strong strong\">\u003Cstrong>webserver-ca\u003C/strong>\u003C/span> sub-CA. Enter the Subject DN, for example \u003Cspan class=\"strong strong\">\u003Cstrong>CN=WEBSERVER,O=IDM.EXAMPLE.COM\u003C/strong>\u003C/span>, in the Subject DN field. Note that the Subject DN must be unique in the IdM CA infrastructure.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tEnter the name of the \u003Cspan class=\"strong strong\">\u003Cstrong>webclient-ca\u003C/strong>\u003C/span> sub-CA. Enter the Subject DN \u003Cspan class=\"strong strong\">\u003Cstrong>CN=WEBCLIENT,O=IDM.EXAMPLE.COM\u003C/strong>\u003C/span> in the Subject DN field.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIn the command-line interface, run the \u003Ccode class=\"literal\">ipa-certupdate\u003C/code> command to create a \u003Cspan class=\"strong strong\">\u003Cstrong>certmonger\u003C/strong>\u003C/span> tracking request for the \u003Cspan class=\"strong strong\">\u003Cstrong>webserver-ca\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>webclient-ca\u003C/strong>\u003C/span> sub-CA certificates:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@ipaserver ~]# \u003Ccode class=\"literal\">ipa-certupdate\u003C/code>\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tForgetting to run the \u003Ccode class=\"literal\">ipa-certupdate\u003C/code> command after creating a sub-CA means that if the sub-CA certificate expires, end-entity certificates issued by the sub-CA are considered invalid even if the end-entity certificate has not expired.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify that the signing certificate of the new sub-CA has been added to the IdM database:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@ipaserver ~]# \u003Ccode class=\"literal\">certutil -d /etc/pki/pki-tomcat/alias/ -L\u003C/code>\n\nCertificate Nickname                      Trust Attributes\n                                          SSL,S/MIME,JAR/XPI\n\ncaSigningCert cert-pki-ca                 CTu,Cu,Cu\nServer-Cert cert-pki-ca                   u,u,u\nauditSigningCert cert-pki-ca              u,u,Pu\n\u003Cspan class=\"strong strong\">\u003Cstrong>caSigningCert cert-pki-ca ba83f324-5e50-4114-b109-acca05d6f1dc u,u,u\u003C/strong>\u003C/span>\nocspSigningCert cert-pki-ca               u,u,u\nsubsystemCert cert-pki-ca                 u,u,u\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tThe new sub-CA certificate is automatically transferred to all the replicas that have a certificate system instance installed.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_deleting-a-sub-ca-from-the-idm-webui_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">22.1.2. Deleting a sub-CA from the IdM WebUI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tFollow this procedure to delete lightweight sub-CAs in the IdM WebUI.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIf you delete a sub-CA, revocation checking for that sub-CA will no longer work. Only delete a sub-CA when there are no more certificates that were issued by that sub-CA whose \u003Ccode class=\"literal\">notAfter\u003C/code> expiration time is in the future.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou should only disable sub-CAs while there are still non-expired certificates that were issued by that sub-CA. If all certificates that were issued by a sub-CA have expired, you can delete that sub-CA.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou cannot disable or delete the IdM CA.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tMake sure you have obtained the administrator’s credentials.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou have disabled the sub-CA in the IdM CLI. See \u003Ca class=\"link\" href=\"#proc_disabling-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.1.4. Disabling a sub-CA from the IdM CLI\">Disabling a sub-CA from the IdM CLI\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIn the IdM WebUI, open the \u003Ccode class=\"literal\">Authentication\u003C/code> tab, and select the \u003Ccode class=\"literal\">Certificates\u003C/code> subtab.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSelect \u003Ccode class=\"literal\">Certificate Authorities\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tSelect the sub-CA to remove and click \u003Ccode class=\"literal\">Delete\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"idm140333359125248\">\u003Cp class=\"title\">\u003Cstrong>Figure 22.1. Deleting a sub-CA in the IdM Web UI\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/a7c0503e43bce4a0d78b3f8fbef89f06/deletingsubca.png\" alt=\"Screenshot of the &quot;Certificate Authorities&quot; screen where you can add and delete certificate authorities and subordinate certificate authorities.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Delete\u003C/code> to confirm.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\t\tThe sub-CA is removed from the list of \u003Ccode class=\"literal\">Certificate Authorities\u003C/code>.\n\t\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-sub-CA-from-IdM-CLI_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">22.1.3. Creating a sub-CA from the IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tFollow this procedure to use the IdM CLI to create new sub-CAs named \u003Cspan class=\"strong strong\">\u003Cstrong>webserver-ca\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>webclient-ca\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tMake sure that you have obtained the administrator’s credentials.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tMake sure you are logged in to an IdM server that is a CA server.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnter the \u003Ccode class=\"literal\">ipa ca-add\u003C/code> command, and specify the name of the \u003Cspan class=\"strong strong\">\u003Cstrong>webserver-ca\u003C/strong>\u003C/span> sub-CA and its Subject Distinguished Name (DN):\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@ipaserver ~]# \u003Ccode class=\"literal\">ipa ca-add \u003Cspan class=\"emphasis\">\u003Cem>webserver-ca\u003C/em>\u003C/span> --subject=\"\u003Cspan class=\"emphasis\">\u003Cem>CN=WEBSERVER,O=IDM.EXAMPLE.COM\u003C/em>\u003C/span>\"\u003C/code>\n-------------------\nCreated CA \"webserver-ca\"\n-------------------\n  Name: webserver-ca\n  Authority ID: ba83f324-5e50-4114-b109-acca05d6f1dc\n  Subject DN: CN=WEBSERVER,O=IDM.EXAMPLE.COM\n  Issuer DN: CN=Certificate Authority,O=IDM.EXAMPLE.COM\u003C/pre>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Name\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tName of the CA.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Authority ID\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tAutomatically created, individual ID for the CA.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Subject DN\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tSubject Distinguished Name (DN). The Subject DN must be unique in the IdM CA infrastructure.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Issuer DN\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tParent CA that issued the sub-CA certificate. All sub-CAs are created as a child of the IdM root CA.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate the \u003Cspan class=\"strong strong\">\u003Cstrong>webclient-ca\u003C/strong>\u003C/span> sub-CA for issuing certificates to web clients:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@ipaserver ~]# \u003Ccode class=\"literal\">ipa ca-add \u003Cspan class=\"emphasis\">\u003Cem>webclient-ca\u003C/em>\u003C/span> --subject=\"\u003Cspan class=\"emphasis\">\u003Cem>CN=WEBCLIENT,O=IDM.EXAMPLE.COM\u003C/em>\u003C/span>\"\u003C/code>\n-------------------\nCreated CA \"webclient-ca\"\n-------------------\n  Name: webclient-ca\n  Authority ID: 8a479f3a-0454-4a4d-8ade-fd3b5a54ab2e\n  Subject DN: CN=WEBCLIENT,O=IDM.EXAMPLE.COM\n  Issuer DN: CN=Certificate Authority,O=IDM.EXAMPLE.COM\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-certupdate\u003C/strong>\u003C/span> command to create a \u003Cspan class=\"strong strong\">\u003Cstrong>certmonger\u003C/strong>\u003C/span> tracking request for the \u003Cspan class=\"strong strong\">\u003Cstrong>webserver-ca\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>webclient-ca\u003C/strong>\u003C/span> sub-CAs certificates:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@ipaserver ~]# \u003Ccode class=\"literal\">ipa-certupdate\u003C/code>\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tIf you forget to run the \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-certupdate\u003C/strong>\u003C/span> command after creating a sub-CA and the sub-CA certificate expires, end-entity certificates issued by that sub-CA are considered invalid even though the end-entity certificate has not expired.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify that the signing certificate of the new sub-CA has been added to the IdM database:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@ipaserver ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>certutil -d /etc/pki/pki-tomcat/alias/ -L\u003C/strong>\u003C/span>\n\nCertificate Nickname                      Trust Attributes\n                                          SSL,S/MIME,JAR/XPI\n\ncaSigningCert cert-pki-ca                 CTu,Cu,Cu\nServer-Cert cert-pki-ca                   u,u,u\nauditSigningCert cert-pki-ca              u,u,Pu\n\u003Cspan class=\"strong strong\">\u003Cstrong>caSigningCert cert-pki-ca ba83f324-5e50-4114-b109-acca05d6f1dc u,u,u\u003C/strong>\u003C/span>\nocspSigningCert cert-pki-ca               u,u,u\nsubsystemCert cert-pki-ca                 u,u,u\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tThe new sub-CA certificate is automatically transferred to all the replicas that have a certificate system instance installed.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_disabling-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">22.1.4. Disabling a sub-CA from the IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tFollow this procedure to disable a sub-CA from the IdM CLI. If there are still non-expired certificates that were issued by a sub-CA, you should not delete it but you can disable it. If you delete the sub-CA, revocation checking for that sub-CA will no longer work.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tMake sure you have obtained the administrator’s credentials.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the \u003Ccode class=\"literal\">ipa ca-find\u003C/code> command to determine the name of the sub-CA you are deleting:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@ipaserver ~]# ipa ca-find\n-------------\n3 CAs matched\n-------------\n  Name: ipa\n  Description: IPA CA\n  Authority ID: 5195deaf-3b61-4aab-b608-317aff38497c\n  Subject DN: CN=Certificate Authority,O=IPA.TEST\n  Issuer DN: CN=Certificate Authority,O=IPA.TEST\n\n  Name: webclient-ca\n  Authority ID: 605a472c-9c6e-425e-b959-f1955209b092\n  Subject DN: CN=WEBCLIENT,O=IDM.EXAMPLE.COM\n  Issuer DN: CN=Certificate Authority,O=IPA.TEST\n\n \u003Cspan class=\"strong strong\">\u003Cstrong>Name: webserver-ca\u003C/strong>\u003C/span>\n  Authority ID: 02d537f9-c178-4433-98ea-53aa92126fc3\n  Subject DN: CN=WEBSERVER,O=IDM.EXAMPLE.COM\n  Issuer DN: CN=Certificate Authority,O=IPA.TEST\n----------------------------\nNumber of entries returned 3\n----------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the \u003Ccode class=\"literal\">ipa ca-disable\u003C/code> command to disable your sub-CA, in this example, the \u003Ccode class=\"literal\">webserver-ca\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ipa ca-disable webserver-ca\n--------------------------\nDisabled CA \"webserver-ca\"\n--------------------------\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_deleting-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">22.1.5. Deleting a sub-CA from the IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tFollow this procedure to delete lightweight sub-CAs from the IdM CLI.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIf you delete a sub-CA, revocation checking for that sub-CA will no longer work. Only delete a sub-CA when there are no more certificates that were issued by that sub-CA whose \u003Ccode class=\"literal\">notAfter\u003C/code> expiration time is in the future.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou should only disable sub-CAs while there are still non-expired certificates that were issued by that sub-CA. If all certificates that were issued by a sub-CA have expired, you can delete that sub-CA.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou cannot disable or delete the IdM CA.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tMake sure you have obtained the administrator’s credentials.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo display a list of sub-CAs and CAs, run the \u003Ccode class=\"literal\">ipa ca-find\u003C/code> command:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa ca-find\n-------------\n3 CAs matched\n-------------\n  Name: ipa\n  Description: IPA CA\n  Authority ID: 5195deaf-3b61-4aab-b608-317aff38497c\n  Subject DN: CN=Certificate Authority,O=IPA.TEST\n  Issuer DN: CN=Certificate Authority,O=IPA.TEST\n\n  Name: webclient-ca\n  Authority ID: 605a472c-9c6e-425e-b959-f1955209b092\n  Subject DN: CN=WEBCLIENT,O=IDM.EXAMPLE.COM\n  Issuer DN: CN=Certificate Authority,O=IPA.TEST\n\n \u003Cspan class=\"strong strong\">\u003Cstrong>Name: webserver-ca\u003C/strong>\u003C/span>\n  Authority ID: 02d537f9-c178-4433-98ea-53aa92126fc3\n  Subject DN: CN=WEBSERVER,O=IDM.EXAMPLE.COM\n  Issuer DN: CN=Certificate Authority,O=IPA.TEST\n----------------------------\nNumber of entries returned 3\n----------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the \u003Ccode class=\"literal\">ipa ca-disable\u003C/code> command to disable your sub-CA, in this example, the \u003Ccode class=\"literal\">webserver-ca\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa ca-disable webserver-ca\n--------------------------\nDisabled CA \"webserver-ca\"\n--------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDelete the sub-CA, in this example, the \u003Ccode class=\"literal\">webserver-ca\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa ca-del webserver-ca\n-------------------------\nDeleted CA \"webserver-ca\"\n-------------------------\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun \u003Ccode class=\"literal\">ipa ca-find\u003C/code> to display the list of CAs and sub-CAs. The \u003Ccode class=\"literal\">webserver-ca\u003C/code> is no longer on the list.\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa ca-find\n-------------\n2 CAs matched\n-------------\n  Name: ipa\n  Description: IPA CA\n  Authority ID: 5195deaf-3b61-4aab-b608-317aff38497c\n  Subject DN: CN=Certificate Authority,O=IPA.TEST\n  Issuer DN: CN=Certificate Authority,O=IPA.TEST\n\n  Name: webclient-ca\n  Authority ID: 605a472c-9c6e-425e-b959-f1955209b092\n  Subject DN: CN=WEBCLIENT,O=IDM.EXAMPLE.COM\n  Issuer DN: CN=Certificate Authority,O=IPA.TEST\n----------------------------\nNumber of entries returned 2\n----------------------------\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.2. Downloading the sub-CA certificate from IdM WebUI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist _abstract\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _abstract\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMake sure that you have obtained the IdM administrator’s credentials.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Authentication\u003C/strong>\u003C/span> menu, click \u003Cspan class=\"strong strong\">\u003Cstrong>Certificates\u003C/strong>\u003C/span> &gt; \u003Cspan class=\"strong strong\">\u003Cstrong>Certificates\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"sub-CA-certificate-in-the-list-of-certificates_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cp class=\"title\">\u003Cstrong>Figure 22.2. sub-CA certificate in the list of certificates\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/44e0bd2d5c830f8525b228ccb8f84997/download-sub-CA-certificate.png\" alt=\"Screenshot of a table displaying two certificates.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick the serial number of the sub-CA certificate to open the certificate information page.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the certificate information page, click \u003Cspan class=\"strong strong\">\u003Cstrong>Actions\u003C/strong>\u003C/span> &gt; \u003Cspan class=\"strong strong\">\u003Cstrong>Download\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the CLI, move the sub-CA certificate to the \u003Ccode class=\"literal\">/etc/pki/tls/private/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>mv \u003Cspan class=\"emphasis\">\u003Cem>path/to/the/downloaded/certificate\u003C/em>\u003C/span> /etc/pki/tls/private/sub-ca.crt\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.3. Creating CA ACLs for web server and client authentication\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tCertificate authority access control list (CA ACL) rules define which profiles can be used to issue certificates to which users, services, or hosts. By associating profiles, principals, and groups, CA ACLs permit principals or groups to request certificates using particular profiles.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor example, using CA ACLs, the administrator can restrict the use of a profile intended for employees working from an office located in London only to users that are members of the London office-related group.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">22.3.1. Viewing CA ACLs in IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tFollow this procedure to view the list of certificate authority access control lists (CA ACLs) available in your IdM deployment and the details of a specific CA ACL.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo view all the CA ACLs in your IdM environment, enter the \u003Ccode class=\"literal\">ipa caacl-find\u003C/code> command:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-find\u003C/strong>\u003C/span>\n-----------------\n1 CA ACL matched\n-----------------\n  ACL name: hosts_services_caIPAserviceCert\n  Enabled: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo view the details of a CA ACL, enter the \u003Ccode class=\"literal\">ipa caacl-show\u003C/code> command, and specify the CA ACL name. For example, to view the details of the \u003Cspan class=\"strong strong\">\u003Cstrong>hosts_services_caIPAserviceCert\u003C/strong>\u003C/span> CA ACL, enter:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-show hosts_services_caIPAserviceCert\u003C/strong>\u003C/span>\n  ACL name: hosts_services_caIPAserviceCert\n  Enabled: TRUE\n  Host category: all\n  Service category: all\n  CAs: ipa\n  Profiles: caIPAserviceCert\n  Users: admin\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-CA-ACL-for-web-servers-authenticating-to-web-clients-using-certificates-issued-by-webserver-ca_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">22.3.2. Creating a CA ACL for web servers authenticating to web clients using certificates issued by webserver-ca\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tFollow this procedure to create a CA ACL that requires the system administrator to use the \u003Cspan class=\"strong strong\">\u003Cstrong>webserver-ca\u003C/strong>\u003C/span> sub-CA and the \u003Cspan class=\"strong strong\">\u003Cstrong>caIPAserviceCert\u003C/strong>\u003C/span> profile when requesting a certificate for the \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM\u003C/strong>\u003C/span> service. If the user requests a certificate from a different sub-CA or of a different profile, the request fails. The only exception is when there is another matching CA ACL that is enabled. To view the available CA ACLs, see \u003Ca class=\"link\" href=\"#viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.3.1. Viewing CA ACLs in IdM CLI\">Viewing CA ACLs in IdM CLI\u003C/a>.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tMake sure that the \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM\u003C/strong>\u003C/span> service is part of IdM.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tMake sure you have obtained IdM administrator’s credentials.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a CA ACL using the \u003Ccode class=\"literal\">ipa caacl\u003C/code> command, and specify its name:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-add TLS_web_server_authentication\u003C/strong>\u003C/span>\n--------------------------------------------\nAdded CA ACL \"TLS_web_server_authentication\"\n--------------------------------------------\n  ACL name: TLS_web_server_authentication\n  Enabled: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tModify the CA ACL using the \u003Ccode class=\"literal\">ipa caacl-mod\u003C/code> command to specify the description of the CA ACL:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-mod TLS_web_server_authentication --desc=\"CAACL for web servers authenticating to web clients using certificates issued by webserver-ca\"\u003C/strong>\u003C/span>\n-----------------------------------------------\nModified CA ACL \"TLS_web_server_authentication\"\n-----------------------------------------------\n  ACL name: TLS_web_server_authentication\n  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca\n  Enabled: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAdd the \u003Cspan class=\"strong strong\">\u003Cstrong>webserver-ca\u003C/strong>\u003C/span> sub-CA to the CA ACL:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-add-ca TLS_web_server_authentication --ca=webserver-ca\u003C/strong>\u003C/span>\n  ACL name: TLS_web_server_authentication\n  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca\n  Enabled: TRUE\n  CAs: webserver-ca\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipa caacl-add-service\u003C/code> to specify the service whose principal will be able to request a certificate:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-add-service TLS_web_server_authentication --service=HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM\u003C/strong>\u003C/span>\n  ACL name: TLS_web_server_authentication\n  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca\n  Enabled: TRUE\n  CAs: webserver-ca\n  Services: HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipa caacl-add-profile\u003C/code> command to specify the certificate profile for the requested certificate:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-add-profile TLS_web_server_authentication --certprofiles=caIPAserviceCert\u003C/strong>\u003C/span>\n  ACL name: TLS_web_server_authentication\n  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca\n  Enabled: TRUE\n  CAs: webserver-ca\n  Profiles: caIPAserviceCert\n  Services: HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can use the newly-created CA ACL straight away. It is enabled after its creation by default.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tThe point of CA ACLs is to specify which CA and profile combinations are allowed for requests coming from particular principals or groups. CA ACLs do not affect certificate validation or trust. They do not affect how the issued certificates will be used.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-CA-ACL-for-user-web-browsers-authenticating-to-web-servers-using-certificates-issued-by-webclient-ca_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">22.3.3. Creating a CA ACL for user web browsers authenticating to web servers using certificates issued by webclient-ca\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tFollow this procedure to create a CA ACL that requires the system administrator to use the \u003Cspan class=\"strong strong\">\u003Cstrong>webclient-ca\u003C/strong>\u003C/span> sub-CA and the \u003Cspan class=\"strong strong\">\u003Cstrong>IECUserRoles\u003C/strong>\u003C/span> profile when requesting a certificate. If the user requests a certificate from a different sub-CA or of a different profile, the request fails. The only exception is when there is another matching CA ACL that is enabled. To view the available CA ACLs, see \u003Ca class=\"link\" href=\"#viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.3.1. Viewing CA ACLs in IdM CLI\">Viewing CA ACLs in IdM CLI\u003C/a>.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tMake sure that you have obtained IdM administrator’s credentials.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a CA ACL using the \u003Ccode class=\"literal\">ipa caacl\u003C/code> command and specify its name:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-add TLS_web_client_authentication\u003C/strong>\u003C/span>\n--------------------------------------------\nAdded CA ACL \"TLS_web_client_authentication\"\n--------------------------------------------\n  ACL name: TLS_web_client_authentication\n  Enabled: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tModify the CA ACL using the \u003Ccode class=\"literal\">ipa caacl-mod\u003C/code> command to specify the description of the CA ACL:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-mod TLS_web_client_authentication --desc=\"CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca\"\u003C/strong>\u003C/span>\n-----------------------------------------------\nModified CA ACL \"TLS_web_client_authentication\"\n-----------------------------------------------\n  ACL name: TLS_web_client_authentication\n  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca\n  Enabled: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAdd the \u003Cspan class=\"strong strong\">\u003Cstrong>webclient-ca\u003C/strong>\u003C/span> sub-CA to the CA ACL:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-add-ca TLS_web_client_authentication --ca=webclient-ca\u003C/strong>\u003C/span>\n  ACL name: TLS_web_client_authentication\n  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca\n  Enabled: TRUE\n  CAs: webclient-ca\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipa caacl-add-profile\u003C/code> command to specify the certificate profile for the requested certificate:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-add-profile TLS_web_client_authentication --certprofiles=IECUserRoles\u003C/strong>\u003C/span>\n  ACL name: TLS_web_client_authentication\n  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca\n  Enabled: TRUE\n  CAs: webclient-ca\n  Profiles: IECUserRoles\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tModify the CA ACL using the \u003Ccode class=\"literal\">ipa caacl-mod\u003C/code> command to specify that the CA ACL applies to all IdM users:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-mod TLS_web_client_authentication --usercat=all\u003C/strong>\u003C/span>\n-----------------------------------------------\nModified CA ACL \"TLS_web_client_authentication\"\n-----------------------------------------------\n  ACL name: TLS_web_client_authentication\n  Description: CAACL for user web browsers authenticating to web servers using certificates issued by webclient-ca\n  Enabled: TRUE\n  User category: all\n  CAs: webclient-ca\n  Profiles: IECUserRoles\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can use the newly-created CA ACL straight away. It is enabled after its creation by default.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tThe point of CA ACLs is to specify which CA and profile combinations are allowed for requests coming from particular principals or groups. CA ACLs do not affect certificate validation or trust. They do not affect how the issued certificates will be used.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.4. Obtaining an IdM certificate for a service using certmonger\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo ensure that communication between browsers and the web service running on your IdM client is secure and encrypted, use a TLS certificate. If you want to restrict web browsers to trust certificates issued by the \u003Ccode class=\"literal\">webserver-ca\u003C/code> sub-CA but no other IdM sub-CA, obtain the TLS certificate for your web service from the \u003Ccode class=\"literal\">webserver-ca\u003C/code> sub-CA.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to use \u003Ccode class=\"literal\">certmonger\u003C/code> to obtain an IdM certificate for a service (\u003Ccode class=\"literal\">HTTP/my_company.idm.example.com\u003C/code>@\u003Ccode class=\"literal\">IDM.EXAMPLE.COM\u003C/code>) running on an IdM client.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUsing \u003Ccode class=\"literal\">certmonger\u003C/code> to request the certificate automatically means that \u003Ccode class=\"literal\">certmonger\u003C/code> manages and renews the certificate when it is due for a renewal.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor a visual representation of what happens when \u003Ccode class=\"literal\">certmonger\u003C/code> requests a service certificate, see \u003Ca class=\"xref\" href=\"#communication-flow-certmonger-requesting-service-cert_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.5. Communication flow for certmonger requesting a service certificate\">Section 22.5, “Communication flow for certmonger requesting a service certificate”\u003C/a>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe web server is enrolled as an IdM client.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have root access to the IdM client on which you are running the procedure.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe service for which you are requesting a certificate does not have to pre-exist in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the \u003Ccode class=\"literal\">my_company.idm.example.com\u003C/code> IdM client on which the \u003Ccode class=\"literal\">HTTP\u003C/code> service is running, request a certificate for the service corresponding to the \u003Ccode class=\"literal\">HTTP/my_company.idm.example.com@IDM.EXAMPLE.COM\u003C/code> principal, and specify that\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe certificate is to be stored in the local \u003Ccode class=\"literal\">/etc/pki/tls/certs/httpd.pem\u003C/code> file\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe private key is to be stored in the local \u003Ccode class=\"literal\">/etc/pki/tls/private/httpd.key\u003C/code> file\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">webserver-ca\u003C/code> sub-CA is to be the issuing certificate authority\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThat an extensionRequest for a \u003Ccode class=\"literal\">SubjectAltName\u003C/code> be added to the signing request with the DNS name of \u003Ccode class=\"literal\">my_company.idm.example.com\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-getcert request -K HTTP/my_company.idm.example.com -k /etc/pki/tls/private/httpd.key -f /etc/pki/tls/certs/httpd.pem -g 2048 -D my_company.idm.example.com -X webserver-ca -C \"systemctl restart httpd\"\u003C/strong>\u003C/span>\nNew signing request \"20190604065735\" added.\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the command above:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipa-getcert request\u003C/code> command specifies that the certificate is to be obtained from the IdM CA. The \u003Ccode class=\"literal\">ipa-getcert request\u003C/code> command is a shortcut for \u003Ccode class=\"literal\">getcert request -c IPA\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-g\u003C/code> option specifies the size of key to be generated if one is not already in place.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-D\u003C/code> option specifies the \u003Ccode class=\"literal\">SubjectAltName\u003C/code> DNS value to be added to the request.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-X\u003C/code> option specifies that the issuer of the certificate must be \u003Ccode class=\"literal\">webserver-ca\u003C/code>, not \u003Ccode class=\"literal\">ipa\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-C\u003C/code> option instructs \u003Ccode class=\"literal\">certmonger\u003C/code> to restart the \u003Ccode class=\"literal\">httpd\u003C/code> service after obtaining the certificate.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tTo specify that the certificate be issued with a particular profile, use the \u003Ccode class=\"literal\">-T\u003C/code> option.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To check the status of your request:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-getcert list -f /etc/pki/tls/certs/httpd.pem\u003C/strong>\u003C/span>\nNumber of certificates and requests being tracked: 3.\nRequest ID '20190604065735':\n    status: MONITORING\n    stuck: no\n    key pair storage: type=FILE,location='/etc/pki/tls/private/httpd.key'\n    certificate: type=FILE,location='/etc/pki/tls/certs/httpd.crt'\n    CA: IPA\n    issuer: CN=WEBSERVER,O=IDM.EXAMPLE.COM\n\n[...]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe output shows that the request is in the \u003Ccode class=\"literal\">MONITORING\u003C/code> status, which means that a certificate has been obtained. The locations of the key pair and the certificate are those requested.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"communication-flow-certmonger-requesting-service-cert_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.5. Communication flow for certmonger requesting a service certificate\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThese diagrams show the stages of what happens when \u003Ccode class=\"literal\">certmonger\u003C/code> requests a service certificate from Identity Management (IdM) certificate authority (CA) server. The sequence consists of these diagrams:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-1\" title=\"Figure 22.3. Unencrypted communication\">Unencrypted communication\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-2\" title=\"Figure 22.4. Certmonger requesting a service certificate\">Certmonger requesting a service certificate\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-3\" title=\"Figure 22.5. IdM CA issuing the service certificate\">IdM CA issuing the service certificate\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-4\" title=\"Figure 22.6. Certmonger applying the service certificate\">Certmonger applying the service certificate\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-5\" title=\"Figure 22.7. Certmonger requesting a new certificate when the old one is nearing expiration\">Certmonger requesting a new certificate when the old one is nearing expiration\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIn the diagrams, the \u003Ccode class=\"literal\">webserver-ca\u003C/code> sub-CA is represented by the generic \u003Ccode class=\"literal\">IdM CA server\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-1\" title=\"Figure 22.3. Unencrypted communication\">Unencrypted communication\u003C/a> shows the initial situation: without an HTTPS certificate, the communication between the web server and the browser is unencrypted.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-1\">\u003Cp class=\"title\">\u003Cstrong>Figure 22.3. Unencrypted communication\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/7f96cab7e5e718e3e2e3590b5afd83c1/84_RHEL_IdM_0420_1.png\" alt=\"A diagram displaying an IdM client running an Apache web server and the certmonger service. There are arrows between a browser and the Apache webserver showing it is connecting over an unencrypted HTTP connection. There is an inactive connection from the certmonger service to an IdM CA server.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cbr/>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-2\" title=\"Figure 22.4. Certmonger requesting a service certificate\">Certmonger requesting a service certificate\u003C/a> shows the system administrator using \u003Ccode class=\"literal\">certmonger\u003C/code> to manually request an HTTPS certificate for the Apache web server. Note that when requesting a web server certificate, certmonger does not communicate directly with the CA. It proxies through IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-2\">\u003Cp class=\"title\">\u003Cstrong>Figure 22.4. Certmonger requesting a service certificate\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/9667aa246bcf76921969274115666533/84_RHEL_IdM_0420_2.png\" alt=\"A diagram displaying an arrow between the certmonger service on the IdM client and the IdM CA server to show it is connecting via an ipa-getcert request.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cbr/>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-3\" title=\"Figure 22.5. IdM CA issuing the service certificate\">IdM CA issuing the service certificate\u003C/a> shows an IdM CA issuing an HTTPS certificate for the web server.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-3\">\u003Cp class=\"title\">\u003Cstrong>Figure 22.5. IdM CA issuing the service certificate\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/760743dd58ac7f0566834b5657089cbe/84_RHEL_IdM_0420_3.png\" alt=\"A diagram displaying an arrow between the IdM CA server and the certmonger service on the IdM client - showing it is connecting and sending an HTTPS certificate.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cbr/>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-4\" title=\"Figure 22.6. Certmonger applying the service certificate\">Certmonger applying the service certificate\u003C/a> shows \u003Ccode class=\"literal\">certmonger\u003C/code> placing the HTTPS certificate in appropriate locations on the IdM client and, if instructed to do so, restarting the \u003Ccode class=\"literal\">httpd\u003C/code> service. The Apache server subsequently uses the HTTPS certificate to encrypt the traffic between itself and the browser.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-4\">\u003Cp class=\"title\">\u003Cstrong>Figure 22.6. Certmonger applying the service certificate\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/710c6fb955eeee2dd6fbc2cd2a0e4ff8/84_RHEL_IdM_0420_4.png\" alt=\"A diagram displaying an image of an HTTPS certificate assigned to the Apache web server and one assigned to the certmonger service. There are arrows between the browser and the Apache webserver showing that the connection is now an encrypted HTTPS connection. The connection between the certmonger service and the IdM CA server is inactive.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cbr/>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-5\" title=\"Figure 22.7. Certmonger requesting a new certificate when the old one is nearing expiration\">Certmonger requesting a new certificate when the old one is nearing expiration\u003C/a> shows \u003Ccode class=\"literal\">certmonger\u003C/code> automatically requesting a renewal of the service certificate from the IdM CA before the expiration of the certificate. The IdM CA issues a new certificate.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"restricting-an-application-to-trust-a-subset-of-certs_certmonger-service-cert-5\">\u003Cp class=\"title\">\u003Cstrong>Figure 22.7. Certmonger requesting a new certificate when the old one is nearing expiration\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/419091544b0b5520f3b5c2e321fc2de7/84_RHEL_IdM_0420_5.png\" alt=\"A diagram displaying an arrow from the certmonger service on the IdM client connecting to the IdM CA server to show it is performing an ipa-getcert request. An arrow from the IdM CA server to the Certmonger is labeled HTTPS certificate to show it is transferring an HTTPS certificate to the certmonger service.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cbr/>\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.6. Setting up a single-instance Apache HTTP Server\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can set up a single-instance Apache HTTP Server to serve static HTML content.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow the procedure if the web server should provide the same content for all domains associated with the server. If you want to provide different content for different domains, set up name-based virtual hosts. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#configuring-apache-name-based-virtual-hosts_setting-apache-http-server\">Configuring Apache name-based virtual hosts\u003C/a>.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal package\">httpd\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install httpd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you use \u003Ccode class=\"literal\">firewalld\u003C/code>, open the TCP port \u003Ccode class=\"literal\">80\u003C/code> in the local firewall:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --permanent --add-port=80/tcp\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --reload\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnable and start the \u003Ccode class=\"literal systemitem\">httpd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now httpd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Add HTML files to the \u003Ccode class=\"literal filename\">/var/www/html/\u003C/code> directory.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tWhen adding content to \u003Ccode class=\"literal filename\">/var/www/html/\u003C/code>, files and directories must be readable by the user under which \u003Ccode class=\"literal\">httpd\u003C/code> runs by default. The content owner can be the either the \u003Ccode class=\"literal\">root\u003C/code> user and \u003Ccode class=\"literal\">root\u003C/code> user group, or another user or group of the administrator’s choice. If the content owner is the \u003Ccode class=\"literal\">root\u003C/code> user and \u003Ccode class=\"literal\">root\u003C/code> user group, the files must be readable by other users. The SELinux context for all the files and directories must be \u003Ccode class=\"literal\">httpd_sys_content_t\u003C/code>, which is applied by default to all content within the \u003Ccode class=\"literal filename\">/var/www\u003C/code> directory.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConnect with a web browser to \u003Ccode class=\"literal\">http://my_company.idm.example.com/\u003C/code> or \u003Ccode class=\"literal command\">http://\u003Cspan class=\"emphasis\">\u003Cem>server_IP\u003C/em>\u003C/span>/\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the \u003Ccode class=\"literal filename\">/var/www/html/\u003C/code> directory is empty or does not contain an \u003Ccode class=\"literal filename\">index.html\u003C/code> or \u003Ccode class=\"literal filename\">index.htm\u003C/code> file, Apache displays the \u003Ccode class=\"literal command\">Red Hat Enterprise Linux Test Page\u003C/code>. If \u003Ccode class=\"literal filename\">/var/www/html/\u003C/code> contains HTML files with a different name, you can load them by entering the URL to that file, such as \u003Ccode class=\"literal command\">http://\u003Cspan class=\"emphasis\">\u003Cem>server_IP\u003C/em>\u003C/span>/\u003Cspan class=\"emphasis\">\u003Cem>example.html\u003C/em>\u003C/span>\u003C/code> or \u003Ccode class=\"literal\">http://my_company.idm.example.com/\u003Cspan class=\"emphasis\">\u003Cem>example.html\u003C/em>\u003C/span>\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tApache manual: \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server\">Installing the Apache HTTP Server manual\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal citetitle\">httpd.service(8)\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.7. Adding TLS encryption to an Apache HTTP Server\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can enable TLS encryption on the \u003Ccode class=\"literal systemitem\">my_company.idm.example.com\u003C/code> Apache HTTP Server for the \u003Ccode class=\"literal systemitem\">idm.example.com\u003C/code> domain.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal systemitem\">my_company.idm.example.com\u003C/code> Apache HTTP Server is installed and running.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have obtained the TLS certificate from the \u003Cspan class=\"strong strong\">\u003Cstrong>webserver-ca\u003C/strong>\u003C/span> sub-CA, and stored it in the \u003Ccode class=\"literal filename\">/etc/pki/tls/certs/httpd.pem\u003C/code> file as described in \u003Ca class=\"link\" href=\"#obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.4. Obtaining an IdM certificate for a service using certmonger\">Obtaining an IdM certificate for a service using certmonger\u003C/a>. If you use a different path, adapt the corresponding steps of the procedure.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe corresponding private key is stored in the \u003Ccode class=\"literal filename\">/etc/pki/tls/private/httpd.key\u003C/code> file. If you use a different path, adapt the corresponding steps of the procedure.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>webserver-ca\u003C/strong>\u003C/span> CA certificate is stored in the \u003Ccode class=\"literal filename\">/etc/pki/tls/private/sub-ca.crt\u003C/code> file. If you use a different path, adapt the corresponding steps of the procedure.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClients and the \u003Cspan class=\"strong strong\">\u003Cstrong>my_company.idm.example.com\u003C/strong>\u003C/span> web server resolve the host name of the server to the IP address of the web server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf the server runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/7018256\">TLS extension \"Extended Master Secret\" enforced\u003C/a> Knowledgebase article.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal package\">mod_ssl\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install mod_ssl\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the \u003Ccode class=\"literal filename\">/etc/httpd/conf.d/ssl.conf\u003C/code> file and add the following settings to the \u003Ccode class=\"literal parameter\">&lt;VirtualHost _default_:443&gt;\u003C/code> directive:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the server name:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>ServerName \u003Cspan class=\"emphasis\">\u003Cem>my_company.idm.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe server name must match the entry set in the \u003Ccode class=\"literal parameter\">Common Name\u003C/code> field of the certificate.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: If the certificate contains additional host names in the \u003Ccode class=\"literal parameter\">Subject Alt Names\u003C/code> (SAN) field, you can configure \u003Ccode class=\"literal systemitem\">mod_ssl\u003C/code> to provide TLS encryption also for these host names. To configure this, add the \u003Ccode class=\"literal parameter\">ServerAliases\u003C/code> parameter with corresponding names:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>ServerAlias \u003Cspan class=\"emphasis\">\u003Cem>www.my_company.idm.example.com\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>server.my_company.idm.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the paths to the private key, the server certificate, and the CA certificate:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>SSLCertificateKeyFile \"/etc/pki/tls/private/httpd.key\"\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>SSLCertificateFile \"/etc/pki/tls/certs/httpd.pem\"\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>SSLCACertificateFile \"/etc/pki/tls/certs/ca.crt\"\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor security reasons, configure that only the \u003Ccode class=\"literal systemitem\">root\u003C/code> user can access the private key file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>chown root:root /etc/pki/tls/private/httpd.key\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>chmod 600 //etc/pki/tls/private/httpd.key\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIf the private key was accessed by unauthorized users, revoke the certificate, create a new private key, and request a new certificate. Otherwise, the TLS connection is no longer secure.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you use \u003Ccode class=\"literal\">firewalld\u003C/code>, open port \u003Ccode class=\"literal\">443\u003C/code> in the local firewall:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --permanent --add-port=443/tcp\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --reload\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal systemitem\">httpd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart httpd\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIf you protected the private key file with a password, you must enter this password each time when the \u003Ccode class=\"literal systemitem\">httpd\u003C/code> service starts.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUse a browser and connect to \u003Ccode class=\"literal command\">https://my_company.idm.example.com\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/setting-apache-http-server_deploying-different-types-of-servers#installing-the-apache-http-server-manual_setting-apache-http-server\">SSL/TLS Encryption\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/securing_networks/planning-and-implementing-tls_securing-networks#security-considerations-for-tls-in-rhel_planning-and-implementing-tls\">Security considerations for TLS in RHEL 8\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-the-supported-tls-protocol-versions-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.8. Setting the supported TLS protocol versions on an Apache HTTP Server\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBy default, the Apache HTTP Server on RHEL uses the system-wide crypto policy that defines safe default values, which are also compatible with recent browsers. For example, the \u003Ccode class=\"literal systemitem\">DEFAULT\u003C/code> policy defines that only the \u003Ccode class=\"literal systemitem\">TLSv1.2\u003C/code> and \u003Ccode class=\"literal systemitem\">TLSv1.3\u003C/code> protocol versions are enabled in apache.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can manually configure which TLS protocol versions your \u003Cspan class=\"strong strong\">\u003Cstrong>my_company.idm.example.com\u003C/strong>\u003C/span> Apache HTTP Server supports. Follow the procedure if your environment requires to enable only specific TLS protocol versions, for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf your environment requires that clients can also use the weak \u003Ccode class=\"literal systemitem\">TLS1\u003C/code> (TLSv1.0) or \u003Ccode class=\"literal systemitem\">TLS1.1\u003C/code> protocol.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf you want to configure that Apache only supports the \u003Ccode class=\"literal systemitem\">TLSv1.2\u003C/code> or \u003Ccode class=\"literal systemitem\">TLSv1.3\u003C/code> protocol.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTLS encryption is enabled on the \u003Cspan class=\"strong strong\">\u003Cstrong>my_company.idm.example.com\u003C/strong>\u003C/span> server as described in \u003Ca class=\"link\" href=\"#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.7. Adding TLS encryption to an Apache HTTP Server\">Adding TLS encryption to an Apache HTTP server\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf the server runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/7018256\">TLS extension \"Extended Master Secret\" enforced\u003C/a> Knowledgebase article.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the \u003Ccode class=\"literal filename\">/etc/httpd/conf/httpd.conf\u003C/code> file, and add the following setting to the \u003Ccode class=\"literal parameter\">&lt;VirtualHost&gt;\u003C/code> directive for which you want to set the TLS protocol version. For example, to enable only the \u003Ccode class=\"literal systemitem\">TLSv1.3\u003C/code> protocol:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>SSLProtocol -All TLSv1.3\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal systemitem\">httpd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart httpd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the following command to verify that the server supports \u003Ccode class=\"literal systemitem\">TLSv1.3\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>openssl s_client -connect \u003Cspan class=\"emphasis\">\u003Cem>example.com\u003C/em>\u003C/span>:443 -tls1_3\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the following command to verify that the server does not support \u003Ccode class=\"literal systemitem\">TLSv1.2\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>openssl s_client -connect \u003Cspan class=\"emphasis\">\u003Cem>example.com\u003C/em>\u003C/span>:443 -tls1_2\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the server does not support the protocol, the command returns an error:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">140111600609088:error:1409442E:SSL routines:ssl3_read_bytes:tlsv1 alert protocol version:ssl/record/rec_layer_s3.c:1543:SSL alert number 70\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: Repeat the command for other TLS protocol versions.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal citetitle\">update-crypto-policies(8)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening\">Using system-wide cryptographic policies\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor further details about the \u003Ccode class=\"literal parameter\">SSLProtocol\u003C/code> parameter, refer to the \u003Ccode class=\"literal systemitem\">mod_ssl\u003C/code> documentation in the Apache manual: \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server\">Installing the Apache HTTP Server manual\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-the-supported-ciphers-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.9. Setting the supported ciphers on an Apache HTTP Server\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBy default, the Apache HTTP Server uses the system-wide crypto policy that defines safe default values, which are also compatible with recent browsers. For the list of ciphers the system-wide crypto allows, see the \u003Ccode class=\"literal filename\">/etc/crypto-policies/back-ends/openssl.config\u003C/code> file.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can manually configure which ciphers the \u003Cspan class=\"strong strong\">\u003Cstrong>my_company.idm.example.com\u003C/strong>\u003C/span> Apache HTTP server supports. Follow the procedure if your environment requires specific ciphers.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTLS encryption is enabled on the \u003Cspan class=\"strong strong\">\u003Cstrong>my_company.idm.example.com\u003C/strong>\u003C/span> server as described in \u003Ca class=\"link\" href=\"#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.7. Adding TLS encryption to an Apache HTTP Server\">Adding TLS encryption to an Apache HTTP server\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the \u003Ccode class=\"literal filename\">/etc/httpd/conf/httpd.conf\u003C/code> file, and add the \u003Ccode class=\"literal parameter\">SSLCipherSuite\u003C/code> parameter to the \u003Ccode class=\"literal parameter\">&lt;VirtualHost&gt;\u003C/code> directive for which you want to set the TLS ciphers:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>SSLCipherSuite \"EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH:!SHA1:!SHA256\"\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis example enables only the \u003Ccode class=\"literal systemitem\">EECDH+AESGCM\u003C/code>, \u003Ccode class=\"literal systemitem\">EDH+AESGCM\u003C/code>, \u003Ccode class=\"literal systemitem\">AES256+EECDH\u003C/code>, and \u003Ccode class=\"literal systemitem\">AES256+EDH\u003C/code> ciphers and disables all ciphers which use the \u003Ccode class=\"literal systemitem\">SHA1\u003C/code> and \u003Ccode class=\"literal systemitem\">SHA256\u003C/code> message authentication code (MAC).\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal systemitem\">httpd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart httpd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo display the list of ciphers the Apache HTTP Server supports:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tInstall the \u003Ccode class=\"literal package\">nmap\u003C/code> package:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install nmap\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal systemitem\">nmap\u003C/code> utility to display the supported ciphers:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmap --script ssl-enum-ciphers -p \u003Cspan class=\"emphasis\">\u003Cem>443\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n...\nPORT    STATE SERVICE\n443/tcp open  https\n| ssl-enum-ciphers:\n|   TLSv1.2:\n|     ciphers:\n|       TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (ecdh_x25519) - A\n|       TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 (dh 2048) - A\n|       TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 (ecdh_x25519) - A\n...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal citetitle\">update-crypto-policies(8)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening\">Using system-wide cryptographic policies\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server\">Installing the Apache HTTP Server manual - SSLCipherSuite\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-tls-client-certificate-authentication_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.10. Configuring TLS client certificate authentication\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tClient certificate authentication enables administrators to allow only users who authenticate using a certificate to access resources on the \u003Cspan class=\"strong strong\">\u003Cstrong>my_company.idm.example.com\u003C/strong>\u003C/span> web server. You can configure client certificate authentication for the \u003Ccode class=\"literal filename\">/var/www/html/Example/\u003C/code> directory.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf the \u003Cspan class=\"strong strong\">\u003Cstrong>my_company.idm.example.com\u003C/strong>\u003C/span> Apache server uses the TLS 1.3 protocol, certain clients require additional configuration. For example, in Firefox, set the \u003Ccode class=\"literal parameter\">security.tls.enable_post_handshake_auth\u003C/code> parameter in the \u003Ccode class=\"literal command\">about:config\u003C/code> menu to \u003Ccode class=\"literal command\">true\u003C/code>. For further details, see \u003Ca class=\"link\" href=\"https://www.redhat.com/en/blog/transport-layer-security-version-13-red-hat-enterprise-linux-8\">Transport Layer Security version 1.3 in Red Hat Enterprise Linux 8\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTLS encryption is enabled on the \u003Cspan class=\"strong strong\">\u003Cstrong>my_company.idm.example.com\u003C/strong>\u003C/span> server as described in \u003Ca class=\"link\" href=\"#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.7. Adding TLS encryption to an Apache HTTP Server\">Adding TLS encryption to an Apache HTTP server\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the \u003Ccode class=\"literal filename\">/etc/httpd/conf/httpd.conf\u003C/code> file and add the following settings to the \u003Ccode class=\"literal parameter\">&lt;VirtualHost&gt;\u003C/code> directive for which you want to configure client authentication:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">&lt;Directory \"/var/www/html/Example/\"&gt;\n  SSLVerifyClient require\n&lt;/Directory&gt;\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal command\">SSLVerifyClient require\u003C/code> setting defines that the server must successfully validate the client certificate before the client can access the content in the \u003Ccode class=\"literal filename\">/var/www/html/Example/\u003C/code> directory.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal systemitem\">httpd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart httpd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal systemitem\">curl\u003C/code> utility to access the \u003Ccode class=\"literal command\">https://my_company.idm.example.com/Example/\u003C/code> URL without client authentication:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>curl https://my_company.idm.example.com/Example/\u003C/strong>\u003C/span>\ncurl: (56) OpenSSL SSL_read: error:1409445C:SSL routines:ssl3_read_bytes:tlsv13 alert certificate required, errno 0\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe error indicates that the \u003Cspan class=\"strong strong\">\u003Cstrong>my_company.idm.example.com\u003C/strong>\u003C/span> web server requires a client certificate authentication.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tPass the client private key and certificate, as well as the CA certificate to \u003Ccode class=\"literal systemitem\">curl\u003C/code> to access the same URL with client authentication:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>curl --cacert \u003Cspan class=\"emphasis\">\u003Cem>ca.crt\u003C/em>\u003C/span> --key \u003Cspan class=\"emphasis\">\u003Cem>client.key\u003C/em>\u003C/span> --cert \u003Cspan class=\"emphasis\">\u003Cem>client.crt\u003C/em>\u003C/span> https://my_company.idm.example.com/Example/\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the request succeeds, \u003Ccode class=\"literal systemitem\">curl\u003C/code> displays the \u003Ccode class=\"literal filename\">index.html\u003C/code> file stored in the \u003Ccode class=\"literal filename\">/var/www/html/Example/\u003C/code> directory.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/deploying_different_types_of_servers/index#installing-the-apache-http-server-manual_setting-apache-http-server\">Installing the Apache HTTP Server manual - mod_ssl configuration\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.11. Requesting a new user certificate and exporting it to the client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs an Identity Management (IdM) administrator, you can configure a web server running on an IdM client to request users that use web browsers to access the server to authenticate with certificates issued by a specific IdM sub-CA. Follow this procedure to request a user certificate from a specific IdM sub-CA and to export the certificate and the corresponding private key on to the host from which the user wants to access the web server using a web browser. Afterwards, \u003Ca class=\"link\" href=\"#configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.12. Configuring a browser to enable certificate authentication\">import the certificate and the private key into the browser\u003C/a>.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Create a new directory, for example \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code>, and make it a temporary certificate database. When asked, create an NSS Certificate DB password to encrypt the keys to the certificate to be generated in a subsequent step:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># mkdir \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code>\n# certutil -N -d \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code>\nEnter a password which will be used to encrypt your keys.\nThe password should be at least 8 characters long,\nand should contain at least one non-alphabetic character.\n\nEnter new password:\nRe-enter password:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the certificate signing request (CSR) and redirect the output to a file. For example, to create a CSR with the name \u003Ccode class=\"literal replaceable\">certificate_request.csr\u003C/code> for a \u003Ccode class=\"literal replaceable\">4096\u003C/code> bit certificate for the \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> user in the \u003Ccode class=\"literal replaceable\">IDM.EXAMPLE.COM\u003C/code> realm, setting the nickname of the certificate private keys to \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> for easy findability, and setting the subject to \u003Ccode class=\"literal replaceable\">CN=idm_user,O=IDM.EXAMPLE.COM\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># certutil -R -d \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code> -a -g \u003Ccode class=\"literal replaceable\">4096\u003C/code> -n \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> -s \"CN=\u003Ccode class=\"literal replaceable\">idm_user\u003C/code>,O=IDM.EXAMPLE.COM\" &gt; \u003Ccode class=\"literal replaceable\">certificate_request.csr\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhen prompted, enter the same password that you entered when using \u003Ccode class=\"literal systemitem\">certutil\u003C/code> to create the temporary database. Then continue typing randlomly until told to stop:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Enter Password or Pin for \"NSS Certificate DB\":\n\nA random seed must be generated that will be used in the\ncreation of your key.  One of the easiest ways to create a\nrandom seed is to use the timing of keystrokes on a keyboard.\n\nTo begin, type keys on the keyboard until this progress meter\nis full.  DO NOT USE THE AUTOREPEAT FUNCTION ON YOUR KEYBOARD!\n\n\nContinue typing until the progress meter is full:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSubmit the certificate request file to the server. Specify the Kerberos principal to associate with the newly-issued certificate, the output file to store the certificate, and optionally the certificate profile. Specify the IdM sub-CA that you want to issue the certificate. For example, to obtain a certificate of the \u003Ccode class=\"literal replaceable\">IECUserRoles\u003C/code> profile, a profile with added user roles extension, for the \u003Ccode class=\"literal replaceable\">idm_user\u003C/code>@\u003Ccode class=\"literal replaceable\">IDM.EXAMPLE.COM\u003C/code> principal from \u003Ccode class=\"literal\">webclient-ca\u003C/code>, and save the certificate in the \u003Ccode class=\"literal replaceable\">~/idm_user.pem\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa cert-request \u003Ccode class=\"literal replaceable\">certificate_request.csr\u003C/code> --principal=\u003Ccode class=\"literal replaceable\">idm_user\u003C/code>@\u003Ccode class=\"literal replaceable\">IDM.EXAMPLE.COM\u003C/code> --profile-id=\u003Ccode class=\"literal replaceable\">IECUserRoles\u003C/code> --ca=\u003Ccode class=\"literal replaceable\">webclient-ca\u003C/code> --certificate-out=\u003Ccode class=\"literal replaceable\">~/idm_user.pem\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the certificate to the NSS database. Use the \u003Ccode class=\"literal option\">-n\u003C/code> option to set the same nickname that you used when creating the CSR previously so that the certificate matches the private key in the NSS database. The \u003Ccode class=\"literal option\">-t\u003C/code> option sets the trust level. For details, see the certutil(1) man page. The \u003Ccode class=\"literal option\">-i\u003C/code> option specifies the input certificate file. For example, to add to the NSS database a certificate with the \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> nickname that is stored in the \u003Ccode class=\"literal replaceable\">~/idm_user.pem\u003C/code> file in the \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code> database:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># certutil -A -d \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code> -n \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> -t \"P,,\" -i \u003Ccode class=\"literal replaceable\">~/idm_user.pem\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the key in the NSS database does not show \u003Ccode class=\"literal replaceable\">(orphan)\u003C/code> as its nickname. For example, to verify that the certificate stored in the \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code> database is not orphaned:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># certutil -K -d \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code>\n&lt; 0&gt; rsa      5ad14d41463b87a095b1896cf0068ccc467df395   \u003Cspan class=\"strong strong\">\u003Cstrong>NSS Certificate DB:idm_user\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal command\">pk12util\u003C/code> command to export the certificate from the NSS database to the PKCS12 format. For example, to export the certificate with the \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> nickname from the \u003Ccode class=\"literal filename\">/root/certdb\u003C/code> NSS database into the \u003Ccode class=\"literal replaceable\">~/idm_user.p12\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># pk12util -d \u003Ccode class=\"literal filename\">~/certdb\u003C/code> -o \u003Ccode class=\"literal replaceable\">~/idm_user.p12\u003C/code> -n \u003Ccode class=\"literal replaceable\">idm_user\u003C/code>\nEnter Password or Pin for \"NSS Certificate DB\":\nEnter password for PKCS12 file:\nRe-enter password:\npk12util: PKCS12 EXPORT SUCCESSFUL\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTransfer the certificate to the host on which you want the certificate authentication for \u003Ccode class=\"literal replaceable\">idm_user\u003C/code> to be enabled:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># scp \u003Ccode class=\"literal replaceable\">~/idm_user.p12\u003C/code> \u003Ccode class=\"literal replaceable\">idm_user@client.idm.example.com:/home/idm_user/\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the host to which the certificate has been transferred, make the directory in which the .pkcs12 file is stored inaccessible to the 'other' group for security reasons:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># chmod o-rwx \u003Ccode class=\"literal replaceable\">/home/idm_user/\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor security reasons, remove the temporary NSS database and the .pkcs12 file from the server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># rm \u003Ccode class=\"literal replaceable\">~/certdb/\u003C/code>\n# rm \u003Ccode class=\"literal replaceable\">~/idm_user.p12\u003C/code>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.12. Configuring a browser to enable certificate authentication\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo be able to authenticate with a certificate when using the WebUI to log into Identity Management (IdM), you need to import the user and the relevant certificate authority (CA) certificates into the Mozilla Firefox or Google Chrome browser. The host itself on which the browser is running does not have to be part of the IdM domain.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIdM supports the following browsers for connecting to the WebUI:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMozilla Firefox 38 and later\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tGoogle Chrome 46 and later\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe following procedure shows how to configure the Mozilla Firefox 57.0.1 browser.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the \u003Ca class=\"link\" href=\"#requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.11. Requesting a new user certificate and exporting it to the client\">user certificate\u003C/a> that you want to import to the browser at your disposal in the PKCS#12 format.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.2. Downloading the sub-CA certificate from IdM WebUI\">downloaded the sub-CA certificate\u003C/a> and have it at your disposal in the PEM format.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen Firefox, then navigate to \u003Ccode class=\"literal gui\">Preferences\u003C/code> → \u003Ccode class=\"literal gui\">Privacy &amp; Security\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"privacy-security_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cp class=\"title\">\u003Cstrong>Figure 22.8. Privacy and Security section in Preferences\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/c69e139faf91acb67d6b6a7faa65b410/privacy_and_security.png\" alt=\"Screenshot of the Firefox settings page and the &quot;Privacy &amp; Security&quot; option is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">View Certificates\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"view-certificates_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cp class=\"title\">\u003Cstrong>Figure 22.9. View Certificates in Privacy and Security\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/aa5fb25b2f4b3061fe69192d0af19b1c/view_certificates.png\" alt=\"A screenshot of the &quot;Certificates&quot; section and the &quot;View Certificates&quot; button at the bottom right is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal gui\">Your Certificates\u003C/code> tab, click \u003Cspan class=\"guibutton\">Import\u003C/span>. Locate and open the certificate of the user in the PKCS12 format, then click \u003Cspan class=\"guibutton\">OK\u003C/span> and \u003Cspan class=\"guibutton\">OK\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo make sure that your IdM sub-CA is recognized by Firefox as a trusted authority, import the IdM sub-CA certificate that you saved in \u003Ca class=\"link\" href=\"#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.2. Downloading the sub-CA certificate from IdM WebUI\">Downloading the sub-CA certificate from IdM WebUI\u003C/a> as a trusted certificate authority certificate:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOpen Firefox, navigate to Preferences and click \u003Cspan class=\"guibutton\">Privacy &amp; Security\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"privacy-security-2_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cp class=\"title\">\u003Cstrong>Figure 22.10. Privacy and Security section in Preferences\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/c69e139faf91acb67d6b6a7faa65b410/privacy_and_security.png\" alt=\"privacy and security\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">View Certificates\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"view-certificates-2_restricting-an-application-to-trust-a-subset-of-certs\">\u003Cp class=\"title\">\u003Cstrong>Figure 22.11. View Certificates in Privacy and Security\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US/images/aa5fb25b2f4b3061fe69192d0af19b1c/view_certificates.png\" alt=\"A screenshot of the &quot;Certificates&quot; section. The &quot;View Certificates&quot; button at the bottom right is highlighted.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal gui\">Authorities\u003C/code> tab, click \u003Cspan class=\"guibutton\">Import\u003C/span>. Locate and open the sub-CA certificate. Trust the certificate to identify websites, then click \u003Cspan class=\"guibutton\">OK\u003C/span> and \u003Cspan class=\"guibutton\">OK\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"invalidating-a-specific-group-of-related-certificates-quickly_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 23. Invalidating a specific group of related certificates quickly\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tAs a system administrator, if you want to be able to invalidate a specific group of related certificates quickly:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tDesign your applications so that they only trust certificates that were issued by a specific lightweight Identity Management (IdM) sub-CA. Afterwards, you will be able to invalidate all these certificates by only revoking the certificate of the Identity Management (IdM) sub-CA that issued these certificates. For details on how to create and use a lightweight sub-CA in IdM, see \u003Ca class=\"link\" href=\"#restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm\" title=\"Chapter 22. Restricting an application to trust only a subset of certificates\">Invalidating a specific group of related certificates quickly\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tTo ensure that all the certificates that have been issued by the to-be-revoked IdM sub-CA are immediately invalid, configure applications that rely on such certificates to use the IdM OCSP responders. For example, to configure the Firefox browser to use OCSP responders, make sure that the \u003Ccode class=\"literal\">Query OCSP responder servers to confirm the current validity of certificates\u003C/code> checkbox is checked in Firefox Preferences.\n\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\tIn IdM, the certificate revocation list (CRL) is updated every four hours. d To invalidate all the certificates issued by an IdM sub-CA, \u003Ca class=\"link\" href=\"#revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm\" title=\"7.5. Revoking certificates with the integrated IdM CAs\">revoke the IdM sub-CA certificate\u003C/a>. In addition, \u003Ca class=\"link\" href=\"#disabling-CA-ACLs-in-IdM-CLI_invalidating-a-specific-group-of-related-certificates-quickly\" title=\"23.1. Disabling CA ACLs in IdM CLI\">disable the relevant CA ACLs\u003C/a>, and consider \u003Ca class=\"link\" href=\"#disabling-an-IdM-sub-CA_invalidating-a-specific-group-of-related-certificates-quickly\" title=\"23.2. Disabling an IdM sub-CA\">disabling the IdM sub-CA\u003C/a>. Disabling the sub-CA prevents the sub-CA from issuing new certificates, but allows Online Certificate Status Protocol (OCSP) responses to be produced for previously issued certificates because the sub-CA’s signing keys are retained.\n\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tDo not delete the sub-CA if you use OCSP in your environment. Deleting the sub-CA deletes the signing keys of the sub-CA, preventing production of OCSP responses for certificates issued by that sub-CA.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe only scenario when deleting a sub-CA is preferable to disabling it is when you want to create a new sub-CA with the same Subject distinguished name (DN) but a new signing key.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Csection class=\"section\" id=\"disabling-CA-ACLs-in-IdM-CLI_invalidating-a-specific-group-of-related-certificates-quickly\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">23.1. Disabling CA ACLs in IdM CLI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tWhen you want to retire an IdM service or a group of IdM services, consider disabling any existing corresponding CA ACLs.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to disable the \u003Ca class=\"link\" href=\"#creating-a-CA-ACL-for-web-servers-authenticating-to-web-clients-using-certificates-issued-by-webserver-ca_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.3.2. Creating a CA ACL for web servers authenticating to web clients using certificates issued by webserver-ca\">TLS_web_server_authentication\u003C/a> CA ACL that restricts the web server running on your IdM client to request a certificate to be issued by the \u003Ccode class=\"literal\">webserver-ca\u003C/code> IdM sub-CA, and to disable the \u003Ca class=\"link\" href=\"#creating-a-CA-ACL-for-user-web-browsers-authenticating-to-web-servers-using-certificates-issued-by-webclient-ca_restricting-an-application-to-trust-a-subset-of-certs\" title=\"22.3.3. Creating a CA ACL for user web browsers authenticating to web servers using certificates issued by webclient-ca\">TLS_web_client_authentication\u003C/a> CA ACL that restricts IdM users to request a user certificate to be issued by the \u003Ccode class=\"literal\">webclient-ca\u003C/code> IdM sub-CA.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To view all the CA ACLs in your IdM environment, enter the \u003Ccode class=\"literal\">ipa caacl-find\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-find\u003C/strong>\u003C/span>\n-----------------\n3 CA ACLs matched\n-----------------\n  ACL name: hosts_services_caIPAserviceCert\n  Enabled: TRUE\n\n  ACL name: TLS_web_server_authentication\n  Enabled: TRUE\n\n  ACL name: TLS_web_client_authentication\n  Enabled: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To view the details of a CA ACL, enter the \u003Ccode class=\"literal\">ipa caacl-show\u003C/code> command, and specify the CA ACL name:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-show TLS_web_server_authentication\u003C/strong>\u003C/span>\n  ACL name: TLS_web_server_authentication\n  Description: CAACL for web servers authenticating to web clients using certificates issued by webserver-ca\n  Enabled: TRUE\n  CAs: webserver-ca\n  Profiles: caIPAserviceCert\n  Services: HTTP/rhel8server.idm.example.com@IDM.EXAMPLE.COM\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo disable a CA ACL, enter the \u003Ccode class=\"literal\">ipa caacl-disable\u003C/code> command, and specify the CA ACL name.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo disable the \u003Cspan class=\"strong strong\">\u003Cstrong>TLS_web_server_authentication\u003C/strong>\u003C/span> CA ACL, enter:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-disable TLS_web_server_authentication\u003C/strong>\u003C/span>\n-------------------------------------------------\nDisabled CA ACL \"TLS_web_server_authentication\"\n-------------------------------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo disable the \u003Cspan class=\"strong strong\">\u003Cstrong>TLS_web_client_authentication\u003C/strong>\u003C/span> CA ACL, enter:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa caacl-disable TLS_web_client_authentication\u003C/strong>\u003C/span>\n-------------------------------------------------\nDisabled CA ACL \"TLS_web_client_authentication\"\n-------------------------------------------------\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe only enabled CA ACL now is the \u003Cspan class=\"strong strong\">\u003Cstrong>hosts_services_caIPAserviceCert\u003C/strong>\u003C/span> CA ACL.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tBe extremely careful about disabling the \u003Ccode class=\"literal\">hosts_services_caIPAserviceCert\u003C/code> CA ACL. Disabling \u003Ccode class=\"literal\">hosts_services_caIPAserviceCert\u003C/code>, without another CA ACL granting IdM servers use of the \u003Ccode class=\"literal\">ipa\u003C/code> CA with the \u003Ccode class=\"literal\">caIPAserviceCert\u003C/code> profile means that certificate renewal of the IdM \u003Ccode class=\"literal\">HTTP\u003C/code> and \u003Ccode class=\"literal\">LDAP\u003C/code> certificates will fail. The expired IdM \u003Ccode class=\"literal\">HTTP\u003C/code> and \u003Ccode class=\"literal\">LDAP\u003C/code> certificates will eventually cause IdM system failure.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"disabling-an-IdM-sub-CA_invalidating-a-specific-group-of-related-certificates-quickly\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">23.2. Disabling an IdM sub-CA\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAfter revoking the CA certificate of an IdM sub-CA to invalidate all the certificates issued by that sub-CA, consider disabling the IdM sub-CA if you no longer need it. You can re-enable the sub-CA at a later time.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDisabling the sub-CA prevents the sub-CA from issuing new certificates, but allows Online Certificate Status Protocol (OCSP) responses to be produced for previously issued certificates because the sub-CA’s signing keys are retained.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnter the \u003Ccode class=\"literal\">ipa ca-disable\u003C/code> command and specify the name of the sub-CA:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa ca-disable webserver-CA\u003C/strong>\u003C/span>\n--------------------\nDisabled CA \"webserver-CA\"\n--------------------\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"verifying-certificates-using-idm-healthcheck_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 24. Verifying certificates using IdM Healthcheck\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tLearn more about understanding and using the Healthcheck tool in Identity management (IdM) to identify issues with IPA certificates maintained by \u003Ccode class=\"literal\">certmonger\u003C/code>.\n\t\t\u003C/p>\u003Cp>\n\t\t\tFor details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_idm_healthcheck_to_monitor_your_idm_environment/installing-and-running-the-ipa-healthcheck-tool_using-idm-healthcheck-to-monitor-your-idm-environment#healthcheck-in-idm_installing-and-running-the-ipa-healthcheck-tool\">Healthcheck in IdM\u003C/a>.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"idm-certificates-healthcheck-tests_verifying-certificates-using-idm-healthcheck\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.1. IdM certificates Healthcheck tests\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Healthcheck tool includes several tests for verifying the status of certificates maintained by certmonger in Identity Management (IdM). For details about certmonger, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/using-certmonger_managing-certificates-in-idm\">Obtaining an IdM certificate for a service using certmonger\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis suite of tests checks expiration, validation, trust and other issues. Multiple errors may be thrown for the same underlying issue.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo see all certificate tests, run the \u003Ccode class=\"literal\">ipa-healthcheck\u003C/code> with the \u003Ccode class=\"literal\">--list-sources\u003C/code> option:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa-healthcheck --list-sources\u003C/pre>\u003Cp>\n\t\t\t\tYou can find all tests under the \u003Ccode class=\"literal\">ipahealthcheck.ipa.certs\u003C/code> source:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">IPACertmongerExpirationCheck\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis test checks expirations in \u003Ccode class=\"literal\">certmonger\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf an error is reported, the certificate has expired.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf a warning appears, the certificate will expire soon. By default, this test applies within 28 days or fewer days before certificate expiration.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the number of days in the \u003Ccode class=\"literal\">/etc/ipahealthcheck/ipahealthcheck.conf\u003C/code> file. After opening the file, change the \u003Ccode class=\"literal\">cert_expiration_days\u003C/code> option located in the default section.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tCertmonger loads and maintains its own view of the certificate expiration. This check does not validate the on-disk certificate.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">IPACertfileExpirationCheck\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis test checks if the certificate file or NSS database cannot be opened. This test also checks expiration. Therefore, carefully read the \u003Ccode class=\"literal\">msg\u003C/code> attribute in the error or warning output. The message specifies the problem.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tThis test checks the on-disk certificate. If a certificate is missing, unreadable, etc a separate error can also be raised.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">IPACertNSSTrust\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThis test compares the trust for certificates stored in NSS databases. For the expected tracked certificates in NSS databases the trust is compared to an expected value and an error raised on a non-match.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">IPANSSChainValidation\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThis test validates the certificate chain of the NSS certificates. The test executes: \u003Ccode class=\"literal\">certutil -V -u V -e -d [dbdir] -n [nickname]\u003C/code>\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">IPAOpenSSLChainValidation\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis test validates the certificate chain of the OpenSSL certificates. To be comparable to the \u003Ccode class=\"literal\">NSSChain\u003C/code> validation here is the OpenSSL command we execute:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">openssl verify -verbose -show_chain -CAfile /etc/ipa/ca.crt [cert file]\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">IPARAAgent\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThis test compares the certificate on disk with the equivalent record in LDAP in \u003Ccode class=\"literal\">uid=ipara,ou=People,o=ipaca\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">IPACertRevocation\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThis test uses certmonger to verify that certificates have not been revoked. Therefore, the test can find issues connected with certificates maintained by certmonger only.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">IPACertmongerCA\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis test verifies the certmonger Certificate Authority (CA) configuration. IdM cannot issue certificates without CA.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCertmonger maintains a set of CA helpers. In IdM, there is a CA named IPA which issues certificates through IdM, authenticating as a host or user principal, for host or service certs.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThere are also \u003Ccode class=\"literal\">dogtag-ipa-ca-renew-agent\u003C/code> and \u003Ccode class=\"literal\">dogtag-ipa-ca-renew-agent-reuse\u003C/code> which renew the CA subsystem certificates.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tRun these tests on all IdM servers when trying to check for issues.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"screening-certificates-using-the-healthcheck-tool_verifying-certificates-using-idm-healthcheck\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.2. Screening certificates using the Healthcheck tool\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to run a standalone manual test of an Identity Management (IdM) certificate health check using the Healthcheck tool.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe Healthcheck tool includes many tests, therefore, you can shorten the results with:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tExcluding all successful test: \u003Ccode class=\"literal\">--failures-only\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIncluding only certificate tests: \u003Ccode class=\"literal\">--source=ipahealthcheck.ipa.certs\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou must perform Healthcheck tests as the \u003Ccode class=\"literal\">root\u003C/code> user.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo run Healthcheck with warnings, errors and critical issues regarding certificates, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa-healthcheck --source=ipahealthcheck.ipa.certs --failures-only\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tSuccessful test displays empty brackets:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[]\u003C/pre>\u003Cp>\n\t\t\t\tFailed test shows you the following output:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">{\n  \"source\": \"ipahealthcheck.ipa.certs\",\n  \"check\": \"IPACertfileExpirationCheck\",\n  \"result\": \"ERROR\",\n  \"kw\": {\n    \"key\": 1234,\n    \"dbdir\": \"/path/to/nssdb\",\n    \"error\": [error],\n    \"msg\": \"Unable to open NSS database '/path/to/nssdb': [error]\"\n  }\n}\u003C/pre>\u003Cp>\n\t\t\t\tThis \u003Ccode class=\"literal\">IPACertfileExpirationCheck\u003C/code> test failed on opening the NSS database.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">man ipa-healthcheck\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"verifying-system-certificates-using-idm-healthcheck_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 25. Verifying system certificates using IdM Healthcheck\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tLearn more about identifying issues with system certificates in Identity Management (IdM) by using the Healthcheck tool.\n\t\t\u003C/p>\u003Cp>\n\t\t\tFor details, see\n\t\t\u003C/p>\u003Cp>\n\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_idm_healthcheck_to_monitor_your_idm_environment/installing-and-running-the-ipa-healthcheck-tool_using-idm-healthcheck-to-monitor-your-idm-environment#healthcheck-in-idm_installing-and-running-the-ipa-healthcheck-tool\">Healthcheck in IdM\u003C/a>.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"system-certificates-healthcheck-tests_verifying-dogtag-certificates-using-healthcheck\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">25.1. System certificates Healthcheck tests\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Healthcheck tool includes several tests for verifying system (DogTag) certificates.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo see all tests, run the \u003Ccode class=\"literal\">ipa-healthcheck\u003C/code> with the \u003Ccode class=\"literal\">--list-sources\u003C/code> option:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa-healthcheck --list-sources\u003C/pre>\u003Cp>\n\t\t\t\tYou can find all tests under the \u003Ccode class=\"literal\">ipahealthcheck.dogtag.ca\u003C/code> source:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">DogtagCertsConfigCheck\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis test compares the CA (Certificate Authority) certificates in its NSS database to the same values stored in \u003Ccode class=\"literal\">CS.cfg\u003C/code>. If they do not match, the CA fails to start.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tSpecifically, it checks:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auditSigningCert cert-pki-ca\u003C/code> against \u003Ccode class=\"literal\">ca.audit_signing.cert\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ocspSigningCert cert-pki-ca\u003C/code> against \u003Ccode class=\"literal\">ca.ocsp_signing.cert\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">caSigningCert cert-pki-ca\u003C/code> against \u003Ccode class=\"literal\">ca.signing.cert\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">subsystemCert cert-pki-ca\u003C/code> against \u003Ccode class=\"literal\">ca.subsystem.cert\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Server-Cert cert-pki-ca\u003C/code> against \u003Ccode class=\"literal\">ca.sslserver.cert\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf Key Recovery Authority (KRA) is installed:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">transportCert cert-pki-kra\u003C/code> against \u003Ccode class=\"literal\">ca.connector.KRA.transportCert\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">DogtagCertsConnectivityCheck\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis test verifies connectivity. This test is equivalent to the \u003Ccode class=\"literal\">ipa cert-show 1\u003C/code> command which checks:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe PKI proxy configuration in Apache\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tIdM being able to find a CA\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe RA agent client certificate\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tCorrectness of CA replies to requests\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that the test checks a certificate with serial #1 because you want to verify that a \u003Ccode class=\"literal\">cert-show\u003C/code> can be executed and get back an expected result from CA (either the certificate or a not found).\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tRun these tests on all IdM servers when trying to find an issue.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"screening-system-certificates-using-healthcheck_verifying-dogtag-certificates-using-healthcheck\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">25.2. Screening system certificates using Healthcheck\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to run a standalone manual test of Identity Management (IdM) certificates using the Healthcheck tool.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSince, the Healthcheck tool includes many tests, you can narrow the results by including only DogTag tests: \u003Ccode class=\"literal\">--source=ipahealthcheck.dogtag.ca\u003C/code>\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo run Healthcheck restricted to DogTag certificates, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># ipa-healthcheck --source=ipahealthcheck.dogtag.ca\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tAn example of a successful test:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">{\n  \"source: ipahealthcheck.dogtag.ca\",\n  \"check: DogtagCertsConfigCheck\",\n  \"result: SUCCESS\",\n  \"uuid: 9b366200-9ec8-4bd9-bb5e-9a280c803a9c\",\n  \"when: 20191008135826Z\",\n  \"duration: 0.252280\",\n  \"kw:\" {\n    \"key\": \"Server-Cert cert-pki-ca\",\n    \"configfile\":  \"/var/lib/pki/pki-tomcat/conf/ca/CS.cfg\"\n    }\n}\u003C/pre>\u003Cp>\n\t\t\t\tAn example of a failed test:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">{\n  \"source: ipahealthcheck.dogtag.ca\",\n  \"check: DogtagCertsConfigCheck\",\n  \"result: CRITICAL\",\n  \"uuid: 59d66200-1447-4b3b-be01-89810c803a98\",\n  \"when: 20191008135912Z\",\n  \"duration: 0.002022\",\n  \"kw:\" {\n    \"exception\": \"NSDB /etc/pki/pki-tomcat/alias not initialized\",\n    }\n}\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">man ipa-healthcheck\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"understanding-what-certificates-are-used-by-idm_managing-certificates-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 26. Understanding the certificates used internally by IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tYou can install a Red Hat Identity Management (IdM) server with an integrated certificate authority (CA) or without a CA. The certificates necessary to access and administer IdM are managed differently depending on whether your CA is integrated or not:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tIntegrated CA: certificates are automatically created and tracked by \u003Ccode class=\"literal\">certmonger\u003C/code>. \u003Ccode class=\"literal\">certmonger\u003C/code> automatically renews the certificates, ensuring a continuing validity of your IdM service.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tWithout a CA: certificates are requested from a third-party authority. In this case, you need to monitor their expiration and ensure they are renewed to ensure the continuing validity of your IdM service.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"about-the-internal-certificates-in-idm_understanding-what-certificates-are-used-by-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.1. About the internal certificates in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tRed Hat Identity Management (IdM) uses many services accessed by using a network, including an LDAP server and an HTTP server. You access these services by using an SSL/TLS port, which requires a server certificate. You require the HTTP and LDAP server certificates during the installation of the IdM server.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can obtain certificates in multiple ways depending on how you install and configure IdM:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWith an integrated CA that can be either self-signed or signed by an external CA: IdM issues all the certificates for the users, hosts, and services managed by IdM and you do not need to provide a certificate file.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">certmonger\u003C/code> automatically monitors the expiry dates of the certificates and they are automatically renewed when required.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWith an externally signed CA: the installation is a multiple step process.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou need to run the installation with the \u003Ccode class=\"literal\">--external-ca\u003C/code> option to generate a CSR.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSubmit the CSR to the external CA and retrieve the issued certificate and CA certificate chain as a PEM file or Base64 encoded certificate.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRun the IdM server install again, specifying the location and names of the newly-issued CA certificate and CA chain file. Your IdM certificate authority is configured as a subCA of the external CA and this subCA issues the required HTTP and LDAP server certificates.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">certmonger\u003C/code> automatically monitors the expiry dates of the certificates and they are automatically renewed when required.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWithout a CA: requires you to request the following certificates from a third-party authority:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAn LDAP server certificate\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAn Apache server certificate\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tA PKINIT certificate\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFull CA certificate chain of the CA that issued the LDAP and Apache server certificates\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThese certificates are not tracked by \u003Ccode class=\"literal\">certmonger\u003C/code> and an administrator is responsible for renewing them before they reach their expiration date.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-your-ca-services_planning-identity-management\">Planning your CA services\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"certificates-internal-to-idm_understanding-what-certificates-are-used-by-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.2. Certificates internal to IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYour internal certificates can depend on how you installed IdM and what components were included in that installation. Depending on that installation, you might have the following certificates stored on your system.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>IdM CA certificate\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe IdM CA certificate is used by IdM to sign all other certificates. Note that it is not present in CA-less installations.\n\t\t\t\t\u003C/p>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333357667760\" scope=\"col\">caSigningCert\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333357666672\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357667760\"> \u003Cp>\n\t\t\t\t\t\t\t\tFile system location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357666672\"> \u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">nickname=caSigningCert cert-pki-ca\u003C/code> in \u003Ccode class=\"literal\">/etc/pki/pki-tomcat/alias\u003C/code> NSS database\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">nickname=REALM.NAME IPA CA\u003C/code> in \u003Ccode class=\"literal\">/etc/ipa/nssdb/\u003C/code> and \u003Ccode class=\"literal\">/etc/ipa/ca.crt\u003C/code> (populated from LDAP)\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357667760\"> \u003Cp>\n\t\t\t\t\t\t\t\tLDAP location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357666672\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cn=REALM.NAME IPA CA,cn=certificates,cn=ipa,cn=etc,dc=realm,dc=name and ou=authorities,ou=ca,o=ipaca\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357667760\"> \u003Cp>\n\t\t\t\t\t\t\t\tIssuer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357666672\"> \u003Cp>\n\t\t\t\t\t\t\t\tSelf-signed or signed by an external CA\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357667760\"> \u003Cp>\n\t\t\t\t\t\t\t\tSubject\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357666672\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">O = REALM.NAME, CN = Certificate Authority\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tNote that this is the default value but it can be customized during the IdM server installation.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357667760\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdditional information\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357666672\"> \u003Cp>\n\t\t\t\t\t\t\t\tMust have \u003Ccode class=\"literal\">CA:true\u003C/code> critical constraint and must have \u003Ccode class=\"literal\">CT,C,C\u003C/code> trust flags in the NSS database.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>External CA certificate\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tIf you are using an external CA, the chain of external CAs must be available in IdM to validate IdM certificates. For a CA-less installation, the external CA certificate must be present in various locations, including LDAP and in the \u003Ccode class=\"literal\">/etc/ipa/ca.crt\u003C/code> directory to validate HTTPD and LDAP certificates.\n\t\t\t\t\u003C/p>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou do not have to manually add the external CA certificate to all the required locations as it is done automatically during the installation. However, if the external CA certificate is updated later, you should follow the steps in \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/managing_certificates_in_idm/index#renew-with-externally-signed-CA_managing-externally-signed-ca-certificates\">Renewing the IdM CA renewal server certificate using an external CA\u003C/a> to ensure the new certificate is added to every location where it is required.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333357786528\" scope=\"col\">External certificate\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333357785440\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357786528\"> \u003Cp>\n\t\t\t\t\t\t\t\tFile system location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357785440\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/etc/pki/pki-tomcat/alias nssdb\u003C/code> and as part of chain in \u003Ccode class=\"literal\">/etc/ipa/ca.crt\u003C/code> (populated from LDAP)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357786528\"> \u003Cp>\n\t\t\t\t\t\t\t\tLDAP location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357785440\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cn=SUBJECT,cn=certificates,cn=ipa,cn=etc,dc=realm,dc=name and ou=authorities,ou=ca,o=ipaca\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357786528\"> \u003Cp>\n\t\t\t\t\t\t\t\tIssuer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357785440\"> \u003Cp>\n\t\t\t\t\t\t\t\tExternal CA-signed\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357786528\"> \u003Cp>\n\t\t\t\t\t\t\t\tSubject\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357785440\"> \u003Cp>\n\t\t\t\t\t\t\t\tExternal CA subject\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357786528\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdditional information\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357785440\"> \u003Cp>\n\t\t\t\t\t\t\t\tYou must have all the certificates in the chain in DER format and you must import them into LDAP. Must have \u003Ccode class=\"literal\">CT,C,C\u003C/code> trust flags in the NSS database.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Subsystem CA certificate\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThis certificate is used to authenticate to the LDAP server when writing to the LDAP database. This certificate is not present in CA-less installations.\n\t\t\t\t\u003C/p>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333357756928\" scope=\"col\">subsystemCert\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333357755840\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357756928\"> \u003Cp>\n\t\t\t\t\t\t\t\tFile system location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357755840\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">nickname=subsystemCert cert-pki-ca\u003C/code> in \u003Ccode class=\"literal\">/etc/pki/pki-tomcat/alias nssdb\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357756928\"> \u003Cp>\n\t\t\t\t\t\t\t\tLDAP location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357755840\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">uid=pkidbuser,ou=people,o=ipaca\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357756928\"> \u003Cp>\n\t\t\t\t\t\t\t\tIssuer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357755840\"> \u003Cp>\n\t\t\t\t\t\t\t\tIPA CA\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357756928\"> \u003Cp>\n\t\t\t\t\t\t\t\tSubject\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357755840\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">CN=CA Subsystem,O=REALM.NAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357756928\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdditional information\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357755840\"> \u003Cp>\n\t\t\t\t\t\t\t\tBe wary of a serial and blob mismatch in LDAP. For example, \u003Ccode class=\"literal\">2;SERIAL;CN=Certificate Authority,O=REALM.NAME;CN=CA Subsystem,O=REALM.NAME\u003C/code> and \u003Ccode class=\"literal\">userCertificate\u003C/code> must match the one on the file system.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Audit signing certificate\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThis certificate is used to sign the audit logs. Note that it is not present in CA-less installations.\n\t\t\t\t\u003C/p>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333356689504\" scope=\"col\">auditSigningCert\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333356688416\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356689504\"> \u003Cp>\n\t\t\t\t\t\t\t\tFile system location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356688416\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">nickname=auditSigningCert cert-pki-ca\u003C/code> in \u003Ccode class=\"literal\">/etc/pki/pki-tomcat/alias nssdb\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356689504\"> \u003Cp>\n\t\t\t\t\t\t\t\tLDAP location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356688416\"> \u003Cp>\n\t\t\t\t\t\t\t\tNo dedicated LDAP location, shared via \u003Ccode class=\"literal\">ou=certificateRepository,ou=ca,o=ipaca\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356689504\"> \u003Cp>\n\t\t\t\t\t\t\t\tIssuer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356688416\"> \u003Cp>\n\t\t\t\t\t\t\t\tIPA CA\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356689504\"> \u003Cp>\n\t\t\t\t\t\t\t\tSubject\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356688416\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">CN=CA Audit,O=REALM.NAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356689504\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdditional information\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356688416\"> \u003Cp>\n\t\t\t\t\t\t\t\tMust have \u003Ccode class=\"literal\">,,P\u003C/code> trust flags in the NSS database.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>OCSP signing certificate\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThis certificate is used to provide Online Certificate Status Protocol (OCSP) services. Note that it is not present in CA-less installations.\n\t\t\t\t\u003C/p>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333356659584\" scope=\"col\">ocspSigningCert\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333356658496\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356659584\"> \u003Cp>\n\t\t\t\t\t\t\t\tFile system location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356658496\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">nickname=ocspSigningCert cert-pki-ca\u003C/code> in \u003Ccode class=\"literal\">/etc/pki/pki-tomcat/alias nssdb\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356659584\"> \u003Cp>\n\t\t\t\t\t\t\t\tLDAP location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356658496\"> \u003Cp>\n\t\t\t\t\t\t\t\tNo dedicated LDAP location, shared via \u003Ccode class=\"literal\">ou=certificateRepository,ou=ca,o=ipaca\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356659584\"> \u003Cp>\n\t\t\t\t\t\t\t\tIssuer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356658496\"> \u003Cp>\n\t\t\t\t\t\t\t\tIPA CA\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356659584\"> \u003Cp>\n\t\t\t\t\t\t\t\tSubject\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356658496\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">CN=OCSP Subsystem,O=REALM.NAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356659584\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdditional information\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333356658496\"> \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Tomcat servlet certificate\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThis certificate is used when a client contacts the PKI. Note that this server certificate is specific to the host and it is not present in CA-less installations.\n\t\t\t\t\u003C/p>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333357563344\" scope=\"col\">Server-Cert\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333357562256\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357563344\"> \u003Cp>\n\t\t\t\t\t\t\t\tFile system location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357562256\"> \u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tNickname=Server-Cert cert-pki-ca in /etc/pki/pki-tomcat/alias nssdb+\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357563344\"> \u003Cp>\n\t\t\t\t\t\t\t\tLDAP location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357562256\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357563344\"> \u003Cp>\n\t\t\t\t\t\t\t\tIssuer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357562256\"> \u003Cp>\n\t\t\t\t\t\t\t\tIPA CA\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357563344\"> \u003Cp>\n\t\t\t\t\t\t\t\tSubject\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357562256\"> \u003Cp>\n\t\t\t\t\t\t\t\tCN=$HOSTNAME,O=REALM.NAME\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357563344\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdditional information\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357562256\"> \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Registration authority certificate\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tCertificate used by \u003Ccode class=\"literal\">certmonger\u003C/code> as well as by the IdM framework to authenticate to the PKI. For example, if you run \u003Ccode class=\"literal\">ipa cert-show 1\u003C/code>, HTTPD communicates with the PKI and authenticates with this certificate. Not present in CA-less installations.\n\t\t\t\t\u003C/p>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333357535168\" scope=\"col\">RA agent\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333357534080\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357535168\"> \u003Cp>\n\t\t\t\t\t\t\t\tFile system location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357534080\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/var/lib/ipa/ra-agent.pem\u003C/code> (used to be in \u003Ccode class=\"literal\">/etc/httpd/alias\u003C/code> before RHEL 7.4)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357535168\"> \u003Cp>\n\t\t\t\t\t\t\t\tLDAP location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357534080\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">uid=ipara,ou=people,o=ipaca\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357535168\"> \u003Cp>\n\t\t\t\t\t\t\t\tIssuer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357534080\"> \u003Cp>\n\t\t\t\t\t\t\t\tIPA CA\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357535168\"> \u003Cp>\n\t\t\t\t\t\t\t\tSubject\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357534080\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">CN=IPA RA,O=REALM.NAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357535168\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdditional information\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333357534080\"> \u003Cp>\n\t\t\t\t\t\t\t\tBe wary of a serial and blob mismatch in LDAP. For example, \u003Ccode class=\"literal\">2;SERIAL;CN=Certificate Authority,O=REALM.NAME;CN=IPA RA,O=REALM.NAME\u003C/code> and \u003Ccode class=\"literal\">userCertificate\u003C/code> must match the one on the file system.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>HTTPD front end certificate\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tCertificate used for the HTTPD frontend to secure connections to the Web UI and API. Must be present.\n\t\t\t\t\u003C/p>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333355481728\" scope=\"col\">HTTPD\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333355480640\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333355481728\"> \u003Cp>\n\t\t\t\t\t\t\t\tFile system location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333355480640\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/var/lib/ipa/certs/httpd.crt\u003C/code> (used to be in \u003Ccode class=\"literal\">/etc/httpd/alias\u003C/code> before RHEL 8)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333355481728\"> \u003Cp>\n\t\t\t\t\t\t\t\tLDAP location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333355480640\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333355481728\"> \u003Cp>\n\t\t\t\t\t\t\t\tIssuer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333355480640\"> \u003Cp>\n\t\t\t\t\t\t\t\tIPA CA or external CA in CA-less installations\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333355481728\"> \u003Cp>\n\t\t\t\t\t\t\t\tSubject\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333355480640\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">CN=$HOSTNAME,O=REALM.NAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333355481728\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdditional information\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333355480640\"> \u003Cp>\n\t\t\t\t\t\t\t\tMust contain a \u003Ccode class=\"literal\">Certificate Subject Alt Name\u003C/code> extension with principal name as \u003Ccode class=\"literal\">otherName = 1.3.6.1.4.1.311.20.2.3;UTF8:HTTP/$HOSTNAME@REALM, DNS name = $HOSTNAME\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>LDAP TLS and STARTTLS certificate\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tCertificate used for LDAP TLS and STARTTLS connections. Must be present.\n\t\t\t\t\u003C/p>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333358758928\" scope=\"col\">LDAP\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333358757840\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358758928\"> \u003Cp>\n\t\t\t\t\t\t\t\tFile system location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358757840\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">nickname=Server-Cert\u003C/code> in \u003Ccode class=\"literal\">/etc/dirsrv/slapd-DOMAIN\u003C/code> NSS database (can be other nickname, matching \u003Ccode class=\"literal\">nsSSLPersonalitySSL\u003C/code> in \u003Ccode class=\"literal\">dse.ldif\u003C/code>)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358758928\"> \u003Cp>\n\t\t\t\t\t\t\t\tLDAP location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358757840\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358758928\"> \u003Cp>\n\t\t\t\t\t\t\t\tIssuer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358757840\"> \u003Cp>\n\t\t\t\t\t\t\t\tIPA CA or external CA in CA-less installations\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358758928\"> \u003Cp>\n\t\t\t\t\t\t\t\tSubject\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358757840\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">CN=$HOSTNAME,O=REALM.NAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358758928\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdditional information\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358757840\"> \u003Cp>\n\t\t\t\t\t\t\t\tMust contain a \u003Ccode class=\"literal\">Certificate Subject Alt Name\u003C/code> extension with principal name as \u003Ccode class=\"literal\">otherName = 1.3.6.1.4.1.311.20.2.3;UTF8:ldap/$HOSTNAME@REALM, DNS name = $HOSTNAME\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>KDC certificate\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tCertificate used for PKINIT for the IdM KDC.\n\t\t\t\t\u003C/p>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333358728720\" scope=\"col\">KDC\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140333358727632\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358728720\"> \u003Cp>\n\t\t\t\t\t\t\t\tFile system location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358727632\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/var/kerberos/krb5kdc/kdc.crt\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358728720\"> \u003Cp>\n\t\t\t\t\t\t\t\tLDAP location\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358727632\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358728720\"> \u003Cp>\n\t\t\t\t\t\t\t\tIssuer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358727632\"> \u003Cp>\n\t\t\t\t\t\t\t\tIPA CA or external CA in CA-less installations\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358728720\"> \u003Cp>\n\t\t\t\t\t\t\t\tSubject\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358727632\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">CN=$HOSTNAME,O=REALM.NAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358728720\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdditional information\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140333358727632\"> \u003Cp>\n\t\t\t\t\t\t\t\tMust have extended key usage \u003Ccode class=\"literal\">id-pkinit-KPkdc (1.3.6.1.5.2.3.5)\u003C/code>, principal name as \u003Ccode class=\"literal\">otherName = 1.3.6.1.4.1.311.20.2.3;UTF8:krbtgt/REALM@REALM, DNS name = $HOSTNAME\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003Csection class=\"section\" id=\"idm-internal-certificate-renewal-process_understanding-what-certificates-are-used-by-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.3. IdM internal certificate renewal process\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBy default, \u003Ccode class=\"literal\">certmonger\u003C/code> tracks the internal certificates and triggers the renewal and requests the IdM CA to issue a new certificate.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you are using an external CA and your internal certificates were issued by this CA, they are not automatically renewed. In this case, you should monitor the expiry dates of your certificates to ensure you renew them before they expire. The renewal process is time consuming and if you do not track the expiry dates carefully, your certificates will expire and some services will no longer be available.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf your internal Red Hat Identity Management (IdM) certificates expire, IdM fails to start.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tThe IdM CA renewal server renews the shared internal certificates 28 days before their expiration date. \u003Ccode class=\"literal\">certmonger\u003C/code> triggers this renewal and uploads the new certificate into \u003Ccode class=\"literal\">cn=&lt;nickname&gt;,cn=ca_renewal,cn=ipa,cn=etc,$BASEDN\u003C/code>. \u003Ccode class=\"literal\">certmonger\u003C/code> also triggers the renewal process on the other IdM servers but as it is executed on an non-CA renewal server, it does not request a new certificate but downloads the certificate from LDAP. Note that the \u003Ccode class=\"literal\">Server-Cert cert-pki-ca\u003C/code>, HTTP, LDAP, and PKINIT certificates are specific to each replica, containing the hostname in their subject.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you manually renew a shared certificate with \u003Ccode class=\"literal\">getcert\u003C/code> before a certificate expires, the renewal process is not triggered on the other replicas and you must run \u003Ccode class=\"literal\">getcert\u003C/code> on the other replicas to perform the download of the renewed certificate from LDAP.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_4\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.4. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/ipa-ca-renewal_managing-certificates-in-idm\">Using IdM CA renewal server\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/renewing-expired-system-certificates-when-idm-is-offline_managing-certificates-in-idm\">Renewing expired system certificates when IdM is offline\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-not-yet-expired-on-an-idm-replica_managing-certificates-in-idm\">Replacing the web server and LDAP server certificates if they have not yet expired on an IdM replica\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-expired-in-the-whole-idm-deployment_managing-certificates-in-idm\">Replacing the web server and LDAP server certificates if they have expired in the whole IdM deployment\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"legalnotice\" id=\"idm140333367899040\">\u003Ch2 class=\"legalnotice\">Legal Notice\u003C/h2>\u003Cdiv class=\"para\">\n\t\tCopyright \u003Cspan class=\"trademark\">\u003C!--Empty-->\u003C/span>© 2024 Red Hat, Inc.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license (\"CC-BY-SA\"). An explanation of CC-BY-SA is available at \u003Ca class=\"uri\" href=\"http://creativecommons.org/licenses/by-sa/3.0/\">http://creativecommons.org/licenses/by-sa/3.0/\u003C/a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Linux\u003C/span>® is the registered trademark of Linus Torvalds in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Java\u003C/span>® is a registered trademark of Oracle and/or its affiliates.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">XFS\u003C/span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">MySQL\u003C/span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Node.js\u003C/span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe \u003Cspan class=\"trademark\">OpenStack\u003C/span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tAll other trademarks are the property of their respective owners.\n\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003C/body>",[14,21,26,44,66,88,114,158,192,244,295,332,434,464,478,496,510,515,520,538,543,594,612,634,722,736,750,764,786],{"title":11,"visible":15,"weight":16,"urlFragment":17,"anchor":18,"singlePageAnchor":18,"docTitle":19,"url":20},true,1,"index",null,"managing_certificates_in_idm","#",{"title":22,"visible":15,"weight":23,"urlFragment":24,"anchor":18,"singlePageAnchor":24,"docTitle":19,"url":25},"Providing feedback on Red Hat documentation",2,"proc_providing-feedback-on-red-hat-documentation_managing-certificates-in-idm","#proc_providing-feedback-on-red-hat-documentation_managing-certificates-in-idm",{"title":27,"visible":15,"weight":28,"urlFragment":29,"anchor":18,"singlePageAnchor":29,"sections":30,"docTitle":19,"url":43},"1. Public key certificates in Identity Management",3,"cert-intro_managing-certificates-in-idm",[31,35,39],{"title":32,"visible":15,"weight":16,"urlFragment":29,"anchor":33,"singlePageAnchor":33,"docTitle":19,"url":34},"1.1. Certificate authorities in IdM","certificate_authorities_in_idm","#certificate_authorities_in_idm",{"title":36,"visible":15,"weight":23,"urlFragment":29,"anchor":37,"singlePageAnchor":37,"docTitle":19,"url":38},"1.2. Comparison of certificates and Kerberos","comparison_of_certificates_and_kerberos","#comparison_of_certificates_and_kerberos",{"title":40,"visible":15,"weight":28,"urlFragment":29,"anchor":41,"singlePageAnchor":41,"docTitle":19,"url":42},"1.3. The pros and cons of using certificates to authenticate users in IdM","using-certs-to-authenticate-users_cert-intro","#using-certs-to-authenticate-users_cert-intro","#cert-intro_managing-certificates-in-idm",{"title":45,"visible":15,"weight":46,"urlFragment":47,"anchor":18,"singlePageAnchor":47,"sections":48,"docTitle":19,"url":65},"2. Managing certificates for users, hosts, and services using the integrated IdM CA",4,"managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm",[49,53,57,61],{"title":50,"visible":15,"weight":16,"urlFragment":47,"anchor":51,"singlePageAnchor":51,"docTitle":19,"url":52},"2.1. Requesting new certificates for a user, host, or service using IdM Web UI","requesting-new-certificates-for-a-user-host-or-service-using-idm-web-ui_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca","#requesting-new-certificates-for-a-user-host-or-service-using-idm-web-ui_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca",{"title":54,"visible":15,"weight":23,"urlFragment":47,"anchor":55,"singlePageAnchor":55,"docTitle":19,"url":56},"2.2. Requesting new certificates for a user, host, or service from IdM CA using certutil","requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-certutil_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca","#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-certutil_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca",{"title":58,"visible":15,"weight":28,"urlFragment":47,"anchor":59,"singlePageAnchor":59,"docTitle":19,"url":60},"2.3. Requesting new certificates for a user, host, or service from IdM CA using openssl","requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-openssl_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca","#requesting-new-certificates-for-a-user-host-or-service-from-idm-ca-using-openssl_managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca",{"title":62,"visible":15,"weight":46,"urlFragment":47,"anchor":63,"singlePageAnchor":63,"docTitle":19,"url":64},"2.4. Additional resources","additional_resources","#additional_resources","#managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm",{"title":67,"visible":15,"weight":68,"urlFragment":69,"anchor":18,"singlePageAnchor":69,"sections":70,"docTitle":19,"url":87},"3. Managing IdM certificates using Ansible",5,"managing-idm-certificates-using-ansible_managing-certificates-in-idm",[71,75,79,83],{"title":72,"visible":15,"weight":16,"urlFragment":69,"anchor":73,"singlePageAnchor":73,"docTitle":19,"url":74},"3.1. Using Ansible to request SSL certificates for IdM hosts, services and users","using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible","#using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible",{"title":76,"visible":15,"weight":23,"urlFragment":69,"anchor":77,"singlePageAnchor":77,"docTitle":19,"url":78},"3.2. Using Ansible to revoke SSL certificates for IdM hosts, services and users","using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible","#using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible",{"title":80,"visible":15,"weight":28,"urlFragment":69,"anchor":81,"singlePageAnchor":81,"docTitle":19,"url":82},"3.3. Using Ansible to restore SSL certificates for IdM users, hosts, and services","using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible","#using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible",{"title":84,"visible":15,"weight":46,"urlFragment":69,"anchor":85,"singlePageAnchor":85,"docTitle":19,"url":86},"3.4. Using Ansible to retrieve SSL certificates for IdM users, hosts, and services","using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible","#using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible","#managing-idm-certificates-using-ansible_managing-certificates-in-idm",{"title":89,"visible":15,"weight":90,"urlFragment":91,"anchor":18,"singlePageAnchor":91,"sections":92,"docTitle":19,"url":113},"4. Managing externally signed certificates for IdM users, hosts, and services",6,"managing-externally-signed-certificates-for-idm-users-hosts-and-services_managing-certificates-in-idm",[93,97,101,105,109],{"title":94,"visible":15,"weight":16,"urlFragment":91,"anchor":95,"singlePageAnchor":95,"docTitle":19,"url":96},"4.1. Adding a certificate issued by an external CA to an IdM user, host, or service by using the IdM CLI","adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services","#adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services",{"title":98,"visible":15,"weight":23,"urlFragment":91,"anchor":99,"singlePageAnchor":99,"docTitle":19,"url":100},"4.2. Adding a certificate issued by an external CA to an IdM user, host, or service by using the IdM Web UI","adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services","#adding-a-certificate-issued-by-an-external-ca-to-an-idm-user-host-or-service-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services",{"title":102,"visible":15,"weight":28,"urlFragment":91,"anchor":103,"singlePageAnchor":103,"docTitle":19,"url":104},"4.3. Removing a certificate issued by an external CA from an IdM user, host, or service account by using the IdM CLI","removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services","#removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-cli_managing-externally-signed-certificates-for-idm-users-hosts-and-services",{"title":106,"visible":15,"weight":46,"urlFragment":91,"anchor":107,"singlePageAnchor":107,"docTitle":19,"url":108},"4.4. Removing a certificate issued by an external CA from an IdM user, host, or service account by using the IdM Web UI","removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services","#removing-a-certificate-issued-by-an-external-ca-from-an-idm-user-host-or-service-account-by-using-the-idm-web-ui_managing-externally-signed-certificates-for-idm-users-hosts-and-services",{"title":110,"visible":15,"weight":68,"urlFragment":91,"anchor":111,"singlePageAnchor":111,"docTitle":19,"url":112},"4.5. Additional resources","additional_resources_2","#additional_resources_2","#managing-externally-signed-certificates-for-idm-users-hosts-and-services_managing-certificates-in-idm",{"title":115,"visible":15,"weight":116,"urlFragment":117,"anchor":18,"singlePageAnchor":117,"sections":118,"docTitle":19,"url":157},"5. Converting certificate formats to work with IdM",7,"convert-cert-formats-idm_managing-certificates-in-idm",[119,123,140,153],{"title":120,"visible":15,"weight":16,"urlFragment":117,"anchor":121,"singlePageAnchor":121,"docTitle":19,"url":122},"5.1. Certificate formats and encodings in IdM","cert-types-idm_convert-cert-formats-idm","#cert-types-idm_convert-cert-formats-idm",{"title":124,"visible":15,"weight":23,"urlFragment":117,"anchor":125,"singlePageAnchor":125,"sections":126,"docTitle":19,"url":139},"5.2. Converting an external certificate to load into an IdM user account","assembly_converting-an-external-certificate-to-load-into-an-idm-user-account_convert-cert-formats-idm",[127,131,135],{"title":128,"visible":15,"weight":16,"urlFragment":117,"anchor":129,"singlePageAnchor":129,"docTitle":19,"url":130},"5.2.1. Prerequisites","prerequisites","#prerequisites",{"title":132,"visible":15,"weight":23,"urlFragment":117,"anchor":133,"singlePageAnchor":133,"docTitle":19,"url":134},"5.2.2. Converting an external certificate in the IdM CLI and loading it into an IdM user account","proc_converting-an-external-certificate-in-the-idm-cli-and-loading-it-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account","#proc_converting-an-external-certificate-in-the-idm-cli-and-loading-it-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account",{"title":136,"visible":15,"weight":28,"urlFragment":117,"anchor":137,"singlePageAnchor":137,"docTitle":19,"url":138},"5.2.3. Converting an external certificate in the IdM web UI for loading into an IdM user account","proc_converting-an-external-certificate-in-the-idm-web-ui-for-loading-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account","#proc_converting-an-external-certificate-in-the-idm-web-ui-for-loading-into-an-idm-user-account_assembly_converting-an-external-certificate-to-load-into-an-idm-user-account","#assembly_converting-an-external-certificate-to-load-into-an-idm-user-account_convert-cert-formats-idm",{"title":141,"visible":15,"weight":28,"urlFragment":117,"anchor":142,"singlePageAnchor":142,"sections":143,"docTitle":19,"url":152},"5.3. Preparing to load a certificate into the browser","assembly_preparing-to-load-a-certificate-into-the-browser_convert-cert-formats-idm",[144,148],{"title":145,"visible":15,"weight":16,"urlFragment":117,"anchor":146,"singlePageAnchor":146,"docTitle":19,"url":147},"5.3.1. Exporting a certificate and private key from an NSS database into a PKCS #12 file","proc_exporting-a-certificate-and-private-key-from-an-nss-database-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser","#proc_exporting-a-certificate-and-private-key-from-an-nss-database-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser",{"title":149,"visible":15,"weight":23,"urlFragment":117,"anchor":150,"singlePageAnchor":150,"docTitle":19,"url":151},"5.3.2. Combining certificate and private key PEM files into a PKCS #12 file","proc_combining-certificate-and-private-key-pem-files-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser","#proc_combining-certificate-and-private-key-pem-files-into-a-pkcs-12-file_assembly_preparing-to-load-a-certificate-into-the-browser","#assembly_preparing-to-load-a-certificate-into-the-browser_convert-cert-formats-idm",{"title":154,"visible":15,"weight":46,"urlFragment":117,"anchor":155,"singlePageAnchor":155,"docTitle":19,"url":156},"5.4. Certificate-related commands and formats in IdM","other-cert-commands_convert-cert-formats-idm","#other-cert-commands_convert-cert-formats-idm","#convert-cert-formats-idm_managing-certificates-in-idm",{"title":159,"visible":15,"weight":160,"urlFragment":161,"anchor":18,"singlePageAnchor":161,"sections":162,"docTitle":19,"url":191},"6. Creating and managing certificate profiles in Identity Management",8,"creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm",[163,167,171,175,179,183,187],{"title":164,"visible":15,"weight":16,"urlFragment":161,"anchor":165,"singlePageAnchor":165,"docTitle":19,"url":166},"6.1. What is a certificate profile?","what-is-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management","#what-is-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management",{"title":168,"visible":15,"weight":23,"urlFragment":161,"anchor":169,"singlePageAnchor":169,"docTitle":19,"url":170},"6.2. Creating a certificate profile","creating-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management","#creating-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management",{"title":172,"visible":15,"weight":28,"urlFragment":161,"anchor":173,"singlePageAnchor":173,"docTitle":19,"url":174},"6.3. What is a CA access control list?","what-is-a-ca-access-control-list_creating-and-managing-certificate-profiles-in-identity-management","#what-is-a-ca-access-control-list_creating-and-managing-certificate-profiles-in-identity-management",{"title":176,"visible":15,"weight":46,"urlFragment":161,"anchor":177,"singlePageAnchor":177,"docTitle":19,"url":178},"6.4. Defining a CA ACL to control access to certificate profiles","defining-a-ca-acl-to-control-access-to-certificate-profiles_creating-and-managing-certificate-profiles-in-identity-management","#defining-a-ca-acl-to-control-access-to-certificate-profiles_creating-and-managing-certificate-profiles-in-identity-management",{"title":180,"visible":15,"weight":68,"urlFragment":161,"anchor":181,"singlePageAnchor":181,"docTitle":19,"url":182},"6.5. Using certificate profiles and CA ACLs to issue certificates","using-certificate-profiles-and-ca-acls-to-issue-certificates_creating-and-managing-certificate-profiles-in-identity-management","#using-certificate-profiles-and-ca-acls-to-issue-certificates_creating-and-managing-certificate-profiles-in-identity-management",{"title":184,"visible":15,"weight":90,"urlFragment":161,"anchor":185,"singlePageAnchor":185,"docTitle":19,"url":186},"6.6. Modifying a certificate profile","modifying-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management","#modifying-a-certificate-profile_creating-and-managing-certificate-profiles-in-identity-management",{"title":188,"visible":15,"weight":116,"urlFragment":161,"anchor":189,"singlePageAnchor":189,"docTitle":19,"url":190},"6.7. Certificate profile configuration parameters","certificate-profile-configuration-parameters_creating-and-managing-certificate-profiles-in-identity-management","#certificate-profile-configuration-parameters_creating-and-managing-certificate-profiles-in-identity-management","#creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm",{"title":193,"visible":15,"weight":194,"urlFragment":195,"anchor":18,"singlePageAnchor":195,"sections":196,"docTitle":19,"url":243},"7. Managing the validity of certificates in IdM",9,"managing-the-validity-of-certificates-in-idm_managing-certificates-in-idm",[197,201,205,209,213,230],{"title":198,"visible":15,"weight":16,"urlFragment":195,"anchor":199,"singlePageAnchor":199,"docTitle":19,"url":200},"7.1. Managing the validity of an existing certificate that was issued by IdM CA","proc_managing-the-validity-of-an-existing-certificate-that-was-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm","#proc_managing-the-validity-of-an-existing-certificate-that-was-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm",{"title":202,"visible":15,"weight":23,"urlFragment":195,"anchor":203,"singlePageAnchor":203,"docTitle":19,"url":204},"7.2. Managing the validity of future certificates issued by IdM CA","proc_managing-the-validity-of-future-certificates-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm","#proc_managing-the-validity-of-future-certificates-issued-by-idm-ca_managing-the-validity-of-certificates-in-idm",{"title":206,"visible":15,"weight":28,"urlFragment":195,"anchor":207,"singlePageAnchor":207,"docTitle":19,"url":208},"7.3. Viewing the expiry date of a certificate in IdM WebUI","viewing-the-expiry-date-of-a-certificate-in-IdM-WebUI_managing-the-validity-of-certificates-in-idm","#viewing-the-expiry-date-of-a-certificate-in-IdM-WebUI_managing-the-validity-of-certificates-in-idm",{"title":210,"visible":15,"weight":46,"urlFragment":195,"anchor":211,"singlePageAnchor":211,"docTitle":19,"url":212},"7.4. Viewing the expiry date of a certificate in the CLI","viewing-the-expiry-date-of-a-certificate-in-the-CLI_managing-the-validity-of-certificates-in-idm","#viewing-the-expiry-date-of-a-certificate-in-the-CLI_managing-the-validity-of-certificates-in-idm",{"title":214,"visible":15,"weight":68,"urlFragment":195,"anchor":215,"singlePageAnchor":215,"sections":216,"docTitle":19,"url":229},"7.5. Revoking certificates with the integrated IdM CAs","revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm",[217,221,225],{"title":218,"visible":15,"weight":16,"urlFragment":195,"anchor":219,"singlePageAnchor":219,"docTitle":19,"url":220},"7.5.1. Certificate revocation reasons","certificate-revocation-reasons_revoking-certificates","#certificate-revocation-reasons_revoking-certificates",{"title":222,"visible":15,"weight":23,"urlFragment":195,"anchor":223,"singlePageAnchor":223,"docTitle":19,"url":224},"7.5.2. Revoking certificates with the integrated IdM CAs using IdM WebUI","revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_revoking-certificates","#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_revoking-certificates",{"title":226,"visible":15,"weight":28,"urlFragment":195,"anchor":227,"singlePageAnchor":227,"docTitle":19,"url":228},"7.5.3. Revoking certificates with the integrated IdM CAs using IdM CLI","revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_revoking-certificates","#revoking-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_revoking-certificates","#revoking-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm",{"title":231,"visible":15,"weight":90,"urlFragment":195,"anchor":232,"singlePageAnchor":232,"sections":233,"docTitle":19,"url":242},"7.6. Restoring certificates with the integrated IdM CAs","restoring-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm",[234,238],{"title":235,"visible":15,"weight":16,"urlFragment":195,"anchor":236,"singlePageAnchor":236,"docTitle":19,"url":237},"7.6.1. Restoring certificates with the integrated IdM CAs using IdM WebUI","restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates","#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-WebUI_restoring-certificates",{"title":239,"visible":15,"weight":23,"urlFragment":195,"anchor":240,"singlePageAnchor":240,"docTitle":19,"url":241},"7.6.2. Restoring certificates with the integrated IdM CAs using IdM CLI","restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_restoring-certificates","#restoring-certificates-with-the-integrated-IdM-CAs-using-IdM-CLI_restoring-certificates","#restoring-certificates-with-the-integrated-IdM-CAs_managing-the-validity-of-certificates-in-idm","#managing-the-validity-of-certificates-in-idm_managing-certificates-in-idm",{"title":245,"visible":15,"weight":246,"urlFragment":247,"anchor":18,"singlePageAnchor":247,"sections":248,"docTitle":19,"url":294},"8. Configuring Identity Management for smart card authentication",10,"configuring-idm-for-smart-card-auth_managing-certificates-in-idm",[249,253,257,261,265,269,273,277,281,285,289],{"title":250,"visible":15,"weight":16,"urlFragment":247,"anchor":251,"singlePageAnchor":251,"docTitle":19,"url":252},"8.1. Configuring the IdM server for smart card authentication","conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth","#conf-idm-server-for-smart-card-auth_configuring-idm-for-smart-card-auth",{"title":254,"visible":15,"weight":23,"urlFragment":247,"anchor":255,"singlePageAnchor":255,"docTitle":19,"url":256},"8.2. Using Ansible to configure the IdM server for smart card authentication","proc_using-ansible-to-configure-the-idm-server-for-smart-card-authentication_configuring-idm-for-smart-card-auth","#proc_using-ansible-to-configure-the-idm-server-for-smart-card-authentication_configuring-idm-for-smart-card-auth",{"title":258,"visible":15,"weight":28,"urlFragment":247,"anchor":259,"singlePageAnchor":259,"docTitle":19,"url":260},"8.3. Configuring the IdM client for smart card authentication","conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth","#conf-idm-client-for-smart-card-auth_configuring-idm-for-smart-card-auth",{"title":262,"visible":15,"weight":46,"urlFragment":247,"anchor":263,"singlePageAnchor":263,"docTitle":19,"url":264},"8.4. Using Ansible to configure IdM clients for smart card authentication","proc_using-ansible-to-configure-idm-clients-for-smart-card-authentication_configuring-idm-for-smart-card-auth","#proc_using-ansible-to-configure-idm-clients-for-smart-card-authentication_configuring-idm-for-smart-card-auth",{"title":266,"visible":15,"weight":68,"urlFragment":247,"anchor":267,"singlePageAnchor":267,"docTitle":19,"url":268},"8.5. Adding a certificate to a user entry in the IdM Web UI","proc-add-cert-idm-user-webui_configuring-idm-for-smart-card-auth","#proc-add-cert-idm-user-webui_configuring-idm-for-smart-card-auth",{"title":270,"visible":15,"weight":90,"urlFragment":247,"anchor":271,"singlePageAnchor":271,"docTitle":19,"url":272},"8.6. Adding a certificate to a user entry in the IdM CLI","proc-add-cert-idm-user-cli_configuring-idm-for-smart-card-auth","#proc-add-cert-idm-user-cli_configuring-idm-for-smart-card-auth",{"title":274,"visible":15,"weight":116,"urlFragment":247,"anchor":275,"singlePageAnchor":275,"docTitle":19,"url":276},"8.7. Installing tools for managing and using smart cards","installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth","#installing-tools-for-managing-and-using-smart-cards_configuring-idm-for-smart-card-auth",{"title":278,"visible":15,"weight":160,"urlFragment":247,"anchor":279,"singlePageAnchor":279,"docTitle":19,"url":280},"8.8. Preparing your smart card and uploading your certificates and keys to your smart card","storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth","#storing-a-certificate-on-the-smart-card_configuring-idm-for-smart-card-auth",{"title":282,"visible":15,"weight":194,"urlFragment":247,"anchor":283,"singlePageAnchor":283,"docTitle":19,"url":284},"8.9. Logging in to IdM with smart cards","logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth","#logging-in-to-idm-with-smart-cards_configuring-idm-for-smart-card-auth",{"title":286,"visible":15,"weight":246,"urlFragment":247,"anchor":287,"singlePageAnchor":287,"docTitle":19,"url":288},"8.10. Logging in to GDM using smart card authentication on an IdM client","configuring-gdm-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth","#configuring-gdm-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth",{"title":290,"visible":15,"weight":291,"urlFragment":247,"anchor":292,"singlePageAnchor":292,"docTitle":19,"url":293},"8.11. Using smart card authentication with the su command",11,"configuring-su-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth","#configuring-su-access-using-smart-card-authentication_configuring-idm-for-smart-card-auth","#configuring-idm-for-smart-card-auth_managing-certificates-in-idm",{"title":296,"visible":15,"weight":291,"urlFragment":297,"anchor":18,"singlePageAnchor":297,"sections":298,"docTitle":19,"url":331},"9. Configuring certificates issued by ADCS for smart card authentication in IdM","configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-certificates-in-idm",[299,303,307,311,315,319,323,327],{"title":300,"visible":15,"weight":16,"urlFragment":297,"anchor":301,"singlePageAnchor":301,"docTitle":19,"url":302},"9.1. Windows Server settings required for trust configuration and certificate usage","windows-server-settings-required-for-trust-configuration-and-certificate-usage_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm","#windows-server-settings-required-for-trust-configuration-and-certificate-usage_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm",{"title":304,"visible":15,"weight":23,"urlFragment":297,"anchor":305,"singlePageAnchor":305,"docTitle":19,"url":306},"9.2. Copying certificates from Active Directory using sftp","copying-certificates-from-active-directory-using-sftp_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm","#copying-certificates-from-active-directory-using-sftp_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm",{"title":308,"visible":15,"weight":28,"urlFragment":297,"anchor":309,"singlePageAnchor":309,"docTitle":19,"url":310},"9.3. Configuring the IdM server and clients for smart card authentication using ADCS certificates","configuring-the-idm-server-and-clients-for-smart-card-authentication-using-adcs-certificates_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm","#configuring-the-idm-server-and-clients-for-smart-card-authentication-using-adcs-certificates_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm",{"title":312,"visible":15,"weight":46,"urlFragment":297,"anchor":313,"singlePageAnchor":313,"docTitle":19,"url":314},"9.4. Converting the PFX file","converting-the-pfx-file_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm","#converting-the-pfx-file_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm",{"title":316,"visible":15,"weight":68,"urlFragment":297,"anchor":317,"singlePageAnchor":317,"docTitle":19,"url":318},"9.5. Installing tools for managing and using smart cards","installing-tools-for-managing-and-using-smart-cards_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm","#installing-tools-for-managing-and-using-smart-cards_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm",{"title":320,"visible":15,"weight":90,"urlFragment":297,"anchor":321,"singlePageAnchor":321,"docTitle":19,"url":322},"9.6. Preparing your smart card and uploading your certificates and keys to your smart card","storing-a-certificate-on-the-smart-card_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm","#storing-a-certificate-on-the-smart-card_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm",{"title":324,"visible":15,"weight":116,"urlFragment":297,"anchor":325,"singlePageAnchor":325,"docTitle":19,"url":326},"9.7. Configuring timeouts in sssd.conf","configuring-timeouts-in-sssd-conf_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm","#configuring-timeouts-in-sssd-conf_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm",{"title":328,"visible":15,"weight":160,"urlFragment":297,"anchor":329,"singlePageAnchor":329,"docTitle":19,"url":330},"9.8. Creating certificate mapping rules for smart card authentication","certificate-mapping-rules-for-smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm","#certificate-mapping-rules-for-smart-card-authentication_configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm","#configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-certificates-in-idm",{"title":333,"visible":15,"weight":334,"urlFragment":335,"anchor":18,"singlePageAnchor":335,"sections":336,"docTitle":19,"url":433},"10. Configuring certificate mapping rules in Identity Management",12,"conf-certmap-idm_managing-certificates-in-idm",[337,341,345,349,370,374,387,404,425,429],{"title":338,"visible":15,"weight":16,"urlFragment":335,"anchor":339,"singlePageAnchor":339,"docTitle":19,"url":340},"10.1. Certificate mapping rules for configuring authentication","con-idm-certmapdata_conf-certmap-idm","#con-idm-certmapdata_conf-certmap-idm",{"title":342,"visible":15,"weight":23,"urlFragment":335,"anchor":343,"singlePageAnchor":343,"docTitle":19,"url":344},"10.2. Components of an identity mapping rule in IdM","sc-id-mapping_conf-certmap-idm","#sc-id-mapping_conf-certmap-idm",{"title":346,"visible":15,"weight":28,"urlFragment":335,"anchor":347,"singlePageAnchor":347,"docTitle":19,"url":348},"10.3. Obtaining data from a certificate for use in a matching rule","sc-id-issuer-obtain-example_conf-certmap-idm","#sc-id-issuer-obtain-example_conf-certmap-idm",{"title":350,"visible":15,"weight":46,"urlFragment":335,"anchor":351,"singlePageAnchor":351,"sections":352,"docTitle":19,"url":369},"10.4. Configuring certificate mapping for users stored in IdM","conf-certmap-for-users-in-idm_conf-certmap-idm",[353,357,361,365],{"title":354,"visible":15,"weight":16,"urlFragment":335,"anchor":355,"singlePageAnchor":355,"docTitle":19,"url":356},"10.4.1. Adding a certificate mapping rule in the IdM web UI","proc-add-maprule-webui_conf-certmap-for-users-in-idm","#proc-add-maprule-webui_conf-certmap-for-users-in-idm",{"title":358,"visible":15,"weight":23,"urlFragment":335,"anchor":359,"singlePageAnchor":359,"docTitle":19,"url":360},"10.4.2. Adding a certificate mapping rule in the IdM CLI","proc-add-maprule-cli_conf-certmap-for-users-in-idm","#proc-add-maprule-cli_conf-certmap-for-users-in-idm",{"title":362,"visible":15,"weight":28,"urlFragment":335,"anchor":363,"singlePageAnchor":363,"docTitle":19,"url":364},"10.4.3. Adding certificate mapping data to a user entry in the IdM web UI","proc-add-certmapdata-to-user-webui_conf-certmap-for-users-in-idm","#proc-add-certmapdata-to-user-webui_conf-certmap-for-users-in-idm",{"title":366,"visible":15,"weight":46,"urlFragment":335,"anchor":367,"singlePageAnchor":367,"docTitle":19,"url":368},"10.4.4. Adding certificate mapping data to a user entry in the IdM CLI","proc-add-certmapdata-to-user-cli_conf-certmap-for-users-in-idm","#proc-add-certmapdata-to-user-cli_conf-certmap-for-users-in-idm","#conf-certmap-for-users-in-idm_conf-certmap-idm",{"title":371,"visible":15,"weight":68,"urlFragment":335,"anchor":372,"singlePageAnchor":372,"docTitle":19,"url":373},"10.5. Certificate mapping rules for trusts with Active Directory domains","con-idm-ad-certmapdata_conf-certmap-idm","#con-idm-ad-certmapdata_conf-certmap-idm",{"title":375,"visible":15,"weight":90,"urlFragment":335,"anchor":376,"singlePageAnchor":376,"sections":377,"docTitle":19,"url":386},"10.6. Configuring certificate mapping for users whose AD user entry contains the whole certificate","conf-certmap-for-ad-certs_conf-certmap-idm",[378,382],{"title":379,"visible":15,"weight":16,"urlFragment":335,"anchor":380,"singlePageAnchor":380,"docTitle":19,"url":381},"10.6.1. Adding a certificate mapping rule in the IdM web UI","proc-add-maprule-webui-ad-cert_conf-certmap-for-ad-certs","#proc-add-maprule-webui-ad-cert_conf-certmap-for-ad-certs",{"title":383,"visible":15,"weight":23,"urlFragment":335,"anchor":384,"singlePageAnchor":384,"docTitle":19,"url":385},"10.6.2. Adding a certificate mapping rule in the IdM CLI","proc-add-maprule-cli-ad-cert_conf-certmap-for-ad-certs","#proc-add-maprule-cli-ad-cert_conf-certmap-for-ad-certs","#conf-certmap-for-ad-certs_conf-certmap-idm",{"title":388,"visible":15,"weight":116,"urlFragment":335,"anchor":389,"singlePageAnchor":389,"sections":390,"docTitle":19,"url":403},"10.7. Configuring certificate mapping if AD is configured to map user certificates to user accounts","conf-certmap-for-ad-map_conf-certmap-idm",[391,395,399],{"title":392,"visible":15,"weight":16,"urlFragment":335,"anchor":393,"singlePageAnchor":393,"docTitle":19,"url":394},"10.7.1. Adding a certificate mapping rule in the IdM web UI","proc-add-ad-maprule-webui_conf-certmap-for-ad-map","#proc-add-ad-maprule-webui_conf-certmap-for-ad-map",{"title":396,"visible":15,"weight":23,"urlFragment":335,"anchor":397,"singlePageAnchor":397,"docTitle":19,"url":398},"10.7.2. Adding a certificate mapping rule in the IdM CLI","proc-add-ad-maprule-cli_conf-certmap-for-ad-map","#proc-add-ad-maprule-cli_conf-certmap-for-ad-map",{"title":400,"visible":15,"weight":28,"urlFragment":335,"anchor":401,"singlePageAnchor":401,"docTitle":19,"url":402},"10.7.3. Checking certificate mapping data on the AD side","check-if-ad-maprule-exists_conf-certmap-for-ad-map","#check-if-ad-maprule-exists_conf-certmap-for-ad-map","#conf-certmap-for-ad-map_conf-certmap-idm",{"title":405,"visible":15,"weight":160,"urlFragment":335,"anchor":406,"singlePageAnchor":406,"sections":407,"docTitle":19,"url":424},"10.8. Configuring certificate mapping if AD user entry contains no certificate or mapping data","conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map",[408,412,416,420],{"title":409,"visible":15,"weight":16,"urlFragment":335,"anchor":410,"singlePageAnchor":410,"docTitle":19,"url":411},"10.8.1. Adding a certificate mapping rule in the IdM web UI","proc-add-certmaprule-ad-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map","#proc-add-certmaprule-ad-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map",{"title":413,"visible":15,"weight":23,"urlFragment":335,"anchor":414,"singlePageAnchor":414,"docTitle":19,"url":415},"10.8.2. Adding a certificate mapping rule in the IdM CLI","proc-add-certmaprule-ad-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map","#proc-add-certmaprule-ad-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map",{"title":417,"visible":15,"weight":28,"urlFragment":335,"anchor":418,"singlePageAnchor":418,"docTitle":19,"url":419},"10.8.3. Adding a certificate to an AD user’s ID override in the IdM web UI","proc-add-certmapdata-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map","#proc-add-certmapdata-no-cert-no-map-webui_conf-certmap-ad-no-cert-no-map",{"title":421,"visible":15,"weight":46,"urlFragment":335,"anchor":422,"singlePageAnchor":422,"docTitle":19,"url":423},"10.8.4. Adding a certificate to an AD user’s ID override in the IdM CLI","proc-add-certmapdata-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map","#proc-add-certmapdata-no-cert-no-map-cli_conf-certmap-ad-no-cert-no-map","#conf-certmap-ad-no-cert-no-map_conf-certmap-for-ad-map",{"title":426,"visible":15,"weight":194,"urlFragment":335,"anchor":427,"singlePageAnchor":427,"docTitle":19,"url":428},"10.9. Combining several identity mapping rules into one","sc-cert-mapping-rule-examples_conf-certmap-for-ad-map","#sc-cert-mapping-rule-examples_conf-certmap-for-ad-map",{"title":430,"visible":15,"weight":246,"urlFragment":335,"anchor":431,"singlePageAnchor":431,"docTitle":19,"url":432},"10.10. Additional resources","additional_resources_3","#additional_resources_3","#conf-certmap-idm_managing-certificates-in-idm",{"title":435,"visible":15,"weight":436,"urlFragment":437,"anchor":18,"singlePageAnchor":437,"sections":438,"docTitle":19,"url":463},"11. Configuring authentication with a certificate stored on the desktop of an IdM client",13,"dc-web-ui-auth_managing-certificates-in-idm",[439,443,447,451,455,459],{"title":440,"visible":15,"weight":16,"urlFragment":437,"anchor":441,"singlePageAnchor":441,"docTitle":19,"url":442},"11.1. Configuring the Identity Management Server for Certificate Authentication in the Web UI","cert-idm-users-auth-preparing-the-server_dc-web-ui-auth","#cert-idm-users-auth-preparing-the-server_dc-web-ui-auth",{"title":444,"visible":15,"weight":23,"urlFragment":437,"anchor":445,"singlePageAnchor":445,"docTitle":19,"url":446},"11.2. Requesting a new user certificate and exporting it to the client","requesting-and-exporting-a-user-certificate_dc-web-ui-auth","#requesting-and-exporting-a-user-certificate_dc-web-ui-auth",{"title":448,"visible":15,"weight":28,"urlFragment":437,"anchor":449,"singlePageAnchor":449,"docTitle":19,"url":450},"11.3. Making sure the certificate and user are linked together","proc_making-sure-the-certificate-and-user-are-linked-together_dc-web-ui-auth","#proc_making-sure-the-certificate-and-user-are-linked-together_dc-web-ui-auth",{"title":452,"visible":15,"weight":46,"urlFragment":437,"anchor":453,"singlePageAnchor":453,"docTitle":19,"url":454},"11.4. Configuring a browser to enable certificate authentication","configuring-browser-for-cert-auth_dc-web-ui-auth","#configuring-browser-for-cert-auth_dc-web-ui-auth",{"title":456,"visible":15,"weight":68,"urlFragment":437,"anchor":457,"singlePageAnchor":457,"docTitle":19,"url":458},"11.5. Authenticating to the Identity Management Web UI with a Certificate as an Identity Management User","cert-idm-users-auth-procedure_dc-web-ui-auth","#cert-idm-users-auth-procedure_dc-web-ui-auth",{"title":460,"visible":15,"weight":90,"urlFragment":437,"anchor":461,"singlePageAnchor":461,"docTitle":19,"url":462},"11.6. Configuring an IdM client to enable authenticating to the CLI using a certificate","authenticating-idm-cli-user-certificate_dc-web-ui-auth","#authenticating-idm-cli-user-certificate_dc-web-ui-auth","#dc-web-ui-auth_managing-certificates-in-idm",{"title":465,"visible":15,"weight":466,"urlFragment":467,"anchor":18,"singlePageAnchor":467,"sections":468,"docTitle":19,"url":477},"12. Using IdM CA renewal server",14,"ipa-ca-renewal_managing-certificates-in-idm",[469,473],{"title":470,"visible":15,"weight":16,"urlFragment":467,"anchor":471,"singlePageAnchor":471,"docTitle":19,"url":472},"12.1. Explanation of IdM CA renewal server","ca-renewal-server_ipa-ca-renewal","#ca-renewal-server_ipa-ca-renewal",{"title":474,"visible":15,"weight":23,"urlFragment":467,"anchor":475,"singlePageAnchor":475,"docTitle":19,"url":476},"12.2. Changing and resetting IdM CA renewal server","changing-ca-renewal_ipa-ca-renewal","#changing-ca-renewal_ipa-ca-renewal","#ipa-ca-renewal_managing-certificates-in-idm",{"title":479,"visible":15,"weight":480,"urlFragment":481,"anchor":18,"singlePageAnchor":481,"sections":482,"docTitle":19,"url":495},"13. Managing externally-signed CA certificates",15,"managing-externally-signed-ca-certificates_managing-certificates-in-idm",[483,487,491],{"title":484,"visible":15,"weight":16,"urlFragment":481,"anchor":485,"singlePageAnchor":485,"docTitle":19,"url":486},"13.1. Switching from an externally-signed to a self-signed CA in IdM","switch-from-externally-to-self-signed-ca_managing-externally-signed-ca-certificates","#switch-from-externally-to-self-signed-ca_managing-externally-signed-ca-certificates",{"title":488,"visible":15,"weight":23,"urlFragment":481,"anchor":489,"singlePageAnchor":489,"docTitle":19,"url":490},"13.2. Switching from a self-signed to an externally-signed CA in IdM","switching-from-a-self-signed-to-an-externally-signed-ca-in-idm_managing-externally-signed-ca-certificates","#switching-from-a-self-signed-to-an-externally-signed-ca-in-idm_managing-externally-signed-ca-certificates",{"title":492,"visible":15,"weight":28,"urlFragment":481,"anchor":493,"singlePageAnchor":493,"docTitle":19,"url":494},"13.3. Renewing the IdM CA renewal server certificate using an external CA","renew-with-externally-signed-CA_managing-externally-signed-ca-certificates","#renew-with-externally-signed-CA_managing-externally-signed-ca-certificates","#managing-externally-signed-ca-certificates_managing-certificates-in-idm",{"title":497,"visible":15,"weight":498,"urlFragment":499,"anchor":18,"singlePageAnchor":499,"sections":500,"docTitle":19,"url":509},"14. Renewing expired system certificates when IdM is offline",16,"renewing-expired-system-certificates-when-idm-is-offline_managing-certificates-in-idm",[501,505],{"title":502,"visible":15,"weight":16,"urlFragment":499,"anchor":503,"singlePageAnchor":503,"docTitle":19,"url":504},"14.1. Renewing expired system certificates on a CA renewal server","renewing-expired-system-certificates-on-a-ca_renewing-expired-system-certificates-when-idm-is-offline","#renewing-expired-system-certificates-on-a-ca_renewing-expired-system-certificates-when-idm-is-offline",{"title":506,"visible":15,"weight":23,"urlFragment":499,"anchor":507,"singlePageAnchor":507,"docTitle":19,"url":508},"14.2. Verifying other IdM servers in the IdM domain after renewal","verifying-other-idm-servers-in-the-domain-after-renewal_renewing-expired-system-certificates-when-idm-is-offline","#verifying-other-idm-servers-in-the-domain-after-renewal_renewing-expired-system-certificates-when-idm-is-offline","#renewing-expired-system-certificates-when-idm-is-offline_managing-certificates-in-idm",{"title":511,"visible":15,"weight":512,"urlFragment":513,"anchor":18,"singlePageAnchor":513,"docTitle":19,"url":514},"15. Replacing the web server and LDAP server certificates if they have not yet expired on an IdM replica",17,"proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-not-yet-expired-on-an-idm-replica_managing-certificates-in-idm","#proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-not-yet-expired-on-an-idm-replica_managing-certificates-in-idm",{"title":516,"visible":15,"weight":517,"urlFragment":518,"anchor":18,"singlePageAnchor":518,"docTitle":19,"url":519},"16. Replacing the web server and LDAP server certificates if they have expired in the whole IdM deployment",18,"proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-expired-in-the-whole-idm-deployment_managing-certificates-in-idm","#proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-expired-in-the-whole-idm-deployment_managing-certificates-in-idm",{"title":521,"visible":15,"weight":522,"urlFragment":523,"anchor":18,"singlePageAnchor":523,"sections":524,"docTitle":19,"url":537},"17. Generating CRL on the IdM CA server",19,"generating-crl-on-the-idm-ca-server_managing-certificates-in-idm",[525,529,533],{"title":526,"visible":15,"weight":16,"urlFragment":523,"anchor":527,"singlePageAnchor":527,"docTitle":19,"url":528},"17.1. Stopping CRL generation on an IdM server","stopping-crl-generation-on-idm-server_generating-crl-on-the-idm-ca-server","#stopping-crl-generation-on-idm-server_generating-crl-on-the-idm-ca-server",{"title":530,"visible":15,"weight":23,"urlFragment":523,"anchor":531,"singlePageAnchor":531,"docTitle":19,"url":532},"17.2. Starting CRL generation on an IdM replica server","starting-crl-generation-on-idm-replica-server_generating-crl-on-the-idm-ca-server","#starting-crl-generation-on-idm-replica-server_generating-crl-on-the-idm-ca-server",{"title":534,"visible":15,"weight":28,"urlFragment":523,"anchor":535,"singlePageAnchor":535,"docTitle":19,"url":536},"17.3. Changing the CRL update interval","changing-the-crl-update-interval_generating-crl-on-the-idm-ca-server","#changing-the-crl-update-interval_generating-crl-on-the-idm-ca-server","#generating-crl-on-the-idm-ca-server_managing-certificates-in-idm",{"title":539,"visible":15,"weight":540,"urlFragment":541,"anchor":18,"singlePageAnchor":541,"docTitle":19,"url":542},"18. Decommissioning a server that performs the CA renewal server and CRL publisher roles",20,"proc_decommissioning-a-server-that-performs-the-ca-renewal-server-and-crl-publisher-roles_managing-certificates-in-idm","#proc_decommissioning-a-server-that-performs-the-ca-renewal-server-and-crl-publisher-roles_managing-certificates-in-idm",{"title":544,"visible":15,"weight":545,"urlFragment":546,"anchor":18,"singlePageAnchor":546,"sections":547,"docTitle":19,"url":593},"19. Obtaining an IdM certificate for a service using certmonger",21,"using-certmonger_managing-certificates-in-idm",[548,552,556,560,564,568,572,576],{"title":549,"visible":15,"weight":16,"urlFragment":546,"anchor":550,"singlePageAnchor":550,"docTitle":19,"url":551},"19.1. Certmonger overview","certmonger_certmonger-for-issuing-renewing-service-certs","#certmonger_certmonger-for-issuing-renewing-service-certs",{"title":553,"visible":15,"weight":23,"urlFragment":546,"anchor":554,"singlePageAnchor":554,"docTitle":19,"url":555},"19.2. Obtaining an IdM certificate for a service using certmonger","obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs","#obtain-service-cert-with-certmonger_certmonger-for-issuing-renewing-service-certs",{"title":557,"visible":15,"weight":28,"urlFragment":546,"anchor":558,"singlePageAnchor":558,"docTitle":19,"url":559},"19.3. Communication flow for certmonger requesting a service certificate","communication-flow-certmonger-requesting-service-cert_certmonger-for-issuing-renewing-service-certs","#communication-flow-certmonger-requesting-service-cert_certmonger-for-issuing-renewing-service-certs",{"title":561,"visible":15,"weight":46,"urlFragment":546,"anchor":562,"singlePageAnchor":562,"docTitle":19,"url":563},"19.4. Viewing the details of a certificate request tracked by certmonger","viewing-cert-tracked-by-certmonger_certmonger-for-issuing-renewing-service-certs","#viewing-cert-tracked-by-certmonger_certmonger-for-issuing-renewing-service-certs",{"title":565,"visible":15,"weight":68,"urlFragment":546,"anchor":566,"singlePageAnchor":566,"docTitle":19,"url":567},"19.5. Starting and stopping certificate tracking","start-stop-cert-tracking_certmonger-for-issuing-renewing-service-certs","#start-stop-cert-tracking_certmonger-for-issuing-renewing-service-certs",{"title":569,"visible":15,"weight":90,"urlFragment":546,"anchor":570,"singlePageAnchor":570,"docTitle":19,"url":571},"19.6. Renewing a certificate manually","renew-cert_certmonger-for-issuing-renewing-service-certs","#renew-cert_certmonger-for-issuing-renewing-service-certs",{"title":573,"visible":15,"weight":116,"urlFragment":546,"anchor":574,"singlePageAnchor":574,"docTitle":19,"url":575},"19.7. Making certmonger resume tracking of IdM certificates on a CA replica","add-tracking-back-to-idm-certs_certmonger-for-issuing-renewing-service-certs","#add-tracking-back-to-idm-certs_certmonger-for-issuing-renewing-service-certs",{"title":577,"visible":15,"weight":160,"urlFragment":546,"anchor":578,"singlePageAnchor":578,"sections":579,"docTitle":19,"url":592},"19.8. Using SCEP with certmonger","assembly_using-scep-with-certmonger_certmonger-for-issuing-renewing-service-certs",[580,584,588],{"title":581,"visible":15,"weight":16,"urlFragment":546,"anchor":582,"singlePageAnchor":582,"docTitle":19,"url":583},"19.8.1. SCEP overview","con_scep-overview_assembly_using-scep-with-certmonger","#con_scep-overview_assembly_using-scep-with-certmonger",{"title":585,"visible":15,"weight":23,"urlFragment":546,"anchor":586,"singlePageAnchor":586,"docTitle":19,"url":587},"19.8.2. Requesting an IdM CA-signed certificate through SCEP","proc_requesting-an-idm-ca-signed-certificate-through-scep_assembly_using-scep-with-certmonger","#proc_requesting-an-idm-ca-signed-certificate-through-scep_assembly_using-scep-with-certmonger",{"title":589,"visible":15,"weight":28,"urlFragment":546,"anchor":590,"singlePageAnchor":590,"docTitle":19,"url":591},"19.8.3. Automatically renewing AD SCEP certificates with certmonger","proc_automatically-renewing-ad-scep-certificates-with-certmonger_assembly_using-scep-with-certmonger","#proc_automatically-renewing-ad-scep-certificates-with-certmonger_assembly_using-scep-with-certmonger","#assembly_using-scep-with-certmonger_certmonger-for-issuing-renewing-service-certs","#using-certmonger_managing-certificates-in-idm",{"title":595,"visible":15,"weight":596,"urlFragment":597,"anchor":18,"singlePageAnchor":597,"sections":598,"docTitle":19,"url":611},"20. Deploying and managing the ACME service in IdM",22,"deploying-and-managing-the-acme-service-in-idm_managing-certificates-in-idm",[599,603,607],{"title":600,"visible":15,"weight":16,"urlFragment":597,"anchor":601,"singlePageAnchor":601,"docTitle":19,"url":602},"20.1. The ACME service in IdM","the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm","#the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm",{"title":604,"visible":15,"weight":23,"urlFragment":597,"anchor":605,"singlePageAnchor":605,"docTitle":19,"url":606},"20.2. Enabling the ACME service in IdM","enabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm","#enabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm",{"title":608,"visible":15,"weight":28,"urlFragment":597,"anchor":609,"singlePageAnchor":609,"docTitle":19,"url":610},"20.3. Disabling the ACME service in IdM","disabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm","#disabling-the-acme-service-in-idm_deploying-and-managing-the-acme-service-in-idm","#deploying-and-managing-the-acme-service-in-idm_managing-certificates-in-idm",{"title":613,"visible":15,"weight":614,"urlFragment":615,"anchor":18,"singlePageAnchor":615,"sections":616,"docTitle":19,"url":633},"21. Requesting certificates by using the RHEL system role",23,"requesting-certificates-using-rhel-system-roles_managing-certificates-in-idm",[617,621,625,629],{"title":618,"visible":15,"weight":16,"urlFragment":615,"anchor":619,"singlePageAnchor":619,"docTitle":19,"url":620},"21.1. The certificate RHEL system role","the-certificate-system-role_requesting-certificates-using-rhel-system-roles","#the-certificate-system-role_requesting-certificates-using-rhel-system-roles",{"title":622,"visible":15,"weight":23,"urlFragment":615,"anchor":623,"singlePageAnchor":623,"docTitle":19,"url":624},"21.2. Requesting a new self-signed certificate by using the certificate RHEL system role","requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles","#requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles",{"title":626,"visible":15,"weight":28,"urlFragment":615,"anchor":627,"singlePageAnchor":627,"docTitle":19,"url":628},"21.3. Requesting a new certificate from IdM CA by using the certificate RHEL system role","requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles","#requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles",{"title":630,"visible":15,"weight":46,"urlFragment":615,"anchor":631,"singlePageAnchor":631,"docTitle":19,"url":632},"21.4. Specifying commands to run before or after certificate issuance by using the certificate RHEL system role","specifying-commands-to-run-before-or-after-certificate-issuance-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles","#specifying-commands-to-run-before-or-after-certificate-issuance-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles","#requesting-certificates-using-rhel-system-roles_managing-certificates-in-idm",{"title":635,"visible":15,"weight":636,"urlFragment":637,"anchor":18,"singlePageAnchor":637,"sections":638,"docTitle":19,"url":721},"22. Restricting an application to trust only a subset of certificates",24,"restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm",[639,664,668,685,689,693,697,701,705,709,713,717],{"title":640,"visible":15,"weight":16,"urlFragment":637,"anchor":641,"singlePageAnchor":641,"sections":642,"docTitle":19,"url":663},"22.1. Managing lightweight sub-CAs","creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs",[643,647,651,655,659],{"title":644,"visible":15,"weight":16,"urlFragment":637,"anchor":645,"singlePageAnchor":645,"docTitle":19,"url":646},"22.1.1. Creating a sub-CA from the IdM WebUI","creating-a-sub-CA-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs","#creating-a-sub-CA-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs",{"title":648,"visible":15,"weight":23,"urlFragment":637,"anchor":649,"singlePageAnchor":649,"docTitle":19,"url":650},"22.1.2. Deleting a sub-CA from the IdM WebUI","proc_deleting-a-sub-ca-from-the-idm-webui_restricting-an-application-to-trust-a-subset-of-certs","#proc_deleting-a-sub-ca-from-the-idm-webui_restricting-an-application-to-trust-a-subset-of-certs",{"title":652,"visible":15,"weight":28,"urlFragment":637,"anchor":653,"singlePageAnchor":653,"docTitle":19,"url":654},"22.1.3. Creating a sub-CA from the IdM CLI","creating-a-sub-CA-from-IdM-CLI_restricting-an-application-to-trust-a-subset-of-certs","#creating-a-sub-CA-from-IdM-CLI_restricting-an-application-to-trust-a-subset-of-certs",{"title":656,"visible":15,"weight":46,"urlFragment":637,"anchor":657,"singlePageAnchor":657,"docTitle":19,"url":658},"22.1.4. Disabling a sub-CA from the IdM CLI","proc_disabling-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs","#proc_disabling-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs",{"title":660,"visible":15,"weight":68,"urlFragment":637,"anchor":661,"singlePageAnchor":661,"docTitle":19,"url":662},"22.1.5. Deleting a sub-CA from the IdM CLI","proc_deleting-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs","#proc_deleting-a-sub-ca-from-the-idm-cli_restricting-an-application-to-trust-a-subset-of-certs","#creating-a-lightweight-sub-ca_restricting-an-application-to-trust-a-subset-of-certs",{"title":665,"visible":15,"weight":23,"urlFragment":637,"anchor":666,"singlePageAnchor":666,"docTitle":19,"url":667},"22.2. Downloading the sub-CA certificate from IdM WebUI","downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs","#downloading-the-sub-CA-certificate-from-IdM-WebUI_restricting-an-application-to-trust-a-subset-of-certs",{"title":669,"visible":15,"weight":28,"urlFragment":637,"anchor":670,"singlePageAnchor":670,"sections":671,"docTitle":19,"url":684},"22.3. Creating CA ACLs for web server and client authentication","creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs",[672,676,680],{"title":673,"visible":15,"weight":16,"urlFragment":637,"anchor":674,"singlePageAnchor":674,"docTitle":19,"url":675},"22.3.1. Viewing CA ACLs in IdM CLI","viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs","#viewing-CA-ACLs_in_IdM_CLI_restricting-an-application-to-trust-a-subset-of-certs",{"title":677,"visible":15,"weight":23,"urlFragment":637,"anchor":678,"singlePageAnchor":678,"docTitle":19,"url":679},"22.3.2. Creating a CA ACL for web servers authenticating to web clients using certificates issued by webserver-ca","creating-a-CA-ACL-for-web-servers-authenticating-to-web-clients-using-certificates-issued-by-webserver-ca_restricting-an-application-to-trust-a-subset-of-certs","#creating-a-CA-ACL-for-web-servers-authenticating-to-web-clients-using-certificates-issued-by-webserver-ca_restricting-an-application-to-trust-a-subset-of-certs",{"title":681,"visible":15,"weight":28,"urlFragment":637,"anchor":682,"singlePageAnchor":682,"docTitle":19,"url":683},"22.3.3. Creating a CA ACL for user web browsers authenticating to web servers using certificates issued by webclient-ca","creating-a-CA-ACL-for-user-web-browsers-authenticating-to-web-servers-using-certificates-issued-by-webclient-ca_restricting-an-application-to-trust-a-subset-of-certs","#creating-a-CA-ACL-for-user-web-browsers-authenticating-to-web-servers-using-certificates-issued-by-webclient-ca_restricting-an-application-to-trust-a-subset-of-certs","#creating-a-ca-acl-specifying-the-profile-users-services-and-CAs_restricting-an-application-to-trust-a-subset-of-certs",{"title":686,"visible":15,"weight":46,"urlFragment":637,"anchor":687,"singlePageAnchor":687,"docTitle":19,"url":688},"22.4. Obtaining an IdM certificate for a service using certmonger","obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs","#obtain-service-cert-with-certmonger_restricting-an-application-to-trust-a-subset-of-certs",{"title":690,"visible":15,"weight":68,"urlFragment":637,"anchor":691,"singlePageAnchor":691,"docTitle":19,"url":692},"22.5. Communication flow for certmonger requesting a service certificate","communication-flow-certmonger-requesting-service-cert_restricting-an-application-to-trust-a-subset-of-certs","#communication-flow-certmonger-requesting-service-cert_restricting-an-application-to-trust-a-subset-of-certs",{"title":694,"visible":15,"weight":90,"urlFragment":637,"anchor":695,"singlePageAnchor":695,"docTitle":19,"url":696},"22.6. Setting up a single-instance Apache HTTP Server","setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs","#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs",{"title":698,"visible":15,"weight":116,"urlFragment":637,"anchor":699,"singlePageAnchor":699,"docTitle":19,"url":700},"22.7. Adding TLS encryption to an Apache HTTP Server","proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs","#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs",{"title":702,"visible":15,"weight":160,"urlFragment":637,"anchor":703,"singlePageAnchor":703,"docTitle":19,"url":704},"22.8. Setting the supported TLS protocol versions on an Apache HTTP Server","setting-the-supported-tls-protocol-versions-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs","#setting-the-supported-tls-protocol-versions-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs",{"title":706,"visible":15,"weight":194,"urlFragment":637,"anchor":707,"singlePageAnchor":707,"docTitle":19,"url":708},"22.9. Setting the supported ciphers on an Apache HTTP Server","setting-the-supported-ciphers-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs","#setting-the-supported-ciphers-on-an-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs",{"title":710,"visible":15,"weight":246,"urlFragment":637,"anchor":711,"singlePageAnchor":711,"docTitle":19,"url":712},"22.10. Configuring TLS client certificate authentication","configuring-tls-client-certificate-authentication_restricting-an-application-to-trust-a-subset-of-certs","#configuring-tls-client-certificate-authentication_restricting-an-application-to-trust-a-subset-of-certs",{"title":714,"visible":15,"weight":291,"urlFragment":637,"anchor":715,"singlePageAnchor":715,"docTitle":19,"url":716},"22.11. Requesting a new user certificate and exporting it to the client","requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs","#requesting-and-exporting-a-user-certificate_restricting-an-application-to-trust-a-subset-of-certs",{"title":718,"visible":15,"weight":334,"urlFragment":637,"anchor":719,"singlePageAnchor":719,"docTitle":19,"url":720},"22.12. Configuring a browser to enable certificate authentication","configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs","#configuring-browser-for-cert-auth_restricting-an-application-to-trust-a-subset-of-certs","#restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm",{"title":723,"visible":15,"weight":724,"urlFragment":725,"anchor":18,"singlePageAnchor":725,"sections":726,"docTitle":19,"url":735},"23. Invalidating a specific group of related certificates quickly",25,"invalidating-a-specific-group-of-related-certificates-quickly_managing-certificates-in-idm",[727,731],{"title":728,"visible":15,"weight":16,"urlFragment":725,"anchor":729,"singlePageAnchor":729,"docTitle":19,"url":730},"23.1. Disabling CA ACLs in IdM CLI","disabling-CA-ACLs-in-IdM-CLI_invalidating-a-specific-group-of-related-certificates-quickly","#disabling-CA-ACLs-in-IdM-CLI_invalidating-a-specific-group-of-related-certificates-quickly",{"title":732,"visible":15,"weight":23,"urlFragment":725,"anchor":733,"singlePageAnchor":733,"docTitle":19,"url":734},"23.2. Disabling an IdM sub-CA","disabling-an-IdM-sub-CA_invalidating-a-specific-group-of-related-certificates-quickly","#disabling-an-IdM-sub-CA_invalidating-a-specific-group-of-related-certificates-quickly","#invalidating-a-specific-group-of-related-certificates-quickly_managing-certificates-in-idm",{"title":737,"visible":15,"weight":738,"urlFragment":739,"anchor":18,"singlePageAnchor":739,"sections":740,"docTitle":19,"url":749},"24. Verifying certificates using IdM Healthcheck",26,"verifying-certificates-using-idm-healthcheck_managing-certificates-in-idm",[741,745],{"title":742,"visible":15,"weight":16,"urlFragment":739,"anchor":743,"singlePageAnchor":743,"docTitle":19,"url":744},"24.1. IdM certificates Healthcheck tests","idm-certificates-healthcheck-tests_verifying-certificates-using-idm-healthcheck","#idm-certificates-healthcheck-tests_verifying-certificates-using-idm-healthcheck",{"title":746,"visible":15,"weight":23,"urlFragment":739,"anchor":747,"singlePageAnchor":747,"docTitle":19,"url":748},"24.2. Screening certificates using the Healthcheck tool","screening-certificates-using-the-healthcheck-tool_verifying-certificates-using-idm-healthcheck","#screening-certificates-using-the-healthcheck-tool_verifying-certificates-using-idm-healthcheck","#verifying-certificates-using-idm-healthcheck_managing-certificates-in-idm",{"title":751,"visible":15,"weight":752,"urlFragment":753,"anchor":18,"singlePageAnchor":753,"sections":754,"docTitle":19,"url":763},"25. Verifying system certificates using IdM Healthcheck",27,"verifying-system-certificates-using-idm-healthcheck_managing-certificates-in-idm",[755,759],{"title":756,"visible":15,"weight":16,"urlFragment":753,"anchor":757,"singlePageAnchor":757,"docTitle":19,"url":758},"25.1. System certificates Healthcheck tests","system-certificates-healthcheck-tests_verifying-dogtag-certificates-using-healthcheck","#system-certificates-healthcheck-tests_verifying-dogtag-certificates-using-healthcheck",{"title":760,"visible":15,"weight":23,"urlFragment":753,"anchor":761,"singlePageAnchor":761,"docTitle":19,"url":762},"25.2. Screening system certificates using Healthcheck","screening-system-certificates-using-healthcheck_verifying-dogtag-certificates-using-healthcheck","#screening-system-certificates-using-healthcheck_verifying-dogtag-certificates-using-healthcheck","#verifying-system-certificates-using-idm-healthcheck_managing-certificates-in-idm",{"title":765,"visible":15,"weight":766,"urlFragment":767,"anchor":18,"singlePageAnchor":767,"sections":768,"docTitle":19,"url":785},"26. Understanding the certificates used internally by IdM",28,"understanding-what-certificates-are-used-by-idm_managing-certificates-in-idm",[769,773,777,781],{"title":770,"visible":15,"weight":16,"urlFragment":767,"anchor":771,"singlePageAnchor":771,"docTitle":19,"url":772},"26.1. About the internal certificates in IdM","about-the-internal-certificates-in-idm_understanding-what-certificates-are-used-by-idm","#about-the-internal-certificates-in-idm_understanding-what-certificates-are-used-by-idm",{"title":774,"visible":15,"weight":23,"urlFragment":767,"anchor":775,"singlePageAnchor":775,"docTitle":19,"url":776},"26.2. Certificates internal to IdM","certificates-internal-to-idm_understanding-what-certificates-are-used-by-idm","#certificates-internal-to-idm_understanding-what-certificates-are-used-by-idm",{"title":778,"visible":15,"weight":28,"urlFragment":767,"anchor":779,"singlePageAnchor":779,"docTitle":19,"url":780},"26.3. IdM internal certificate renewal process","idm-internal-certificate-renewal-process_understanding-what-certificates-are-used-by-idm","#idm-internal-certificate-renewal-process_understanding-what-certificates-are-used-by-idm",{"title":782,"visible":15,"weight":46,"urlFragment":767,"anchor":783,"singlePageAnchor":783,"docTitle":19,"url":784},"26.4. Additional resources","additional_resources_4","#additional_resources_4","#understanding-what-certificates-are-used-by-idm_managing-certificates-in-idm",{"title":787,"visible":15,"weight":788,"urlFragment":789,"anchor":18,"singlePageAnchor":790,"docTitle":19,"url":791},"Legal Notice",29,"legal-notice","idm140333367899040","#idm140333367899040",[793,796,799],{"text":794,"link":795},"Red Hat Enterprise Linux","/documentation/red_hat_enterprise_linux/",{"text":797,"link":798},"9","/documentation/red_hat_enterprise_linux/9/",{"text":11},{"name":11,"translations":801,"productVersion":802,"singlePage":803,"pdf":806,"publishingStatus":808},[5,6,7,8,9],{"name":797},{"contentUrl":804,"name":11,"new":805,"url":19},"https://d2bhdhkti9t3uj.cloudfront.net/html/2e684d17-b4e1-4d85-8896-dc202ded3d15/9223e14f1398aaea40ae3548d9720bbb.html","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/managing_certificates_in_idm/index",{"url":807},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/pdf/managing_certificates_in_idm/Red_Hat_Enterprise_Linux-9-Managing_certificates_in_IdM-en-US.pdf","PUBLISHED",[810,815,818,822,826,830,834],{"name":811,"new":812,"url":813,"urlAliases":814},"10.0-Beta","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/10-beta","10-beta",[],{"name":797,"new":816,"url":797,"urlAliases":817},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9",[],{"name":819,"new":820,"url":819,"urlAliases":821},"8","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8",[],{"name":823,"new":824,"url":823,"urlAliases":825},"7","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7",[],{"name":827,"new":828,"url":827,"urlAliases":829},"6","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/6",[],{"name":831,"new":832,"url":831,"urlAliases":833},"5","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/5",[],{"name":835,"new":836,"url":835,"urlAliases":837},"4","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/4",[],{"managing_certificates_in_idm/index":839,"managing_certificates_in_idm/proc_providing-feedback-on-red-hat-documentation_managing-certificates-in-idm":840,"managing_certificates_in_idm/cert-intro_managing-certificates-in-idm":841,"managing_certificates_in_idm/managing-certificates-for-users-hosts-and-services-using-the-integrated-idm-ca_managing-certificates-in-idm":842,"managing_certificates_in_idm/managing-idm-certificates-using-ansible_managing-certificates-in-idm":843,"managing_certificates_in_idm/managing-externally-signed-certificates-for-idm-users-hosts-and-services_managing-certificates-in-idm":844,"managing_certificates_in_idm/convert-cert-formats-idm_managing-certificates-in-idm":845,"managing_certificates_in_idm/creating-and-managing-certificate-profiles-in-identity-management_managing-certificates-in-idm":846,"managing_certificates_in_idm/managing-the-validity-of-certificates-in-idm_managing-certificates-in-idm":847,"managing_certificates_in_idm/configuring-idm-for-smart-card-auth_managing-certificates-in-idm":848,"managing_certificates_in_idm/configuring-certificates-issued-by-adcs-for-smart-card-authentication-in-idm_managing-certificates-in-idm":849,"managing_certificates_in_idm/conf-certmap-idm_managing-certificates-in-idm":850,"managing_certificates_in_idm/dc-web-ui-auth_managing-certificates-in-idm":851,"managing_certificates_in_idm/ipa-ca-renewal_managing-certificates-in-idm":852,"managing_certificates_in_idm/managing-externally-signed-ca-certificates_managing-certificates-in-idm":853,"managing_certificates_in_idm/renewing-expired-system-certificates-when-idm-is-offline_managing-certificates-in-idm":854,"managing_certificates_in_idm/proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-not-yet-expired-on-an-idm-replica_managing-certificates-in-idm":855,"managing_certificates_in_idm/proc_replacing-the-web-server-and-ldap-server-certificates-if-they-have-expired-in-the-whole-idm-deployment_managing-certificates-in-idm":856,"managing_certificates_in_idm/generating-crl-on-the-idm-ca-server_managing-certificates-in-idm":857,"managing_certificates_in_idm/proc_decommissioning-a-server-that-performs-the-ca-renewal-server-and-crl-publisher-roles_managing-certificates-in-idm":858,"managing_certificates_in_idm/using-certmonger_managing-certificates-in-idm":859,"managing_certificates_in_idm/deploying-and-managing-the-acme-service-in-idm_managing-certificates-in-idm":860,"managing_certificates_in_idm/requesting-certificates-using-rhel-system-roles_managing-certificates-in-idm":861,"managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm":862,"managing_certificates_in_idm/invalidating-a-specific-group-of-related-certificates-quickly_managing-certificates-in-idm":863,"managing_certificates_in_idm/verifying-certificates-using-idm-healthcheck_managing-certificates-in-idm":864,"managing_certificates_in_idm/verifying-system-certificates-using-idm-healthcheck_managing-certificates-in-idm":865,"managing_certificates_in_idm/understanding-what-certificates-are-used-by-idm_managing-certificates-in-idm":866,"managing_certificates_in_idm/legal-notice":867},{"prevt":18,"next":24},{"prevt":17,"next":29},{"prevt":18,"next":29},{"prevt":18,"next":47},{"prevt":18,"next":69},{"prevt":18,"next":91},{"prevt":18,"next":117},{"prevt":18,"next":161},{"prevt":18,"next":195},{"prevt":18,"next":247},{"prevt":18,"next":297},{"prevt":18,"next":335},{"prevt":18,"next":437},{"prevt":18,"next":467},{"prevt":18,"next":481},{"prevt":18,"next":499},{"prevt":499,"next":518},{"prevt":513,"next":523},{"prevt":18,"next":523},{"prevt":523,"next":546},{"prevt":18,"next":546},{"prevt":18,"next":597},{"prevt":18,"next":615},{"prevt":18,"next":637},{"prevt":18,"next":725},{"prevt":18,"next":739},{"prevt":18,"next":753},{"prevt":18,"next":767},{"prevt":767,"next":18},{"product":18,"version":18},{"managing_certificates_in_idm":870},[805],{"products":872},[873,874,875,876,877,878,879,880,881,882,883,884,885],"builds_for_red_hat_openshift","migration_toolkit_for_virtualization","openshift_container_platform","openshift_sandboxed_containers","red_hat_advanced_cluster_security_for_kubernetes","red_hat_advanced_cluster_management_for_kubernetes","red_hat_openshift_data_foundation","red_hat_openshift_dev_spaces","red_hat_openshift_gitops","red_hat_openshift_local","red_hat_openshift_pipelines","red_hat_openshift_serverless","workload_availability_for_red_hat_openshift",[],{"default":888},[889,898,904,913,921,929,936,944,951],{"nid":890,"type":891,"langcode":892,"Published":16,"title":893,"Created":894,"Updated":895,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":896,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":897},580,"rebrand banner","en","OpenShift Container Storage is now OpenShift Data Foundation starting with version 4.9.","2023-01-11 15:38:32","2023-01-11 15:40:04","/documentation/red_hat_openshift_container_storage\r\n/documentation/red_hat_openshift_container_storage/\r\n/documentation/red_hat_openshift_container_storage/*","internal:/documentation/red_hat_openshift_data_foundation/",{"nid":899,"type":891,"langcode":892,"Published":16,"title":893,"Created":900,"Updated":901,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":902,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":903},581,"2023-01-11 15:41:31","2023-01-11 15:42:04","/documentation/red_hat_openshift_data_foundation/4.9\r\n/documentation/red_hat_openshift_data_foundation/4.9/\r\n/documentation/red_hat_openshift_data_foundation/4.9/*\r\n/documentation/red_hat_openshift_data_foundation/4.10\r\n/documentation/red_hat_openshift_data_foundation/4.10/\r\n/documentation/red_hat_openshift_data_foundation/4.10/*\r\n/documentation/red_hat_openshift_data_foundation/4.11\r\n/documentation/red_hat_openshift_data_foundation/4.11/\r\n/documentation/red_hat_openshift_data_foundation/4.11/*","internal:/documentation/red_hat_openshift_container_storage/",{"nid":905,"type":906,"langcode":892,"Published":16,"title":907,"Created":908,"Updated":909,"body_value":18,"field_documentation banner_text_value":910,"field_documentation banner_text_format":911,"field_paths_value":912,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},582,"developer preview banner","MicroShift is Developer Preview software only","2023-01-11 15:50:24","2023-01-30 19:00:52","\u003Cp slot=header>MicroShift is Developer Preview software only.\u003C/p>For more information about the support scope of Red Hat Developer Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/devpreview/\">Developer Preview Support Scope\u003C/a>.","documentation banner","/documentation/microshift/4.12\r\n/documentation/microshift/4.12/*\r\n/documentation/red_hat_build_of_microshift/4.12\r\n/documentation/red_hat_build_of_microshift/4.12/*",{"nid":914,"type":915,"langcode":892,"Published":16,"title":916,"Created":917,"Updated":918,"body_value":18,"field_documentation banner_text_value":919,"field_documentation banner_text_format":911,"field_paths_value":920,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},583,"obsolete documentation banner","RHACS EOL - DAT-3433","2023-01-23 16:36:43","2023-01-23 16:39:14","\u003Cp slot=header>You are viewing documentation for a release that is no longer maintained. To view the documentation for the most recent version, see the \u003Ca href=\"/documentation/red_hat_advanced_cluster_security_for_kubernetes/\">latest RHACS docs\u003C/a>.\u003C/p>","/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71/*",{"nid":922,"type":923,"langcode":892,"Published":16,"title":924,"Created":925,"Updated":926,"body_value":18,"field_documentation banner_text_value":927,"field_documentation banner_text_format":911,"field_paths_value":928,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},584,"end of life banner","EOL banner for RHV","2023-05-23 14:58:05","2023-05-24 15:19:42","\u003Cp slot=header>The Red Hat Virtualization\u003C/p>Maintenance Phase runs until August 31, 2024, followed by the Extended Life Phase with no more software fixes through August 31, 2026. See \u003Ca href=\"https://access.redhat.com/articles/6975303\">Migration Paths for OpenShift Container Platform deployed on Red Hat Virtualization\u003C/a> for details.","/documentation/red_hat_virtualization/4.4",{"nid":930,"type":923,"langcode":892,"Published":16,"title":931,"Created":932,"Updated":933,"body_value":18,"field_documentation banner_text_value":934,"field_documentation banner_text_format":911,"field_paths_value":935,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},585,"RHHI-V EOL","2023-06-01 16:52:57","2023-06-01 17:03:44","\u003Cp slot=header>Red Hat Hyperconverged Infrastructure for Virtualization\u003C/p> is in the \u003Ca href=\"https://access.redhat.com/support/policy/updates/rhhiv\">Maintenance Support Phase\u003C/a> of its lifecycle until October 31, 2024. After that date, the product will be End of Life. See the \u003Ca href=\"https://access.redhat.com/announcements/6972521\">RHHI-V announcement\u003C/a> for next steps.","/documentation/red_hat_hyperconverged_infrastructure_for_virtualization/1.8",{"nid":937,"type":938,"langcode":892,"Published":16,"title":939,"Created":940,"Updated":941,"body_value":18,"field_documentation banner_text_value":942,"field_documentation banner_text_format":911,"field_paths_value":943,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},586,"preview banner","MicroShift is Technology Preview software only","2024-03-18 16:53:05","2024-03-18 16:54:56","\u003Cp slot=header>MicroShift is Technology Preview software only.\u003C/p>For more information about the support scope of Red Hat Technology Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/techpreview/\">Technology Preview Support Scope\u003C/a>.","/documentation/red_hat_build_of_microshift/4.13\r\n/documentation/red_hat_build_of_microshift/4.13/*",{"nid":945,"type":938,"langcode":892,"Published":16,"title":946,"Created":947,"Updated":948,"body_value":18,"field_documentation banner_text_value":949,"field_documentation banner_text_format":911,"field_paths_value":950,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},588,"Ansible 2.5 upgrade limitation","2024-09-30 16:53:05","2024-10-28 16:54:56","\u003Cp slot=\"header\">Support added for upgrades from 2.4\u003C/p>Ansible Automation Platform 2.5-3, released on October 28, 2024, adds support for upgrades from 2.4. See the upgrade documentation for more information.","",{"nid":952,"alertType":953,"type":954,"langcode":892,"Published":16,"title":955,"Created":950,"Updated":950,"body_value":18,"field_documentation banner_text_value":956,"field_documentation banner_text_format":911,"field_paths_value":957,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},587,"warning","Warning banner","Red Hat build of Apache Camel K","\u003Cp slot=header>Red Hat Camel K is deprecated\u003C/p>Red Hat Camel K is deprecated and the End of Life date for this product is June 30, 2025. For help migrating to the current go-to solution, \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel\">Red Hat build of Apache Camel\u003C/a>, see the \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel_k/1.10.7/html/migration_guide_camel_k_to_camel_extensions_for_quarkus/index\">Migration Guide\u003C/a>.","/documentation/red_hat_build_of_apache_camel_k/*",{"product":794},["Reactive",960],{"$snuxt-i18n-meta":961,"$sisLoading":962,"$sisSinglePage":15,"$sisInFocusMode":962,"$smobileTocOpen":962,"$sisLargeTOC":962,"$scurrentChapter":17,"$scurrentSection":17,"$scurrentSubSection":950},{},false,["Set"],["ShallowReactive",965],{"s8LoCEfG4A":18,"rFVLKcOK8e":18,"uUstF4AIyn":18,"MdHNSZP4nR":18,"Pn02PlJOas":18},"/en/documentation/red_hat_enterprise_linux/9/html-single/managing_certificates_in_idm/index"]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{contentEnv:"",collectFeedback:true,i18n:{baseUrl:"",defaultLocale:"en",defaultDirection:"ltr",strategy:"prefix",lazy:false,rootRedirect:"",routesNameSeparator:"___",defaultLocaleRouteNameSuffix:"default",skipSettingLocaleOnNavigate:false,differentDomains:false,trailingSlash:false,configLocales:[{code:"en",name:"English",iso:"en-US"},{code:"fr",name:"Français",iso:"fr-FR"},{code:"ko",name:"한국어",iso:"ko-KR"},{code:"ja",name:"日本語",iso:"ja-JP"},{code:"zh-cn",name:"中文 (中国)",iso:"zh-CN"},{code:"de",name:"Deutsch",iso:"de_DE"},{code:"it",name:"Italiano",iso:"it_IT"},{code:"pt-br",name:"Português",iso:"pt_BR"},{code:"es",name:"Español",iso:"es-ES"}],locales:{en:{domain:""},fr:{domain:""},ko:{domain:""},ja:{domain:""},"zh-cn":{domain:""},de:{domain:""},it:{domain:""},"pt-br":{domain:""},es:{domain:""}},detectBrowserLanguage:{alwaysRedirect:false,cookieCrossOrigin:false,cookieDomain:"",cookieKey:"i18n_redirected",cookieSecure:false,fallbackLocale:"",redirectOn:"root",useCookie:true},experimental:{localeDetector:"",switchLocalePathLinkSSR:false,autoImportTranslationFunctions:false}}},app:{baseURL:"/",buildId:"5ff82c51-785e-4a7d-aca6-77d6692e8c7a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>
