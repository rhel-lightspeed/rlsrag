<!DOCTYPE html><html  data-capo=""><head><script type="importmap">
  {
    "imports": {
      "@patternfly/elements/": "/scripts/v1/@patternfly/elements/",
      "@patternfly/pfe-clipboard/": "/scripts/v1/@patternfly/pfe-clipboard/",
      "@rhds/elements/": "/scripts/v1/@rhds/elements/elements/",
      "@cpelements/elements/": "/scripts/v1/@cpelements/elements/elements/"
    },
    "scopes": {
      "/": {
        "@floating-ui/core": "/scripts/v1/@floating-ui/core/dist/floating-ui.core.mjs",
        "@floating-ui/dom": "/scripts/v1/@floating-ui/dom/dist/floating-ui.dom.mjs",
        "@floating-ui/utils": "/scripts/v1/@floating-ui/utils/dist/floating-ui.utils.mjs",
        "@floating-ui/utils/dom": "/scripts/v1/@floating-ui/utils/dom/dist/floating-ui.utils.dom.mjs",
        "@lit/reactive-element": "/scripts/v1/@lit/reactive-element/reactive-element.js",
        "@lit/reactive-element/decorators/": "/scripts/v1/@lit/reactive-element/decorators/",
        "@patternfly/pfe-core": "/scripts/v1/@patternfly/pfe-core/core.js",
        "@patternfly/pfe-core/": "/scripts/v1/@patternfly/pfe-core/",
        "@rhds/tokens/media.js": "/scripts/v1/@rhds/tokens/js/media.js",
        "lit": "/scripts/v1/lit/index.js",
        "lit-element/lit-element.js": "/scripts/v1/lit-element/lit-element.js",
        "lit-html": "/scripts/v1/lit-html/lit-html.js",
        "lit-html/": "/scripts/v1/lit-html/",
        "lit/": "/scripts/v1/lit/",
        "tslib": "/scripts/v1/tslib/tslib.es6.mjs",
        "@cpelements/rh-table/dist/rh-table.js": "/scripts/v1/@cpelements/rh-table/dist/rh-table.js"
      }
    }
  }
</script><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Using SELinux | Red Hat Product Documentation</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<script type="text/javascript" id="trustarc" src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
<script src="//www.redhat.com/dtm.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@400;500;700&family=Red+Hat+Text:wght@400;500;700&display=swap">
<link rel="stylesheet" href="/styles/rh-table--lightdom.min.css">
<style>.section .titlepage{gap:.75rem}.section .titlepage,div.edit{align-items:center;display:flex}div.edit{font-size:.9rem;margin-bottom:8px}div.edit>a{align-items:center;display:flex}.edit pf-icon{margin-right:4px}</style>
<style>#error[data-v-df31ff14]{align-items:center;display:flex;flex-direction:column;justify-content:center;min-height:80vh}h1[data-v-df31ff14]{font-size:calc(var(--rh-font-size-body-text-md, 1rem)*4);font-weight:700;margin-bottom:0}h1[data-v-df31ff14],h1 span[data-v-df31ff14]{line-height:var(--rh-line-height-heading,1.3)}h1 span[data-v-df31ff14]{color:var(--rh-color-text-brand-on-light,#e00);display:block;text-transform:uppercase}h1 span[data-v-df31ff14],p[data-v-df31ff14]{font-size:var(--rh-font-size-body-text-lg,1.125rem)}aside[data-v-df31ff14]{align-items:center;background:var(--rh-color-surface-lightest,#fff);border:var(--rh-border-width-sm,1px) solid var(--rh-color-border-subtle-on-light,#c7c7c7);border-radius:var(--rh-border-radius-default,3px);border-top:calc(var(--rh-border-width-md, 2px)*2) solid var(--rh-color-text-brand-on-light,#e00);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2));display:flex;flex-direction:column;justify-content:space-between;margin-top:var(--rh-space-2xl,32px);padding:var(--rh-space-xl,24px)}aside[data-v-df31ff14],aside>div[data-v-df31ff14]{width:100%}.text-container[data-v-df31ff14]{margin:auto;max-width:442px;text-align:center}.desktop[data-v-df31ff14]{display:none}.sr-only[data-v-df31ff14]{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;clip-path:inset(50%);white-space:nowrap}form[data-v-df31ff14]{display:flex}button[data-v-df31ff14],input[data-v-df31ff14]{border:1px solid var(--rh-color-black-500,#8a8d90);box-sizing:border-box;height:40px}input[data-v-df31ff14]{border-right:none;flex:1;font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);padding-left:var(--rh-space-md,8px);width:100%}button[data-v-df31ff14]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border-left:none;display:flex;width:var(--rh-size-icon-04,40px)}button[data-v-df31ff14]:before{background:var(--rh-context-light-color-text-link,#06c);content:"";cursor:pointer;display:block;height:28px;margin:auto;width:28px}.search-icon[data-v-df31ff14]{margin:auto}ul[data-v-df31ff14]{max-width:275px;padding:0}ul li[data-v-df31ff14]{display:inline-block;list-style:none;margin-right:var(--rh-space-xl,24px);padding:var(--rh-space-xs,4px) 0}ul li a[data-v-df31ff14]{color:var(--rh-context-light-color-text-link,#06c);text-decoration:none}@media (min-width:992px){aside[data-v-df31ff14]{flex-direction:row}.mobile[data-v-df31ff14]{display:none}.desktop[data-v-df31ff14]{display:block}input[data-v-df31ff14]{width:auto}}</style>
<style>@keyframes fade-in{0%{opacity:0;visibility:hidden}1%{visibility:visible}to{opacity:1;visibility:visible}}@media (min-height:48em){.rhdocs{--rh-table--maxHeight:calc(100vh - 12.5rem)}}*,.rhdocs *,.rhdocs :after,.rhdocs :before,:after,:before{box-sizing:border-box}.rhdocs img,.rhdocs object,.rhdocs svg,img,object,svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs hr{border:0;border-top:.0625rem solid #d2d2d2;clear:both;margin:1rem 0}.rhdocs a{color:#06c;text-decoration:underline}.rhdocs a:focus,.rhdocs a:hover{color:#036}.rhdocs a.anchor-heading{color:#151515;cursor:pointer;text-decoration:none;word-break:break-all}.rhdocs p{margin:1.49963rem 0}.rhdocs li>p{margin:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:500;margin:0 0 .625rem}.rhdocs h1{font-size:2.25rem;margin:2rem 0}.rhdocs h2{font-size:1.625rem;margin:2rem 0}.rhdocs h3{font-size:1.5rem;font-weight:400}.rhdocs h4,.rhdocs h5{font-size:1.25rem}.rhdocs h5{font-weight:400}.rhdocs h6{font-size:1.125rem;font-weight:500;line-height:1.6667}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ol ::marker,.rhdocs ul ::marker{font:inherit}.rhdocs li{margin:0 0 .5em;padding:0}.rhdocs li>p{margin:.5rem 0}.rhdocs li>ol,.rhdocs li>ul{margin:0}.rhdocs dl dd{margin:.5rem 0 .5rem 1rem}.rhdocs dl dd>p{margin:.5rem 0}.rhdocs .informaltable,.rhdocs .table-contents,.rhdocs .table-wrapper{max-height:var(--rh-table--maxHeight);overflow:auto}.rhdocs table{border:0;font-size:1rem;line-height:1.6667;table-layout:fixed}.rhdocs table caption{color:#585858;margin-bottom:.5rem;margin-top:.5rem;text-align:left}.rhdocs table td,.rhdocs table th{border:0;border-bottom:.0625rem solid #d2d2d2;border-bottom:.0625rem solid var(--pfe-table--Border,#d2d2d2);padding:.5em 1rem}.rhdocs table td.halign-left,.rhdocs table th.halign-left{text-align:left}.rhdocs table td.halign-center,.rhdocs table th.halign-center,table td.halign-center,table th.halign-center{text-align:center}.rhdocs table td.halign-right,.rhdocs table th.halign-right{text-align:right}.rhdocs table td.valign-top,.rhdocs table th.valign-top{vertical-align:top}.rhdocs table td.valign-middle,.rhdocs table th.valign-middle{vertical-align:middle}.rhdocs table td.valign-bottom,.rhdocs table th.valign-bottom{vertical-align:bottom}.rhdocs table thead td,.rhdocs table thead th{background:#f5f5f5;font-weight:600}.rhdocs rh-table table,.rhdocs rh-table.rh-table--expanded-vertically{max-height:-moz-max-content;max-height:max-content}.rhdocs pre.nowrap{overflow:auto;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs .codeblock__wrapper pre{background:transparent}.rh-table--full-screen code,.rhdocs .content--md code,.rhdocs .content--sm code,.rhdocs .rh-table--full-screen code{overflow-wrap:normal;word-break:normal}.rhdocs[class] pre code,[class] pre code{background:inherit;color:inherit;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;padding:0}.rhdocs .keycap,.rhdocs kbd{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.keycap strong,.rhdocs .keycap strong{font-weight:inherit}.rhdocs kbd.keyseq,kbd.keyseq{background:transparent;border:0;box-shadow:none;padding:0}.rhdocs kbd.keyseq kbd,kbd.keyseq kbd{display:inline-block;margin:0 .375rem}.rhdocs kbd.keyseq kbd:first-child,kbd.keyseq kbd:first-child{margin-left:0}.rhdocs b.button{font-size:90%;font-weight:700;padding:.1875rem}.rhdocs b.button:before{content:"["}.rhdocs b.button:after{content:"]"}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}.rhdocs audio,.rhdocs canvas,.rhdocs progress,.rhdocs video{display:inline-block;vertical-align:baseline}.rhdocs audio:not([controls]){display:none;height:0}[hidden],template{display:none}.rhdocs a{background:transparent}.rhdocs a:active,.rhdocs a:hover{outline:0}.rhdocs a.anchor-heading:hover:before{color:#151515;content:"#";margin-left:-1.6rem;position:absolute}.rhdocs a.anchor-heading:focus-visible{color:#151515}@media screen and (max-width:990px){.rhdocs a.anchor-heading:hover:before{font-size:16px;margin-left:-1rem;padding-top:8px}.rhdocs h1 a.anchor-heading:hover:before{padding-top:12px}.rhdocs h4 a.anchor-heading:hover:before,.rhdocs h5 a.anchor-heading:hover:before{padding-top:4px}.rhdocs h6 a.anchor-heading:hover:before{padding-top:2px}}.rhdocs abbr[title]{border-bottom:.0625rem dotted}.rhdocs dfn{font-style:italic}.rhdocs h1{font-size:2em;margin:.67em 0}.rhdocs mark{background:#ff0;color:#000}.rhdocs small{font-size:80%}.rhdocs sub,.rhdocs sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}.rhdocs sup{top:-.5em}.rhdocs sub{bottom:-.25em}.rhdocs img{border:0}.rhdocs svg:not(:root){overflow:hidden}.rhdocs figure{margin:1em 2.5rem}.rhdocs hr{box-sizing:content-box;height:0}.rhdocs code,.rhdocs kbd,.rhdocs pre,.rhdocs samp{font-family:monospace,monospace;font-size:1em}.rhdocs button,.rhdocs optgroup,.rhdocs select,.rhdocs textarea,.rhdocsinput{color:inherit;font:inherit;margin:0}.rhdocs button.copy-link-btn{background:none;border:2px solid #fff;font:1px Red Hat Text}.rhdocs button.copy-link-btn:hover{border-bottom:2px solid #06c}.rhdocs button.copy-link-btn .link-icon{padding-bottom:4px}.rhdocs button{overflow:visible}.rhdocs button,.rhdocs select{text-transform:none}.rhdocs button,.rhdocs html input[type=button],.rhdocs input[type=reset],.rhdocs input[type=submit]{-moz-appearance:button;appearance:button;-webkit-appearance:button;cursor:pointer}.rhdocs button[disabled],.rhdocs html input[disabled]{cursor:default}.rhdocs button::-moz-focus-inner,.rhdocs input::-moz-focus-inner{border:0;padding:0}.rhdocs input{line-height:normal}.rhdocs input[type=checkbox],.rhdocs input[type=radio]{box-sizing:border-box;padding:0}.rhdocs input[type=number]::-webkit-inner-spin-button,.rhdocs input[type=number]::-webkit-outer-spin-button{height:auto}.rhdocs input[type=search]{-moz-appearance:textfield;appearance:textfield;-webkit-appearance:textfield;box-sizing:content-box}.rhdocs input[type=search]::-webkit-search-cancel-button,.rhdocs input[type=search]::-webkit-search-decoration{-webkit-appearance:none}.rhdocs fieldset{border:.0625rem solid silver;margin:0 .125rem;padding:.35em .625em .75em}.rhdocs legend{border:0;padding:0}.rhdocs textarea{overflow:auto}.rhdocs optgroup{font-weight:700}.rhdocs table{border-collapse:collapse;border-spacing:0}.rhdocs td,.rhdocs th{padding:0}.rhdocs ._additional-resources[class][class][id]:last-child{margin-top:-2rem}.rhdocs ._additional-resources[class][class]:only-child{grid-column:1/-1}._additional-resources[class][class] .additional-resources__heading,._additional-resources[class][class] .heading,._additional-resources[class][class] h1,._additional-resources[class][class] h2,._additional-resources[class][class] h3,._additional-resources[class][class] h4,._additional-resources[class][class] h5,._additional-resources[class][class] h6,._additional-resources[class][class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper ._additional-resources[class][class] ul{display:block}._additional-resources[class][class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}._additional-resources[class][class] li:only-child{grid-column:1/-1}._additional-resources[class][class] li:last-child{border:0}@media (min-width:1100px){._additional-resources[class][class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}._additional-resources[class][class] li p:only-child{margin:0;padding:0}._additional-resources[class][class] li a{text-decoration:none}._additional-resources[class][class] li a:focus,._additional-resources[class][class] li a:hover{text-decoration:underline}.rhdocs table .admonitionblock>div:nth-child(2),.rhdocs table .caution>div:nth-child(2),.rhdocs table .important>div:nth-child(2),.rhdocs table .note>div:nth-child(2),.rhdocs table .tip>div:nth-child(2),.rhdocs table .warning>div:nth-child(2){margin:.5rem 0}.rhdocs table .admonitionblock>div:nth-child(2)>:first-child,.rhdocs table .caution>div:nth-child(2)>:first-child,.rhdocs table .important>div:nth-child(2)>:first-child,.rhdocs table .note>div:nth-child(2)>:first-child,.rhdocs table .tip>div:nth-child(2)>:first-child,.rhdocs table .warning>div:nth-child(2)>:first-child{margin-top:0}.rhdocs table .admonitionblock>div:nth-child(2)>:last-child,.rhdocs table .caution>div:nth-child(2)>:last-child,.rhdocs table .important>div:nth-child(2)>:last-child,.rhdocs table .note>div:nth-child(2)>:last-child,.rhdocs table .tip>div:nth-child(2)>:last-child,.rhdocs table .warning>div:nth-child(2)>:last-child{margin-bottom:0}.rhdocs .codeblock__wrapper+.codeblock__wrapper,.rhdocs pre+pre,.rhdocs pre[class]+pre[class]{margin-top:2rem}.rhdocs .codeblock__wrapper{background:#f8f8f8;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__wrapper:before{background-repeat:no-repeat;background-size:6.25rem 100%;bottom:var(--scrollbar__height,1px);content:"";display:block;height:7.125rem;max-height:100%;max-height:calc(100% - var(--scrollbar__height, 2px));position:absolute;right:var(--scrollbar__width,6px);top:.0625rem;width:4.0625rem;z-index:1}.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 6.25rem)}@media (min-height:48em){.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 12.5rem)}}.rhdocs .codeblock__inner-wrapper{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs .codeblock__wrapper--expanded .codeblock__inner-wrapper{max-height:-moz-max-content;max-height:max-content}.codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.codeblock__copy:focus{outline:.0625rem dashed currentcolor}.codeblock__copy svg#icon--copy{height:1rem;width:1rem}.codeblock__expand{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;border:0;cursor:pointer;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));position:absolute;text-indent:-9999em;top:3.25rem;width:1.75rem;z-index:2}.codeblock__expand:before{background:#6a6e73;content:"";height:100%;left:0;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");-webkit-mask-position:center center;mask-position:center center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:auto 1rem;mask-size:auto 1rem;position:absolute;top:0;width:100%}.codeblock__wrapper--expanded .codeblock__expand{background:#2b9af3}.codeblock__wrapper--expanded .codeblock__expand:before{background:#fff}.codeblock__expand:focus:before,.codeblock__expand:hover:before{background:#06c}.codeblock__wrapper--expanded .codeblock__expand:focus:before,.codeblock__wrapper--expanded .codeblock__expand:hover:before{background:#fff}.codeblock__expand:focus{outline:.0625rem dashed currentcolor}.rhdocs .calloutlist>ol,.rhdocs .colist>ol{counter-reset:colist;list-style:none;margin:1rem 0 2rem;padding:0}.rhdocs .calloutlist>ol>li,.rhdocs .colist>ol>li{counter-increment:colist;font-size:1rem;margin:.5rem 0;padding-left:1.75rem;position:relative}.rhdocs .calloutlist>ol>li .colist-num,.rhdocs .colist>ol>li .colist-num{display:none}.calloutlist>ol>li:before,.colist>ol>li:before{content:counter(colist);left:0;position:absolute;top:.1875rem}.calloutlist dt{clear:left;float:left;margin:0;padding:0 .5rem 0 0}.included-in-guides[class],.included-in-guides[class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.included-in-guides[class][id]:last-child{margin-top:-2rem}.included-in-guides[class]:only-child{grid-column:1/-1}.included-in-guides[class] .additional-resources__heading,.included-in-guides[class] .heading,.included-in-guides[class] h1,.included-in-guides[class] h2,.included-in-guides[class] h3,.included-in-guides[class] h4,.included-in-guides[class] h5,.included-in-guides[class] h6,.included-in-guides[class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.included-in-guides[class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper .included-in-guides[class] ul{display:block}.included-in-guides[class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}.included-in-guides[class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.included-in-guides[class] li:only-child{grid-column:1/-1}.included-in-guides[class] li:last-child{border:0}@media (min-width:1100px){.included-in-guides[class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}.included-in-guides[class] li p:only-child{margin:0;padding:0}.included-in-guides[class] li a{text-decoration:none}.included-in-guides[class] li a:focus,.included-in-guides[class] li a:hover{text-decoration:underline}.menuseq{display:inline-flex;overflow:hidden;text-indent:-9999em}.menuseq .menu,.menuseq .menuitem,.menuseq .submenu{display:block;position:relative;text-indent:0}.menuseq .menu+.menu:before,.menuseq .menu+.menuitem:before,.menuseq .menu+.submenu:before,.menuseq .menuitem+.menu:before,.menuseq .menuitem+.menuitem:before,.menuseq .menuitem+.submenu:before,.menuseq .submenu+.menu:before,.menuseq .submenu+.menuitem:before,.menuseq .submenu+.submenu:before{content:">";display:inline-block;font-weight:700;padding:0 .25em}.related-topic-content__wrapper{margin:2em 0}.related-topic-content__wrapper--for-guide{margin-bottom:-2.5rem;padding-bottom:.0625rem;position:relative;z-index:1}.related-topic-content__wrapper--for-guide:before{background:#f0f0f0;content:"";display:block;height:100%;left:-3rem;position:absolute;right:-4.5rem;top:0;width:auto;z-index:-1}@media (min-width:1100px){.related-topic-content__wrapper--for-guide:before{left:-2.5rem;right:-3.625rem}}.related-topic-content__wrapper--for-guide summary{padding:1em 2em 1em 2.1875rem}@media (min-width:950px){.related-topic-content__inner-wrapper{display:grid;gap:2em;grid-template-columns:repeat(2,minmax(0,1fr))}}.local-render .rhdocs-content{margin:0 auto}.rhdocs cp-documentation{display:block;padding-bottom:2.5rem}.rhdocs cp-documentation.PFElement,.rhdocs cp-documentation[pfelement]{padding:0}rh-table{display:block}::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar{height:.625rem;width:.625rem}::-webkit-scrollbar,::-webkit-scrollbar-track,:host .rhdocs ::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar-track{background-color:#d6d6d6}::-webkit-scrollbar-thumb,:host .rhdocs ::-webkit-scrollbar-thumb{background-color:#8e8e8e}*,:host .rhdocs *{scrollbar-color:#8e8e8e #d6d6d6}.rhdocs p:empty,p:empty{display:none}.rhdocs[class] h1 code,.rhdocs[class] h2 code,.rhdocs[class] h3 code,.rhdocs[class] h4 code,.rhdocs[class] h5 code,.rhdocs[class] h6 code,[class] h1 code,[class] h2 code,[class] h3 code,[class] h4 code,[class] h5 code,[class] h6 code{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.pane-page-title h1,.rhdocs__header__primary-wrapper h1{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:2.25rem;line-height:1.333}.rhdocs details[class]{list-style:none;margin:1rem 0 3rem;padding:0}.rhdocs-toc[class]{background:#f2f2f2;margin:1rem 0 2rem;padding:1rem}.rhdocs-toc[class]>:last-child{margin-bottom:0}.rhdocs-toc[class] .rhdocs-toctitle{font-size:1.25rem;font-weight:400;line-height:1.6667;margin-top:0;text-transform:none}.rhdocs-toc[class] li{margin-bottom:.25em;padding-left:.5em}.preamble{margin:0 0 2rem}.sect1{margin:2rem 0 1rem}:host .sect1,cp-documentation .sect1{margin:0 0 2rem;padding:.0625rem 0 0}:host(.cp-documentation--has-external-header) .sect1:first-child>h2:first-child,:host(.cp-documentation--has-external-header) .sect1:first-child>h3:first-child{margin-top:0}.listingblock,.literalblock{margin:1rem 0}.quoteblock,.verseblock{border-left:.25rem solid #d2d2d2;margin:1rem 0;padding:1rem 1rem 1rem 2rem}.quoteblock.pullleft,.verseblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.quoteblock.pullleft,.verseblock.pullleft{margin-left:-1rem}}.quoteblock.pullright,.verseblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.quoteblock.pullright,.verseblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.quoteblock.pullright,.verseblock.pullright{margin-right:-10rem}}.quoteblock>:first-child,.verseblock>:first-child{margin-top:0}.quoteblock .content,.verseblock .content{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.25rem;line-height:1.6667}.quoteblock .attribution,.verseblock .attribution{font-size:.875rem;font-style:italic;font-weight:600;line-height:1.6667;text-transform:uppercase}.quoteblock .attribution .citetitle,.verseblock .attribution .citetitle{color:#585858}.quoteblock .attribution cite,.verseblock .attribution cite{font-size:1em}.quoteblock blockquote{font-style:italic;margin:0;padding:0}.quoteblock blockquote .content>:first-child{margin-top:0}.quoteblock blockquote .content>:first-child:before{color:#e00;content:"â€œ";display:block;float:left;font-size:2.75rem;font-style:normal;line-height:1.125em;margin-right:.5rem}.quoteblock blockquote .content>:first-child .content>:first-child:before{content:none}.imageblock{margin:1rem 0}.imageblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.imageblock.pullleft{margin-left:-1rem}}.imageblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.imageblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.imageblock.pullright{margin-right:-10rem}}.imageblock.interrupter{margin:2rem 0}@media (min-width:768px){.imageblock.interrupter{margin-left:-1rem;margin-right:-2rem}.imageblock.interrupter .caption{margin-left:1rem;margin-right:2rem}}@media (min-width:1100px){.imageblock.interrupter{margin-right:-10rem}.imageblock.interrupter .caption{margin-right:10rem}}.imageblock.interrupter img{max-width:100%}.imageblock .caption{color:#585858;display:block;font-size:.875rem;line-height:1.6667;margin:.5rem 0 0}.rhdocs-footnotes{border-top:.0625rem solid #d2d2d2;margin:3rem 0 1rem;padding:1rem 0 0}.rhdocs-footnotes>ol{margin:0;padding:0 0 0 1.5rem}@supports (counter-reset:footnotenum){.rhdocs-footnotes>ol{counter-reset:footnotenum;list-style:none;padding:0}.rhdocs-footnotes>ol>li{counter-increment:footnotenum}.rhdocs-footnotes>ol>li:before{color:#585858;content:"[" counter(footnotenum) "]";display:inline-block;margin-right:.25rem}}.rhdocs-footer{background:#ededed;color:#151515;font-size:.875rem;line-height:1.6667;margin:3rem 0 0;padding:1rem}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.visually-hidden{overflow:hidden;position:absolute;clip:rect(0,0,0,0);border:0;height:.0625rem;margin:-.0625rem;padding:0;width:.0625rem}.rh-docs-legal-notice{margin-top:4em}pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}code.language-none,code.language-text,code.language-txt,pre.language-none,pre.language-text,pre.language-txt{color:#151515}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#cceae7;color:#263238}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#cceae7;color:#263238}:not(pre)>code[class*=language-]{border-radius:.2em;padding:.1em;white-space:normal}.token.atrule{color:#40199a}.token.attr-name{color:#06c}.token.attr-value,.token.attribute{color:#b300b3}.token.boolean{color:#40199a}.token.builtin,.token.cdata,.token.char,.token.class,.token.class-name{color:#06c}.token.comment{color:#6a6e73}.token.constant{color:#40199a}.token.deleted{color:#c9190b}.token.doctype{color:#6a6e73}.token.entity{color:#c9190b}.token.function{color:#40199a}.token.hexcode{color:#b300b3}.token.id,.token.important{color:#40199a;font-weight:700}.token.inserted{color:#06c}.token.keyword{color:#40199a}.token.number{color:#b300b3}.token.operator{color:#06c}.token.prolog{color:#6a6e73}.token.property{color:#06c}.token.pseudo-class,.token.pseudo-element{color:#b300b3}.token.punctuation,.token.regex{color:#06c}.token.selector{color:#c9190b}.token.string{color:#b300b3}.token.symbol{color:#40199a}.token.unit{color:#b300b3}.token.url,.token.variable{color:#c9190b}.rhdocs.local-render{margin:0 auto;max-width:45.8125rem;padding:0 1.5rem}@media print{.field code,.field pre,code[class*=language-],pre,pre[class*=language-]{white-space:pre-wrap!important;word-wrap:break-word!important;overflow-wrap:break-word!important;word-break:break-word!important}}.book-nav__list[class]{display:flex;justify-content:space-between;line-height:var(--jupiter__lineHeight--xs,1.3333);list-style:none;margin:5rem 0 0;padding:0}@media (min-width:1200px){.book-nav__list[class]{display:grid;gap:2rem;grid-template-columns:repeat(2,minmax(0,1fr))}}.book-nav__item a{display:inline-block;font-size:.875rem;font-weight:500;padding-left:1.25rem;position:relative;text-transform:uppercase}.book-nav__item a:before{background:url(/sites/dxp-docs/penumbra-dist/jupiter/images/arrow-down-solid.svg) no-repeat;background-size:contain;content:"";display:block;height:.875rem;left:0;position:absolute;top:.125rem;transform:rotate(90deg);width:.875rem}.book>.titlepage:not(:last-child),.rhdocs .chapter,section[id]{padding-bottom:3.75rem}.book>.titlepage .chapter:last-child,.book>.titlepage section[id]:last-child,.chapter .chapter:last-child,.chapter section[id]:last-child,section[id] .chapter:last-child,section[id] section[id]:last-child{margin-bottom:-3.75rem}.rhdocs .codeblock__wrapper+section[id],pre+section[id]{padding-top:3.75rem}.rhdocs .cta-link{font-size:inherit}.rhdocs a{word-wrap:break-word;overflow-wrap:break-word}.rhdocs .caution,.rhdocs .important,.rhdocs .note,.rhdocs .tip,.rhdocs .warning{padding:.8888888889em;position:relative}.rhdocs .QSIPopOver{bottom:18.75rem!important;top:auto!important}.rhdocs .alert{position:relative}.rhdocs button.dismiss-button{background:none;border:0;cursor:pointer;height:2.5rem;margin-top:-1.25rem;padding:0;position:absolute;right:.3125rem;text-align:center;top:50%;width:2.5rem;z-index:50}.rhdocs button.dismiss-button:after{content:"\f109";display:inline-block;filter:alpha(opacity=30);font-family:rh-web-iconfont;font-size:1.3125rem;font-style:normal;font-variant:normal;font-weight:400;line-height:1;line-height:2.5rem;opacity:.3;text-decoration:inherit;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs .book>.titlepage,.rhdocs .chapter,.rhdocs section[id]{padding-bottom:var(--rh-space-4xl,64px)}.rhdocs .alert{border:0;border-radius:0}.rhdocs .alert>h2:first-child,.rhdocs .alert>h3:first-child,.rhdocs .alert>h4:first-child,.rhdocs .alert>h5:first-child,.rhdocs .alert>h6:first-child,.rhdocs .alert>p:first-child{margin-top:0!important}.rhdocs .alert>p:last-child{margin-bottom:0!important}.rhdocs .alert-w-icon[class]{padding-left:2.8125rem}.rhdocs .alert-w-icon .alert-icon{float:left;font-size:1.125rem;margin-left:-1.875rem;margin-right:.625rem}.rhdocs .alert-w-icon .alert-icon[class*=" rh-icon-"],.rhdocs .alert-w-icon .alert-icon[class^=rh-icon-]{font-size:2.25rem;line-height:1em;margin-left:-2.5rem;margin-top:-.375rem}.rhdocs .alert-w-icon .alert-icon[class*=" icon-innov-prev"],.rhdocs .alert-w-icon .alert-icon[class^=icon-innov-prev]{font-size:1.3125rem;margin-top:.25rem}.rhdocs .alert-w-icon.alert-plain{background:none;color:#151515;padding-left:5rem}.rhdocs .alert-w-icon.alert-plain .alert-icon{font-size:3rem;margin-left:-4.375rem;margin-right:0}.rhdocs .alert-w-icon.alert-plain.alert-success .alert-icon{color:#3f9c35}.rhdocs .alert-w-icon.alert-plain.alert-info .alert-icon{color:#0088ce}.rhdocs .alert-w-icon.alert-plain.alert-warning .alert-icon{color:#f0ab00}.rhdocs .alert-w-icon.alert-plain.alert-danger .alert-icon{color:#e00}#target_banner .copy-url{float:right;margin-top:0}#target_banner .dropdown-menu{font-size:inherit}.titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.para{margin:1.49963rem 0}.para[class]{margin-bottom:1.49963rem}dd{margin-bottom:2.5rem}.rhdocs .card-light,.rhdocs .card-light-gray,.rhdocs .card-light-grey{background:#f0f0f0;border:.0625rem solid #f0f0f0;color:#151515}.rhdocs .card-light-gray.push-bottom:first-child,.rhdocs .card-light-grey.push-bottom:first-child,.rhdocs .card-light.push-bottom:first-child{margin-bottom:3.125rem!important}.rhdocs .card-light a.card-link,.rhdocs .card-light h1,.rhdocs .card-light h2,.rhdocs .card-light h3,.rhdocs .card-light h4,.rhdocs .card-light h5,.rhdocs .card-light h6,.rhdocs .card-light-gray a.card-link,.rhdocs .card-light-gray h1,.rhdocs .card-light-gray h2,.rhdocs .card-light-gray h3,.rhdocs .card-light-gray h4,.rhdocs .card-light-gray h5,.rhdocs .card-light-gray h6,.rhdocs .card-light-grey a.card-link,.rhdocs .card-light-grey h1,.rhdocs .card-light-grey h2,.rhdocs .card-light-grey h3,.rhdocs .card-light-grey h4,.rhdocs .card-light-grey h5,.rhdocs .card-light-grey h6{color:#151515}.rhdocs .card-light-gray.card-active:after,.rhdocs .card-light-grey.card-active:after,.rhdocs .card-light.card-active:after{border-top-color:#f0f0f0}.rhdocs .card-md,.rhdocs .card-narrow{display:block;padding:1.1875rem;white-space:normal;word-wrap:break-word}.rhdocs .card .card-heading.card-heading-sm,.rhdocs .card-sm .card .card-heading{font-size:1.0625em;font-weight:500;line-height:1.5}.rhdocs .card .card-heading.card-heading-flush{margin-bottom:.25rem}.rhdocs .card .card-heading.card-heading-red{color:#d10000}.rhdocs .card>p{margin-top:0}.rhdocs .card>p:last-child{margin-bottom:0}.rhdocs .new-experience{background-color:#e7f1fa;border:.0625rem solid #bee1f4;font-size:1rem;margin:1.5rem;padding:1.5rem;position:relative;z-index:1}@media (min-width:48rem){.new-experience{display:flex}.new-experience--contained{left:50%;position:relative;transform:translateX(-50%);width:calc(100vw - 2.5rem)}}.new-experience__primary-content{flex-grow:1}@media (min-width:48rem){.new-experience__primary-content{margin-right:1.25rem}}.new-experience__title{font-size:inherit;font-weight:inherit;line-height:1.6;margin:0;padding:0}.new-experience__title+a,.new-experience__title+pfe-cta{display:inline-block;margin-top:1.5em}.new-experience__secondary-content{min-width:12.5rem}@media (min-width:48rem){.new-experience__secondary-content{text-align:right}}.example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:min-content 1fr}dl.calloutlist[class] dt{float:none;margin:0;padding:0}dl.calloutlist[class] dd{margin:0;padding:0}dl.calloutlist[class] dd>:first-child{margin-top:0}dl.calloutlist[class] dd>:last-child{margin-bottom:0}.toast{background-color:#000;background-color:rgba(0,0,0,.9);bottom:.9375rem;box-shadow:0 .125rem .3125rem 0 rgba(0,0,0,.26);color:#fff;left:.9375rem;max-width:32.8125rem;min-width:6.25rem;padding:.9375rem;position:fixed;right:.9375rem;transform:translate3d(0,150%,0);transition:transform .2s cubic-bezier(.465,.183,.153,.946);will-change:transform;z-index:999}.toast.show{transform:translateZ(0)}.toast a{color:#fff;text-decoration:underline}.toast a:focus,.toast a:hover{color:#2b9af3}.toast a.btn{text-decoration:none}.toast .btn.btn-link{color:#fff}.toast .close{color:#fff;opacity:.3;text-decoration:none}.toast .close:focus,.toast .close:hover{color:#fff;opacity:.5}.no-csstransforms3d.csstransitions .toast{transition:all .2s cubic-bezier(.465,.183,.153,.946)}.no-csstransforms3d .toast{opacity:0;visibility:hidden}.no-csstransforms3d .toast.show{opacity:1;visibility:visible}.annotator-outer[class][class]{display:none;flex-direction:column;flex-grow:1;height:auto;margin:0;position:static;width:auto}@media (min-width:1400px){.annotator-outer[class][class]{display:flex}}.annotator-frame[class] *{height:auto}@media (min-width:1400px){.annotator-frame .h-sidebar-iframe[class]{position:static;width:calc(100% + 1.5rem)}}.annotator-toolbar[class][class]{position:static;width:auto}.annotator-toolbar>ul,.annotator-toolbar>ul>li{display:block;height:auto;list-style:none;margin:0;padding:0;width:auto}.annotator-toolbar>ul>li{display:flex;justify-content:flex-end}.annotator-frame[class] .annotator-frame-button--sidebar_toggle,.annotator-outer .annotator-frame-button[class][class],.app-content-wrapper *{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif!important}.annotator-outer .annotator-frame-button[class][class]{font-size:.9375rem;font-weight:500;height:auto;line-height:1.333;margin-right:1.875rem;padding:.75em 1em;position:static}@media (min-width:1400px){.annotator-outer .annotator-frame-button[class][class]{margin-right:0}}.annotator-outer iframe{flex-grow:1;margin-bottom:1.25rem}@media (min-width:1400px){.annotator-outer iframe{min-height:37.5rem}}.producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.producttitle .productnumber{color:var(--jupiter__palette__red--50,#e00)}.cp-modal-open,.zoom-open{overflow:hidden}.cp-modal,.cp-video-modal,.zoom-modal{bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;outline:0;overflow:hidden;position:fixed;right:0;top:0;transition:all .2s cubic-bezier(.465,.183,.153,.946);z-index:1040;z-index:1050;-webkit-overflow-scrolling:touch}.rhdocs .in.cp-modal,.rhdocs .in.cp-video-modal,.rhdocs .in.zoom-modal{display:block;filter:alpha(opacity=100);opacity:1;overflow-x:hidden;overflow-y:auto}.rhdocs .cp-modal .close,.rhdocs .cp-video-modal .close,.rhdocs .zoom-modal .close{background-color:#fff;border-radius:50%;color:#1a1a1a;font-size:1.75rem;height:28px;height:1.75rem;line-height:1.75rem;margin-bottom:.375rem;margin-top:0;opacity:.9;position:absolute;right:-.5rem;text-shadow:none;top:0;width:28px;width:1.75rem}.cp-modal .close:after,.cp-video-modal .close:after,.zoom-modal .close:after{line-height:1.75rem}.cp-modal-wrap,.zoom-wrap{margin:.625rem;padding-top:.5rem;position:relative}@media (min-width:48rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{margin:2.8125rem auto;width:38.4375rem}}@media (min-width:62rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:49.8958rem}}@media (min-width:75rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:60.3125rem}}.rhdocs .cp-modal-body :last-child{margin-bottom:0}.rhdocs .cp-modal-backdrop,.rhdocs .zoom-backdrop{background-color:#000;bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;position:fixed;right:0;top:0;transition:opacity .2s cubic-bezier(.465,.183,.153,.946);z-index:1040}.rhdocs .in.cp-modal-backdrop,.rhdocs .in.zoom-backdrop{display:block;filter:alpha(opacity=80);opacity:.8}.rhdocs .cp-modal-body{background:#fff;padding:1.875rem}.rhdocs .cp-modal[data-cp-modal-video=true] .cp-modal-body,.rhdocs .cp-video-modal .cp-modal-body{padding:0}.rhdocs [data-action=zoom]{position:relative}.rhdocs [data-action=zoom]:after{background:rgba(0,0,0,.4);bottom:0;color:#fff;display:inline-block;font-family:rh-web-iconfont;font-style:normal;font-variant:normal;font-weight:400;line-height:1;padding:.375rem;position:absolute;right:0;text-decoration:inherit;text-decoration:none!important;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs [data-action=zoom]:focus:after,.rhdocs [data-action=zoom]:hover:after{background:rgba(0,0,0,.9)}.rhdocs .zoom-wrap .zoom-larger{text-align:center}.rhdocs .zoom-wrap .zoom-larger a{color:#fff}.rhdocs .zoom-wrap .zoom-larger a:focus,.rhdocs .zoom-wrap .zoom-larger a:hover{color:#fff;text-decoration:underline}.rhdocs .zoom-wrap .zoom-larger a:after{content:"â¿»";display:inline-block;margin-left:.25rem}.rhdocs .zoom-body{background:#fff;border-radius:.5rem;margin:0 0 1rem;padding:1rem;text-align:center}.rhdocs .zoom-body .video-wrapper{height:0;overflow:hidden;padding-bottom:56.25%;position:relative}.rhdocs .zoom-body .video-wrapper[data-aspect-ratio="4:3"]{padding-bottom:75%}.rhdocs .zoom-body iframe{height:100%;left:0;position:absolute;top:0;width:100%}.rhdocs .para>.title[class],.rhdocs p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0;text-transform:none}.rhdocs .para>.title[class]+.content>:first-child,.rhdocs .para>.title[class]+p,.rhdocs p.title[class]+.content>:first-child,.rhdocs p.title[class]+p{margin-top:0}.rhdocs [class] pre .caution,.rhdocs [class] pre .important,.rhdocs [class] pre .note,.rhdocs [class] pre .tip,.rhdocs [class] pre .warning{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.rhdocs [class] pre .caution:after,.rhdocs [class] pre .important:after,.rhdocs [class] pre .note:after,.rhdocs [class] pre .tip:after,.rhdocs [class] pre .warning:after{content:none}.rhdocs [class] code.email{background-color:transparent;font:inherit;padding:0}.rhdocs [class] .author{margin-bottom:1.5rem}.rhdocs [class] .author .author{margin-bottom:0}.rhdocs table{margin:2rem 0}.rhdocs [class] table{width:auto}.rhdocs table .table-contents table{max-width:100%;overflow:auto}.rhdocs rh-table table{margin:0;max-width:9999em;overflow:visible}.rhdocs td,.rhdocs th{border-left:0;padding:.5em 1rem;transition:background .25s ease-out}.rhdocs td.content--md[class][class],.rhdocs th.content--md[class][class]{min-width:13em}.rhdocs td.content--lg[class][class],.rhdocs th.content--lg[class][class]{min-width:20em}.rhdocs thead th{padding-top:1.5em}.rhdocs caption{color:currentColor;color:var(--pfe-table__caption--Color,currentColor);font-weight:700;margin-bottom:.5rem;margin-top:.5rem;text-align:center}.rhdocs .revhistory table td,.rhdocs .revhistory table th{border-color:transparent}.rhdocs .revhistory table td{padding:.625rem .875rem}.rhdocs .revhistory table.simplelist{margin:0}@media print{#masthead{display:none!important}}.rh-table--is-full-screen #to-top{display:none}.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:var(--rh-font-family-body-text,RedHatText,"Red Hat Text","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-body-copy-lage,1.125rem);line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs rh-codeblock::slotted(#content){border-radius:.25rem;padding:var (--rh-space-lg,16px)}.rhdocs rh-codeblock .screen{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs rh-codeblock[class][class][class][class][class]{max-width:99999em}.rhdocs .codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.rhdocs .codeblock__copy:focus{outline:.0625rem dashed currentcolor}.rhdocs .codeblock__copy svg#icon--copy{height:1rem;width:1rem}.rhdocs pre{border:0;max-height:-moz-max-content;max-height:max-content}.rhdocs pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre,.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre[class]{margin:0;padding:0;position:relative}.rhdocs code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs code.literal{background:#eee;border-radius:.25rem;color:#000;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs code.literal,.rhdocs kbd,.rhdocs span.keycap{font-family:RedHatMono,Red Hat Mono,Consolas,monospace}.rhdocs kbd,.rhdocs span.keycap{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ._additional-resources[class][class],.rhdocs ._additional-resources[class][class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.rhdocs ._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.rhdocs ._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.rhdocs ._additional-resources[class][class] li:last-child{border:0}.rhdocs section.section#additional_resource .additional-resources__heading,.rhdocs section.section#additional_resource .heading,.rhdocs section.section#additional_resource h1,.rhdocs section.section#additional_resource h2,.rhdocs section.section#additional_resource h3,.rhdocs section.section#additional_resource h4,.rhdocs section.section#additional_resource h5,.rhdocs section.section#additional_resource h6,.rhdocs section.section#additional_resource p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.rhdocs section.section:first-of-type{margin-top:var(--rh-space-4xl,64px)}.rhdocs section.section p{margin-bottom:var(--rh-space-lg,16px);margin-top:0;word-wrap:break-word}.rhdocs .section.section h1,.rhdocs .section.section h2,.rhdocs .section.section h3,.rhdocs .section.section h4,.rhdocs .section.section h5,.rhdocs .section.section h6,.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h1:first-of-type,.rhdocs h2:first-of-type,.rhdocs h3:first-of-type,.rhdocs h4:first-of-type,.rhdocs h5:first-of-type,.rhdocs h6:first-of-type{margin-top:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h2,.rhdocs section.section h2{font-size:var(--rh-font-size-heading-md,1.75rem)}.rhdocs h3,.rhdocs section.section h3{font-size:1.5rem;font-weight:400}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs dl{display:block;margin-block-end:1em;margin-block-start:1em;margin-inline-end:0;margin-inline-start:0}.rhdocs .para{margin:1.49963rem 0}.rhdocs dl.calloutlist[class] dt{float:none;margin:0;padding:0}.rhdocs dl.calloutlist[class] dd>:last-child{margin-bottom:0}.rhdocs dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:fit-content(40%) 1fr}.rhdocs .calloutlist dt{clear:left;display:flex;flex-wrap:wrap;float:left;margin:0;padding:0 .5rem 0 0}.rhdocs .calloutlist dt a:not(:first-child){padding-left:4px}.rhdocs dl.calloutlist[class] dd{margin:0;padding:0}.rhdocs .callout,.rhdocs .colist>ol>li:before,.rhdocs .conum{background:#06c;border-radius:50%;color:#fff;display:inline-block;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:.75rem;font-style:normal;font-weight:600;height:1.25rem;line-height:1.35rem;padding:0;position:relative;text-align:center;top:-.125em;vertical-align:middle;width:1.25rem}.rhdocs img,.rhdocs object,.rhdocs svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs .titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.rhdocs[class] .author{margin-bottom:1.5rem}.rhdocs[class] .author .author{margin-bottom:0}.rhdocs .para>.title[class],p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0}.rhdocs .example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}.rhdocs code{background:#eee;color:#000;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs .para[class]{margin-bottom:1.49963rem}.rhdocs[class] code.email{background-color:transparent;font:inherit;padding:0}rh-alert.admonition #description,rh-alert.admonition p{font-size:var(--rh-font-size-body-text-md,1rem)}rh-alert{width:-moz-fit-content;width:fit-content}.rhdocs .producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.rhdocs dl{margin:1rem 0}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs ol ol{list-style:lower-roman}.rhdocs .codeblock--processed pf-clipboard-copy::part(input),.rhdocs .codeblock--processed pf-clipboard-copy::part(span){display:none}.token.tag{color:#c9190b}.calloutlist div.para{margin:0}rh-alert.admonition{margin-bottom:var(--rh-space-lg,1rem)}.guibutton,.guimenu,.guimenuitem{font-weight:700}.guibutton{font-size:90%;padding:.1875rem}.guibutton:before{content:"["}.guibutton:after{content:"]"}.docs-content-container,.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}pre[hidden]{display:none}.codeblock[class][class][class][class][class]{max-width:99999em}.codeblock__wrapper{background:var(--rh-color-surface-lighter,#f2f2f2);margin:1rem 0;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__inner-wrapper:after{content:"";display:block;min-height:.625rem;width:4.375rem}.codeblock__copy{--pfe-clipboard--icon--Color--hover:#06c;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));padding:.3125rem .375rem;position:absolute;top:1rem;width:1.75rem;z-index:2}.codeblock__inner-wrapper pre{border:0;max-height:-moz-max-content;max-height:max-content}.pfe-clipboard:not([copied]) .pfe-clipboard__text--success,:host(:not([copied])) .pfe-clipboard__text--success{display:none!important}.codeblock[class]{margin:0;overflow:visible;padding-right:0}pre{display:block;font-size:.8125rem;line-height:1.42857;margin:0 0 .625rem;word-break:break-all;word-wrap:break-word;background-color:var(--rh-color-surface-lighter,#f2f2f2);border:.0625rem solid #ccc;border-radius:.25rem;color:#333}.docs-content-container pre,.rhdocs pre{background:var(--rh-color-surface-lighter,#f2f2f2);color:#151515;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs pre[class]{line-height:1.6667;overflow-x:auto}rh-codeblock pre[class][class]{overflow-x:auto}.pfe-clipboard__text--success{background-color:#ddd;border:1px solid #000;border-radius:2px}*,:after,:before{box-sizing:border-box}:root{--rh-space-xs:4px;--rh-space-sm:6px;--rh-space-md:8px;--rh-space-lg:16px;--rh-space-xl:24px;--rh-space-2xl:32px;--rh-space-3xl:48px;--rh-space-4xl:64px;--rh-space-5xl:80px;--rh-space-6xl:96px;--rh-space-7xl:128px;--rh-font-size-body-text-xs:.75rem;--rh-font-size-body-text-sm:.875rem;--rh-font-size-body-text-md:1rem;--rh-font-size-body-text-lg:1.125rem;--rh-font-size-body-text-xl:1.25rem;--rh-font-size-body-text-2xl:1.5rem;--rh-font-size-heading-xs:1.25rem;--rh-font-size-heading-sm:1.5rem;--rh-font-size-heading-md:1.75rem;--rh-font-size-heading-lg:2.25rem;--rh-font-size-heading-xl:2.5rem;--rh-font-size-heading-2xl:3rem;--pfe-navigation--logo--maxWidth:200px;--pfe-navigation__logo--height:40px;--pfe-navigation--fade-transition-delay:500ms;--pfe-navigation__nav-bar--highlight-color:var(--rh-color-brand-red-on-dark,#e00);--pf-global--icon--FontSize--sm:.75rem}body,html{font-family:Red Hat Text,sans-serif;font-size:var(--rh-font-size-body-text-md,1rem);line-height:var(--rh-line-height-body-text,1.5);margin:0}h1,h2,h3,h4,h5,h6{font-family:Red Hat Display,sans-serif;font-weight:400;line-height:var(--rh-line-height-heading,1.3)}h1{font-size:var(--rh-font-size-heading-2xl,3rem);line-height:62px}h2{font-size:var(--rh-font-size-heading-xl,2.5rem);line-height:48px}h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}h4{font-size:var(--rh-font-size-heading-md,2.25rem)}h5{font-size:var(--rh-font-size-heading-sm,2.25rem)}h6{font-size:var(--rh-font-size-heading-xs,2.25rem)}main{line-height:30px}section{padding-bottom:3rem;padding-top:3rem}img{height:auto;max-width:100%}a{color:var(--rh-color-interactive-blue-darker,#06c);text-decoration:none}a:hover{color:var(--rh-color-interactive-blue-darkest,#004080)}rh-alert.html-container a{text-decoration:underline}.container{padding-left:12px;padding-right:12px}.container,.container-fluid{margin-left:auto;margin-right:auto;width:100%}.container-fluid{padding:12px}@media (min-width:576px){.container{max-width:540px}}@media (min-width:768px){.container{max-width:720px}}@media (min-width:992px){.container{max-width:960px}}@media (min-width:1200px){.container{min-width:1140px}}@media (min-width:1400px){.container{min-width:1320px}}.grid{display:grid;gap:var(--rh-space-xl,24px)}.grid-center{margin:auto}.grid.grid-col-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-12{grid-template-columns:repeat(12,1fr)}@media (min-width:768px){.grid.grid-col-md-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-md-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-md-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-md-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-md-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-md-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-md-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-md-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-md-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-md-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-md-12{grid-template-columns:repeat(12,1fr)}}@media (min-width:992px){.grid.grid-col-lg-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-lg-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-lg-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-lg-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-lg-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-lg-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-lg-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-lg-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-lg-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-lg-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-lg-12{grid-template-columns:repeat(12,1fr)}}.span-1{grid-column:span 1}.span-2{grid-column:span 2}.span-3{grid-column:span 3}.span-4{grid-column:span 4}.span-5{grid-column:span 5}.span-6{grid-column:span 6}.span-7{grid-column:span 7}.span-8{grid-column:span 8}.span-9{grid-column:span 9}.span-10{grid-column:span 10}.span-11{grid-column:span 11}.span-12{grid-column:span 12}@media (min-width:399px){.span-xs-1{grid-column:span 1}.span-xs-2{grid-column:span 2}.span-xs-3{grid-column:span 3}.span-xs-4{grid-column:span 4}.span-xs-5{grid-column:span 5}.span-xs-6{grid-column:span 6}.span-xs-7{grid-column:span 7}.span-xs-8{grid-column:span 8}.span-xs-9{grid-column:span 9}.span-xs-10{grid-column:span 10}.span-xs-11{grid-column:span 11}.span-xs-12{grid-column:span 12}}@media (min-width:768px){.span-md-1{grid-column:span 1}.span-md-2{grid-column:span 2}.span-md-3{grid-column:span 3}.span-md-4{grid-column:span 4}.span-md-5{grid-column:span 5}.span-md-6{grid-column:span 6}.span-md-7{grid-column:span 7}.span-md-8{grid-column:span 8}.span-md-9{grid-column:span 9}.span-md-10{grid-column:span 10}.span-md-11{grid-column:span 11}.span-md-12{grid-column:span 12}}@media (min-width:992px){.span-lg-1{grid-column:span 1}.span-lg-2{grid-column:span 2}.span-lg-3{grid-column:span 3}.span-lg-4{grid-column:span 4}.span-lg-5{grid-column:span 5}.span-lg-6{grid-column:span 6}.span-lg-7{grid-column:span 7}.span-lg-8{grid-column:span 8}.span-lg-9{grid-column:span 9}.span-lg-10{grid-column:span 10}.span-lg-11{grid-column:span 11}.span-lg-12{grid-column:span 12}}@media (min-width:1025px){.span-xl-1{grid-column:span 1}.span-xl-2{grid-column:span 2}.span-xl-3{grid-column:span 3}.span-xl-4{grid-column:span 4}.span-xl-5{grid-column:span 5}.span-xl-6{grid-column:span 6}.span-xl-7{grid-column:span 7}.span-xl-8{grid-column:span 8}.span-xl-9{grid-column:span 9}.span-xl-10{grid-column:span 10}.span-xl-11{grid-column:span 11}.span-xl-12{grid-column:span 12}}@media (min-width:1200px){.span-2xl-1{grid-column:span 1}.span-2xl-2{grid-column:span 2}.span-2xl-3{grid-column:span 3}.span-2xl-4{grid-column:span 4}.span-2xl-5{grid-column:span 5}.span-2xl-6{grid-column:span 6}.span-2xl-7{grid-column:span 7}.span-2xl-8{grid-column:span 8}.span-2xl-9{grid-column:span 9}.span-2xl-10{grid-column:span 10}.span-2xl-11{grid-column:span 11}.span-2xl-12{grid-column:span 12}}.flex{display:flex;flex-direction:column;gap:var(--rh-space-lg,16px)}.flex-row{flex-direction:row}.flex-column{flex-direction:column}@media (min-width:768px){.flex-md-row{flex-direction:row}.flex-md-column{flex-direction:column}}.typography-h1{font-size:var(--rh-font-size-heading-2xl,3rem)}.typography-h2{font-size:var(--rh-font-size-heading-xl,2.5rem)}.typography-h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}.typography-h4{font-size:var(--rh-font-size-heading-md,1.75rem)}.typography-h5{font-size:var(--rh-font-size-heading-sm,1.5rem)}.typography-h6{font-size:var(--rh-font-size-heading-xs,1.25rem)}.content section{padding:0}.content h1,.content h2,.content h3,.content h4,.content h5,.content h6{margin:var(--rh-space-lg,16px) 0}.sr-only{height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0}.list-unstyled{list-style:none;padding-left:0}.tooltip-content{align-items:center;display:flex;font-family:Red Hat Text;justify-content:center;text-transform:none}.tooltip-content .check-icon{margin-left:var(--rh-space-md,8px)}.doc-image-link{display:inline-block;text-decoration:none}.modal-img{display:block;width:100%}.modal-helper-text{margin-top:.5rem;text-align:center}.modal-helper-text a{color:#000;cursor:pointer}.modal-helper-text a:hover{text-decoration:underline}.modal-helper-text a:after{content:"⿻";margin-left:.25rem}pf-modal.pf-img-modal{--pf-c-modal-box--MaxHeight:90vh;overflow-y:scroll}pf-modal.pf-img-modal::part(close-button){background-color:#fff;border-radius:50%;color:#000;margin-right:-2rem;margin-top:-2rem}pf-modal.pf-img-modal::part(close-button):hover{opacity:.7}h2.truste-title{line-height:normal;margin-top:0}rh-alert p[slot=header]{color:#002952}@media (width < 992px){html:has(nav.mobile-nav .mobile-nav-wrapper){scroll-behavior:smooth;scroll-padding-top:4rem}html:has(nav.mobile-nav .mobile-jump-links){scroll-padding-top:7rem}html:has(nav.mobile-nav.hide-mobile-nav){scroll-padding-top:2rem}}.highlight{background:#fff4cc;color:#000}</style>
<style>rh-alert[data-v-84359384]{width:100%}</style>
<style>.search-btn[data-v-edc0d12c]{align-items:center;background-color:var(--rh-color-canvas-black,#151515);border:3px solid var(--rh-color-canvas-black,#151515);cursor:pointer;display:flex;flex-direction:column;height:100%;justify-content:center;outline:none;padding:14px var(--rh-space-md,8px)}.search-btn[data-v-edc0d12c]:focus{border-top:3px solid var(--rh-color-accent-brand-on-light,#e00);outline:2px dotted var(--rh-color-white,#fff)}.search-btn .search-icon[data-v-edc0d12c]{height:26px;padding:2px 0 var(--rh-space-xs,4px);width:20px}.search-btn .search-icon[data-v-edc0d12c],.search-icon-helper-text[data-v-edc0d12c]{color:var(--rh-color-white,#fff)}.search-mobile[data-v-edc0d12c]{margin-bottom:var(--rh-space-2xl,32px)}.search-mobile form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto}.search-box[data-v-edc0d12c]{width:35rem}nav[data-v-edc0d12c]{background-color:#151515;justify-content:space-between;width:100%}a[data-v-edc0d12c],a[data-v-edc0d12c]:visited{color:#fff;display:inline-block;font-size:var(--rh-font-size-body-text-md,1rem)}.skip-link[class][class][data-v-edc0d12c]{font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class][data-v-edc0d12c]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}.visually-hidden[data-v-edc0d12c]{border:1px solid #06c;height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);white-space:nowrap}h3[data-v-edc0d12c]{color:#464646;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-lg,1.125rem)}.language-picker[data-v-edc0d12c]{align-items:center;background-color:#fff;display:flex;flex-direction:column;padding:var(--rh-space-xl,24px);width:100%}.language-picker h3[data-v-edc0d12c]{margin:0;padding:0 1rem 1rem}.language-picker ul[data-v-edc0d12c]{margin:0;padding:0}.language-picker a[data-v-edc0d12c]{color:#06c}.language-picker li[data-v-edc0d12c]{list-style:none}.language-dropdown[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:block!important;position:absolute;right:0;width:100%;z-index:104}.pfe-navigation.pfe-navigation--processed>[slot=secondary-links][data-v-edc0d12c]{height:auto;overflow:visible;visibility:visible;width:auto}.upper-navigation[data-v-edc0d12c]{padding:0 var(--rh-space-2xl,32px)}.upper-nav-container[data-v-edc0d12c]{border-bottom:1px solid #404040;margin:0}.upper-nav-hidden[data-v-edc0d12c]:not(:focus):not(:active){clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.upper-nav-menu[data-v-edc0d12c]{align-items:center;display:flex;justify-content:flex-end;line-height:1.444;list-style:none;margin-bottom:0;margin-top:0;padding-left:0}.upper-nav-menu[data-v-edc0d12c],.upper-nav-menu>li[data-v-edc0d12c]{position:relative}.upper-nav-menu>li:not(:first-child)>a[data-v-edc0d12c]:before,.upper-nav-menu>li:not(:first-child)>button[data-v-edc0d12c]:before{background-color:#404040;content:"";height:40%;left:0;position:absolute;top:30%;width:1px}li[data-v-edc0d12c]{display:list-item;margin:0;padding:0;text-align:-webkit-match-parent}.upper-nav-menu button.upper-nav-links[data-v-edc0d12c]{border:0;border-top:3px solid transparent;cursor:pointer;line-height:1.444}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]{outline-color:#151515}.upper-nav-menu button.upper-nav-links[aria-expanded=true] .upper-nav-arrow[data-v-edc0d12c]{filter:invert(0) sepia(2%) saturate(21%) hue-rotate(257deg) brightness(108%) contrast(100%);transform:rotate(270deg)}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]:before{display:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]{background-color:var(--pfe-navigation--BackgroundColor,var(--pfe-theme--color--surface--darkest,#151515));border-top:3px solid transparent;color:#fff;display:block;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);outline:none;padding:12px 12px 14px;text-decoration:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:hover{border-top-color:#b8bbbe}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within{outline:1px dashed var(--rh-color-white,#fff);outline-offset:-1px}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within:before{display:none}.upper-nav-dropdown-container[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:none;padding:5px 30px 24px;position:absolute;right:0;top:100%;width:500px;z-index:105}.upper-nav-dropdown-container>ul[data-v-edc0d12c]{-moz-column-count:2;column-count:2;list-style-type:none;padding:0;width:auto}.upper-nav-dropdown-container>ul li[data-v-edc0d12c]{color:#151515;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);list-style-type:none;margin-bottom:0}.upper-nav-dropdown-container>ul li span[data-v-edc0d12c]{font-weight:var(--rh-font-weight-body-text-medium,500)}.upper-nav-dropdown-container>ul ul[data-v-edc0d12c]{padding-left:0;padding-top:9px}.upper-nav-dropdown-container>ul>li[data-v-edc0d12c]{padding-top:19px;-moz-column-break-inside:avoid;break-inside:avoid}.upper-nav-dropdown-container>ul>li>ul>li[data-v-edc0d12c]{line-height:1.45;padding:4px 0}.upper-nav-menu .upper-nav-arrow[data-v-edc0d12c]{display:inline-block;filter:invert(100%) sepia(8%) saturate(7%) hue-rotate(1turn) brightness(100%) contrast(93%);height:18px;margin-left:5px;transform:rotate(90deg);vertical-align:middle;width:8px}#pfe-navigation__secondary-links .show[data-v-edc0d12c],.upper-navigation .show[data-v-edc0d12c]{display:block}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:active,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:focus,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:hover{background-color:#fff;color:#151515}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]{background-color:#fff;border-top-color:#b8bbbe;color:#000;position:relative;z-index:1}.upper-nav-dropdown-container>ul a[data-v-edc0d12c]{color:var(--rh-color-accent-base-on-light,#06c);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;text-decoration:none}.pfe-navigation__search[data-v-edc0d12c]{background-color:var(--rh-color-white,#fff)}.pfe-navigation__search form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto;max-width:992px}pfe-navigation [slot=secondary-links] .buttons[data-v-edc0d12c]{display:flex;flex-wrap:wrap;gap:var(--rh-space-md,8px);margin-top:4px}pfe-navigation [slot=secondary-links] .buttons a[data-v-edc0d12c]{border:1px solid #d2d2d2;border-radius:3px;color:#06c;cursor:pointer;flex-basis:calc(50% - 5px);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-weight:var(--rh-font-weight-code-regular,400);padding:1em;text-align:center;text-decoration:none}pfe-navigation [slot=secondary-links] .mobile-lang-select[data-v-edc0d12c]{border:1px solid #d2d2d2;border-bottom-color:#3c3f42;cursor:pointer;display:flex;margin:3rem 0;position:relative}pfe-navigation [slot=secondary-links] .mobile-lang-select label[data-v-edc0d12c]{bottom:100%;color:#000;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;font-weight:500;margin-bottom:5px;position:absolute}pfe-navigation [slot=secondary-links] .mobile-lang-select select[data-v-edc0d12c]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border-style:none;color:#000;flex-basis:100%;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:16px;line-height:24px;padding:6px 24px 6px 8px}select[data-v-edc0d12c]{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position:98% 50%;background-repeat:no-repeat}#inputLabel[data-v-edc0d12c]{align-items:center;display:flex;position:relative}#inputLabel form[data-v-edc0d12c]{width:100%}.input-box[data-v-edc0d12c]{font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 8px;width:100%}.input-box[data-v-edc0d12c]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-box[data-v-edc0d12c]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}@media(max-width:960px){.search-box[data-v-edc0d12c]{width:28rem}}@media (max-width:768px){.right-navigation[data-v-edc0d12c],.upper-navigation[data-v-edc0d12c]{display:none}}@media (min-width:767px){.pfe-navigation__search form[data-v-edc0d12c]{padding:var(--rh-space-2xl,32px) 0}}</style>
<style>.element-invisible,.sr-only,.visually-hidden{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;white-space:nowrap}@keyframes reveal-nav{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@keyframes reveal-nav-parts{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}1%{visibility:visible}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@media print{.pfe-navigation__menu,pfe-navigation [slot]{display:none!important}}pfe-navigation{--pfe-broadcasted--text:var(--pfe-theme--color--text,#151515);--pfe-broadcasted--text--muted:var(--pfe-theme--color--text--muted,#6a6e73);--pfe-broadcasted--link:var(--pfe-theme--color--link,#06c);--pfe-broadcasted--link--hover:var(--pfe-theme--color--link--hover,#004080);--pfe-broadcasted--link--focus:var(--pfe-theme--color--link--focus,#004080);--pfe-broadcasted--link--visited:var(--pfe-theme--color--link--visited,#6753ac);--pfe-broadcasted--link-decoration:var(--pfe-theme--link-decoration,none);--pfe-broadcasted--link-decoration--hover:var(--pfe-theme--link-decoration--hover,underline);--pfe-broadcasted--link-decoration--focus:var(--pfe-theme--link-decoration--focus,underline);--pfe-broadcasted--link-decoration--visited:var(--pfe-theme--link-decoration--visited,none)}@supports (display:grid){pfe-navigation{animation:reveal-nav .1618s 4s 1 forwards;max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}pfe-navigation>*{animation:reveal-nav-parts .1618s 4s 1 forwards;opacity:0;transition:opacity .1618s ease-in-out;transition:opacity var(--pfe-reveal-duration,.1618s) ease-in-out;visibility:hidden}}pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed>*{animation:none;opacity:1;visibility:visible}pfe-navigation pfe-primary-detail{display:none}pfe-navigation[pfelement]{display:block}pfe-navigation-dropdown{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515)}#pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],#pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],#pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class],pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class]{display:none}#pfe-navigation,#pfe-navigation *,pfe-navigation,pfe-navigation *{box-sizing:border-box}#pfe-navigation [pfelement] .pfe-navigation__log-in-link,pfe-navigation [pfelement] .pfe-navigation__log-in-link{display:none}#pfe-navigation,pfe-navigation{align-items:stretch;background:#151515;background:var(--pfe-navigation__nav-bar--Background,#151515);color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;font-family:Red Hat Text,RedHatText,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamily,Red Hat Text,RedHatText,Arial,Helvetica,sans-serif);font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);height:auto;line-height:1.5;margin:0;max-width:9999em;min-height:72px;min-height:var(--pfe-navigation__nav-bar--Height,72px);padding:0 16px;position:relative;z-index:95;z-index:var(--pfe-navigation--ZIndex,var(--pfe-theme--zindex--navigation,95))}@media (min-width:768px){#pfe-navigation,pfe-navigation{flex-wrap:wrap;margin:0;max-width:9999em;padding:0 16px}}@media (min-width:1200px){#pfe-navigation,pfe-navigation{margin:0 auto;padding:0 32px}}#pfe-navigation .pfe-navigation__dropdown,#pfe-navigation pfe-navigation-dropdown,pfe-navigation .pfe-navigation__dropdown,pfe-navigation pfe-navigation-dropdown{display:none}#pfe-navigation>[slot=account],#pfe-navigation>[slot=search],#pfe-navigation>[slot=secondary-links],pfe-navigation>[slot=account],pfe-navigation>[slot=search],pfe-navigation>[slot=secondary-links]{height:0;overflow:hidden;visibility:hidden;width:0}@media (min-width:768px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{align-items:stretch;display:flex;flex-wrap:wrap}}@media (min-width:992px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{flex-wrap:nowrap}}#pfe-navigation .pfe-navigation__logo-wrapper,pfe-navigation .pfe-navigation__logo-wrapper{align-items:center;display:flex;justify-content:flex-start;margin:0;min-width:150px;padding:10px 16px 10px 0}@media (min-width:768px){.pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:auto}}.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:0}#pfe-navigation .pfe-navigation__logo-link,pfe-navigation .pfe-navigation__logo-link{border-radius:3px;display:block;margin-left:-8px;outline:0;padding:6px 8px;position:relative}#pfe-navigation .pfe-navigation__logo-link:focus,pfe-navigation .pfe-navigation__logo-link:focus{outline:0}#pfe-navigation .pfe-navigation__logo-link:focus:after,pfe-navigation .pfe-navigation__logo-link:focus:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:block;height:auto;width:100%}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{height:40px;height:var(--pfe-navigation__logo--height,40px);width:auto}}@media print{#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:none}}#pfe-navigation .pfe-navigation__logo-image:only-child,pfe-navigation .pfe-navigation__logo-image:only-child{display:block}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small{height:32px;height:var(--pfe-navigation__logo--height,32px)}}@media print{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen{display:none!important}}@media screen{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print{display:none!important}}#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print{display:inline-block!important}#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;justify-content:center;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{display:none!important}}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__fallback-links a[class]:focus,#pfe-navigation .pfe-navigation__fallback-links a[class]:hover,#pfe-navigation .pfe-navigation__log-in-link[class]:focus,#pfe-navigation .pfe-navigation__log-in-link[class]:hover,#pfe-navigation .pfe-navigation__menu-link[class]:focus,#pfe-navigation .pfe-navigation__menu-link[class]:hover,#pfe-navigation .pfe-navigation__secondary-link[class]:focus,#pfe-navigation .pfe-navigation__secondary-link[class]:hover,pfe-navigation .pfe-navigation__fallback-links a[class]:focus,pfe-navigation .pfe-navigation__fallback-links a[class]:hover,pfe-navigation .pfe-navigation__log-in-link[class]:focus,pfe-navigation .pfe-navigation__log-in-link[class]:hover,pfe-navigation .pfe-navigation__menu-link[class]:focus,pfe-navigation .pfe-navigation__menu-link[class]:hover,pfe-navigation .pfe-navigation__secondary-link[class]:focus,pfe-navigation .pfe-navigation__secondary-link[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__secondary-link:focus{outline:0}#pfe-navigation .pfe-navigation__fallback-links a:focus:after,#pfe-navigation .pfe-navigation__log-in-link:focus:after,#pfe-navigation .pfe-navigation__menu-link:focus:after,#pfe-navigation .pfe-navigation__secondary-link:focus:after,pfe-navigation .pfe-navigation__fallback-links a:focus:after,pfe-navigation .pfe-navigation__log-in-link:focus:after,pfe-navigation .pfe-navigation__menu-link:focus:after,pfe-navigation .pfe-navigation__secondary-link:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{pointer-events:none}#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding:0 16px 0 0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{display:block;height:18px}#pfe-navigation .pfe-navigation__fallback-links a[class],#pfe-navigation .pfe-navigation__fallback-links a[href],#pfe-navigation .pfe-navigation__log-in-link[class],#pfe-navigation .pfe-navigation__log-in-link[href],#pfe-navigation .pfe-navigation__menu-link[class],#pfe-navigation .pfe-navigation__menu-link[href],#pfe-navigation .pfe-navigation__secondary-link[class],#pfe-navigation .pfe-navigation__secondary-link[href],pfe-navigation .pfe-navigation__fallback-links a[class],pfe-navigation .pfe-navigation__fallback-links a[href],pfe-navigation .pfe-navigation__log-in-link[class],pfe-navigation .pfe-navigation__log-in-link[href],pfe-navigation .pfe-navigation__menu-link[class],pfe-navigation .pfe-navigation__menu-link[href],pfe-navigation .pfe-navigation__secondary-link[class],pfe-navigation .pfe-navigation__secondary-link[href]{align-items:center;justify-content:center}#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%;--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none!important}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation [slot=account]>a[href]:focus,#pfe-navigation [slot=account]>a[href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation [slot=account]>a[href]:focus,pfe-navigation [slot=account]>a[href]:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation [slot=account]>a[href]:focus,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation [slot=account]>a[href]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle:focus:after,#pfe-navigation [slot=account]>a[href]:focus:after,pfe-navigation .pfe-navigation__account-toggle:focus:after,pfe-navigation [slot=account]>a[href]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{pointer-events:none}@supports (display:grid){#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__account-toggle[class]:focus,#pfe-navigation .pfe-navigation__account-toggle[class]:hover,#pfe-navigation [slot=account]>a[href][class]:focus,#pfe-navigation [slot=account]>a[href][class]:hover,pfe-navigation .pfe-navigation__account-toggle[class]:focus,pfe-navigation .pfe-navigation__account-toggle[class]:hover,pfe-navigation [slot=account]>a[href][class]:focus,pfe-navigation [slot=account]>a[href][class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none}}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{--pfe-icon--size:18px;padding:2px 0 4px}@media (min-width:768px){#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{padding-right:0}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],#pfe-navigation [slot=account]>a[href][href]:focus,#pfe-navigation [slot=account]>a[href][href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation [slot=account]>a[href][href]:focus,pfe-navigation [slot=account]>a[href][href]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after{border:1px dashed #151515;border:1px dashed var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{font-size:inherit;list-style:none;margin:0;padding:0}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{align-items:stretch;display:flex}}#pfe-navigation .pfe-navigation__fallback-links li,#pfe-navigation .pfe-navigation__menu li,pfe-navigation .pfe-navigation__fallback-links li,pfe-navigation .pfe-navigation__menu li{font-size:inherit;margin:0;padding:0}#pfe-navigation .pfe-navigation__fallback-links li:before,#pfe-navigation .pfe-navigation__menu li:before,pfe-navigation .pfe-navigation__fallback-links li:before,pfe-navigation .pfe-navigation__menu li:before{content:none}#pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__fallback-links{margin-left:auto}#pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__menu-link{display:flex;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);white-space:nowrap}#pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed{display:block;padding:0}#pfe-navigation.pfe-navigation--processed:before,pfe-navigation.pfe-navigation--processed:before{content:none}#pfe-navigation.pfe-navigation--processed>[slot=account],#pfe-navigation.pfe-navigation--processed>[slot=search],#pfe-navigation.pfe-navigation--processed>[slot=secondary-links],pfe-navigation.pfe-navigation--processed>[slot=account],pfe-navigation.pfe-navigation--processed>[slot=search],pfe-navigation.pfe-navigation--processed>[slot=secondary-links]{height:auto;overflow:visible;visibility:visible;width:auto}#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,#pfe-navigation.pfe-navigation--processed>[slot],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed>[slot]{animation:none;opacity:1}#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{display:block;height:auto;list-style:none;margin:0 0 8px;padding:0;width:auto}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0 0 8px}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{display:none!important}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{pointer-events:none}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding:0 16px 0 0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{display:block;height:18px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed #fff;border:1px dashed var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{box-shadow:none}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{background:0 0;box-shadow:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column{position:relative}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper{display:block}#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{height:0;transition:height .25s ease-in-out;transition:var(--pfe-navigation--accordion-transition,height .25s ease-in-out)}@media (prefers-reduced-motion){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{transition:none}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:absolute;right:0;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:auto}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:0}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper{left:100vw;left:calc(100vw - 32px);left:calc(100vw - var(--pfe-navigation__mobile-dropdown--PaddingHorizontal,32px));position:absolute;top:0;width:100vw}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false],pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false]{height:100vh;height:calc(100vh - 72px);height:calc(100vh - var(--pfe-navigation__nav-bar--Height,72px));overflow-y:scroll}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 64px24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px) var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a{border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));display:inline-block}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6{margin:32px 0 .75em;margin:var(--pfe-navigation--gutter,32px) 0 .75em;padding:0;-moz-column-break-inside:avoid;break-inside:avoid;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);font-family:Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamilyHeadline,Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif);font-size:1.125rem;font-size:var(--pf-global--FontSize--lg,1.125rem);font-weight:500}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a{border:1px solid transparent;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li{margin:0 0 16px;-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--BackgroundColor,#e00);--pfe-cta--BackgroundColor--hover:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00);--pfe-theme--ui--border-width:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00)}pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul{list-style:none;margin:0;padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515);-moz-column-count:auto;column-count:auto;display:block;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);gap:0;margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:flex;flex-wrap:wrap;padding-bottom:32px;padding-top:32px}@supports (display:grid){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{display:grid;gap:32px;gap:var(--pfe-navigation--gutter,32px);grid-auto-flow:row;grid-template-columns:repeat(4,minmax(0,1fr))}}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:block;gap:0;margin-left:-16px;margin-right:-16px;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{transition-delay:0s;visibility:visible}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px;-moz-column-break-inside:avoid;break-inside:avoid}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid{max-width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown{background:#fff}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:32px 64px;padding:32px var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px)}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container{margin:0;padding:0;width:auto}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class]{padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown{visibility:hidden}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{padding:0}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:0 1px 2px rgba(0,0,0,.12);box-shadow:var(--pfe-navigation__dropdown--BoxShadow,0 1px 2px rgba(0,0,0,.12));max-width:100%;min-width:13em;padding:0 32px;position:absolute;top:100%}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:none;max-width:100%;position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{right:0}}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{width:100%}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{left:0;position:absolute;right:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{position:static}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown{width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles{padding-left:16px;padding-right:16px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form{align-items:center;display:flex}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{padding:10px;transition:box-shadow .2s}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{border:1px solid #f0f0f0;border-bottom-color:#8b8e91;color:#717579;flex-basis:0%;flex-grow:1;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);margin-right:8px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button{background-color:#e00;border:1px solid #e00;border-radius:2px;color:#fff;flex-basis:auto;flex-grow:0;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after{border:1px dashed #000;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{border-bottom:1px solid #d2d2d2;border-bottom:var(--pfe-navigation__dropdown--separator--Border,1px solid var(--pfe-theme--color--ui--border--lighter,#d2d2d2));display:block}@media (min-width:768px){#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:none}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__site-switcher__back-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:block}#pfe-navigation .pfe-navigation__site-switcher__back-button,pfe-navigation .pfe-navigation__site-switcher__back-button{background-color:transparent;border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);padding:21px 21px 21px 45px;position:relative;text-align:left;width:100%}#pfe-navigation .pfe-navigation__site-switcher__back-button:before,pfe-navigation .pfe-navigation__site-switcher__back-button:before{border:2px solid #06c;border:2px solid var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));border-right:0;border-top:0;content:"";display:block;height:8px;left:35px;position:absolute;right:auto;top:27px;transform:rotate(45deg);transform-origin:left top;width:8px}#pfe-navigation .pfe-navigation__site-switcher__back-button:focus,#pfe-navigation .pfe-navigation__site-switcher__back-button:hover,pfe-navigation .pfe-navigation__site-switcher__back-button:focus,pfe-navigation .pfe-navigation__site-switcher__back-button:hover{border:1px dashed #151515;border-top:1px dashed #151515;border:1px dashed var(--pfe-navigation__dropdown--Color,#151515);color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);outline:0}#pfe-navigation.pfe-navigation--processed site-switcher,pfe-navigation.pfe-navigation--processed site-switcher{-moz-columns:auto;columns:auto;display:block}#pfe-navigation.pfe-navigation--stuck,pfe-navigation.pfe-navigation--stuck{left:0;position:fixed;top:0;width:100%;z-index:95;z-index:var(--pfe-theme--zindex--navigation,95)}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner{opacity:1!important}#pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown{display:none!important}#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown{display:block!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item{display:block}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus{outline:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown{display:flex;flex-wrap:wrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope{flex-basis:25%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope{flex-basis:100%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope{margin-right:16px}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{display:flex;flex-direction:column;flex-wrap:nowrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{flex-basis:auto}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a{color:#fff!important;justify-content:center!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true]{color:#151515!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon{display:none!important}[id=pfe-navigation__account-dropdown][class][class]{display:block;height:auto;left:0;padding:0;position:absolute;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px);width:100%}[id=pfe-navigation__account-dropdown].pfe-navigation__dropdown-wrapper--invisible[class]{display:none}.pfe-navigation__dropdown-wrapper{overflow:hidden}@media (min-width:768px){.pfe-navigation__custom-dropdown--single-column{min-width:25em}}.pfe-navigation--collapse-secondary-links .pfe-navigation__custom-dropdown--single-column{min-width:0}.secondary-link__icon-wrapper{align-items:center;display:flex;justify-content:center}.secondary-link__alert-count{background:#06c;background:var(--pfe-navigation__nav-bar--alert-color,var(--pfe-theme--color--link,#06c));border-radius:20px;color:#fff;color:var(--pfe-navigation__nav-bar--Color--on-highlight,var(--pfe-theme--color--text--on-saturated,#fff));display:block;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);line-height:20px;margin:0 4px 0 2px;min-width:23px;overflow:hidden;padding:0 8px}.secondary-link__alert-count:empty{display:none}#pfe-navigation__1x-skip-links{left:0;position:absolute;top:0}#pfe-navigation__1x-skip-links,#pfe-navigation__1x-skip-links li{height:0;list-style:none;margin:0;padding:0;width:0}.skip-link[class][class]{font-size:.875rem;font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}pfe-navigation pfe-navigation-account[slot=account]{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));width:100%}</style>
<style>:host([size=sm]) #container[data-v-8589d091]{--_size:var(--pf-global--icon--FontSize--sm,12px)}.content-wrapper[data-v-8589d091]{height:auto;margin:0 auto;min-height:46vh}.content[data-v-8589d091]{max-width:1000px}#left-content[data-v-8589d091]{max-width:330px;z-index:1}.line-below-chp[data-v-8589d091]{margin:var(--rh-space-xl,24px) 0 var(--rh-space-3xl,48px)}.toc-container[data-v-8589d091]{border-right:1px solid var(--rh-color-gray-30,#c7c7c7);min-height:100vh;position:sticky;top:0;transition:transform .3s ease-in-out}nav#toc[data-v-8589d091]{height:auto;overflow-y:auto;padding-bottom:var(--rh-space-2xl,32px)}.max-height-85[data-v-8589d091]{max-height:85vh}.max-height-75[data-v-8589d091]{max-height:75vh}.toc-filter[data-v-8589d091]{background-color:#fff;padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px);position:sticky;top:-1px;width:100%;z-index:1}#text[data-v-8589d091],.toc-filter[data-v-8589d091]{align-items:center;display:flex}#text[data-v-8589d091]{flex:1;flex-direction:row}#search-icon[data-v-8589d091]{color:#151515;left:2.5rem;position:absolute;top:55%;transform:translateY(-50%)}pf-icon[data-v-8589d091]{--pf-icon--size:16px}#text:focus-within #icon[data-v-8589d091],#text:hover #icon[data-v-8589d091]{color:#151515}#text[data-v-8589d091]:after,#text[data-v-8589d091]:before{content:"";inset:0;pointer-events:none;position:absolute}#text-input[data-v-8589d091]:focus,#text-input:focus+#utilities[data-v-8589d091]{border-bottom:2px solid #06c;outline:none}#text-input[data-v-8589d091]{background-color:transparent;border:1px solid #f0f0f0;border-bottom-color:#8a8d90;color:#151515;font-family:inherit;font-size:100%;grid-area:text-input;line-height:1.5;overflow:hidden;padding:.375rem .25rem .375rem 2rem;position:relative;text-overflow:ellipsis;white-space:nowrap;width:100%}#utilities[data-v-8589d091]{align-items:center;border:1px solid #f0f0f0;border-bottom:1px solid #8a8d90;border-left:0;display:flex}#utilities rh-badge[data-v-8589d091]{border-radius:80px;font-weight:var(--rh-font-weight-heading-medium,500);--_background-color:#e0e0e0;margin-right:8px}#clear-button[data-v-8589d091]{--pf-c-button--PaddingTop:0.625rem;--pf-c-button--PaddingRight:.25rem;--pf-c-button--PaddingBottom:0.625rem;--pf-c-button--PaddingLeft:.25rem;margin-right:8px}#text-input.no-right-border[data-v-8589d091]{border-right:0}.btn-container[data-v-8589d091]{bottom:0;display:flex;justify-content:flex-end;padding:1rem;pointer-events:none;position:fixed;right:0;z-index:2}.top-scroll-btn[data-v-8589d091]{--pf-c-button--BorderRadius:64px;pointer-events:all}.focusable[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-interactive-blue,#06c)}.mobile-nav-wrapper[data-v-8589d091]{align-items:center;border-bottom:1px solid #c7c7c7;display:flex;height:auto;justify-content:space-between;padding:var(--rh-space-sm,.5rem)}.mobile-nav[data-v-8589d091]{align-items:center;background-color:var(--rh-color-bg-page,#fff);min-height:51px;position:sticky;top:0;z-index:5}.active-mobile-menu[data-v-8589d091]{color:#151515;padding-left:.5rem}.hidden[data-v-8589d091]{display:none}.mobile-nav-btn[data-v-8589d091]{background-color:transparent;border:none;font-family:inherit;font-size:.875rem;font-weight:500;margin:0;min-height:40px;min-width:40px}.border-right[data-v-8589d091]{border-right:1px solid #c7c7c7}.toc-focus-container[data-v-8589d091]{position:sticky;top:0;z-index:2}.toc-focus-btn[data-v-8589d091]{align-items:center;background-color:var(--rh-color-white,#fff);border:1px solid var(--rh-color-blue-50,#06c);border-radius:50%;cursor:pointer;display:flex;height:40px;justify-content:center;position:absolute;right:-20px;top:15px;width:40px}.toc-focus-btn[data-v-8589d091]:focus-visible,.toc-focus-btn[data-v-8589d091]:hover{background-color:var(--rh-color-blue-10,#e0f0ff);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2))}.toc-focus-btn[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-blue-50,#06c)}.toc-focus-btn-icon[data-v-8589d091]{color:var(--rh-color-blue-50,#06c)}.toc-wrapper[data-v-8589d091]{padding:0}.product-container[data-v-8589d091]{border-bottom:1px solid var(--rh-color-gray-30,#c7c7c7);padding:var(--rh-space-xl,24px) var(--rh-space-2xl,32px)}.product-container h1.product-title[data-v-8589d091]{font-size:var(--rh-font-size-code-xl,1.25rem);line-height:30px;margin-bottom:0;margin-top:0}.product-container .product-version[data-v-8589d091]{align-items:center;display:flex;flex-wrap:wrap;margin-top:var(--rh-space-lg,16px)}.product-version .version-label[data-v-8589d091]{color:var(--rh-color-canvas-black,#151515);font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:500}.product-version .version-select-dropdown[data-v-8589d091]{margin:var(--rh-space-md,8px) var(--rh-space-sm,6px);max-width:9.75rem;min-height:2rem;min-width:3rem;overflow:hidden;width:-moz-min-content;width:min-content;word-wrap:nowrap;-webkit-appearance:none;-moz-appearance:none;background:var(--rh-color-white,#fff);background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position-x:85%;background-position-y:50%;background-repeat:no-repeat;border:1px solid var(--rh-color-gray-30,#c7c7c7);border-bottom:0;box-shadow:0 -1px 0 0 var(--rh-color-gray-60,#4d4d4d) inset;cursor:pointer;font-size:var(--rh-font-size-body-text-md,1rem);padding:var(--rh-space-md,8px);padding-right:24px;text-overflow:ellipsis}pf-popover[data-v-8589d091]{margin-top:var(--rh-space-md,8px);--pf-c-popover__arrow--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover__content--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover--BoxShadow:0px 4px 8px 0px #15151540;--pf-c-popover__title-text--Color:var(--rh-color-white,#fff);--pf-c-popover--MaxWidth:300px;--pf-c-popover--MinWidth:300px;--pf-c-popover--c-button--Top:20px;--pf-c-popover--c-button--Right:4px;--pf-c-button--m-plain--hover--Color:var(--rh-color-white,#fff)}pf-popover[data-v-8589d091]::part(content){padding:var(--rh-space-2xl,32px)}pf-popover[data-v-8589d091]::part(body){margin-top:var(--rh-space-lg,16px)}pf-popover[data-v-8589d091]::part(close-button){--pf-c-button--m-plain--focus--Color:var(--rh-color-gray-30,#c7c7c7);--pf-c-button--m-plain--Color:var(--rh-color-gray-30,#c7c7c7)}.popover-header-text[data-v-8589d091]{color:var(--rh-color-white,#fff);font-size:var(--rh-font-size-code-md,1rem);margin:0;max-width:80%;padding:0}.popover-body-link[data-v-8589d091]{color:var(--rh-color-blue-30,#92c5f9);text-decoration:none}.popover-trigger-btn[data-v-8589d091]{align-items:center;background:none;border:none;cursor:pointer;display:flex;justify-content:center}#first-button[data-v-8589d091]{width:80%}#second-button[data-v-8589d091]{text-align:right;width:20%}#toc-btn[data-v-8589d091]{text-align:left;width:100%}.toc-error[data-v-8589d091]{margin:0;max-width:100%}#layout label[data-v-8589d091]{font-weight:500}.page-layout-options[data-v-8589d091]{background-color:#fff;display:flex;flex-direction:column;padding-bottom:var(--rh-space-lg,16px)}.sticky-top[data-v-8589d091]{position:sticky;top:0}summary[data-v-8589d091]{cursor:pointer;list-style:none;position:relative}summary[data-v-8589d091]::-webkit-details-marker{display:none}details#jump-links-details .jump-links-heading[data-v-8589d091]{background-color:var(--rh-color-white,#fff);display:block;margin-top:var(--rh-space-lg,16px);padding:var(--rh-space-lg,16px) 0 0 var(--rh-space-xl,24px);position:sticky;top:0}details#jump-links-details .jump-links-heading[data-v-8589d091]:before{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;height:9px;left:2px;position:absolute;top:26px;transform:rotate(-135deg);width:9px}details#jump-links-details[open] .jump-links-heading[data-v-8589d091]:before{transform:rotate(135deg)}.table-of-contents>ol[data-v-8589d091]{list-style:none;margin:0;padding:0}nav.table-of-contents[data-v-8589d091]{z-index:1}nav.table-of-contents ol[data-v-8589d091]{list-style:none;margin:0;padding:0}#mobile-browse-docs[data-v-8589d091]{font-weight:var(--rh-font-weight-body-text-medium,500);padding-left:var(--rh-space-2xl,32px)}.docs-content-container[data-v-8589d091]{font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:1.6667;padding-left:6rem;padding-right:6rem;padding-top:var(--rh-space-3xl,4rem)}.chapter-title[data-v-8589d091]{font-family:Red Hat Display}h1.chapter-title[data-v-8589d091]{font-size:var(--rh-fontsize-heading-xl,2.25rem);line-height:46.8px;margin:0;padding:0}.chapter .section h4[data-v-8589d091]{font-size:24px;font-weight:400}.banner-wrapper[data-v-8589d091]{padding:3rem 6rem 0}.page-format-dropdown[data-v-8589d091]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#fff;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABtSURBVHgBhc4xCoAwDAXQxE6li0K76w0cPZqjHsEb6AlcHb2BR9ADdG7GmIKTWv0QSOAFPjrndgAo4TtHxszTD4JoVAhh1VoXiNgkUO+971Q8iGgxxlSy1jc3CGof39baWTrzNSOkkksEbG/oBGEJIn6gD3jAAAAAAElFTkSuQmCC");background-position:8.5rem;background-repeat:no-repeat;background-size:auto;border:1px solid #c7c7c7;box-shadow:inset 0 -1px 0 0 #4d4d4d;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-md,1rem);margin-top:var(--rh-space-xs,4px);max-width:168px;min-height:36px;min-width:168px;overflow:hidden;padding:0 var(--rh-space-xl,24px) 0 var(--rh-space-md,8px);text-overflow:ellipsis;white-space:nowrap}.content-format-selectors[data-v-8589d091]{color:#151515;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:var(--rh-font-weight-body-text-medium,500);margin-right:var(--rh-space-2xl,32px);max-width:250px;min-width:250px;padding-top:var(--rh-space-2xl,32px)}.chapter .section .simpara[data-v-8589d091],.chapter .section p[data-v-8589d091]{font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:30px}#toggle-focus-mode[data-v-8589d091]{padding-right:var(--rh-space-lg,1rem)}@keyframes slideaway-left-8589d091{0%{display:block}to{opacity:0;transform:translateX(-40px)}}@keyframes slideaway-right-8589d091{0%{display:block}to{opacity:0;transform:translateX(40px)}}@keyframes enter-left-8589d091{0%{display:none;transform:translateX(-40px)}to{opacity:1}}@keyframes enter-right-8589d091{0%{display:none;transform:translateX(40px)}to{opacity:1}}.hide-left[data-v-8589d091]{animation:slideaway-left-8589d091 .2s;display:none}.enter-left[data-v-8589d091]{animation:enter-left-8589d091 .3s;border-right:none;display:block}.enter-right[data-v-8589d091]{animation:enter-right-8589d091 .3s;display:block}.hide-right[data-v-8589d091]{animation:slideaway-right-8589d091 .2s;display:none}.toc-container.enter-toc-container-left[data-v-8589d091]{transform:translateX(-85%)}.alert-section[data-v-8589d091]{padding-bottom:3rem}rh-alert[data-v-8589d091]{width:auto}@media (min-width:992px){#mobile-nav[data-v-8589d091],#toc-list-mobile[data-v-8589d091]{display:none}}@media (min-width:992px) and (max-width:1400px){.docs-ocp-content-container[data-v-8589d091]{padding:var(--rh-space-4xl,64px) var(--rh-space-lg,16px) 0}}@media (width < 992px){#breadcrumbs[data-v-8589d091],.content-format-selectors[data-v-8589d091],.toc-container[data-v-8589d091]{display:none}#mobile-nav-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7}#toc-wrapper-mobile[data-v-8589d091]{padding:var(--rh-space-md,1.5rem)}.product-container[data-v-8589d091]{padding:var(--rh-space-2xl,32px) var(--rh-space-lg,16px)}.product-container.shrink-product-padding[data-v-8589d091]{padding:var(--rh-space-lg,16px)}.product-version .version-select-dropdown[data-v-8589d091]{margin:0 var(--rh-space-lg,16px)}#page-content-options-mobile[data-v-8589d091]{padding:var(--rh-space-lg,2rem)}label[for=page-format][data-v-8589d091],label[for=toggle-focus-mode][data-v-8589d091]{display:block}.page-format-dropdown[data-v-8589d091]{background-position:97%;max-width:100%}nav#mobile-toc-menu[data-v-8589d091]{max-height:50vh;overflow-y:scroll}.mobile-jump-links #first-button[data-v-8589d091]{width:100%}#jump-links-btn[data-v-8589d091]{text-align:left;width:100%}#mobile-jump-links-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7;padding:0 var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}.table-of-contents #browse-docs[data-v-8589d091]{margin-top:1rem;padding-top:var(--rh-space-md,1.5rem)}.mobile-nav[data-v-8589d091]{display:block}.hide-mobile-nav[data-v-8589d091],.mobile-nav[data-v-8589d091]{transition:transform .3s ease-in-out}.hide-mobile-nav[data-v-8589d091]{transform:translateY(-100%)}.docs-content-container[data-v-8589d091]{padding-left:1.25rem;padding-right:1.25rem;padding-top:var(--rh-space-xl,24px)}.banner-wrapper[data-v-8589d091]{padding:0 1rem}.toc-filter-mobile[data-v-8589d091]{align-items:center;display:flex;padding:var(--rh-space-lg,16px);width:100%}#text-input[data-v-8589d091]{padding-left:.5rem}.toc-filter[data-v-8589d091]{display:none}}@media (width <=576px){.content-format-selectors[data-v-8589d091]{display:none}}.informaltable[data-v-8589d091],.rhdocs .informaltable[data-v-8589d091],.rhdocs .table-contents[data-v-8589d091],.rhdocs .table-wrapper[data-v-8589d091],.table-contents[data-v-8589d091],.table-wrapper[data-v-8589d091]{max-height:var(--rh-table--maxHeight);overflow:auto}rh-table[data-v-8589d091]{display:block;margin:2rem 0;max-width:100%}.pvof-doc__wrapper[data-v-8589d091],.rhdocs[data-v-8589d091]{--rh-table--maxHeight:calc(100vh - 12.5rem)}</style>
<style>:is(rh-footer-block) a[data-v-97dd2752]{text-decoration:underline}</style>
<style>:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a{color:var(--rh-color-link-inline-on-dark,var(--rh-color-interactive-blue-lighter,#92c5f9));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:hover{color:var(--rh-color-link-inline-hover-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:is(:focus,:focus-within){color:var(--rh-color-link-inline-focus-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:visited{color:var(--rh-color-link-inline-visited-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a[slot^=logo]{display:block}:is(rh-footer) a[slot^=logo]>img{display:block;height:100%;height:var(--rh-size-icon-04,40px);width:auto}:is(rh-footer,rh-footer-universal,rh-global-footer) :is(h1,h2,h3,h4,h5,h6){font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);line-height:var(--rh-line-height-heading,1.3)}rh-footer [slot=links]:is(h1,h2,h3,h4,h5):nth-of-type(n+5){--_link-header-margin:calc(var(--rh-space-2xl, 32px) - var(--rh-space-lg, 16px))}rh-footer [slot^=links] a{gap:var(--rh-footer-links-gap,var(--rh-space-md,8px))}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] li{display:contents;margin:0;padding:0}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] a{color:var(--rh-color-text-primary-on-dark,#fff)!important;display:block;font-size:var(--rh-footer-link-font-size,var(--rh-font-size-body-text-sm,.875rem));width:-moz-fit-content;width:fit-content}:is(rh-footer-universal,rh-global-footer) [slot^=links] a{font-size:inherit}:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-lg,16px)}@media screen and (min-width:768px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-2xl,32px)}}@media screen and (min-width:1440px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-4xl,64px)}}rh-footer:not(:defined){background-color:var(--rh-color-surface-darker,#1f1f1f);display:grid;grid-template-areas:"footer" "global";grid-template-rows:1fr auto;min-height:var(--rh-footer-nojs-min-height,750px);width:100%}:is(rh-footer-universal,rh-global-footer):not(:defined):before{grid-area:global}rh-footer:not(:defined)>[slot=logo]{padding:var(--rh-space-2xl,32px) var(--_section-side-gap)}:is(rh-footer-universal,rh-global-footer):not(:defined)>*,rh-footer:not(:defined)>:not([slot=logo],:is(rh-footer-universal,rh-global-footer)){border:0;clip:rect(1px,1px,1px,1px);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}:is(rh-footer-universal,rh-global-footer):not(:defined){background-color:var(--rh-color-surface-darkest,#151515);display:block;min-height:176px;width:100%}rh-footer-universal rh-footer-copyright{grid-column:-1/1}</style>
<style>.status-legal .status-page-widget[data-v-5f538988]{display:block;margin:.5rem 0;width:11.3125rem;width:-moz-max-content;width:max-content}.status-page-widget[data-v-5f538988]{align-items:center;display:flex;flex-direction:row}.status-legal .status-page-widget .status-description[data-v-5f538988]{color:#ccc;font-weight:600;letter-spacing:.0125rem;line-height:1.5;margin-right:.5rem}.status-good[data-v-5f538988]{background-color:#3e8536}.status-critical[data-v-5f538988]{background-color:#a30100}.status-partial[data-v-5f538988]{background-color:#f5c12d}.status-maintentance[data-v-5f538988]{background-color:#316dc1}.status-minor[data-v-5f538988]{background-color:#b85c00}.status-description[data-v-5f538988]{color:#ccc;font-weight:500;letter-spacing:.2px;line-height:1.5}.current-status-indicator[data-v-5f538988]{border-radius:6px;display:inline-block;height:12px;margin:0 0 0 5px;width:12px}.current-status-indicator.small[data-v-5f538988]{border-radius:4px;display:inline-block;height:8px;margin:0 0 0 5px;width:8px}</style>
<style>.breadcrumbs[data-v-798f280c]{align-items:center;background-color:#f6f6f6;display:flex;gap:var(--rh-space-xl,24px);padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}nav[data-v-798f280c]{flex:1}ol[data-v-798f280c]{background-color:#f6f6f6;font-size:.875rem;list-style:none;margin:0;padding:0}li[data-v-798f280c]{color:#151515;display:inline}a[data-v-798f280c]:after{border-bottom-color:transparent;border-left-color:transparent;box-shadow:inset .25rem .25rem 0 .0625rem #8a8d8d;content:"";display:inline-block;height:1.07143em;margin:0 .5em;position:relative;right:0;top:.75em;transform:translateY(-.5em) rotate(135deg) scale(.5);width:1.07143em}</style>
<style>ol[data-v-fa0dae77]{margin:0;padding:0}li[data-v-fa0dae77],ol[data-v-fa0dae77],ul[data-v-fa0dae77]{list-style:none;margin:0}.chapter-title[data-v-fa0dae77]{font-size:1em}.sub-chapter-title[data-v-fa0dae77],.sub-chapter-title a[data-v-fa0dae77]{font-size:.875rem}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77],.heading[data-v-fa0dae77],.sub-nav .link[data-v-fa0dae77],.sub-nav .link .link[data-v-fa0dae77]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-fa0dae77]:hover,.link[data-v-fa0dae77]:hover,.sub-nav .link[data-v-fa0dae77]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}details[open]:first-of-type>.heading[data-v-fa0dae77]:after{transform:rotate(135deg)}.item[data-v-fa0dae77]{line-height:22px}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77]{color:var(--rh-color-text-primary-on-light,#151515)}.sub-nav[data-v-fa0dae77],.toc-wrapper[data-v-fa0dae77]{list-style:none;margin:0}.toc-wrapper[data-v-fa0dae77]{min-width:100%;padding:0}.sub-nav[data-v-fa0dae77]{font-size:1em;line-height:24px;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-fa0dae77]:hover{color:#151515}.active[data-v-fa0dae77]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.chapter-landing-page[data-v-fa0dae77]{font-weight:500}summary[data-v-fa0dae77]{cursor:pointer;list-style:none;position:relative}summary[data-v-fa0dae77]::-webkit-details-marker{display:none}@keyframes slideDown-fa0dae77{0%{height:0;opacity:0}to{height:var(--details-height-open,"100%");opacity:1}}html[data-v-fa0dae77]{--details-transition-time:400ms}details[data-v-fa0dae77]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-fa0dae77]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-fa0dae77]:after,details .heading[data-v-fa0dae77]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-fa0dae77]:after{height:8px;width:8px}</style>
<style>.item[data-v-b883c74f]{line-height:22px}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f]{color:var(--rh-color-text-primary-on-light,#151515)}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f],.heading[data-v-b883c74f],.sub-nav .link[data-v-b883c74f],.sub-nav .link .link[data-v-b883c74f]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-b883c74f]:hover,.link[data-v-b883c74f]:hover,.sub-nav .link[data-v-b883c74f]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}ol[data-v-b883c74f]{margin:0;padding:0}li[data-v-b883c74f],ol[data-v-b883c74f],ul[data-v-b883c74f]{list-style:none;margin:0}.chapter-title[data-v-b883c74f]{font-size:1em}.sub-nav[data-v-b883c74f]{font-size:1em;line-height:24px;list-style:none;margin:0;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-b883c74f]:hover{color:#151515}.active[data-v-b883c74f]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.sub-chapter-title[data-v-b883c74f],.sub-chapter-title a[data-v-b883c74f]{font-size:.875rem}summary[data-v-b883c74f]{cursor:pointer;list-style:none;position:relative}summary[data-v-b883c74f]::-webkit-details-marker{display:none}html[data-v-b883c74f]{--details-transition-time:400ms}.chapter-landing-page[data-v-b883c74f]{font-weight:500}details[open]:first-of-type>.heading[data-v-b883c74f]:after{transform:rotate(135deg)}details[data-v-b883c74f]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-b883c74f]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-b883c74f]:after,details .heading[data-v-b883c74f]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-b883c74f]:after{height:8px;width:8px}</style>
<style>.html-container[data-v-9c2a9ddb]{padding:2rem 1.5rem 0}rh-alert[data-v-9c2a9ddb]{color:#151515}@media (max-width:772px){.html-container[data-v-9c2a9ddb]{padding:3rem 1rem 0}}</style>
<style>.search-container[data-v-69710f44]{height:100%}.form-box[data-v-69710f44],.search-container[data-v-69710f44]{justify-content:center}.form-box[data-v-69710f44],.search-box[data-v-69710f44],.search-container[data-v-69710f44]{align-items:center;display:flex;width:100%}.search-box[data-v-69710f44]{justify-content:space-between;position:relative}ul[data-v-69710f44]{list-style-type:none}#search-list[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;box-shadow:0 4px 4px 0 #00000040;color:#151515;display:block;left:0;margin:0;padding:0;position:absolute;top:37px;width:100%;z-index:200}#search-list li[data-v-69710f44]{align-items:center;display:flex;justify-content:space-between;padding:.75rem}#search-list .active[data-v-69710f44],#search-list li[data-v-69710f44]:hover{background:#f0f0f0}.group-title[data-v-69710f44]{border-top:1px solid #4d4d4d;color:#4d4d4d;cursor:default;font-size:12px;font-weight:400;pointer-events:none}.group-title[data-v-69710f44],.group-title[data-v-69710f44]:hover{background:#fff}.search-item-text-elipsis[data-v-69710f44]{display:inline-block;max-width:48%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.search-item-text[data-v-69710f44]{padding-left:1.75rem}.search-item-chip[data-v-69710f44]{float:right}.search-product-version[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;border-radius:3px;font-size:1rem;font-weight:400;line-height:24px}.search-icon-form[data-v-69710f44]{color:var(--rh-color-gray-50,#707070);left:12px;position:absolute}.input-search-box[data-v-69710f44]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 40px;width:100%}.input-clear-btn[data-v-69710f44]{align-items:center;background-color:transparent;border:none;display:flex;height:36px;justify-content:center;margin-right:-30px;outline:none;transform:translateX(-30px)}.input-clear-btn[data-v-69710f44]:focus{border:1px solid var(--rh-color-accent-base-on-light,#06c)}.input-clear-btn:focus .input-clear-icon[data-v-69710f44]{color:var(--rh-color-canvas-black,#151515)}.input-clear-icon[data-v-69710f44]{color:#6b6e72;cursor:pointer}.input-clear-icon[data-v-69710f44]:hover{color:var(--rh-color-canvas-black,#151515)}.form-submit-btn[data-v-69710f44]::part(button){align-items:center;background-color:var(--rh-color-gray-20,#e0e0e0);border-radius:0;display:flex;height:36px;justify-content:center;--_default-border-color:var(--rh-color-gray-20,#e0e0e0)}.input-close-btn[data-v-69710f44]{background:none;border:none;cursor:pointer;margin:0 var(--rh-space-lg,16px)}.input-close-icon[data-v-69710f44]{color:var(--rh-color-white,#fff)}@media (max-width:992px){.form-box[data-v-69710f44]{gap:var(--rh-space-md,8px);margin:auto;width:100%}.input-search-box[data-v-69710f44]{border:1px solid var(--rh-color-gray-30,#c7c7c7)}.input-search-box[data-v-69710f44]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-search-box[data-v-69710f44]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.search-item-text-elipsis[data-v-69710f44]{max-width:60%}}@media (max-width:767px){.input-close-btn[data-v-69710f44]{display:none}.search-container[data-v-69710f44]{border:1px solid #f0f0f0}}</style>
<link rel="stylesheet" href="/_nuxt/entry.DNAluCmw.css" integrity="sha384-FnrZajt9k3u4tri3ClqikI96k+jP7kyrvgKKgdzBr5Y8CQEi3gusKE0+eMSLvGxm">
<link rel="stylesheet" href="/_nuxt/SearchAutocomplete.DkrJaF8R.css" integrity="sha384-Zw8gf6w7SrpWDmknvrab5QanIN+DSJRS/bPB9/lgDkhR7JhDmG/VF++MTMKU8mKB">
<link rel="stylesheet" href="/_nuxt/Breadcrumbs.BLkLxUMB.css" integrity="sha384-f6iEfCywVoZB0/hIKTRaxywtS21KzhBx2JOI/uVjjU9aqFcP7X9cqLH29w2HQvLe">
<link rel="stylesheet" href="/_nuxt/Alert.fTkXFs3h.css" integrity="sha384-yFMpT5E64LAQi3qJ10AJJ1oOH3DrI68OvLSjSivjNCQXZ25pmFxlPavPQ0TEyEpq">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C3PvZR0C.js" integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Ds9UYxCD.js" integrity="sha384-PFyBx6Pvk48yXM+prD4CDErW/3HFtPEqORVyAch5qDvJSyubA93+vR4jsWGRQKZs">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BUXK7nH-.js" integrity="sha384-Kqf3r1QrD7+NOn9EuK/ba9sTBZjn7vLAjnCoRtq7IKz+QV0JUUBFf1Snf1yVkkgr">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BxBriHwM.js" integrity="sha384-bejD6BN5N1iVRo5Ymn+LdVN0jvrnJTzgqgFD9xQ5+Yi46U6ff+s5W2AISzRWvJaM">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DB5Lt3x5.js" integrity="sha384-Ae/gV/4Dt4jnJApC0CWbckKJ7omq+W9Hb4jjdMyhxGJpwk6FlO7pGYMD3bPO/h1y">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D8BFaW0S.js" integrity="sha384-/m09v/yYk14L9Hra6/9jYtMTn2IdkKQvzpFPRQ5P/baRKwdZQN98873hqvwuYXFS">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/_58Q44fW.js" integrity="sha384-EdSd8jpnetO/BWDAc8C4SpQExZ7pYjMygNPvbLmiA1TaYsNUdVOqIIyOIzaErEeU">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DOCUiUcq.js" integrity="sha384-9H868K5q7MLzC8TSRXT3pVqDzsOVxZLYvUQ8cLGpHPZCFEyEJjnwSHE+/7FWrJPV">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CiTVMRA7.js" integrity="sha384-xBIJ2xO0t62/oREKqSxPtW1tRxKY+5YYXbGcJ0QR9IRM28JhL+53NOiAvVFn3rmF">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CR3F0y4K.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Bn-QuJwp.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/T_zvNmZe.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Ciddaed-.js">
<link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/Footer_Cloud.DpSdW8MR.svg">
<script type="module">
      import "@rhds/elements/rh-cta/rh-cta.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@cpelements/pfe-navigation/dist/pfe-navigation.min.js";
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">import "@rhds/elements/rh-footer/rh-footer.js"</script>
<link rel="canonical" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/using_selinux/index">
<script type="module">
      import "@rhds/elements/rh-alert/rh-alert.js";
      import "@rhds/elements/rh-code-block/rh-code-block.js";
      import '@rhds/elements/rh-cta/rh-cta.js';
      import '@patternfly/elements/pf-switch/pf-switch.js';
      import '@cpelements/rh-table/dist/rh-table.js';
      import '@patternfly/pfe-clipboard/dist/pfe-clipboard.min.js';
      import '@patternfly/elements/pf-button/pf-button.js';
      import '@patternfly/elements/pf-modal/pf-modal.js';
      import '@patternfly/elements/pf-icon/pf-icon.js';
      import '@patternfly/elements/pf-popover/pf-popover.js';
      import '@patternfly/elements/pf-tooltip/pf-tooltip.js';
      import '@rhds/elements/rh-badge/rh-badge.js';
      </script>
<meta name="description" content="Using SELinux | Red Hat Documentation">
<meta name="app-version" content="v0.0.1">
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
        import "@patternfly/elements/pf-badge/pf-badge.js";
      </script>
<script type="module" src="/_nuxt/C3PvZR0C.js" crossorigin integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c"></script></head><body><div id="__nuxt"><!--[--><!--[--><!----><header data-v-edc0d12c><a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden" data-v-edc0d12c>Skip to navigation</a><a href="#main-content" class="skip-link visually-hidden" data-v-edc0d12c>Skip to content</a><nav id="upper-navigation" class="upper-navigation" aria-labelledby="upper-navigation-label" data-analytics-region="upper-navigation" data-v-edc0d12c><p id="upper-navigation-label" class="upper-nav-hidden" data-v-edc0d12c>Featured links</p><div class="upper-nav-container" data-v-edc0d12c><ul class="upper-nav-menu" data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/" class="upper-nav-links" data-analytics-text="Support" data-analytics-category="Featured Links" data-v-edc0d12c>Support</a></li><li data-v-edc0d12c><a href="https://console.redhat.com/" class="upper-nav-links" data-analytics-text="Console" data-analytics-category="Featured Links" data-v-edc0d12c>Console</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" class="upper-nav-links" data-analytics-text="Developers" data-analytics-category="Featured Links" data-v-edc0d12c>Developers</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" class="upper-nav-links" data-analytics-text="Start a trial" data-analytics-category="Featured Links" data-v-edc0d12c>Start a trial</a></li><li data-v-edc0d12c><button id="all-red-hat" class="upper-nav-links" data-analytics-text="All Red Hat" data-analytics-category="Featured Links" aria-expanded="false" data-analytics-linktype="tab" data-v-edc0d12c>All Red Hat<svg class="upper-nav-arrow" xmlns="http://www.w3.org/2000/svg" width="1024" height="1024" viewBox="0 0 1024 1024" aria-hidden="true" data-v-edc0d12c=""><path d="M810.642 511.557c0 8.905-3.447 16.776-10.284 23.613L322.31 1013.216c-6.835 6.837-14.706 10.284-23.61 10.284s-16.776-3.447-23.613-10.284l-51.303-51.303c-6.837-6.837-10.284-14.707-10.284-23.612s3.447-16.775 10.284-23.61L626.972 511.5 223.784 108.31c-6.837-6.835-10.284-14.706-10.284-23.61s3.447-16.776 10.284-23.613l51.303-51.303C281.924 2.947 289.794-.5 298.7-.5s16.775 3.447 23.61 10.284L800.36 487.83c6.837 6.837 10.284 14.708 10.284 23.613v.114" data-v-edc0d12c=""/></svg></button><div class="upper-nav-dropdown-container" data-v-edc0d12c><ul data-v-edc0d12c><li data-v-edc0d12c><span data-v-edc0d12c>For customers</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/support" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Customer support" data-v-edc0d12c>Customer support</a></li><li data-v-edc0d12c><a href="/products" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Documentation" data-v-edc0d12c>Documentation</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/support/cases" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Support cases" data-v-edc0d12c>Support Cases</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/management" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Subscription management" data-v-edc0d12c>Subscription management</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/" data-analytics-category="All Red Hat|For customers" data-analytics-text="Red Hat Ecosystem Catalog" data-v-edc0d12c>Red Hat Ecosystem Catalog</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/partners" data-analytics-category="All Red Hat|For customers" data-analytics-text="Find a partner" data-v-edc0d12c>Find a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>For partners</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://connect.redhat.com/login" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner login" data-v-edc0d12c>Partner login</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/en/support" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner support" data-v-edc0d12c>Partner support</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Become a partner " data-v-edc0d12c>Become a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Try, buy, &amp; sell</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://marketplace.redhat.com/en-us" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Marketplace" data-v-edc0d12c>Red Hat Marketplace</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/store" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Store" data-v-edc0d12c>Red Hat Store</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/contact" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Contact sales" data-v-edc0d12c>Contact Sales</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Learning resources</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.redhat.com/en/services/training-and-certification" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Training and certification " data-v-edc0d12c>Training and certification</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" data-pzn-audience="developers|community" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="For developers" data-v-edc0d12c>For developers</a></li><li data-v-edc0d12c><a href="https://cloud.redhat.com/learn" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Hybrid cloud learning hub" data-v-edc0d12c>Hybrid cloud learning hub</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Interactive labs" data-v-edc0d12c>Interactive labs</a></li><li data-v-edc0d12c><a href="https://learn.redhat.com/" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Learning community" data-v-edc0d12c>Learning community</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/tv" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Red Hat TV" data-v-edc0d12c>Red Hat TV</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Open source communities</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.ansible.com/community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="Ansible" data-v-edc0d12c>Ansible</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/sysadmin/" id="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For system administrators" data-v-edc0d12c>For system administrators</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/architect/" data-pzn-audience="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For architects" data-v-edc0d12c>For architects</a></li></ul></li></ul></div></li></ul></div></nav><pfe-navigation full-width id="pfe-navigation" pf-sticky="true" lang="en" data-v-edc0d12c><nav class="pfe-navigation" aria-label="Main Navigation" data-v-edc0d12c><div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper" data-v-edc0d12c><a href="/en" class="pfe-navigation__logo-link" data-v-edc0d12c><img class="pfe-navigation__logo-image pfe-navigation__logo-image--screen pfe-navigation__logo-image--small" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" width="240" height="40" alt="Red Hat Documentation" data-v-edc0d12c></a></div></nav><span data-v-edc0d12c></span><div slot="secondary-links" data-v-edc0d12c><div class="hidden-at-desktop hidden-at-tablet search-mobile" data-v-edc0d12c><div id="search-form" class="search-container" opensearchbox="true" data-v-edc0d12c data-v-69710f44><form role="search" class="form-box" autocomplete="off" data-v-69710f44><div class="search-box" data-v-69710f44><pf-icon icon="search" size="md" class="search-icon-form" data-v-69710f44></pf-icon><input type="text" id="input-search" class="input-search-box" placeholder="Search documentation" value aria-autocomplete="list" data-v-69710f44><!----><!----><!----><rh-button disabled variant="tertiary" class="form-submit-btn" data-v-69710f44><img src="data:image/svg+xml,%3csvg%20width=&#39;14&#39;%20height=&#39;14&#39;%20viewBox=&#39;0%200%2014%2014&#39;%20fill=&#39;none&#39;%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%3e%3cpath%20d=&#39;M7%200L5.6%201.4L10.3%206H0V8H10.3L5.6%2012.6L7%2014L14%207L7%200Z&#39;%20fill=&#39;%23707070&#39;/%3e%3c/svg%3e" alt="Submit button" data-v-69710f44></rh-button></div></form><!----></div></div><div class="hidden-at-desktop hidden-at-tablet buttons" data-v-edc0d12c><a href="https://access.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Support" data-v-edc0d12c>Support</a><a href="https://console.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Console" data-v-edc0d12c>Console</a><a href="https://developers.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Developers" data-v-edc0d12c>Developers</a><a href="https://www.redhat.com/en/products/trials" data-analytics-category="More Red Hat" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a><a href="https://www.redhat.com/en/contact" data-analytics-category="More Red Hat" data-analytics-text="Contact" data-v-edc0d12c>Contact</a></div><div class="hidden-at-desktop hidden-at-tablet mobile-lang-select" data-v-edc0d12c><label for="lang_selection" data-v-edc0d12c>Select your language</label><select id="lang_selection" data-v-edc0d12c><!--[--><option value="en" xml:lang="en" hreflang="en" data-v-edc0d12c>English</option><option value="fr" xml:lang="fr" hreflang="fr" data-v-edc0d12c>Français</option><option value="ko" xml:lang="ko" hreflang="ko" data-v-edc0d12c>한국어</option><option value="ja" xml:lang="ja" hreflang="ja" data-v-edc0d12c>日本語</option><option value="zh-cn" xml:lang="zh-cn" hreflang="zh-cn" data-v-edc0d12c>中文 (中国)</option><option value="de" xml:lang="de" hreflang="de" data-v-edc0d12c>Deutsch</option><option value="it" xml:lang="it" hreflang="it" data-v-edc0d12c>Italiano</option><option value="pt-br" xml:lang="pt-br" hreflang="pt-br" data-v-edc0d12c>Português</option><option value="es" xml:lang="es" hreflang="es" data-v-edc0d12c>Español</option><!--]--></select></div></div></pfe-navigation></header><main id="main-content"><!--[--><!--[--><!--[--><!----><!----><!--]--><div class="breadcrumbs" id="breadcrumbs" data-v-8589d091 data-v-798f280c><nav aria-label="Breadcrumb" class="breadcrumb" data-v-798f280c><ol data-v-798f280c><li data-v-798f280c><a href="/" data-v-798f280c>Home</a></li><li data-v-798f280c><a href="/en/products" data-v-798f280c>Products</a></li><!--[--><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/" data-v-798f280c>Red Hat Enterprise Linux</a></li><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/9/" data-v-798f280c>9</a></li><li data-v-798f280c><!--[-->Using SELinux<!--]--></li><!--]--></ol></nav><span data-v-798f280c></span></div><!----><nav id="mobile-nav" class="mobile-nav" aria-label="mobile menu" data-v-8589d091><div class="mobile-nav-wrapper" data-v-8589d091><div id="first-button" data-v-8589d091><button id="toc-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><span class="sr-only" data-v-8589d091>Open </span>Table of contents</button></div><div id="second-button" data-v-8589d091><button id="settings-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><pf-icon icon="cog" size="md" data-v-8589d091></pf-icon><span class="sr-only" data-v-8589d091>Open page settings</span></button></div></div><div id="mobile-nav-content-wrapper" class="hidden" role="navigation" tabindex="0" data-v-8589d091><div id="toc-mobile" class="hidden" aria-labelledby="toc-btn" data-v-8589d091><div class="shrink-product-padding product-container" id="product-container-mobile" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter-mobile" data-v-8589d091><span id="text" part="text" data-v-8589d091><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper-mobile" class="span-xs-12 span-sm-4 span-md-3" lang="en" data-v-8589d091><nav id="mobile-toc-menu" class="table-of-contents" aria-label="table of content - mobile" data-v-8589d091><!----></nav></div><!----></div><div id="page-content-options-mobile" class="hidden" aria-labelledby="settings-btn" data-v-8589d091><div class="page-layout-options" data-v-8589d091><label for="page-format-mobile" data-v-8589d091>Format</label><select id="page-format-mobile" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div></div></div><!----><!----></nav><div class="grid grid-col-12 content-wrapper" data-v-8589d091><aside id="left-content" class="span-xs-12 span-sm-4 span-md-3" lang="en-us" aria-label="left navigation" xml:lang="en-us" data-v-8589d091><div class="toc-container" id="toc-container" visible="true" data-v-8589d091><div class="toc-focus-container" id="toc-focus-container" data-v-8589d091><button class="toc-focus-btn" aria-label="toggle left menu" aria-controls="toc-container" aria-expanded="true" data-v-8589d091><pf-icon size="md" icon="angle-left" class="toc-focus-btn-icon" data-v-8589d091></pf-icon></button></div><div class="product-container" id="product-container-desktop" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter" id="toc-filter" data-v-8589d091><span id="text" part="text" data-v-8589d091><span id="search-icon" part="search-icon" data-v-8589d091><pf-icon icon="filter" size="md" data-v-8589d091></pf-icon></span><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper" class="toc-wrapper" data-v-8589d091><nav id="toc" class="max-height-85 table-of-contents" aria-label="Table of contents" data-v-8589d091><ol id="toc-list" data-v-8589d091><!--[--><li class="item chapter" data-v-fa0dae77><a class="link active" href id="chapter-index" data-v-fa0dae77>Using SELinux</a></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#proc_providing-feedback-on-red-hat-documentation_using-selinux" id="chapter-landing--using_selinux-proc_providing-feedback-on-red-hat-documentation_using-selinux" data-v-fa0dae77>Providing feedback on Red Hat documentation</a></li><li class="item chapter" data-v-fa0dae77><details id="toc--getting-started-with-selinux_using-selinux" data-v-fa0dae77><summary class="heading chapter-title" id="getting-started-with-selinux_using-selinux--summary" data-v-fa0dae77>1. Getting started with SELinux</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#getting-started-with-selinux_using-selinux" id="chapter-landing--using_selinux-getting-started-with-selinux_using-selinux" data-v-fa0dae77>Getting started with SELinux</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#introduction-to-selinux_getting-started-with-selinux" id="sub-link-to-using_selinux-introduction-to-selinux_getting-started-with-selinux" data-v-b883c74f>1.1. Introduction to SELinux</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#benefits-of-selinux_getting-started-with-selinux" id="sub-link-to-using_selinux-benefits-of-selinux_getting-started-with-selinux" data-v-b883c74f>1.2. Benefits of running SELinux</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#selinux-examples_getting-started-with-selinux" id="sub-link-to-using_selinux-selinux-examples_getting-started-with-selinux" data-v-b883c74f>1.3. SELinux examples</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#selinux-architecture_getting-started-with-selinux" id="sub-link-to-using_selinux-selinux-architecture_getting-started-with-selinux" data-v-b883c74f>1.4. SELinux architecture and packages</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#selinux-states-and-modes_getting-started-with-selinux" id="sub-link-to-using_selinux-selinux-states-and-modes_getting-started-with-selinux" data-v-b883c74f>1.5. SELinux states and modes</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--changing-selinux-states-and-modes_using-selinux" data-v-fa0dae77><summary class="heading chapter-title" id="changing-selinux-states-and-modes_using-selinux--summary" data-v-fa0dae77>2. Changing SELinux states and modes</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#changing-selinux-states-and-modes_using-selinux" id="chapter-landing--using_selinux-changing-selinux-states-and-modes_using-selinux" data-v-fa0dae77>Changing SELinux states and modes</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#changing-selinux-modes_changing-selinux-states-and-modes" id="sub-link-to-using_selinux-changing-selinux-modes_changing-selinux-states-and-modes" data-v-b883c74f>2.1. Permanent changes in SELinux states and modes</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#changing-to-permissive-mode_changing-selinux-states-and-modes" id="sub-link-to-using_selinux-changing-to-permissive-mode_changing-selinux-states-and-modes" data-v-b883c74f>2.2. Changing SELinux to permissive mode</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#changing-to-enforcing-mode_changing-selinux-states-and-modes" id="sub-link-to-using_selinux-changing-to-enforcing-mode_changing-selinux-states-and-modes" data-v-b883c74f>2.3. Changing SELinux to enforcing mode</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#enabling-selinux-on-systems-that-previously-had-it-disabled_changing-selinux-states-and-modes" id="sub-link-to-using_selinux-enabling-selinux-on-systems-that-previously-had-it-disabled_changing-selinux-states-and-modes" data-v-b883c74f>2.4. Enabling SELinux on systems that previously had it disabled</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#Enabling_and_Disabling_SELinux-Disabling_SELinux_changing-selinux-states-and-modes" id="sub-link-to-using_selinux-Enabling_and_Disabling_SELinux-Disabling_SELinux_changing-selinux-states-and-modes" data-v-b883c74f>2.5. Disabling SELinux</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes" id="sub-link-to-using_selinux-changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes" data-v-b883c74f>2.6. Changing SELinux modes at boot time</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-confined-and-unconfined-users_using-selinux" data-v-fa0dae77><summary class="heading chapter-title" id="managing-confined-and-unconfined-users_using-selinux--summary" data-v-fa0dae77>3. Managing confined and unconfined users</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-confined-and-unconfined-users_using-selinux" id="chapter-landing--using_selinux-managing-confined-and-unconfined-users_using-selinux" data-v-fa0dae77>Managing confined and unconfined users</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#confined-and-unconfined-users_managing-confined-and-unconfined-users" id="sub-link-to-using_selinux-confined-and-unconfined-users_managing-confined-and-unconfined-users" data-v-b883c74f>3.1. Confined and unconfined users in SELinux</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#roles-and-access-rights-of-selinux-users_managing-confined-and-unconfined-users" id="sub-link-to-using_selinux-roles-and-access-rights-of-selinux-users_managing-confined-and-unconfined-users" data-v-b883c74f>3.2. Roles and access rights of SELinux users</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#confined-non-administrator-roles-in-selinux_managing-confined-and-unconfined-users" id="sub-link-to-using_selinux-confined-non-administrator-roles-in-selinux_managing-confined-and-unconfined-users" data-v-b883c74f>3.3. Confined non-administrator roles in SELinux</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#confined-administrator-roles-in-selinux_managing-confined-and-unconfined-users" id="sub-link-to-using_selinux-confined-administrator-roles-in-selinux_managing-confined-and-unconfined-users" data-v-b883c74f>3.4. Confined administrator roles in SELinux</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-a-new-user-automatically-mapped-to-the-selinux-unconfined_u-user_managing-confined-and-unconfined-users" id="sub-link-to-using_selinux-adding-a-new-user-automatically-mapped-to-the-selinux-unconfined_u-user_managing-confined-and-unconfined-users" data-v-b883c74f>3.5. Adding a new user automatically mapped to the SELinux unconfined_u user</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-a-new-user-as-an-selinux-confined-user_managing-confined-and-unconfined-users" id="sub-link-to-using_selinux-adding-a-new-user-as-an-selinux-confined-user_managing-confined-and-unconfined-users" data-v-b883c74f>3.6. Adding a new user as an SELinux-confined user</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#confining-regular-users_managing-confined-and-unconfined-users" id="sub-link-to-using_selinux-confining-regular-users_managing-confined-and-unconfined-users" data-v-b883c74f>3.7. Confining regular users in SELinux</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#confining-an-administrator-by-mapping-to-sysadm_u_managing-confined-and-unconfined-users" id="sub-link-to-using_selinux-confining-an-administrator-by-mapping-to-sysadm_u_managing-confined-and-unconfined-users" data-v-b883c74f>3.8. Confining an administrator by mapping to sysadm_u</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#confining-an-administrator-using-sudo-and-the-sysadm_r-role_managing-confined-and-unconfined-users" id="sub-link-to-using_selinux-confining-an-administrator-using-sudo-and-the-sysadm_r-role_managing-confined-and-unconfined-users" data-v-b883c74f>3.9. Confining an administrator by using sudo and the sysadm_r role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources" id="sub-link-to-using_selinux-additional_resources" data-v-b883c74f>3.10. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux--summary" data-v-fa0dae77>4. Configuring SELinux for applications and services with non-standard configurations</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux" id="chapter-landing--using_selinux-configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux" data-v-fa0dae77>Configuring SELinux for applications and services with non-standard configurations</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations" id="sub-link-to-using_selinux-customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations" data-v-b883c74f>4.1. Customizing the SELinux policy for the Apache HTTP server in a non-standard configuration</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adjusting-the-policy-for-sharing-nfs-and-cifs-volumes-using-selinux-booleans_configuring-selinux-for-applications-and-services-with-non-standard-configurations" id="sub-link-to-using_selinux-adjusting-the-policy-for-sharing-nfs-and-cifs-volumes-using-selinux-booleans_configuring-selinux-for-applications-and-services-with-non-standard-configurations" data-v-b883c74f>4.2. Adjusting the policy for sharing NFS and CIFS volumes by using SELinux booleans</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#finding-the-correct-selinux-type-for-managing-access-to-non-standard-directories_configuring-selinux-for-applications-and-services-with-non-standard-configurations" id="sub-link-to-using_selinux-finding-the-correct-selinux-type-for-managing-access-to-non-standard-directories_configuring-selinux-for-applications-and-services-with-non-standard-configurations" data-v-b883c74f>4.3. Finding the correct SELinux type for managing access to non-standard directories</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#managing-access-to-non-standard-shared-directories-for-selinux-unprivileged-users_configuring-selinux-for-applications-and-services-with-non-standard-configurations" id="sub-link-to-using_selinux-managing-access-to-non-standard-shared-directories-for-selinux-unprivileged-users_configuring-selinux-for-applications-and-services-with-non-standard-configurations" data-v-b883c74f>4.4. Managing access to non-standard shared directories for unprivileged SELinux users</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--troubleshooting-problems-related-to-selinux_using-selinux" data-v-fa0dae77><summary class="heading chapter-title" id="troubleshooting-problems-related-to-selinux_using-selinux--summary" data-v-fa0dae77>5. Troubleshooting problems related to SELinux</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#troubleshooting-problems-related-to-selinux_using-selinux" id="chapter-landing--using_selinux-troubleshooting-problems-related-to-selinux_using-selinux" data-v-fa0dae77>Troubleshooting problems related to SELinux</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#identifying-selinux-denials_troubleshooting-problems-related-to-selinux" id="sub-link-to-using_selinux-identifying-selinux-denials_troubleshooting-problems-related-to-selinux" data-v-b883c74f>5.1. Identifying SELinux denials</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#analyzing-an-already-found-selinux-denial_troubleshooting-problems-related-to-selinux" id="sub-link-to-using_selinux-analyzing-an-already-found-selinux-denial_troubleshooting-problems-related-to-selinux" data-v-b883c74f>5.2. Analyzing SELinux denial messages</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#fixing-an-analyzed-selinux-denial_troubleshooting-problems-related-to-selinux" id="sub-link-to-using_selinux-fixing-an-analyzed-selinux-denial_troubleshooting-problems-related-to-selinux" data-v-b883c74f>5.3. Fixing analyzed SELinux denials</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_creating-a-local-selinux-policy-module_troubleshooting-problems-related-to-selinux" id="sub-link-to-using_selinux-proc_creating-a-local-selinux-policy-module_troubleshooting-problems-related-to-selinux" data-v-b883c74f>5.4. Creating a local SELinux policy module</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#selinux-denials-in-the-audit-log_troubleshooting-problems-related-to-selinux" id="sub-link-to-using_selinux-selinux-denials-in-the-audit-log_troubleshooting-problems-related-to-selinux" data-v-b883c74f>5.5. SELinux denials in the Audit log</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional-resources-troubleshooting-problems-related-to-selinux" id="sub-link-to-using_selinux-additional-resources-troubleshooting-problems-related-to-selinux" data-v-b883c74f>5.6. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-multi-level-security-mls_using-selinux" data-v-fa0dae77><summary class="heading chapter-title" id="using-multi-level-security-mls_using-selinux--summary" data-v-fa0dae77>6. Using Multi-Level Security (MLS)</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-multi-level-security-mls_using-selinux" id="chapter-landing--using_selinux-using-multi-level-security-mls_using-selinux" data-v-fa0dae77>Using Multi-Level Security (MLS)</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#multi-level-security-mls_using-multi-level-security-mls" id="sub-link-to-using_selinux-multi-level-security-mls_using-multi-level-security-mls" data-v-b883c74f>6.1. Multi-Level Security (MLS)</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_selinux-roles-in-mls_using-multi-level-security-mls" id="sub-link-to-using_selinux-ref_selinux-roles-in-mls_using-multi-level-security-mls" data-v-b883c74f>6.2. SELinux roles in MLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#switching-the-selinux-policy-to-mls_using-multi-level-security-mls" id="sub-link-to-using_selinux-switching-the-selinux-policy-to-mls_using-multi-level-security-mls" data-v-b883c74f>6.3. Switching the SELinux policy to MLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#establishing-user-clearance-in-mls_using-multi-level-security-mls" id="sub-link-to-using_selinux-establishing-user-clearance-in-mls_using-multi-level-security-mls" data-v-b883c74f>6.4. Establishing user clearance in MLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_changing-a-users-clearance-level-within-the-defined-security-range-in-mls_using-multi-level-security-mls" id="sub-link-to-using_selinux-proc_changing-a-users-clearance-level-within-the-defined-security-range-in-mls_using-multi-level-security-mls" data-v-b883c74f>6.5. Changing a user’s clearance level within the defined security range in MLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_increasing-file-sensitivity-levels-in-mls_using-multi-level-security-mls" id="sub-link-to-using_selinux-proc_increasing-file-sensitivity-levels-in-mls_using-multi-level-security-mls" data-v-b883c74f>6.6. Increasing file sensitivity levels in MLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_changing-file-sensitivity-in-mls_using-multi-level-security-mls" id="sub-link-to-using_selinux-proc_changing-file-sensitivity-in-mls_using-multi-level-security-mls" data-v-b883c74f>6.7. Changing file sensitivity in MLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_separating-system-administration-from-security-administration-in-mls_using-multi-level-security-mls" id="sub-link-to-using_selinux-proc_separating-system-administration-from-security-administration-in-mls_using-multi-level-security-mls" data-v-b883c74f>6.8. Separating system administration from security administration in MLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_defining-a-secure-terminal-in-mls_using-multi-level-security-mls" id="sub-link-to-using_selinux-proc_defining-a-secure-terminal-in-mls_using-multi-level-security-mls" data-v-b883c74f>6.9. Defining a secure terminal in MLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_allowing-mls-users-to-edit-files-on-lower-levels_using-multi-level-security-mls" id="sub-link-to-using_selinux-proc_allowing-mls-users-to-edit-files-on-lower-levels_using-multi-level-security-mls" data-v-b883c74f>6.10. Allowing MLS users to edit files on lower levels</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_using-multi-category-security-mcs-for-data-confidentiality_using-selinux" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_using-multi-category-security-mcs-for-data-confidentiality_using-selinux--summary" data-v-fa0dae77>7. Using Multi-Category Security (MCS) for data confidentiality</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_using-multi-category-security-mcs-for-data-confidentiality_using-selinux" id="chapter-landing--using_selinux-assembly_using-multi-category-security-mcs-for-data-confidentiality_using-selinux" data-v-fa0dae77>Using Multi-Category Security (MCS) for data confidentiality</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con_multi-category-security-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality" id="sub-link-to-using_selinux-con_multi-category-security-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality" data-v-b883c74f>7.1. Multi-Category Security (MCS)</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-multi-category-security-for-data-confidentiality_assembly_using-multi-category-security-mcs-for-data-confidentiality" id="sub-link-to-using_selinux-proc_configuring-multi-category-security-for-data-confidentiality_assembly_using-multi-category-security-mcs-for-data-confidentiality" data-v-b883c74f>7.2. Configuring Multi-Category Security for data confidentiality</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_defining-category-labels-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality" id="sub-link-to-using_selinux-proc_defining-category-labels-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality" data-v-b883c74f>7.3. Defining category labels in MCS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_assigning-categories-to-users-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality" id="sub-link-to-using_selinux-proc_assigning-categories-to-users-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality" data-v-b883c74f>7.4. Assigning categories to users in MCS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_assigning-categories-to-files-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality" id="sub-link-to-using_selinux-proc_assigning-categories-to-files-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality" data-v-b883c74f>7.5. Assigning categories to files in MCS</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--writing-a-custom-selinux-policy_using-selinux" data-v-fa0dae77><summary class="heading chapter-title" id="writing-a-custom-selinux-policy_using-selinux--summary" data-v-fa0dae77>8. Writing a custom SELinux policy</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#writing-a-custom-selinux-policy_using-selinux" id="chapter-landing--using_selinux-writing-a-custom-selinux-policy_using-selinux" data-v-fa0dae77>Writing a custom SELinux policy</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#custom-selinux-policies-and-related-tools_writing-a-custom-selinux-policy" id="sub-link-to-using_selinux-custom-selinux-policies-and-related-tools_writing-a-custom-selinux-policy" data-v-b883c74f>8.1. Custom SELinux policies and related tools</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-and-enforcing-an-selinux-policy-for-a-custom-application_writing-a-custom-selinux-policy" id="sub-link-to-using_selinux-creating-and-enforcing-an-selinux-policy-for-a-custom-application_writing-a-custom-selinux-policy" data-v-b883c74f>8.2. Creating and enforcing an SELinux policy for a custom application</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_2" id="sub-link-to-using_selinux-additional_resources_2" data-v-b883c74f>8.3. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--creating-selinux-policies-for-containers_using-selinux" data-v-fa0dae77><summary class="heading chapter-title" id="creating-selinux-policies-for-containers_using-selinux--summary" data-v-fa0dae77>9. Creating SELinux policies for containers</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#creating-selinux-policies-for-containers_using-selinux" id="chapter-landing--using_selinux-creating-selinux-policies-for-containers_using-selinux" data-v-fa0dae77>Creating SELinux policies for containers</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#introduction-to-udica_creating-selinux-policies-for-containers" id="sub-link-to-using_selinux-introduction-to-udica_creating-selinux-policies-for-containers" data-v-b883c74f>9.1. Introduction to the udica SELinux policy generator</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-and-using-an-selinux-policy-for-a-custom-container_creating-selinux-policies-for-containers" id="sub-link-to-using_selinux-creating-and-using-an-selinux-policy-for-a-custom-container_creating-selinux-policies-for-containers" data-v-b883c74f>9.2. Creating and using an SELinux policy for a custom container</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--deploying-the-same-selinux-configuration-on-multiple-systems_using-selinux" data-v-fa0dae77><summary class="heading chapter-title" id="deploying-the-same-selinux-configuration-on-multiple-systems_using-selinux--summary" data-v-fa0dae77>10. Deploying the same SELinux configuration on multiple systems</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#deploying-the-same-selinux-configuration-on-multiple-systems_using-selinux" id="chapter-landing--using_selinux-deploying-the-same-selinux-configuration-on-multiple-systems_using-selinux" data-v-fa0dae77>Deploying the same SELinux configuration on multiple systems</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#introduction-to-the-selinux-system-role_deploying-the-same-selinux-configuration-on-multiple-systems" id="sub-link-to-using_selinux-introduction-to-the-selinux-system-role_deploying-the-same-selinux-configuration-on-multiple-systems" data-v-b883c74f>10.1. Introduction to the selinux RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_deploying-the-same-selinux-configuration-on-multiple-systems" id="sub-link-to-using_selinux-using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_deploying-the-same-selinux-configuration-on-multiple-systems" data-v-b883c74f>10.2. Using the selinux RHEL system role to apply SELinux settings on multiple systems</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#managing-ports-by-using-the-selinux-rhel-system-role_deploying-the-same-selinux-configuration-on-multiple-systems" id="sub-link-to-using_selinux-managing-ports-by-using-the-selinux-rhel-system-role_deploying-the-same-selinux-configuration-on-multiple-systems" data-v-b883c74f>10.3. Managing ports by using the selinux RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#applying-a-generated-ansible-playbook_deploying-the-same-selinux-configuration-on-multiple-systems" id="sub-link-to-using_selinux-applying-a-generated-ansible-playbook_deploying-the-same-selinux-configuration-on-multiple-systems" data-v-b883c74f>10.4. Creating an SELinux configuration Ansible playbook in the web console</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#transferring-selinux-settings-to-another-system-with-semanage_deploying-the-same-selinux-configuration-on-multiple-systems" id="sub-link-to-using_selinux-transferring-selinux-settings-to-another-system-with-semanage_deploying-the-same-selinux-configuration-on-multiple-systems" data-v-b883c74f>10.5. Transferring SELinux settings to another system with semanage</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#configuring-polyinstantiated-directories_using-selinux" id="chapter-landing--using_selinux-configuring-polyinstantiated-directories_using-selinux" data-v-fa0dae77>11. Configuring polyinstantiated directories</a></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#idm139843088056768" id="chapter-landing--using_selinux-idm139843088056768" data-v-fa0dae77>Legal Notice</a></li><!--]--></ol></nav><!----></div></div></aside><article class="content span-xs-12 span-sm-6 span-md-12 span-lg-7" aria-live="polite" data-v-8589d091><!----><div lang="en-us" xml:lang="en-us" class="docs-content-container" data-v-8589d091><!----><!----><h1 data-id="content_chapter" class="chapter-title" data-v-8589d091>Using SELinux</h1><hr class="line-below-chp" data-v-8589d091><section class="rhdocs" data-v-8589d091><body><div xml:lang="en-US" class="book" id="idm139843084842528"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Enterprise Linux</span> <span class="productnumber">9</span></div><div><h3 class="subtitle">Prevent users and processes from performing unauthorized interactions with files and devices by using Security-Enhanced Linux (SELinux)</h3></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="#idm139843088056768">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				By configuring SELinux, you can enhance your system’s security. SELinux is an implementation of Mandatory Access Control (MAC), and provides an additional layer of security. The SELinux policy defines how users and processes can interact with the files on the system. You can control which users can perform which actions by mapping them to specific SELinux confined users.
			</div></div></div></div><hr></div><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_using-selinux"><div class="titlepage"><div><div><h2 class="title">Providing feedback on Red Hat documentation</h2></div></div></div><p class="_abstract _abstract">
			We appreciate your feedback on our documentation. Let us know how we can improve it.
		</p><div class="orderedlist"><p class="title"><strong>Submitting feedback through Jira (account required)</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					Log in to the <a class="link" href="https://issues.redhat.com/projects/RHELDOCS/issues">Jira</a> website.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> in the top navigation bar
				</li><li class="listitem">
					Enter a descriptive title in the <span class="strong strong"><strong>Summary</strong></span> field.
				</li><li class="listitem">
					Enter your suggestion for improvement in the <span class="strong strong"><strong>Description</strong></span> field. Include links to the relevant parts of the documentation.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> at the bottom of the dialogue.
				</li></ol></div></section><section class="chapter" id="getting-started-with-selinux_using-selinux"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Getting started with SELinux</h2></div></div></div><p class="_abstract _abstract">
			Security Enhanced Linux (SELinux) provides an additional layer of system security. SELinux fundamentally answers the question: <span class="emphasis"><em>May &lt;subject&gt; do &lt;action&gt; to &lt;object&gt;?</em></span>, for example: <span class="emphasis"><em>May a web server access files in users' home directories?</em></span>
		</p><section class="section" id="introduction-to-selinux_getting-started-with-selinux"><div class="titlepage"><div><div><h3 class="title">1.1. Introduction to SELinux</h3></div></div></div><p class="_abstract _abstract">
				The standard access policy based on the user, group, and other permissions, known as Discretionary Access Control (DAC), does not enable system administrators to create comprehensive and fine-grained security policies, such as restricting specific applications to only viewing log files, while allowing other applications to append new data to the log files.
			</p><p>
				Security Enhanced Linux (SELinux) implements Mandatory Access Control (MAC). Every process and system resource has a special security label called an <span class="emphasis"><em>SELinux context</em></span>. A SELinux context, sometimes referred to as an <span class="emphasis"><em>SELinux label</em></span>, is an identifier which abstracts away the system-level details and focuses on the security properties of the entity. Not only does this provide a consistent way of referencing objects in the SELinux policy, but it also removes any ambiguity that can be found in other identification methods. For example, a file can have multiple valid path names on a system that makes use of bind mounts.
			</p><p>
				The SELinux policy uses these contexts in a series of rules which define how processes can interact with each other and the various system resources. By default, the policy does not allow any interaction unless a rule explicitly grants access.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Remember that SELinux policy rules are checked after DAC rules. SELinux policy rules are not used if DAC rules deny access first, which means that no SELinux denial is logged if the traditional DAC rules prevent the access.
				</p></div></rh-alert><p>
				SELinux contexts have several fields: user, role, type, and security level. The SELinux type information is perhaps the most important when it comes to the SELinux policy, as the most common policy rule which defines the allowed interactions between processes and system resources uses SELinux types and not the full SELinux context. SELinux types end with <code class="literal">_t</code>. For example, the type name for the web server is <code class="literal">httpd_t</code>. The type context for files and directories normally found in <code class="literal">/var/www/html/</code> is <code class="literal">httpd_sys_content_t</code>. The type contexts for files and directories normally found in <code class="literal">/tmp</code> and <code class="literal">/var/tmp/</code> is <code class="literal">tmp_t</code>. The type context for web server ports is <code class="literal">http_port_t</code>.
			</p><p>
				There is a policy rule that permits Apache (the web server process running as <code class="literal">httpd_t</code>) to access files and directories with a context normally found in <code class="literal">/var/www/html/</code> and other web server directories (<code class="literal">httpd_sys_content_t</code>). There is no allow rule in the policy for files normally found in <code class="literal">/tmp</code> and <code class="literal">/var/tmp/</code>, so access is not permitted. With SELinux, even if Apache is compromised, and a malicious script gains access, it is still not able to access the <code class="literal">/tmp</code> directory.
			</p><div class="figure" id="fig-intro-httpd-mysqld"><p class="title"><strong>Figure 1.1. An example how can SELinux help to run Apache and MariaDB in a secure way.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_SELinux-en-US/images/f7b4d4a7ee54ec0153a3422060470895/selinux-intro-apache-mariadb.png" alt="SELinux_Apache_MariaDB_example"></div></div></div><p>
				As the previous scheme shows, SELinux allows the Apache process running as <code class="literal">httpd_t</code> to access the <code class="literal">/var/www/html/</code> directory and it denies the same process to access the <code class="literal">/data/mysql/</code> directory because there is no allow rule for the <code class="literal">httpd_t</code> and <code class="literal">mysqld_db_t</code> type contexts. On the other hand, the MariaDB process running as <code class="literal">mysqld_t</code> is able to access the <code class="literal">/data/mysql/</code> directory and SELinux also correctly denies the process with the <code class="literal">mysqld_t</code> type to access the <code class="literal">/var/www/html/</code> directory labeled as <code class="literal">httpd_sys_content_t</code>.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">selinux(8)</code> man page and man pages listed by the <code class="literal">apropos selinux</code> command.
					</li><li class="listitem">
						Man pages listed by the <code class="literal">man -k _selinux</code> command when the <code class="literal">selinux-policy-doc</code> package is installed.
					</li><li class="listitem">
						<a class="link" href="https://people.redhat.com/duffy/selinux/selinux-coloring-book_A4-Stapled.pdf">The SELinux Coloring Book</a> helps you to better understand SELinux basic concepts.
					</li><li class="listitem">
						<a class="link" href="http://selinuxproject.org/page/FAQ">SELinux Wiki FAQ</a>
					</li></ul></div></section><section class="section" id="benefits-of-selinux_getting-started-with-selinux"><div class="titlepage"><div><div><h3 class="title">1.2. Benefits of running SELinux</h3></div></div></div><p class="_abstract _abstract">
				SELinux provides the following benefits:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						All processes and files are labeled. SELinux policy rules define how processes interact with files, as well as how processes interact with each other. Access is only allowed if an SELinux policy rule exists that specifically allows it.
					</li><li class="listitem">
						SELinux provides fine-grained access control. Stepping beyond traditional UNIX permissions that are controlled at user discretion and based on Linux user and group IDs, SELinux access decisions are based on all available information, such as an SELinux user, role, type, and, optionally, a security level.
					</li><li class="listitem">
						SELinux policy is administratively-defined and enforced system-wide.
					</li><li class="listitem">
						SELinux can mitigate privilege escalation attacks. Processes run in domains, and are therefore separated from each other. SELinux policy rules define how processes access files and other processes. If a process is compromised, the attacker only has access to the normal functions of that process, and to files the process has been configured to have access to. For example, if the Apache HTTP Server is compromised, an attacker cannot use that process to read files in user home directories, unless a specific SELinux policy rule was added or configured to allow such access.
					</li><li class="listitem">
						SELinux can enforce data confidentiality and integrity, and can protect processes from untrusted inputs.
					</li></ul></div><p>
				SELinux is designed to enhance existing security solutions, not replace antivirus software, secure passwords, firewalls, or other security systems. Even when running SELinux, it is important to continue to follow good security practices, such as keeping software up-to-date, using hard-to-guess passwords, and firewalls.
			</p></section><section class="section" id="selinux-examples_getting-started-with-selinux"><div class="titlepage"><div><div><h3 class="title">1.3. SELinux examples</h3></div></div></div><p>
				The following examples demonstrate how SELinux increases security:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The default action is deny. If an SELinux policy rule does not exist to allow access, such as for a process opening a file, access is denied.
					</li><li class="listitem">
						SELinux can confine Linux users. A number of confined SELinux users exist in the SELinux policy. Linux users can be mapped to confined SELinux users to take advantage of the security rules and mechanisms applied to them. For example, mapping a Linux user to the SELinux <code class="literal">user_u</code> user, results in a Linux user that is not able to run unless configured otherwise set user ID (setuid) applications, such as <code class="literal command">sudo</code> and <code class="literal command">su</code>.
					</li><li class="listitem">
						Increased process and data separation. The concept of SELinux <span class="emphasis"><em>domains</em></span> allows defining which processes can access certain files and directories. For example, when running SELinux, unless otherwise configured, an attacker cannot compromise a Samba server, and then use that Samba server as an attack vector to read and write to files used by other processes, such as MariaDB databases.
					</li><li class="listitem">
						SELinux helps mitigate the damage made by configuration mistakes. Domain Name System (DNS) servers often replicate information between each other in a zone transfer. Attackers can use zone transfers to update DNS servers with false information. When running the Berkeley Internet Name Domain (BIND) as a DNS server in RHEL, even if an administrator forgets to limit which servers can perform a zone transfer, the default SELinux policy prevent updates for zone files <a href="#ftn.idm139843084959872" class="footnote"><sup class="footnote" id="idm139843084959872">[1]</sup></a> that use zone transfers, by the BIND <code class="literal">named</code> daemon itself, and by other processes.
					</li><li class="listitem">
						Without SELinux, an attacker can misuse a vulnerability to path traversal on an Apache web server and access files and directories stored on the file system by using special elements such as <code class="literal">../</code>. If an attacker attempts an attack on a server running with SELinux in enforcing mode, SELinux denies access to files that the <code class="literal">httpd</code> process must not access. SELinux cannot block this type of attack completely but it effectively mitigates it.
					</li><li class="listitem">
						SELinux in enforcing mode successfully prevents exploitation of kernel NULL pointer dereference operators on non-SMAP platforms (CVE-2019-9213). Attackers use a vulnerability in the <code class="literal">mmap</code> function, which does not check mapping of a null page, for placing arbitrary code on this page.
					</li><li class="listitem">
						The <code class="literal">deny_ptrace</code> SELinux boolean and SELinux in enforcing mode protect systems from the <span class="strong strong"><strong>PTRACE_TRACEME</strong></span> vulnerability (CVE-2019-13272). Such configuration prevents scenarios when an attacker can get <code class="literal">root</code> privileges.
					</li><li class="listitem">
						The <code class="literal">nfs_export_all_rw</code> and <code class="literal">nfs_export_all_ro</code> SELinux booleans provide an easy-to-use tool to prevent misconfigurations of Network File System (NFS) such as accidental sharing <code class="literal">/home</code> directories.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/6964380">SELinux as a security pillar of an operating system - Real-world benefits and examples</a> Knowledgebase article
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/7047896">SELinux hardening with Ansible</a> Knowledgebase article
					</li><li class="listitem">
						<a class="link" href="https://github.com/fedora-selinux/selinux-playbooks">selinux-playbooks</a> Github repository with Ansible playbooks for SELinux hardening
					</li></ul></div><div class="footnotes"><br><hr width="100" align="left"><div id="ftn.idm139843084959872" class="footnote"><div class="para"><a href="#idm139843084959872" class="simpara"><sup class="simpara">[1] </sup></a>
							Text files that include DNS information, such as hostname to IP address mappings.
						</div></div></div></section><section class="section" id="selinux-architecture_getting-started-with-selinux"><div class="titlepage"><div><div><h3 class="title">1.4. SELinux architecture and packages</h3></div></div></div><p class="_abstract _abstract">
				SELinux is a Linux Security Module (LSM) that is built into the Linux kernel. The SELinux subsystem in the kernel is driven by a security policy which is controlled by the administrator and loaded at boot. All security-relevant, kernel-level access operations on the system are intercepted by SELinux and examined in the context of the loaded security policy. If the loaded policy allows the operation, it continues. Otherwise, the operation is blocked and the process receives an error.
			</p><p>
				SELinux decisions, such as allowing or disallowing access, are cached. This cache is known as the Access Vector Cache (AVC). When using these cached decisions, SELinux policy rules need to be checked less, which increases performance. Remember that SELinux policy rules have no effect if DAC rules deny access first. Raw audit messages are logged to the <code class="literal">/var/log/audit/audit.log</code> and they start with the <code class="literal">type=AVC</code> string.
			</p><p>
				In RHEL 9, system services are controlled by the <code class="literal">systemd</code> daemon; <code class="literal">systemd</code> starts and stops all services, and users and processes communicate with <code class="literal">systemd</code> using the <code class="literal">systemctl</code> utility. The <code class="literal">systemd</code> daemon can consult the SELinux policy and check the label of the calling process and the label of the unit file that the caller tries to manage, and then ask SELinux whether or not the caller is allowed the access. This approach strengthens access control to critical system capabilities, which include starting and stopping system services.
			</p><p>
				The <code class="literal">systemd</code> daemon also works as an SELinux Access Manager. It retrieves the label of the process running <code class="literal">systemctl</code> or the process that sent a <code class="literal">D-Bus</code> message to <code class="literal">systemd</code>. The daemon then looks up the label of the unit file that the process wanted to configure. Finally, <code class="literal">systemd</code> can retrieve information from the kernel if the SELinux policy allows the specific access between the process label and the unit file label. This means a compromised application that needs to interact with <code class="literal">systemd</code> for a specific service can now be confined by SELinux. Policy writers can also use these fine-grained controls to confine administrators.
			</p><p>
				If a process is sending a <code class="literal">D-Bus</code> message to another process and if the SELinux policy does not allow the <code class="literal">D-Bus</code> communication of these two processes, then the system prints a <code class="literal">USER_AVC</code> denial message, and the D-Bus communication times out. Note that the D-Bus communication between two processes works bidirectionally.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					To avoid incorrect SELinux labeling and subsequent problems, ensure that you start services using a <code class="literal">systemctl start</code> command.
				</p></div></rh-alert><p>
				RHEL 9 provides the following packages for working with SELinux:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						policies: <code class="literal package">selinux-policy-targeted</code>, <code class="literal package">selinux-policy-mls</code>
					</li><li class="listitem">
						tools: <code class="literal package">policycoreutils</code>, <code class="literal package">policycoreutils-gui</code>, <code class="literal package">libselinux-utils</code>, <code class="literal package">policycoreutils-python-utils</code>, <code class="literal package">setools-console</code>, <code class="literal package">checkpolicy</code>
					</li></ul></div></section><section class="section" id="selinux-states-and-modes_getting-started-with-selinux"><div class="titlepage"><div><div><h3 class="title">1.5. SELinux states and modes</h3></div></div></div><p class="_abstract _abstract">
				SELinux can run in one of three modes: enforcing, permissive, or disabled.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Enforcing mode is the default, and recommended, mode of operation; in enforcing mode SELinux operates normally, enforcing the loaded security policy on the entire system.
					</li><li class="listitem">
						In permissive mode, the system acts as if SELinux is enforcing the loaded security policy, including labeling objects and emitting access denial entries in the logs, but it does not actually deny any operations. While not recommended for production systems, permissive mode can be helpful for SELinux policy development and debugging.
					</li><li class="listitem">
						Disabled mode is strongly discouraged; not only does the system avoid enforcing the SELinux policy, it also avoids labeling any persistent objects such as files, making it difficult to enable SELinux in the future.
					</li></ul></div><p>
				Use the <code class="literal command">setenforce</code> utility to change between enforcing and permissive mode. Changes made with <code class="literal command">setenforce</code> do not persist across reboots. To change to enforcing mode, enter the <code class="literal command">setenforce 1</code> command as the Linux root user. To change to permissive mode, enter the <code class="literal command">setenforce 0</code> command. Use the <code class="literal command">getenforce</code> utility to view the current SELinux mode:
			</p><pre class="screen"># <span class="strong strong"><strong>getenforce</strong></span>
Enforcing</pre><pre class="screen"># <span class="strong strong"><strong>setenforce 0</strong></span>
# <span class="strong strong"><strong>getenforce</strong></span>
Permissive</pre><pre class="screen"># <span class="strong strong"><strong>setenforce 1</strong></span>
# <span class="strong strong"><strong>getenforce</strong></span>
Enforcing</pre><p>
				In Red Hat Enterprise Linux, you can set individual domains to permissive mode while the system runs in enforcing mode. For example, to make the <span class="emphasis"><em>httpd_t</em></span> domain permissive:
			</p><pre class="screen"># <span class="strong strong"><strong>semanage permissive -a <span class="emphasis"><em>httpd_t</em></span></strong></span></pre><p>
				Note that permissive domains are a powerful tool that can compromise security of your system. Red Hat recommends to use permissive domains with caution, for example, when debugging a specific scenario.
			</p></section></section><section class="chapter" id="changing-selinux-states-and-modes_using-selinux"><div class="titlepage"><div><div><h2 class="title">Chapter 2. Changing SELinux states and modes</h2></div></div></div><p class="_abstract _abstract">
			When enabled, SELinux can run in one of two modes: enforcing or permissive. The following sections show how to permanently change into these modes.
		</p><section class="section" id="changing-selinux-modes_changing-selinux-states-and-modes"><div class="titlepage"><div><div><h3 class="title">2.1. Permanent changes in SELinux states and modes</h3></div></div></div><p class="_abstract _abstract">
				As discussed in <a class="link" href="#selinux-states-and-modes_getting-started-with-selinux" title="1.5. SELinux states and modes">SELinux states and modes</a>, SELinux can be enabled or disabled. When enabled, SELinux has two modes: enforcing and permissive.
			</p><p>
				Use the <code class="literal command">getenforce</code> or <code class="literal command">sestatus</code> commands to check in which mode SELinux is running. The <code class="literal command">getenforce</code> command returns <code class="literal">Enforcing</code>, <code class="literal">Permissive</code>, or <code class="literal">Disabled</code>.
			</p><p>
				The <code class="literal command">sestatus</code> command returns the SELinux status and the SELinux policy being used:
			</p><pre class="screen">$ <span class="strong strong"><strong>sestatus</strong></span>
SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Memory protection checking:     actual (secure)
Max kernel policy version:      31</pre><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					When systems run SELinux in permissive mode, users and processes might label various file-system objects incorrectly. File-system objects created while SELinux is disabled are not labeled at all. This behavior causes problems when changing to enforcing mode because SELinux relies on correct labels of file-system objects.
				</p><p>
					To prevent incorrectly labeled and unlabeled files from causing problems, SELinux automatically relabels file systems when changing from the disabled state to permissive or enforcing mode. Use the <code class="literal command">fixfiles -F onboot</code> command as root to create the <code class="literal filename">/.autorelabel</code> file containing the <code class="literal option">-F</code> option to ensure that files are relabeled upon next reboot.
				</p><p>
					Before rebooting the system for relabeling, make sure the system will boot in permissive mode, for example by using the <code class="literal">enforcing=0</code> kernel option. This prevents the system from failing to boot in case the system contains unlabeled files required by <code class="literal">systemd</code> before launching the <code class="literal">selinux-autorelabel</code> service. For more information, see <a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2021835">RHBZ#2021835</a>.
				</p></div></rh-alert></section><section class="section" id="changing-to-permissive-mode_changing-selinux-states-and-modes"><div class="titlepage"><div><div><h3 class="title">2.2. Changing SELinux to permissive mode</h3></div></div></div><p>
				When SELinux is running in permissive mode, SELinux policy is not enforced. The system remains operational and SELinux does not deny any operations but only logs AVC messages, which can be then used for troubleshooting, debugging, and SELinux policy improvements. Each AVC is logged only once in this case.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">selinux-policy-targeted</code>, <code class="literal">libselinux-utils</code>, and <code class="literal">policycoreutils</code> packages are installed on your system.
					</li><li class="listitem">
						The <code class="literal">selinux=0</code> or <code class="literal">enforcing=0</code> kernel parameters are not used.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open the <code class="literal">/etc/selinux/config</code> file in a text editor of your choice, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/selinux/config</strong></span></pre></li><li class="listitem"><p class="simpara">
						Configure the <code class="literal">SELINUX=permissive</code> option:
					</p><pre class="screen"># This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
#       enforcing - SELinux security policy is enforced.
#       permissive - SELinux prints warnings instead of enforcing.
#       disabled - No SELinux policy is loaded.
SELINUX=<span class="strong strong"><strong>permissive</strong></span>
# SELINUXTYPE= can take one of these two values:
#       targeted - Targeted processes are protected,
#       mls - Multi Level Security protection.
SELINUXTYPE=targeted</pre></li><li class="listitem"><p class="simpara">
						Restart the system:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						After the system restarts, confirm that the <code class="literal">getenforce</code> command returns <code class="literal">Permissive</code>:
					</p><pre class="screen">$ <span class="strong strong"><strong>getenforce</strong></span>
Permissive</pre></li></ol></div></section><section class="section" id="changing-to-enforcing-mode_changing-selinux-states-and-modes"><div class="titlepage"><div><div><h3 class="title">2.3. Changing SELinux to enforcing mode</h3></div></div></div><p>
				When SELinux is running in enforcing mode, it enforces the SELinux policy and denies access based on SELinux policy rules. In RHEL, enforcing mode is enabled by default when the system was initially installed with SELinux.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">selinux-policy-targeted</code>, <code class="literal">libselinux-utils</code>, and <code class="literal">policycoreutils</code> packages are installed on your system.
					</li><li class="listitem">
						The <code class="literal">selinux=0</code> or <code class="literal">enforcing=0</code> kernel parameters are not used.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open the <code class="literal">/etc/selinux/config</code> file in a text editor of your choice, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/selinux/config</strong></span></pre></li><li class="listitem"><p class="simpara">
						Configure the <code class="literal option">SELINUX=enforcing</code> option:
					</p><pre class="screen"># This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
#       enforcing - SELinux security policy is enforced.
#       permissive - SELinux prints warnings instead of enforcing.
#       disabled - No SELinux policy is loaded.
SELINUX=<span class="strong strong"><strong>enforcing</strong></span>
# SELINUXTYPE= can take one of these two values:
#       targeted - Targeted processes are protected,
#       mls - Multi Level Security protection.
SELINUXTYPE=targeted</pre></li><li class="listitem"><p class="simpara">
						Save the change, and restart the system:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre><p class="simpara">
						On the next boot, SELinux relabels all the files and directories within the system and adds SELinux context for files and directories that were created when SELinux was disabled.
					</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						After the system restarts, confirm that the <code class="literal">getenforce</code> command returns <code class="literal">Enforcing</code>:
					</p><pre class="screen">$ <span class="strong strong"><strong>getenforce</strong></span>
Enforcing</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Troubleshooting</strong></p><p>
					After changing to enforcing mode, SELinux may deny some actions because of incorrect or missing SELinux policy rules.
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To view what actions SELinux denies, enter the following command as root:
					</p><pre class="screen"># <span class="strong strong"><strong>ausearch -m AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR -ts today</strong></span></pre></li><li class="listitem"><p class="simpara">
						Alternatively, with the <code class="literal">setroubleshoot-server</code> package installed, enter:
					</p><pre class="screen"># <span class="strong strong"><strong>grep "SELinux is preventing" /var/log/messages</strong></span></pre></li><li class="listitem"><p class="simpara">
						If SELinux is active and the Audit daemon (<code class="literal">auditd</code>) is not running on your system, then search for certain SELinux messages in the output of the <code class="literal">dmesg</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>dmesg | grep -i -e type=1300 -e type=1400</strong></span></pre></li></ul></div><p>
				See <a class="link" href="#troubleshooting-problems-related-to-selinux_using-selinux" title="Chapter 5. Troubleshooting problems related to SELinux">Troubleshooting problems related to SELinux</a> for more information.
			</p></section><section class="section" id="enabling-selinux-on-systems-that-previously-had-it-disabled_changing-selinux-states-and-modes"><div class="titlepage"><div><div><h3 class="title">2.4. Enabling SELinux on systems that previously had it disabled</h3></div></div></div><p id="enabling-selinux_changing-selinux-states-and-modes">
				To avoid problems, such as systems unable to boot or process failures, when enabling SELinux on systems that previously had it disabled, resolve Access Vector Cache (AVC) messages in permissive mode first.
			</p><p>
				When systems run SELinux in permissive mode, users and processes might label various file-system objects incorrectly. File-system objects created while SELinux is disabled are not labeled at all. This behavior causes problems when changing to enforcing mode because SELinux relies on correct labels of file-system objects.
			</p><p>
				To prevent incorrectly labeled and unlabeled files from causing problems, SELinux automatically relabels file systems when changing from the disabled state to permissive or enforcing mode.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Before rebooting the system for relabeling, make sure the system will boot in permissive mode, for example by using the <code class="literal">enforcing=0</code> kernel option. This prevents the system from failing to boot in case the system contains unlabeled files required by <code class="literal">systemd</code> before launching the <code class="literal">selinux-autorelabel</code> service. For more information, see <a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=2021835">RHBZ#2021835</a>.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Enable SELinux in permissive mode. For more information, see <a class="link" href="#changing-to-permissive-mode_changing-selinux-states-and-modes" title="2.2. Changing SELinux to permissive mode">Changing to permissive mode</a>.
					</li><li class="listitem"><p class="simpara">
						Restart your system:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li><li class="listitem">
						Check for SELinux denial messages. For more information, see <a class="link" href="#identifying-selinux-denials_troubleshooting-problems-related-to-selinux" title="5.1. Identifying SELinux denials">Identifying SELinux denials</a>.
					</li><li class="listitem"><p class="simpara">
						Ensure that files are relabeled upon the next reboot:
					</p><pre class="screen"># <span class="strong strong"><strong>fixfiles -F onboot</strong></span></pre><p class="simpara">
						This creates the <code class="literal filename">/.autorelabel</code> file containing the <code class="literal option">-F</code> option.
					</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
							Always switch to permissive mode before entering the <code class="literal">fixfiles -F onboot</code> command.
						</p></div></rh-alert><p class="simpara">
						By default, <code class="literal">autorelabel</code> uses as many threads in parallel as the system has available CPU cores. To use only a single thread during automatic relabeling, use the <code class="literal">fixfiles -T 1 onboot</code> command.
					</p></li><li class="listitem">
						If there are no denials, switch to enforcing mode. For more information, see <a class="link" href="#changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes" title="2.6. Changing SELinux modes at boot time">Changing SELinux modes at boot time</a>.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						After the system restarts, confirm that the <code class="literal">getenforce</code> command returns <code class="literal">Enforcing</code>:
					</p><pre class="screen">$ <span class="strong strong"><strong>getenforce</strong></span>
Enforcing</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Next steps</strong></p><p>
					To run custom applications with SELinux in enforcing mode, choose one of the following scenarios:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Run your application in the <code class="literal">unconfined_service_t</code> domain.
					</li><li class="listitem">
						Write a new policy for your application. See the <a class="link" href="#writing-a-custom-selinux-policy_using-selinux" title="Chapter 8. Writing a custom SELinux policy">Writing a custom SELinux policy</a> section for more information.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#selinux-states-and-modes_getting-started-with-selinux" title="1.5. SELinux states and modes">SELinux states and modes</a> section covers temporary changes in modes.
					</li></ul></div></section><section class="section" id="Enabling_and_Disabling_SELinux-Disabling_SELinux_changing-selinux-states-and-modes"><div class="titlepage"><div><div><h3 class="title">2.5. Disabling SELinux</h3></div></div></div><p>
				When you disable SELinux, your system does not load your SELinux policy. As a result, the system does not enforce the SELinux policy and does not log Access Vector Cache (AVC) messages. Therefore, all <a class="link" href="#benefits-of-selinux_getting-started-with-selinux" title="1.2. Benefits of running SELinux">benefits of running SELinux</a> are lost.
			</p><p>
				Do not disable SELinux except in specific scenarios, such as performance-sensitive systems where the weakened security does not impose significant risks.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					If your scenario requires to perform debugging in a production environment, temporarily use permissive mode instead of permanently disabling SELinux. See <a class="link" href="#changing-to-permissive-mode_changing-selinux-states-and-modes" title="2.2. Changing SELinux to permissive mode">Changing to permissive mode</a> for more information about permissive mode.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal package">grubby</code> package is installed:
					</p><pre class="screen">$ <span class="strong strong"><strong>rpm -q grubby</strong></span>
grubby-<span class="emphasis"><em>&lt;version&gt;</em></span></pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Configure your boot loader to add <code class="literal">selinux=0</code> to the kernel command line:
					</p><pre class="screen">$ <span class="strong strong"><strong>sudo grubby --update-kernel ALL --args selinux=0</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart your system:
					</p><pre class="screen">$ <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						After the reboot, confirm that the <code class="literal command">getenforce</code> command returns <code class="literal">Disabled</code>:
					</p><pre class="screen">$ <span class="strong strong"><strong>getenforce</strong></span>
Disabled</pre></li></ul></div></section><section class="section" id="changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes"><div class="titlepage"><div><div><h3 class="title">2.6. Changing SELinux modes at boot time</h3></div></div></div><p class="_abstract _abstract">
				On boot, you can set the following kernel parameters to change the way SELinux runs:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">enforcing=0</span></dt><dd><p class="simpara">
							Setting this parameter causes the system to start in permissive mode, which is useful when troubleshooting issues. Using permissive mode might be the only option to detect a problem if your file system is too corrupted. Moreover, in permissive mode, the system continues to create the labels correctly. The AVC messages that are created in this mode can be different than in enforcing mode.
						</p><p class="simpara">
							In permissive mode, only the first denial from a series of the same denials is reported. However, in enforcing mode, you might get a denial related to reading a directory, and an application stops. In permissive mode, you get the same AVC message, but the application continues reading files in the directory and you get an AVC for each denial in addition.
						</p></dd><dt><span class="term">selinux=0</span></dt><dd><p class="simpara">
							This parameter causes the kernel to not load any part of the SELinux infrastructure. The init scripts notice that the system booted with the <code class="literal option">selinux=0</code> parameter and touch the <code class="literal">/.autorelabel</code> file. This causes the system to automatically relabel the next time you boot with SELinux enabled.
						</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
								Do not use the <code class="literal option">selinux=0</code> parameter in a production environment. To debug your system, temporarily use permissive mode instead of disabling SELinux.
							</p></div></rh-alert></dd><dt><span class="term">autorelabel=1</span></dt><dd><p class="simpara">
							This parameter forces the system to relabel similarly to the following commands:
						</p><pre class="screen"># <span class="strong strong"><strong>touch /.autorelabel</strong></span>
# <span class="strong strong"><strong>reboot</strong></span></pre><p class="simpara">
							If a file system contains a large amount of mislabeled objects, start the system in permissive mode to make the autorelabel process successful.
						</p></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem"><p class="simpara">
						For additional SELinux-related kernel boot parameters, such as <code class="literal">checkreqprot</code>, see the <code class="literal">/usr/share/doc/kernel-doc-<span class="emphasis"><em>&lt;KERNEL_VER&gt;</em></span>/Documentation/admin-guide/kernel-parameters.txt</code> file installed with the <code class="literal">kernel-doc</code> package. Replace the <span class="emphasis"><em>&lt;KERNEL_VER&gt;</em></span> string with the version number of the installed kernel, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install kernel-doc</strong></span>
$ <span class="strong strong"><strong>less /usr/share/doc/kernel-doc-<span class="emphasis"><em>4.18.0</em></span>/Documentation/admin-guide/kernel-parameters.txt</strong></span></pre></li></ul></div></section></section><section class="chapter" id="managing-confined-and-unconfined-users_using-selinux"><div class="titlepage"><div><div><h2 class="title">Chapter 3. Managing confined and unconfined users</h2></div></div></div><p class="_abstract _abstract">
			Each Linux user is mapped to an SELinux user according to the rules in the SELinux policy. Administrators can modify these rules by using the <code class="literal">semanage login</code> utility or by assigning Linux users directly to specific SELinux users. Therefore, a Linux user has the restrictions of the SELinux user to which it is assigned. When a Linux user that is assigned to an SELinux user launches a process, this process inherits the SELinux user’s restrictions, unless other rules specify a different role or type.
		</p><section class="section" id="confined-and-unconfined-users_managing-confined-and-unconfined-users"><div class="titlepage"><div><div><h3 class="title">3.1. Confined and unconfined users in SELinux</h3></div></div></div><p class="_abstract _abstract">
				By default, all Linux users in Red Hat Enterprise Linux, including users with administrative privileges, are mapped to the unconfined SELinux user <code class="literal">unconfined_u</code>. You can improve the security of the system by assigning users to SELinux confined users.
			</p><p>
				The security context for a Linux user consists of the SELinux user, the SELinux role, and the SELinux type. For example:
			</p><pre class="screen">user_u:user_r:user_t</pre><p>
				Where:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">user_u</code></span></dt><dd>
							Is the SELinux user.
						</dd><dt><span class="term"><code class="literal">user_r</code></span></dt><dd>
							Is the SELinux role.
						</dd><dt><span class="term"><code class="literal">user_t</code></span></dt><dd>
							Is the SELinux type.
						</dd></dl></div><p>
				After a Linux user logs in, its SELinux user cannot change. However, its type and role can change, for example, during transitions.
			</p><p>
				To see the SELinux user mapping on your system, use the <code class="literal">semanage login -l</code> command as root:
			</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>semanage login -l</strong></span>
Login Name           SELinux User         MLS/MCS Range        Service

__default__          unconfined_u         s0-s0:c0.c1023       *
root                 unconfined_u         s0-s0:c0.c1023       *</pre><p>
				In Red Hat Enterprise Linux, Linux users are mapped to the SELinux <code class="literal">__default__</code> login by default, which is mapped to the SELinux <code class="literal">unconfined_u</code> user. The following line defines the default mapping:
			</p><pre class="screen"><span class="emphasis"><em>default</em></span>          unconfined_u         s0-s0:c0.c1023       *</pre><p>
				Confined users are restricted by SELinux rules explicitly defined in the current SELinux policy. Unconfined users are subject to only minimal restrictions by SELinux.
			</p><p>
				Confined and unconfined Linux users are subject to executable and writable memory checks, and are also restricted by MCS or MLS.
			</p><p>
				To list the available SELinux users, enter the following command:
			</p><pre class="screen">$ <span class="strong strong"><strong>seinfo -u</strong></span>
Users: 8
   guest_u
   root
   staff_u
   sysadm_u
   system_u
   unconfined_u
   user_u
   xguest_u</pre><p>
				Note that the <code class="literal">seinfo</code> command is provided by the <code class="literal">setools-console</code> package, which is not installed by default.
			</p><p>
				If an unconfined Linux user executes an application that SELinux policy defines as one that can transition from the <code class="literal">unconfined_t</code> domain to its own confined domain, the unconfined Linux user is still subject to the restrictions of that confined domain. The security benefit of this is that, even though a Linux user is running unconfined, the application remains confined. Therefore, the exploitation of a flaw in the application can be limited by the policy.
			</p><p>
				Similarly, we can apply these checks to confined users. Each confined user is restricted by a confined user domain. The SELinux policy can also define a transition from a confined user domain to its own target confined domain. In such a case, confined users are subject to the restrictions of that target confined domain. The main point is that special privileges are associated with the confined users according to their role.
			</p></section><section class="section" id="roles-and-access-rights-of-selinux-users_managing-confined-and-unconfined-users"><div class="titlepage"><div><div><h3 class="title">3.2. Roles and access rights of SELinux users<span id="selinux-user-capabilities"><!--Empty--></span></h3></div></div></div><p class="_abstract _abstract">
				The SELinux policy maps each Linux user to an SELinux user. This allows Linux users to inherit the restrictions of SELinux users.
			</p><p>
				You can customize the permissions for confined users in your SELinux policy according to specific needs by adjusting booleans in the policy. You can determine the current state of these booleans by using the <code class="literal">semanage boolean -l</code> command. To list all SELinux users, their SELinux roles, and levels and ranges for MLS and MCS, use the <code class="literal">semanage user -l</code> command as <code class="literal">root</code>.
			</p><rh-table id="idm139843088198080"><table class="lt-4-cols lt-7-rows"><caption>Table 3.1. Roles of SELinux users</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm139843085706656" scope="col">User</th><th align="left" valign="top" id="idm139843085705568" scope="col">Default role</th><th align="left" valign="top" id="idm139843085704480" scope="col">Additional roles</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139843085706656"> <p>
								<code class="literal">unconfined_u</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085705568"> <p>
								<code class="literal">unconfined_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085704480"> <p>
								<code class="literal">system_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843085706656"> <p>
								<code class="literal">guest_u</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085705568"> <p>
								<code class="literal">guest_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085704480"> </td></tr><tr><td align="left" valign="top" headers="idm139843085706656"> <p>
								<code class="literal">xguest_u</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085705568"> <p>
								<code class="literal">xguest_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085704480"> </td></tr><tr><td align="left" valign="top" headers="idm139843085706656"> <p>
								<code class="literal">user_u</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085705568"> <p>
								<code class="literal">user_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085704480"> </td></tr><tr><td rowspan="3" align="left" valign="top" headers="idm139843085706656"> <p>
								<code class="literal">staff_u</code>
							</p>
							 </td><td rowspan="3" align="left" valign="top" headers="idm139843085705568"> <p>
								<code class="literal">staff_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085704480"> <p>
								<code class="literal">sysadm_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843085704480"> <p>
								<code class="literal">unconfined_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843085704480"> <p>
								<code class="literal">system_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843085706656"> <p>
								<code class="literal">sysadm_u</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085705568"> <p>
								<code class="literal">sysadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085704480"> </td></tr><tr><td rowspan="3" align="left" valign="top" headers="idm139843085706656"> <p>
								<code class="literal">root</code>
							</p>
							 </td><td rowspan="3" align="left" valign="top" headers="idm139843085705568"> <p>
								<code class="literal">staff_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085704480"> <p>
								<code class="literal">sysadm_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843085704480"> <p>
								<code class="literal">unconfined_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843085704480"> <p>
								<code class="literal">system_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843085706656"> <p>
								<code class="literal">system_u</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085705568"> <p>
								<code class="literal">system_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843085704480"> </td></tr></tbody></table></rh-table><p>
				Note that <code class="literal">system_u</code> is a special user identity for system processes and objects, and <code class="literal">system_r</code> is the associated role. Administrators must never associate this <code class="literal">system_u</code> user and the <code class="literal">system_r</code> role to a Linux user. Also, <code class="literal">unconfined_u</code> and <code class="literal">root</code> are unconfined users. For these reasons, the roles associated to these SELinux users are not included in the following table <span class="emphasis"><em>Types and access rights of SELinux roles</em></span>.
			</p><p>
				Each SELinux role corresponds to an SELinux type and provides specific access rights.
			</p><rh-table id="idm139843076681376"><table class="gt-4-cols lt-7-rows"><caption>Table 3.2. Types and access rights of SELinux roles</caption><colgroup><col style="width: 17%; " class="col_1"><!--Empty--><col style="width: 17%; " class="col_2"><!--Empty--><col style="width: 17%; " class="col_3"><!--Empty--><col style="width: 17%; " class="col_4"><!--Empty--><col style="width: 17%; " class="col_5"><!--Empty--><col style="width: 17%; " class="col_6"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm139843084869888" scope="col">Role</th><th align="left" valign="top" id="idm139843084868800" scope="col">Type</th><th align="left" valign="top" id="idm139843084867712" scope="col">Log in using X Window System</th><th align="left" valign="top" id="idm139843084866608" scope="col"><code class="literal">su</code> and <code class="literal">sudo</code></th><th align="left" valign="top" id="idm139843086216320" scope="col">Execute in home directory and <code class="literal">/tmp</code> (default)</th><th align="left" valign="top" id="idm139843086214848" scope="col">Networking</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139843084869888"> <p>
								<code class="literal">unconfined_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084868800"> <p>
								<code class="literal">unconfined_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084867712"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843084866608"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086216320"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086214848"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843084869888"> <p>
								<code class="literal">guest_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084868800"> <p>
								<code class="literal">guest_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084867712"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm139843084866608"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm139843086216320"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086214848"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843084869888"> <p>
								<code class="literal">xguest_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084868800"> <p>
								<code class="literal">xguest_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084867712"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843084866608"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm139843086216320"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086214848"> <p>
								web browsers only (Mozilla Firefox, GNOME Web)
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843084869888"> <p>
								<code class="literal">user_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084868800"> <p>
								<code class="literal">user_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084867712"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843084866608"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm139843086216320"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086214848"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843084869888"> <p>
								<code class="literal">staff_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084868800"> <p>
								<code class="literal">staff_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084867712"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843084866608"> <p>
								only <code class="literal">sudo</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843086216320"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086214848"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843084869888"> <p>
								<code class="literal">auditadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084868800"> <p>
								<code class="literal">auditadm_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084867712"> </td><td align="left" valign="top" headers="idm139843084866608"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086216320"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086214848"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843084869888"> <p>
								<code class="literal">dbadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084868800"> <p>
								<code class="literal">dbadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084867712"> </td><td align="left" valign="top" headers="idm139843084866608"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086216320"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086214848"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843084869888"> <p>
								<code class="literal">logadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084868800"> <p>
								<code class="literal">logadm_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084867712"> </td><td align="left" valign="top" headers="idm139843084866608"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086216320"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086214848"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843084869888"> <p>
								<code class="literal">webadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084868800"> <p>
								<code class="literal">webadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084867712"> </td><td align="left" valign="top" headers="idm139843084866608"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086216320"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086214848"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843084869888"> <p>
								<code class="literal">secadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084868800"> <p>
								<code class="literal">secadm_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084867712"> </td><td align="left" valign="top" headers="idm139843084866608"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086216320"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086214848"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843084869888"> <p>
								<code class="literal">sysadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084868800"> <p>
								<code class="literal">sysadm_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084867712"> <p>
								only when the <code class="literal">xdm_sysadm_login</code> boolean is <code class="literal">on</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843084866608"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086216320"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843086214848"> <p>
								yes
							</p>
							 </td></tr></tbody></table></rh-table><p>
				For more detailed descriptions of the non-administrator roles, see <a class="link" href="#confined-non-administrator-roles-in-selinux_managing-confined-and-unconfined-users" title="3.3. Confined non-administrator roles in SELinux">Confined non-administrator roles in SELinux</a>.
			</p><p>
				For more detailed descriptions of the administrator roles, see <a class="link" href="#confined-administrator-roles-in-selinux_managing-confined-and-unconfined-users" title="3.4. Confined administrator roles in SELinux">Confined administrator roles in SELinux</a>.
			</p><p>
				To list all available roles, enter the <code class="literal">seinfo -r</code> command:
			</p><pre class="screen">$ <span class="strong strong"><strong>seinfo -r</strong></span>
Roles: 14
   auditadm_r
   dbadm_r
   guest_r
   logadm_r
   nx_server_r
   object_r
   secadm_r
   staff_r
   sysadm_r
   system_r
   unconfined_r
   user_r
   webadm_r
   xguest_r</pre><p>
				Note that the <code class="literal">seinfo</code> command is provided by the <code class="literal">setools-console</code> package, which is not installed by default.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">seinfo(1)</code>, <code class="literal">semanage-login(8)</code>, and <code class="literal">xguest_selinux(8)</code> man pages installed with the <code class="literal">selinux-policy-doc</code> package
					</li><li class="listitem">
						<a class="link" href="https://www.redhat.com/sysadmin/change-selinux-settings-boolean">How to modify SELinux settings with booleans</a>
					</li></ul></div></section><section class="section" id="confined-non-administrator-roles-in-selinux_managing-confined-and-unconfined-users"><div class="titlepage"><div><div><h3 class="title">3.3. Confined non-administrator roles in SELinux</h3></div></div></div><p>
				In SELinux, confined non-administrator roles grant specific sets of privileges and permissions for performing specific tasks to the Linux users assigned to them. By assigning separate confined non-administrator roles, you can assign specific privileges to individual users. This is useful in scenarios with multiple users who each have a different level of authorizations.
			</p><p>
				You can also customize the permissions of SELinux roles by changing the related SELinux booleans on your system. To see the SELinux booleans and their current state, use the <code class="literal">semanage boolean -l</code> command as root. You can get more detailed descriptions if you install the <code class="literal">selinux-policy-devel</code> package.
			</p><pre class="screen"># <span class="strong strong"><strong>semanage boolean -l</strong></span>
SELinux boolean                State  Default Description
…
xguest_connect_network         (on   ,   on)  Allow xguest users to configure Network Manager and connect to apache ports
xguest_exec_content            (on   ,   on)  Allow xguest to exec content
…</pre><p>
				Linux users in the <code class="literal">user_t</code>, <code class="literal">guest_t</code>, and <code class="literal">xguest_t</code> domains can only run set user ID (<code class="literal">setuid</code>) applications if SELinux policy permits it (for example, <code class="literal">passwd</code>). These users cannot run the <code class="literal">setuid</code> applications <code class="literal">su</code> and <code class="literal">sudo</code>, and therefore cannot use these applications to become root.
			</p><p>
				By default, Linux users in the <code class="literal">staff_t</code>, <code class="literal">user_t</code>, <code class="literal">guest_t</code>, and <code class="literal">xguest_t</code> domains can execute applications in their home directories and <code class="literal">/tmp</code>. Applications inherit the permissions of the user that executed them.
			</p><p>
				To prevent <code class="literal">guest_t</code>, and <code class="literal">xguest_t</code> users from executing applications in directories in which they have write access, set the <code class="literal">guest_exec_content</code> and <code class="literal">xguest_exec_content</code> booleans to <code class="literal">off</code>.
			</p><p>
				SELinux has the following confined non-administrator roles, each with specific privileges and limitations:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">guest_r</code></span></dt><dd><p class="simpara">
							Has very limited permissions. Users assigned to this role cannot access the network, but can execute files in the <code class="literal">/tmp</code> and <code class="literal">/home</code> directories.
						</p><p class="simpara">
							Related boolean:
						</p><pre class="screen">SELinux boolean                State  Default Description
guest_exec_content             (on   ,   on)  Allow guest to exec content</pre></dd><dt><span class="term"><code class="literal">xguest_r</code></span></dt><dd><p class="simpara">
							Has limited permissions. Users assigned to this role can log into X Window, access web pages by using network browsers, and access media. They can also execute files in the <code class="literal">/tmp</code> and <code class="literal">/home</code> directories.
						</p><p class="simpara">
							Related booleans:
						</p><pre class="screen">SELinux boolean                State  Default Description
xguest_connect_network         (on   ,   on)  Allow xguest users to configure Network Manager and connect to apache ports
xguest_exec_content            (on   ,   on)  Allow xguest to exec content
xguest_mount_media             (on   ,   on)  Allow xguest users to mount removable media
xguest_use_bluetooth           (on   ,   on)  Allow xguest to use blue tooth devices</pre></dd><dt><span class="term"><code class="literal">user_r</code></span></dt><dd><p class="simpara">
							Has non-privileged access with full user permissions. Users assigned to this role can perform most actions that do not require administrative privileges.
						</p><p class="simpara">
							Related booleans:
						</p><pre class="screen">SELinux boolean                State  Default Description
unprivuser_use_svirt           (off  ,  off)  Allow unprivileged user to create and transition to svirt domains.</pre></dd><dt><span class="term"><code class="literal">staff_r</code></span></dt><dd><p class="simpara">
							Has permissions similar to <code class="literal">user_r</code> and additional privileges. In particular, users assigned to this role are allowed to run <code class="literal">sudo</code> to execute administrative commands that are normally reserved for the <code class="literal">root</code> user. This changes roles and the effective user ID (EUID) but does not change the SELinux user.
						</p><p class="simpara">
							Related booleans:
						</p><pre class="screen">SELinux boolean                State  Default Description
staff_exec_content             (on   ,   on)  Allow staff to exec content
staff_use_svirt                (on   ,   on)  allow staff user to create and transition to svirt domains.</pre></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						To map a Linux user to <code class="literal">staff_u</code> and configure <code class="literal">sudo</code>, see <a class="link" href="#confining-an-administrator-using-sudo-and-the-sysadm_r-role_managing-confined-and-unconfined-users" title="3.9. Confining an administrator by using sudo and the sysadm_r role">Confining an administrator using sudo and the sysadm_r role</a>.
					</li><li class="listitem"><p class="simpara">
						For additional information about each role and the associated types, see the relevant man pages installed with the <code class="literal">selinux-policy-doc</code> package:
					</p><p class="simpara">
						<code class="literal">guest_selinux(8)</code>, <code class="literal">xguest_selinux(8)</code>, <code class="literal">user_selinux(8)</code>, and <code class="literal">staff_selinux(8)</code>
					</p></li></ul></div></section><section class="section" id="confined-administrator-roles-in-selinux_managing-confined-and-unconfined-users"><div class="titlepage"><div><div><h3 class="title">3.4. Confined administrator roles in SELinux</h3></div></div></div><p>
				In SELinux, confined administrator roles grant specific sets of privileges and permissions for performing specific tasks to the Linux users assigned to them. By assigning separate confined administrator roles, you can divide the privileges over various domains of system administration to individual users. This is useful in scenarios with multiple administrators, each with a separate domain.
			</p><p>
				You can assign these roles to SELinux users by using the <code class="literal">semanage user</code> command.
			</p><p>
				SELinux has the following confined administrator roles:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">auditadm_r</code></span></dt><dd><p class="simpara">
							The audit administrator role allows managing processes related to the Audit subsystem.
						</p><p class="simpara">
							Related boolean:
						</p><pre class="screen">SELinux boolean                State  Default Description
auditadm_exec_content          (on   ,   on)  Allow auditadm to exec content</pre></dd><dt><span class="term"><code class="literal">dbadm_r</code></span></dt><dd><p class="simpara">
							The database administrator role allows managing MariaDB and PostgreSQL databases.
						</p><p class="simpara">
							Related booleans:
						</p><pre class="screen">SELinux boolean                State  Default Description
dbadm_exec_content             (on   ,   on)  Allow dbadm to exec content
dbadm_manage_user_files        (off  ,  off)  Determine whether dbadm can manage generic user files.
dbadm_read_user_files          (off  ,  off)  Determine whether dbadm can read generic user files.</pre></dd><dt><span class="term"><code class="literal">logadm_r</code></span></dt><dd><p class="simpara">
							The log administrator role allows managing logs, specifically, SELinux types related to the Rsyslog logging service and the Audit subsystem.
						</p><p class="simpara">
							Related boolean:
						</p><pre class="screen">SELinux boolean                State  Default Description
logadm_exec_content            (on   ,   on)  Allow logadm to exec content</pre></dd><dt><span class="term"><code class="literal">webadm_r</code></span></dt><dd><p class="simpara">
							The web administrator allows managing the Apache HTTP Server.
						</p><p class="simpara">
							Related booleans:
						</p><pre class="screen">SELinux boolean                State  Default Description
webadm_manage_user_files       (off  ,  off)  Determine whether webadm can manage generic user files.
webadm_read_user_files         (off  ,  off)  Determine whether webadm can read generic user files.</pre></dd><dt><span class="term"><code class="literal">secadm_r</code></span></dt><dd><p class="simpara">
							The security administrator role allows managing the SELinux database.
						</p><p class="simpara">
							Related booleans:
						</p><pre class="screen">SELinux boolean                State  Default Description
secadm_exec_content            (on   ,   on)  Allow secadm to exec content</pre></dd><dt><span class="term"><code class="literal">sysadm_r</code></span></dt><dd><p class="simpara">
							The system administrator role allows doing everything of the previously listed roles and has additional privileges. In non-default configurations, security administration can be separated from system administration by disabling the <code class="literal">sysadm_secadm</code> module in the SELinux policy. For detailed instructions, see <a class="link" href="#proc_separating-system-administration-from-security-administration-in-mls_using-multi-level-security-mls" title="6.8. Separating system administration from security administration in MLS">Separating system administration from security administration in MLS</a>.
						</p><p class="simpara">
							The <code class="literal">sysadm_u</code> user cannot log in directly using SSH. To enable SSH logins for <code class="literal">sysadm_u</code>, set the <code class="literal">ssh_sysadm_login</code> boolean to <code class="literal">on</code>:
						</p><pre class="screen"># <span class="strong strong"><strong>setsebool -P ssh_sysadm_login on</strong></span></pre><p class="simpara">
							Related booleans:
						</p><pre class="screen">SELinux boolean                State  Default Description
ssh_sysadm_login               (on   ,   on)  Allow ssh logins as sysadm_r:sysadm_t
sysadm_exec_content            (on   ,   on)  Allow sysadm to exec content
xdm_sysadm_login               (on   ,   on)  Allow the graphical login program to login directly as sysadm_r:sysadm_t</pre></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						To assign a Linux user to a confined administrator role, see <a class="link" href="#confining-an-administrator-by-mapping-to-sysadm_u_managing-confined-and-unconfined-users" title="3.8. Confining an administrator by mapping to sysadm_u">Confining an administrator by mapping to sysadm_u</a>.
					</li><li class="listitem"><p class="simpara">
						For additional information about each role, and the associated types, see the relevant man pages installed with the <code class="literal">selinux-policy-doc</code> package:
					</p><p class="simpara">
						<code class="literal">auditadm_selinux(8)</code>, <code class="literal">dbadm_selinux (8)</code>, <code class="literal">logadm_selinux(8)</code>, <code class="literal">webadm_selinux(8)</code>, <code class="literal">secadm_selinux(8)</code>, and <code class="literal">sysadm_selinux(8)</code>
					</p></li></ul></div></section><section class="section" id="adding-a-new-user-automatically-mapped-to-the-selinux-unconfined_u-user_managing-confined-and-unconfined-users"><div class="titlepage"><div><div><h3 class="title">3.5. Adding a new user automatically mapped to the SELinux unconfined_u user</h3></div></div></div><p class="_abstract _abstract">
				The following procedure demonstrates how to add a new Linux user to the system. The user is automatically mapped to the SELinux <code class="literal">unconfined_u</code> user.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">root</code> user is running unconfined, as it does by default in Red Hat Enterprise Linux.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enter the following command to create a new Linux user named <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code>:
					</p><pre class="screen"># <span class="strong strong"><strong>useradd <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To assign a password to the Linux <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code> user:
					</p><pre class="screen"># <span class="strong strong"><strong>passwd <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span>
Changing password for user <span class="emphasis"><em>&lt;example_user&gt;</em></span>.
New password:
Retype new password:
passwd: all authentication tokens updated successfully.</pre></li><li class="listitem">
						Log out of your current session.
					</li><li class="listitem">
						Log in as the Linux <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code> user. When you log in, the <code class="literal">pam_selinux</code> PAM module automatically maps the Linux user to an SELinux user (in this case, <code class="literal">unconfined_u</code>), and sets up the resulting SELinux context. The Linux user’s shell is then launched with this context.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						When logged in as the <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code> user, check the context of a Linux user:
					</p><pre class="screen">$ <span class="strong strong"><strong>id -Z</strong></span>
unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">pam_selinux(8)</code> man page on your system
					</li></ul></div></section><section class="section" id="adding-a-new-user-as-an-selinux-confined-user_managing-confined-and-unconfined-users"><div class="titlepage"><div><div><h3 class="title">3.6. Adding a new user as an SELinux-confined user</h3></div></div></div><p class="_abstract _abstract">
				Use the following steps to add a new SELinux-confined user to the system. This example procedure maps the user to the SELinux <code class="literal">staff_u</code> user right with the command for creating the user account.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">root</code> user is running unconfined, as it does by default in Red Hat Enterprise Linux.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enter the following command to create a new Linux user named <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code> and map it to the SELinux <code class="literal">staff_u</code> user:
					</p><pre class="screen"># <span class="strong strong"><strong>useradd -Z staff_u <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To assign a password to the Linux <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code> user:
					</p><pre class="screen"># <span class="strong strong"><strong>passwd <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span>
Changing password for user <span class="emphasis"><em>&lt;example_user&gt;</em></span>.
New password:
Retype new password:
passwd: all authentication tokens updated successfully.</pre></li><li class="listitem">
						Log out of your current session.
					</li><li class="listitem">
						Log in as the Linux <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code> user. The user’s shell launches with the <code class="literal">staff_u</code> context.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						When logged in as the <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code> user, check the context of a Linux user:
					</p><pre class="screen">$ <span class="strong strong"><strong>id -Z</strong></span>
uid=1000(<span class="emphasis"><em>&lt;example_user&gt;</em></span>) gid=1000(<span class="emphasis"><em>&lt;example_user&gt;</em></span>) groups=1000(<span class="emphasis"><em>&lt;example_user&gt;</em></span>) context=staff_u:staff_r:staff_t:s0-s0:c0.c1023</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">pam_selinux(8)</code> man page on your system
					</li></ul></div></section><section class="section" id="confining-regular-users_managing-confined-and-unconfined-users"><div class="titlepage"><div><div><h3 class="title">3.7. Confining regular users in SELinux</h3></div></div></div><p class="_abstract _abstract">
				You can confine all regular users on your system by mapping them to the <code class="literal">user_u</code> SELinux user.
			</p><p>
				By default, all Linux users in Red Hat Enterprise Linux, including users with administrative privileges, are mapped to the unconfined SELinux user <code class="literal">unconfined_u</code>. You can improve the security of the system by assigning users to SELinux confined users. This is useful to conform with the <a class="link" href="https://rhel7stig.readthedocs.io/en/latest/medium.html#v-71971-the-operating-system-must-prevent-non-privileged-users-from-executing-privileged-functions-to-include-disabling-circumventing-or-altering-implemented-security-safeguards-countermeasures-rhel-07-020020">V-71971 Security Technical Implementation Guide</a>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the list of SELinux login records. The list displays the mappings of Linux users to SELinux users:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>semanage login -l</strong></span>

Login Name    SELinux User  MLS/MCS Range   Service

__default__   unconfined_u  s0-s0:c0.c1023       *
root          unconfined_u  s0-s0:c0.c1023       *</pre></li><li class="listitem"><p class="simpara">
						Map the <code class="literal">__default__</code> user, which represents all users without an explicit mapping, to the <code class="literal">user_u</code> SELinux user:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>semanage login -m -s user_u -r s0 __default__</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that the <code class="literal">__default__</code> user is mapped to the <code class="literal">user_u</code> SELinux user:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>semanage login -l</strong></span>

Login Name    SELinux User   MLS/MCS Range    Service

__default__   user_u         s0               *
root          unconfined_u   s0-s0:c0.c1023   *</pre></li><li class="listitem"><p class="simpara">
						Verify that the processes of a new user run in the <code class="literal">user_u:user_r:user_t:s0</code> SELinux context.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a new user:
							</p><pre class="screen"># <span class="strong strong"><strong>adduser <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
								Define a password for <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code>:
							</p><pre class="screen"># <span class="strong strong"><strong>passwd <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span></pre></li><li class="listitem">
								Log out as <code class="literal">root</code> and log in as the new user.
							</li><li class="listitem"><p class="simpara">
								Show the security context for the user’s ID:
							</p><pre class="screen">[<span class="emphasis"><em>&lt;example_user&gt;</em></span>@localhost ~]$ <span class="strong strong"><strong>id -Z</strong></span>
user_u:user_r:user_t:s0</pre></li><li class="listitem"><p class="simpara">
								Show the security context of the user’s current processes:
							</p><pre class="screen white-space-pre white-space-pre">[<span class="emphasis"><em>&lt;example_user&gt;</em></span>@localhost ~]$ <span class="strong strong"><strong>ps axZ</strong></span>
LABEL                           PID TTY      STAT   TIME COMMAND
-                                 1 ?        Ss     0:05 /usr/lib/systemd/systemd --switched-root --system --deserialize 18
-                              3729 ?        S      0:00 (sd-pam)
user_u:user_r:user_t:s0        3907 ?        Ss     0:00 /usr/lib/systemd/systemd --user
-                              3911 ?        S      0:00 (sd-pam)
user_u:user_r:user_t:s0        3918 ?        S      0:00 sshd: <span class="emphasis"><em>&lt;example_user&gt;</em></span>@pts/0
user_u:user_r:user_t:s0        3922 pts/0    Ss     0:00 -bash
user_u:user_r:user_dbusd_t:s0  3969 ?        Ssl    0:00 /usr/bin/dbus-daemon --session --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
user_u:user_r:user_t:s0        3971 pts/0    R+     0:00 ps axZ</pre></li></ol></div></li></ol></div></section><section class="section" id="confining-an-administrator-by-mapping-to-sysadm_u_managing-confined-and-unconfined-users"><div class="titlepage"><div><div><h3 class="title">3.8. Confining an administrator by mapping to <code class="literal">sysadm_u</code></h3></div></div></div><p class="_abstract _abstract">
				You can confine a user with administrative privileges by mapping the user directly to the <code class="literal">sysadm_u</code> SELinux user. When the user logs in, the session runs in the <code class="literal">sysadm_u:sysadm_r:sysadm_t</code> SELinux context.
			</p><p>
				By default, all Linux users in Red Hat Enterprise Linux, including users with administrative privileges, are mapped to the unconfined SELinux user <code class="literal">unconfined_u</code>. You can improve the security of the system by assigning users to SELinux confined users. This is useful to conform with the <a class="link" href="https://rhel7stig.readthedocs.io/en/latest/medium.html#v-71971-the-operating-system-must-prevent-non-privileged-users-from-executing-privileged-functions-to-include-disabling-circumventing-or-altering-implemented-security-safeguards-countermeasures-rhel-07-020020">V-71971 Security Technical Implementation Guide</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">root</code> user runs unconfined. This is the Red Hat Enterprise Linux default.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: To allow <code class="literal">sysadm_u</code> users to connect to the system by using SSH:
					</p><pre class="screen"># <span class="strong strong"><strong>setsebool -P ssh_sysadm_login on</strong></span></pre></li><li class="listitem"><p class="simpara">
						Map a new or existing user to the <code class="literal">sysadm_u</code> SELinux user:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To map a new user, add a new user to the <code class="literal">wheel</code> user group and map the user to the <code class="literal">sysadm_u</code> SELinux user:
							</p><pre class="screen"># <span class="strong strong"><strong>adduser -G wheel -Z sysadm_u <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
								To map an existing user, add the user to the <code class="literal">wheel</code> user group and map the user to the <code class="literal">sysadm_u</code> SELinux user:
							</p><pre class="screen"># <span class="strong strong"><strong>usermod -G wheel -Z sysadm_u <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span></pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Restore the context of the user’s home directory:
					</p><pre class="screen"># <span class="strong strong"><strong>restorecon -R -F -v /home/<span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code> is mapped to the <code class="literal">sysadm_u</code> SELinux user:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage login -l | grep <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span>
<span class="emphasis"><em>&lt;example_user&gt;</em></span>     sysadm_u    s0-s0:c0.c1023   *</pre></li><li class="listitem"><p class="simpara">
						Log in as <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code>, for example, by using SSH, and show the user’s security context:
					</p><pre class="screen">[<span class="emphasis"><em>&lt;example_user&gt;</em></span>@localhost ~]$ <span class="strong strong"><strong>id -Z</strong></span>
sysadm_u:sysadm_r:sysadm_t:s0-s0:c0.c1023</pre></li><li class="listitem"><p class="simpara">
						Switch to the <code class="literal">root</code> user:
					</p><pre class="screen">$ <span class="strong strong"><strong>sudo -i</strong></span>
[sudo] password for <span class="emphasis"><em>&lt;example_user&gt;</em></span>:</pre></li><li class="listitem"><p class="simpara">
						Verify that the security context remains unchanged:
					</p><pre class="screen"># <span class="strong strong"><strong>id -Z</strong></span>
sysadm_u:sysadm_r:sysadm_t:s0-s0:c0.c1023</pre></li><li class="listitem"><p class="simpara">
						Try an administrative task, for example, restarting the <code class="literal">sshd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart sshd</strong></span></pre><p class="simpara">
						If there is no output, the command finished successfully.
					</p><p class="simpara">
						If the command does not finish successfully, it prints the following message:
					</p><pre class="screen">Failed to restart sshd.service: Access denied
See system logs and 'systemctl status sshd.service' for details.</pre></li></ol></div></section><section class="section" id="confining-an-administrator-using-sudo-and-the-sysadm_r-role_managing-confined-and-unconfined-users"><div class="titlepage"><div><div><h3 class="title">3.9. Confining an administrator by using sudo and the sysadm_r role</h3></div></div></div><p class="_abstract _abstract">
				You can map a specific user with administrative privileges to the <code class="literal">staff_u</code> SELinux user, and configure <code class="literal">sudo</code> so that the user can gain the <code class="literal">sysadm_r</code> SELinux administrator role. This role allows the user to perform administrative tasks without SELinux denials. When the user logs in, the session runs in the <code class="literal">staff_u:staff_r:staff_t</code> SELinux context, but when the user enters a command by using <code class="literal">sudo</code>, the session changes to the <code class="literal">staff_u:sysadm_r:sysadm_t</code> context.
			</p><p>
				By default, all Linux users in Red Hat Enterprise Linux, including users with administrative privileges, are mapped to the unconfined SELinux user <code class="literal">unconfined_u</code>. You can improve the security of the system by assigning users to SELinux confined users. This is useful to conform with the <a class="link" href="https://rhel7stig.readthedocs.io/en/latest/medium.html#v-71971-the-operating-system-must-prevent-non-privileged-users-from-executing-privileged-functions-to-include-disabling-circumventing-or-altering-implemented-security-safeguards-countermeasures-rhel-07-020020">V-71971 Security Technical Implementation Guide</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">root</code> user runs unconfined. This is the Red Hat Enterprise Linux default.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Map a new or existing user to the <code class="literal">staff_u</code> SELinux user:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								To map a new user, add a new user to the <code class="literal">wheel</code> user group and map the user to the <code class="literal">staff_u</code> SELinux user:
							</p><pre class="screen"># <span class="strong strong"><strong>adduser -G wheel -Z staff_u <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
								To map an existing user, add the user to the <code class="literal">wheel</code> user group and map the user to the <code class="literal">staff_u</code> SELinux user:
							</p><pre class="screen"># <span class="strong strong"><strong>usermod -G wheel -Z staff_u <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Restore the context of the user’s home directory:
					</p><pre class="screen"># <span class="strong strong"><strong>restorecon -R -F -v /home/<span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To allow <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code> to gain the SELinux administrator role, create a new file in the <code class="literal">/etc/sudoers.d/</code> directory, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>visudo -f /etc/sudoers.d/<span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Add the following line to the new file:
					</p><pre class="screen white-space-pre white-space-pre"><span class="strong strong"><strong><span class="emphasis"><em>&lt;example_user&gt;</em></span> ALL=(ALL) TYPE=sysadm_t ROLE=sysadm_r ALL</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code> is mapped to the <code class="literal">staff_u</code> SELinux user:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage login -l | grep <span class="emphasis"><em>&lt;example_user&gt;</em></span></strong></span>
<span class="emphasis"><em>&lt;example_user&gt;</em></span>     staff_u    s0-s0:c0.c1023   *</pre></li><li class="listitem"><p class="simpara">
						Log in as <code class="literal"><span class="emphasis"><em>&lt;example_user&gt;</em></span></code>, for example, using SSH, and switch to the <code class="literal">root</code> user:
					</p><pre class="screen">[<span class="emphasis"><em>&lt;example_user&gt;</em></span>@localhost ~]$ <span class="strong strong"><strong>sudo -i</strong></span>
[sudo] password for <span class="emphasis"><em>&lt;example_user&gt;</em></span>:</pre></li><li class="listitem"><p class="simpara">
						Show the <code class="literal">root</code> security context:
					</p><pre class="screen"># <span class="strong strong"><strong>id -Z</strong></span>
staff_u:sysadm_r:sysadm_t:s0-s0:c0.c1023</pre></li><li class="listitem"><p class="simpara">
						Try an administrative task, for example, restarting the <code class="literal">sshd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart sshd</strong></span></pre><p class="simpara">
						If there is no output, the command finished successfully.
					</p><p class="simpara">
						If the command does not finish successfully, it prints the following message:
					</p><pre class="screen">Failed to restart sshd.service: Access denied
See system logs and 'systemctl status sshd.service' for details.</pre></li></ol></div></section><section class="section _additional-resources" id="additional_resources"><div class="titlepage"><div><div><h3 class="title">3.10. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">unconfined_selinux(8)</code>, <code class="literal">user_selinux(8)</code>, <code class="literal">staff_selinux(8)</code>, and <code class="literal">sysadm_selinux(8)</code> man pages installed with the <code class="literal">selinux-policy-doc</code> package.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/3263671">How to set up a system with SELinux confined users</a>
					</li><li class="listitem">
						<a class="link" href="https://www.redhat.com/sysadmin/change-selinux-settings-boolean">How to modify SELinux settings with booleans</a>
					</li></ul></div></section></section><section class="chapter" id="configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux"><div class="titlepage"><div><div><h2 class="title">Chapter 4. Configuring SELinux for applications and services with non-standard configurations</h2></div></div></div><p>
			When SELinux is in enforcing mode, the default policy is the targeted policy. The following sections provide information about setting up and configuring the SELinux policy for various services after you change configuration defaults, such as ports, database locations, or file-system permissions for processes.
		</p><p>
			You learn to change SELinux types for non-standard ports, to identify and fix incorrect labels for changes of default directories, and to adjust the policy using SELinux booleans.
		</p><section class="section" id="customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations"><div class="titlepage"><div><div><h3 class="title">4.1. Customizing the SELinux policy for the Apache HTTP server in a non-standard configuration</h3></div></div></div><p>
				You can configure the Apache HTTP server to listen on a different port and to provide content in a non-default directory. To prevent consequent SELinux denials, follow the steps in this procedure to adjust your system’s SELinux policy.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">httpd</code> package is installed and the Apache HTTP server is configured to listen on TCP port 3131 and to use the <code class="literal">/var/test_www/</code> directory instead of the default <code class="literal">/var/www/</code> directory.
					</li><li class="listitem">
						The <code class="literal package">policycoreutils-python-utils</code> and <code class="literal package">setroubleshoot-server</code> packages are installed on your system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Start the <code class="literal">httpd</code> service and check the status:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl start httpd</strong></span>
# <span class="strong strong"><strong>systemctl status httpd</strong></span>
...
httpd[14523]: (13)Permission denied: AH00072: make_sock: could not bind to address [::]:3131
...
systemd[1]: Failed to start The Apache HTTP Server.
...</pre></li><li class="listitem"><p class="simpara">
						The SELinux policy assumes that <code class="literal">httpd</code> runs on port 80:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage port -l | grep http</strong></span>
http_cache_port_t              tcp      8080, 8118, 8123, 10001-10010
http_cache_port_t              udp      3130
http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, 9000
pegasus_http_port_t            tcp      5988
pegasus_https_port_t           tcp      5989</pre></li><li class="listitem"><p class="simpara">
						Change the SELinux type of port 3131 to match port 80:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage port -a -t http_port_t -p tcp 3131</strong></span></pre></li><li class="listitem"><p class="simpara">
						Start <code class="literal">httpd</code> again:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl start httpd</strong></span></pre></li><li class="listitem"><p class="simpara">
						However, the content remains inaccessible:
					</p><pre class="screen"># <span class="strong strong"><strong>wget localhost:3131/index.html</strong></span>
...
HTTP request sent, awaiting response... 403 Forbidden
...</pre><p class="simpara">
						Find the reason with the <code class="literal">sealert</code> tool:
					</p><pre class="screen"># <span class="strong strong"><strong>sealert -l "*"</strong></span>
...
SELinux is preventing httpd from getattr access on the file /var/test_www/html/index.html.
...</pre></li><li class="listitem"><p class="simpara">
						Compare SELinux types for the standard and the new path using the <code class="literal">matchpathcon</code> tool:
					</p><pre class="screen"># <span class="strong strong"><strong>matchpathcon /var/www/html /var/test_www/html</strong></span>
/var/www/html       system_u:object_r:httpd_sys_content_t:s0
/var/test_www/html  system_u:object_r:var_t:s0</pre></li><li class="listitem"><p class="simpara">
						Change the SELinux type of the new <code class="literal">/var/test_www/html/</code> content directory to the type of the default <code class="literal">/var/www/html</code> directory:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage fcontext -a -e /var/www /var/test_www</strong></span></pre></li><li class="listitem"><p class="simpara">
						Relabel the <code class="literal">/var</code> directory recursively:
					</p><pre class="screen"># <span class="strong strong"><strong>restorecon -Rv /var/</strong></span>
...
Relabeled /var/test_www/html from unconfined_u:object_r:var_t:s0 to unconfined_u:object_r:httpd_sys_content_t:s0
Relabeled /var/test_www/html/index.html from unconfined_u:object_r:var_t:s0 to unconfined_u:object_r:httpd_sys_content_t:s0</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that the <code class="literal">httpd</code> service is running:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status httpd</strong></span>
...
Active: active (running)
...
systemd[1]: Started The Apache HTTP Server.
httpd[14888]: Server configured, listening on: port 3131
...</pre></li><li class="listitem"><p class="simpara">
						Verify that the content provided by the Apache HTTP server is accessible:
					</p><pre class="screen"># <span class="strong strong"><strong>wget localhost:3131/index.html</strong></span>
...
HTTP request sent, awaiting response... 200 OK
Length: 0 [text/html]
Saving to: ‘index.html’
...</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">semanage(8)</code>, <code class="literal">matchpathcon(8)</code>, and <code class="literal">sealert(8)</code> man pages.
					</li></ul></div></section><section class="section" id="adjusting-the-policy-for-sharing-nfs-and-cifs-volumes-using-selinux-booleans_configuring-selinux-for-applications-and-services-with-non-standard-configurations"><div class="titlepage"><div><div><h3 class="title">4.2. Adjusting the policy for sharing NFS and CIFS volumes by using SELinux booleans</h3></div></div></div><p class="_abstract _abstract">
				You can change parts of SELinux policy at runtime using booleans, even without any knowledge of SELinux policy writing. This enables changes, such as allowing services access to NFS volumes, without reloading or recompiling SELinux policy. The following procedure demonstrates listing SELinux booleans and configuring them to achieve the required changes in the policy.
			</p><p>
				NFS mounts on the client side are labeled with a default context defined by a policy for NFS volumes. In RHEL, this default context uses the <code class="literal">nfs_t</code> type. Also, Samba shares mounted on the client side are labeled with a default context defined by the policy. This default context uses the <code class="literal">cifs_t</code> type. You can enable or disable booleans to control which services are allowed to access the <code class="literal">nfs_t</code> and <code class="literal">cifs_t</code> types.
			</p><p>
				To allow the Apache HTTP server service (<code class="literal">httpd</code>) to access and share NFS and CIFS volumes, perform the following steps:
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Optionally, install the <code class="literal">selinux-policy-devel</code> package to obtain clearer and more detailed descriptions of SELinux booleans in the output of the <code class="literal">semanage boolean -l</code> command.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Identify SELinux booleans relevant for NFS, CIFS, and Apache:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage boolean -l | grep 'nfs\|cifs' | grep httpd</strong></span>
httpd_use_cifs                 (off  ,  off)  Allow httpd to access cifs file systems
httpd_use_nfs                  (off  ,  off)  Allow httpd to access nfs file systems</pre></li><li class="listitem"><p class="simpara">
						List the current state of the booleans:
					</p><pre class="screen">$ <span class="strong strong"><strong>getsebool -a | grep 'nfs\|cifs' | grep httpd</strong></span>
httpd_use_cifs --&gt; off
httpd_use_nfs --&gt; off</pre></li><li class="listitem"><p class="simpara">
						Enable the identified booleans:
					</p><pre class="screen"># <span class="strong strong"><strong>setsebool httpd_use_nfs on</strong></span>
# <span class="strong strong"><strong>setsebool httpd_use_cifs on</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Use <code class="literal">setsebool</code> with the <code class="literal">-P</code> option to make the changes persistent across restarts. A <code class="literal">setsebool -P</code> command requires a rebuild of the entire policy, and it might take some time depending on your configuration.
						</p></div></rh-alert></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that the booleans are <code class="literal">on</code>:
					</p><pre class="screen">$ <span class="strong strong"><strong>getsebool -a | grep 'nfs\|cifs' | grep httpd</strong></span>
httpd_use_cifs --&gt; on
httpd_use_nfs --&gt; on</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">semanage-boolean(8)</code>, <code class="literal">sepolicy-booleans(8)</code>, <code class="literal">getsebool(8)</code>, <code class="literal">setsebool(8)</code>, <code class="literal">booleans(5)</code>, and <code class="literal">booleans(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="finding-the-correct-selinux-type-for-managing-access-to-non-standard-directories_configuring-selinux-for-applications-and-services-with-non-standard-configurations"><div class="titlepage"><div><div><h3 class="title">4.3. Finding the correct SELinux type for managing access to non-standard directories</h3></div></div></div><p>
				If you need to set access-control rules that the default SELinux policy does not cover, start by searching for a boolean that matches your use case. If you cannot find a suitable boolean, you can use a matching SELinux type or even create a local policy module.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">selinux-policy-doc</code> and <code class="literal">setools-console</code> packages are installed on your system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List all SELinux-related topics and limit the results to a component you want to configure. For example:
					</p><pre class="screen"># <span class="strong strong"><strong>man -k selinux | grep samba</strong></span>
samba_net_selinux (8) - Security Enhanced Linux Policy for the samba_net processes
samba_selinux (8)    - Security Enhanced Linux Policy for the smbd processes
…</pre><p class="simpara">
						In the man page that corresponds to your scenario, find the related SELinux booleans, port types, and file types.
					</p><p class="simpara">
						Note that the <code class="literal">man -k selinux</code> or <code class="literal">apropos selinux</code> commands are available only after you install the <code class="literal">selinux-policy-doc</code> package.
					</p></li><li class="listitem"><p class="simpara">
						Optional: You can display the default mapping of processes on default locations by using the <code class="literal">semanage fcontext -l</code> command, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage fcontext -l | grep samba</strong></span>
…
/var/cache/samba(/.*)?                             all files          system_u:object_r:samba_var_t:s0
…
/var/spool/samba(/.*)?                             all files          system_u:object_r:samba_spool_t:s0
…</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">sesearch</code> command to display rules in the default SELinux policy. You can find the type and boolean to use by listing the corresponding rule, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>sesearch -A | grep samba | grep httpd</strong></span>
…
allow httpd_t cifs_t:dir { getattr open search }; [ use_samba_home_dirs &amp;&amp; httpd_enable_homedirs ]:True
…</pre></li><li class="listitem"><p class="simpara">
						An SELinux boolean might be the most straightforward solution for your configuration problem. You can display all available booleans and their values by using the <code class="literal">getsebool -a</code> command, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>getsebool -a | grep homedirs</strong></span>
git_cgi_enable_homedirs --&gt; off
git_system_enable_homedirs --&gt; off
httpd_enable_homedirs --&gt; off
mock_enable_homedirs --&gt; off
mpd_enable_homedirs --&gt; off
openvpn_enable_homedirs --&gt; on
ssh_chroot_rw_homedirs --&gt; off</pre></li><li class="listitem"><p class="simpara">
						You can verify that the selected boolean does exactly what you want by using the <code class="literal">sesearch</code> command, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>sesearch -A | grep httpd_enable_homedirs</strong></span>
…
allow httpd_suexec_t autofs_t:dir { getattr open search }; [ use_nfs_home_dirs &amp;&amp; httpd_enable_homedirs ]:True
allow httpd_suexec_t autofs_t:dir { getattr open search }; [ use_samba_home_dirs &amp;&amp; httpd_enable_homedirs ]:True
…</pre></li><li class="listitem"><p class="simpara">
						If no boolean matches your scenario, find an SELinux type that suits your case. You can find a type for your files by querying a corresponding rule from the default policy by using <code class="literal">sesearch</code>, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>sesearch -A -s httpd_t -c file -p read</strong></span>
…
allow httpd_t httpd_t:file { append getattr ioctl lock open read write };
allow httpd_t httpd_tmp_t:file { append create getattr ioctl link lock map open read rename setattr unlink write };
…</pre></li><li class="listitem">
						If none of the previous solutions cover your scenario, you can add a custom rule to the SELinux policy. See the <a class="link" href="#proc_creating-a-local-selinux-policy-module_troubleshooting-problems-related-to-selinux" title="5.4. Creating a local SELinux policy module">Creating a local SELinux policy module</a> section for more information.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						SELinux-related man pages provided by the <code class="literal">man -k selinux</code> command
					</li><li class="listitem">
						<code class="literal">sesearch(1)</code>, <code class="literal">semanage-fcontext(8)</code>, <code class="literal">semanage-boolean(8)</code>, and <code class="literal">getsebool(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="managing-access-to-non-standard-shared-directories-for-selinux-unprivileged-users_configuring-selinux-for-applications-and-services-with-non-standard-configurations"><div class="titlepage"><div><div><h3 class="title">4.4. Managing access to non-standard shared directories for unprivileged SELinux users</h3></div></div></div><p>
				You can configure access to a non-standard shared directory for the generic unprivileged SELinux user <code class="literal">user_u</code> by finding and mapping the corresponding SELinux file type. The <code class="literal">user_u</code> user has the default role <code class="literal">user_r</code> and the default domain <code class="literal">user_t</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">selinux-policy-doc</code> and <code class="literal">setools-console</code> packages are installed on your system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open the <code class="literal">user_selinux(8)</code> man page in your terminal:
					</p><pre class="screen">$ <span class="strong strong"><strong>man user_selinux</strong></span></pre><p class="simpara">
						In the <code class="literal">MANAGED FILES</code> section, find an attribute or a type that corresponds with your scenario. For example, the <code class="literal">user_home_type</code> attribute.
					</p></li><li class="listitem"><p class="simpara">
						Optional: To list all types assigned to an attribute, use the <code class="literal">seinfo</code> command with the <code class="literal">-x</code> and <code class="literal">-a</code> options, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>seinfo -x -a user_home_type</strong></span>

Type Attributes: 1
   attribute user_home_type;
…
	chrome_sandbox_home_t
	config_home_t
	cvs_home_t
	data_home_t
	dbus_home_t
	fetchmail_home_t
	gconf_home_t
	git_user_content_t
…</pre></li><li class="listitem"><p class="simpara">
						After you identify a candidate for the corresponding type, the <code class="literal">data_home_t</code> type in this example, check its SELinux mapping:
					</p><pre class="screen">$ <span class="strong strong"><strong>semanage fcontext -l | grep data_home_t</strong></span>
…
/root/\.local/share(/.*)?                          all files          system_u:object_r:data_home_t:s0
…</pre></li><li class="listitem"><p class="simpara">
						Map the corresponding type to a directory that you want to make accessible for <code class="literal">user_u</code>, for example, <code class="literal">/shared-data</code>:
					</p><pre class="screen">$ <span class="strong strong"><strong>semanage fcontext -a -t data_home_t '/shared-data(/.*)?'</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the mapping of the directory you configured:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage fcontext -l | grep "shared-data"</strong></span>
/shared-data(/.*)?                             	all files      	system_u:object_r:data_home_t:s0</pre></li><li class="listitem">
						Log in as a Linux user mapped to the <code class="literal">user_u</code> SELinux user, and verify you can access the directory.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem"><p class="simpara">

					</p><p class="simpara">
						<a class="link" href="#managing-confined-and-unconfined-users_using-selinux" title="Chapter 3. Managing confined and unconfined users">Managing confined and unconfined users</a>
					</p></li><li class="listitem">
						<code class="literal">seinfo(1)</code>, <code class="literal">semanage-fcontext(8)</code>, and <code class="literal">user_selinux(8)</code> man pages on your system
					</li></ul></div></section></section><section class="chapter" id="troubleshooting-problems-related-to-selinux_using-selinux"><div class="titlepage"><div><div><h2 class="title">Chapter 5. Troubleshooting problems related to SELinux</h2></div></div></div><p class="_abstract _abstract">
			If you plan to enable SELinux on systems where it has been previously disabled or if you run a service in a non-standard configuration, you might need to troubleshoot situations potentially blocked by SELinux. Note that in most cases, SELinux denials are signs of misconfiguration.
		</p><section class="section" id="identifying-selinux-denials_troubleshooting-problems-related-to-selinux"><div class="titlepage"><div><div><h3 class="title">5.1. Identifying SELinux denials</h3></div></div></div><p class="_abstract _abstract">
				Follow only the necessary steps from this procedure; in most cases, you need to perform just step 1.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						When your scenario is blocked by SELinux, the <code class="literal">/var/log/audit/audit.log</code> file is the first place to check for more information about a denial. To query Audit logs, use the <code class="literal">ausearch</code> tool. Because the SELinux decisions, such as allowing or disallowing access, are cached and this cache is known as the Access Vector Cache (AVC), use the <code class="literal">AVC</code> and <code class="literal">USER_AVC</code> values for the message type parameter, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>ausearch -m AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR -ts recent</strong></span></pre><p class="simpara">
						If there are no matches, check if the Audit daemon is running. If it does not, repeat the denied scenario after you start <code class="literal">auditd</code> and check the Audit log again.
					</p></li><li class="listitem"><p class="simpara">
						In case <code class="literal">auditd</code> is running, but there are no matches in the output of <code class="literal">ausearch</code>, check messages provided by the <code class="literal">systemd</code> Journal:
					</p><pre class="screen"># <span class="strong strong"><strong>journalctl -t setroubleshoot</strong></span></pre></li><li class="listitem"><p class="simpara">
						If SELinux is active and the Audit daemon is not running on your system, then search for certain SELinux messages in the output of the <code class="literal">dmesg</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>dmesg | grep -i -e type=1300 -e type=1400</strong></span></pre></li><li class="listitem"><p class="simpara">
						Even after the previous three checks, it is still possible that you have not found anything. In this case, AVC denials can be silenced because of <code class="literal">dontaudit</code> rules.
					</p><p class="simpara">
						To temporarily disable <code class="literal">dontaudit</code> rules, allowing all denials to be logged:
					</p><pre class="screen"># <span class="strong strong"><strong>semodule -DB</strong></span></pre><p class="simpara">
						After re-running your denied scenario and finding denial messages using the previous steps, the following command enables <code class="literal">dontaudit</code> rules in the policy again:
					</p><pre class="screen"># <span class="strong strong"><strong>semodule -B</strong></span></pre></li><li class="listitem"><p class="simpara">
						If you apply all four previous steps, and the problem still remains unidentified, consider if SELinux really blocks your scenario:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Switch to permissive mode:
							</p><pre class="screen"># <span class="strong strong"><strong>setenforce 0</strong></span>
$ <span class="strong strong"><strong>getenforce</strong></span>
Permissive</pre></li><li class="listitem">
								Repeat your scenario.
							</li></ul></div><p class="simpara">
						If the problem still occurs, something different than SELinux is blocking your scenario.
					</p></li></ol></div></section><section class="section" id="analyzing-an-already-found-selinux-denial_troubleshooting-problems-related-to-selinux"><div class="titlepage"><div><div><h3 class="title">5.2. Analyzing SELinux denial messages</h3></div></div></div><p class="_abstract _abstract">
				After <a class="link" href="#identifying-selinux-denials_troubleshooting-problems-related-to-selinux" title="5.1. Identifying SELinux denials">identifying</a> that SELinux is blocking your scenario, you might need to analyze the root cause before you choose a fix.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal package">policycoreutils-python-utils</code> and <code class="literal package">setroubleshoot-server</code> packages are installed on your system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List more details about a logged denial using the <code class="literal command">sealert</code> command, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>sealert -l "*"</strong></span>
SELinux is preventing /usr/bin/passwd from write access on the file
/root/test.

*****  Plugin leaks (86.2 confidence) suggests *****************************

If you want to ignore passwd trying to write access the test file,
because you believe it should not need this access.
Then you should report this as a bug.
You can generate a local policy module to dontaudit this access.
Do
# ausearch -x /usr/bin/passwd --raw | audit2allow -D -M my-passwd
# semodule -X 300 -i my-passwd.pp

*****  Plugin catchall (14.7 confidence) suggests **************************

...

Raw Audit Messages
type=AVC msg=audit(1553609555.619:127): avc:  denied  { write } for
pid=4097 comm="passwd" path="/root/test" dev="dm-0" ino=17142697
scontext=unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023
tcontext=unconfined_u:object_r:admin_home_t:s0 tclass=file permissive=0

...

Hash: passwd,passwd_t,admin_home_t,file,write</pre></li><li class="listitem"><p class="simpara">
						If the output obtained in the previous step does not contain clear suggestions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Enable full-path auditing to see full paths to accessed objects and to make additional Linux Audit event fields visible:
							</p><pre class="screen"># <span class="strong strong"><strong>auditctl -w /etc/shadow -p w -k shadow-write</strong></span></pre></li><li class="listitem"><p class="simpara">
								Clear the <code class="literal">setroubleshoot</code> cache:
							</p><pre class="screen"># <span class="strong strong"><strong>rm -f /var/lib/setroubleshoot/setroubleshoot.xml</strong></span></pre></li><li class="listitem">
								Reproduce the problem.
							</li><li class="listitem"><p class="simpara">
								Repeat step 1.
							</p><p class="simpara">
								After you finish the process, disable full-path auditing:
							</p><pre class="screen"># <span class="strong strong"><strong>auditctl -W /etc/shadow -p w -k shadow-write</strong></span></pre></li></ul></div></li><li class="listitem">
						If <code class="literal">sealert</code> returns only <code class="literal">catchall</code> suggestions or suggests adding a new rule using the <code class="literal">audit2allow</code> tool, match your problem with examples listed and explained in <a class="link" href="#selinux-denials-in-the-audit-log_troubleshooting-problems-related-to-selinux" title="5.5. SELinux denials in the Audit log">SELinux denials in the Audit log</a>.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">sealert(8)</code> man page on your system
					</li></ul></div></section><section class="section" id="fixing-an-analyzed-selinux-denial_troubleshooting-problems-related-to-selinux"><div class="titlepage"><div><div><h3 class="title">5.3. Fixing analyzed SELinux denials</h3></div></div></div><p class="_abstract _abstract">
				In most cases, suggestions provided by the <code class="literal">sealert</code> tool give you the right guidance about how to fix problems related to the SELinux policy. See <a class="link" href="#analyzing-an-already-found-selinux-denial_troubleshooting-problems-related-to-selinux" title="5.2. Analyzing SELinux denial messages">Analyzing SELinux denial messages</a> for information how to use <code class="literal">sealert</code> to analyze SELinux denials.
			</p><p>
				Be careful when the tool suggests using the <code class="literal">audit2allow</code> tool for configuration changes. You should not use <code class="literal">audit2allow</code> to generate a local policy module as your first option when you see an SELinux denial. Troubleshooting should start with a check if there is a labeling problem. The second most often case is that you have changed a process configuration, and you forgot to tell SELinux about it.
			</p><div class="formalpara"><p class="title"><strong>Labeling problems</strong></p><p>
					A common cause of labeling problems is when a non-standard directory is used for a service. For example, instead of using <code class="literal">/var/www/html/</code> for a website, an administrator might want to use <code class="literal">/srv/myweb/</code>. On Red Hat Enterprise Linux, the <code class="literal">/srv</code> directory is labeled with the <code class="literal">var_t</code> type. Files and directories created in <code class="literal">/srv</code> inherit this type. Also, newly-created objects in top-level directories, such as <code class="literal">/myserver</code>, can be labeled with the <code class="literal">default_t</code> type. SELinux prevents the Apache HTTP Server (<code class="literal">httpd</code>) from accessing both of these types. To allow access, SELinux must know that the files in <code class="literal">/srv/myweb/</code> are to be accessible by <code class="literal">httpd</code>:
				</p></div><pre class="screen"># <span class="strong strong"><strong>semanage fcontext -a -t httpd_sys_content_t "/srv/myweb(/.*)?"</strong></span></pre><p>
				This <code class="literal">semanage</code> command adds the context for the <code class="literal">/srv/myweb/</code> directory and all files and directories under it to the SELinux file-context configuration. The <code class="literal">semanage</code> utility does not change the context. As root, use the <code class="literal">restorecon</code> utility to apply the changes:
			</p><pre class="screen"># <span class="strong strong"><strong>restorecon -R -v /srv/myweb</strong></span></pre><div class="formalpara"><p class="title"><strong>Incorrect context</strong></p><p>
					The <code class="literal">matchpathcon</code> utility checks the context of a file path and compares it to the default label for that path. The following example demonstrates the use of <code class="literal">matchpathcon</code> on a directory that contains incorrectly labeled files:
				</p></div><pre class="screen white-space-pre white-space-pre">$ <span class="strong strong"><strong>matchpathcon -V /var/www/html/*</strong></span>
/var/www/html/index.html has context unconfined_u:object_r:user_home_t:s0, should be system_u:object_r:httpd_sys_content_t:s0
/var/www/html/page1.html has context unconfined_u:object_r:user_home_t:s0, should be system_u:object_r:httpd_sys_content_t:s0</pre><p>
				In this example, the <code class="literal">index.html</code> and <code class="literal">page1.html</code> files are labeled with the <code class="literal">user_home_t</code> type. This type is used for files in user home directories. Using the <code class="literal command">mv</code> command to move files from your home directory may result in files being labeled with the <code class="literal">user_home_t</code> type. This type should not exist outside of home directories. Use the <code class="literal">restorecon</code> utility to restore such files to their correct type:
			</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>restorecon -v /var/www/html/index.html</strong></span>
restorecon reset /var/www/html/index.html context unconfined_u:object_r:user_home_t:s0-&gt;system_u:object_r:httpd_sys_content_t:s0</pre><p>
				To restore the context for all files under a directory, use the <code class="literal option">-R</code> option:
			</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>restorecon -R -v /var/www/html/</strong></span>
restorecon reset /var/www/html/page1.html context unconfined_u:object_r:samba_share_t:s0-&gt;system_u:object_r:httpd_sys_content_t:s0
restorecon reset /var/www/html/index.html context unconfined_u:object_r:samba_share_t:s0-&gt;system_u:object_r:httpd_sys_content_t:s0</pre><div class="formalpara"><p class="title"><strong>Confined applications configured in non-standard ways</strong></p><p>
					Services can be run in a variety of ways. To account for that, you need to specify how you run your services. You can achieve this through SELinux booleans that allow parts of SELinux policy to be changed at runtime. This enables changes, such as allowing services access to NFS volumes, without reloading or recompiling SELinux policy. Also, running services on non-default port numbers requires policy configuration to be updated using the <code class="literal command">semanage</code> command.
				</p></div><p>
				For example, to allow the Apache HTTP Server to communicate with MariaDB, enable the <code class="literal">httpd_can_network_connect_db</code> boolean:
			</p><pre class="screen"># <span class="strong strong"><strong>setsebool -P httpd_can_network_connect_db on</strong></span></pre><p>
				Note that the <code class="literal option">-P</code> option makes the setting persistent across reboots of the system.
			</p><p>
				If access is denied for a particular service, use the <code class="literal">getsebool</code> and <code class="literal">grep</code> utilities to see if any booleans are available to allow access. For example, use the <code class="literal command">getsebool -a | grep ftp</code> command to search for FTP related booleans:
			</p><pre class="screen">$ <span class="strong strong"><strong>getsebool -a | grep ftp</strong></span>
ftpd_anon_write --&gt; off
ftpd_full_access --&gt; off
ftpd_use_cifs --&gt; off
ftpd_use_nfs --&gt; off

ftpd_connect_db --&gt; off
httpd_enable_ftp_server --&gt; off
tftp_anon_write --&gt; off</pre><p>
				To get a list of booleans and to find out if they are enabled or disabled, use the <code class="literal command">getsebool -a</code> command. To get a list of booleans including their meaning, and to find out if they are enabled or disabled, install the <code class="literal package">selinux-policy-devel</code> package and use the <code class="literal command">semanage boolean -l</code> command as root.
			</p><div class="formalpara"><p class="title"><strong>Port numbers</strong></p><p>
					Depending on policy configuration, services can only be allowed to run on certain port numbers. Attempting to change the port a service runs on without changing policy may result in the service failing to start. For example, run the <code class="literal command">semanage port -l | grep http</code> command as root to list <code class="literal">http</code> related ports:
				</p></div><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>semanage port -l | grep http</strong></span>
http_cache_port_t              tcp      3128, 8080, 8118
http_cache_port_t              udp      3130
http_port_t                    tcp      80, 443, 488, 8008, 8009, 8443
pegasus_http_port_t            tcp      5988
pegasus_https_port_t           tcp      5989</pre><p>
				The <code class="literal">http_port_t</code> port type defines the ports Apache HTTP Server can listen on, which in this case, are TCP ports 80, 443, 488, 8008, 8009, and 8443. If an administrator configures <code class="literal">httpd.conf</code> so that <code class="literal">httpd</code> listens on port 9876 (<code class="literal option">Listen 9876</code>), but policy is not updated to reflect this, the following command fails:
			</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>systemctl start httpd.service</strong></span>
Job for httpd.service failed. See 'systemctl status httpd.service' and 'journalctl -xn' for details.

# <span class="strong strong"><strong>systemctl status httpd.service</strong></span>
httpd.service - The Apache HTTP Server
   Loaded: loaded (/usr/lib/systemd/system/httpd.service; disabled)
   Active: failed (Result: exit-code) since Thu 2013-08-15 09:57:05 CEST; 59s ago
  Process: 16874 ExecStop=/usr/sbin/httpd $OPTIONS -k graceful-stop (code=exited, status=0/SUCCESS)
  Process: 16870 ExecStart=/usr/sbin/httpd $OPTIONS -DFOREGROUND (code=exited, status=1/FAILURE)</pre><p>
				An SELinux denial message similar to the following is logged to <code class="literal">/var/log/audit/audit.log</code>:
			</p><pre class="screen">type=AVC msg=audit(1225948455.061:294): avc:  denied  { name_bind } for  pid=4997 comm="httpd" src=9876 scontext=unconfined_u:system_r:httpd_t:s0 tcontext=system_u:object_r:port_t:s0 tclass=tcp_socket</pre><p>
				To allow <code class="literal">httpd</code> to listen on a port that is not listed for the <code class="literal">http_port_t</code> port type, use the <code class="literal command">semanage port</code> command to assign a different label to the port:
			</p><pre class="screen"># <span class="strong strong"><strong>semanage port -a -t http_port_t -p tcp 9876</strong></span></pre><p>
				The <code class="literal option">-a</code> option adds a new record; the <code class="literal option">-t</code> option defines a type; and the <code class="literal option">-p</code> option defines a protocol. The last argument is the port number to add.
			</p><div class="formalpara"><p class="title"><strong>Corner cases, evolving or broken applications, and compromised systems</strong></p><p>
					Applications may contain bugs, causing SELinux to deny access. Also, SELinux rules are evolving – SELinux may not have seen an application running in a certain way, possibly causing it to deny access, even though the application is working as expected. For example, if a new version of PostgreSQL is released, it may perform actions the current policy does not account for, causing access to be denied, even though access should be allowed.
				</p></div><p>
				For these situations, after access is denied, use the <code class="literal">audit2allow</code> utility to create a custom policy module to allow access. You can report missing rules in the SELinux policy in <span class="strong strong"><strong><a class="link" href="https://bugzilla.redhat.com/">Red Hat Bugzilla</a></strong></span>. For Red Hat Enterprise Linux 9, create bugs against the <code class="literal">Red Hat Enterprise Linux 9</code> product, and select the <code class="literal">selinux-policy</code> component. Include the output of the <code class="literal command">audit2allow -w -a</code> and <code class="literal command">audit2allow -a</code> commands in such bug reports.
			</p><p>
				If an application asks for major security privileges, it could be a signal that the application is compromised. Use intrusion detection tools to inspect such suspicious behavior.
			</p><p>
				The <span class="strong strong"><strong><a class="link" href="https://access.redhat.com/solution-engine/">Solution Engine</a></strong></span> on the <a class="link" href="https://access.redhat.com/">Red Hat Customer Portal</a> can also provide guidance in the form of an article containing a possible solution for the same or very similar problem you have. Select the relevant product and version and use SELinux-related keywords, such as <span class="emphasis"><em>selinux</em></span> or <span class="emphasis"><em>avc</em></span>, together with the name of your blocked service or application, for example: <code class="literal">selinux samba</code>.
			</p></section><section class="section" id="proc_creating-a-local-selinux-policy-module_troubleshooting-problems-related-to-selinux"><div class="titlepage"><div><div><h3 class="title">5.4. Creating a local SELinux policy module</h3></div></div></div><p>
				Adding specific SELinux policy modules to an active SELinux policy can fix certain problems with the SELinux policy. You can use this procedure to fix a specific Known Issue described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/">Red Hat release notes</a>, or to implement a specific <a class="link" href="https://access.redhat.com/solutions">Red Hat Solution</a>.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Use only rules provided by Red Hat. Red Hat does not support creating SELinux policy modules with custom rules, because this falls outside of the <a class="link" href="https://access.redhat.com/support/offerings/production/soc/">Production Support Scope of Coverage</a>. If you are not an expert, contact your Red Hat sales representative and request consulting services.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">setools-console</code> and <code class="literal">audit</code> packages for verification.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open a new <code class="literal">.cil</code> file with a text editor, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vim <span class="emphasis"><em>&lt;local_module&gt;</em></span>.cil</strong></span></pre><p class="simpara">
						To keep your local modules better organized, use the <code class="literal">local_</code> prefix in the names of local SELinux policy modules.
					</p></li><li class="listitem"><p class="simpara">
						Insert the custom rules from a Known Issue or a Red Hat Solution.
					</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							Do not write your own rules. Use only the rules provided in a specific Known Issue or Red Hat Solution.
						</p></div></rh-alert><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								For example, to implement the <a class="link" href="https://access.redhat.com/solutions/5729251">SELinux denies cups-lpd read access to cups.sock in RHEL</a> solution, insert the following rule:
							</p><pre class="screen">(allow cupsd_lpd_t cupsd_var_run_t (sock_file (read)))</pre><p class="simpara">
								The example solution has been fixed permanently for RHEL in <a class="link" href="https://access.redhat.com/errata/RHBA-2021:4420">RHBA-2021:4420</a>. Therefore, the parts of this procedure specific to this solution have no effect on updated RHEL 8 and 9 systems, and are included only as examples of syntax.
							</p><p class="simpara">
								You can use either of the two SELinux rule syntaxes, Common Intermediate Language (CIL) and m4. For example, <code class="literal">(allow cupsd_lpd_t cupsd_var_run_t (sock_file (read)))</code> in CIL is equivalent to the following in m4:
							</p><pre class="screen">module local_cupslpd-read-cupssock 1.0;

require {
    type cupsd_var_run_t;
    type cupsd_lpd_t;
    class sock_file read;
}

#============= cupsd_lpd_t ==============
allow cupsd_lpd_t cupsd_var_run_t:sock_file read;</pre></li></ul></div></li><li class="listitem">
						Save and close the file.
					</li><li class="listitem"><p class="simpara">
						Install the policy module:
					</p><pre class="screen"># <span class="strong strong"><strong>semodule -i <span class="emphasis"><em>&lt;local_module&gt;</em></span>.cil</strong></span></pre><p class="simpara">
						If you want to remove a local policy module which you created by using <code class="literal">semodule -i</code>, refer to the module name without the <code class="literal">.cil</code> suffix. To remove a local policy module, use <code class="literal">semodule -r <span class="emphasis"><em>&lt;local_module&gt;</em></span></code>.
					</p></li><li class="listitem"><p class="simpara">
						Restart any services related to the rules:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart <span class="emphasis"><em>&lt;service-name&gt;</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List the local modules installed in your SELinux policy:
					</p><pre class="screen"># <span class="strong strong"><strong>semodule -lfull | grep "local_"</strong></span>
400 local_module  cil</pre><p class="simpara">
						Because local modules have priority <code class="literal">400</code>, you can filter them from the list also by using that value, for example, by using the <code class="literal">semodule -lfull | grep -v ^100</code> command.
					</p></li><li class="listitem"><p class="simpara">
						Search the SELinux policy for the relevant allow rules:
					</p><pre class="screen"># <span class="strong strong"><strong>sesearch -A --source=<span class="emphasis"><em>&lt;SOURCENAME&gt;</em></span> --target=<span class="emphasis"><em>&lt;TARGETNAME&gt;</em></span> --class=<span class="emphasis"><em>&lt;CLASSNAME&gt;</em></span> --perm=<span class="emphasis"><em>&lt;P1&gt;</em></span>,<span class="emphasis"><em>&lt;P2&gt;</em></span></strong></span></pre><p class="simpara">
						Where <code class="literal"><span class="emphasis"><em>&lt;SOURCENAME&gt;</em></span></code> is the source SELinux type, <code class="literal"><span class="emphasis"><em>&lt;TARGETNAME&gt;</em></span></code> is the target SELinux type, <code class="literal"><span class="emphasis"><em>&lt;CLASSNAME&gt;</em></span></code> is the security class or object class name, and <code class="literal"><span class="emphasis"><em>&lt;P1&gt;</em></span></code> and <code class="literal"><span class="emphasis"><em>&lt;P2&gt;</em></span></code> are the specific permissions of the rule.
					</p><p class="simpara">
						For example, for the <a class="link" href="https://access.redhat.com/solutions/5729251">SELinux denies cups-lpd read access to cups.sock in RHEL</a> solution:
					</p><pre class="screen"># <span class="strong strong"><strong>sesearch -A --source=cupsd_lpd_t --target=cupsd_var_run_t --class=sock_file --perm=read</strong></span>
allow cupsd_lpd_t cupsd_var_run_t:sock_file { append getattr open read write };</pre><p class="simpara">
						The last line should now include the <code class="literal">read</code> operation.
					</p></li><li class="listitem"><p class="simpara">
						Verify that the relevant service runs confined by SELinux:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Identify the process related to the relevant service:
							</p><pre class="screen">$ <span class="strong strong"><strong>systemctl status <span class="emphasis"><em>&lt;service-name&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
								Check the SELinux context of the process listed in the output of the previous command:
							</p><pre class="screen">$ <span class="strong strong"><strong>ps -efZ | grep <span class="emphasis"><em>&lt;process-name&gt;</em></span></strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Verify that the service does not cause any SELinux denials:
					</p><pre class="screen"># <span class="strong strong"><strong>ausearch -m AVC -i -ts recent</strong></span>
&lt;no matches&gt;</pre><p class="simpara">
						The <code class="literal">-i</code> option interprets the numeric values into human-readable text.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/5494701">How to create custom SELinux policy module wisely</a> Knowledgebase article
					</li></ul></div></section><section class="section" id="selinux-denials-in-the-audit-log_troubleshooting-problems-related-to-selinux"><div class="titlepage"><div><div><h3 class="title">5.5. SELinux denials in the Audit log</h3></div></div></div><p class="_abstract _abstract">
				The Linux Audit system stores log entries in the <code class="literal filename">/var/log/audit/audit.log</code> file by default.
			</p><p>
				To list only SELinux-related records, use the <code class="literal command">ausearch</code> command with the message type parameter set to <code class="literal">AVC</code> and <code class="literal">AVC_USER</code> at a minimum, for example:
			</p><pre class="screen"># <span class="strong strong"><strong>ausearch -m</strong></span> AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR</pre><p>
				An SELinux denial entry in the Audit log file can look as follows:
			</p><pre class="screen">type=AVC msg=audit(1395177286.929:1638): avc:  denied  { read } for  pid=6591 comm="httpd" name="webpages" dev="0:37" ino=2112 scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:nfs_t:s0 tclass=dir</pre><p>
				The most important parts of this entry are:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">avc: denied</code> - the action performed by SELinux and recorded in Access Vector Cache (AVC)
					</li><li class="listitem">
						<code class="literal">{ read }</code> - the denied action
					</li><li class="listitem">
						<code class="literal">pid=6591</code> - the process identifier of the subject that tried to perform the denied action
					</li><li class="listitem">
						<code class="literal">comm="httpd"</code> - the name of the command that was used to invoke the analyzed process
					</li><li class="listitem">
						<code class="literal">httpd_t</code> - the SELinux type of the process
					</li><li class="listitem">
						<code class="literal">nfs_t</code> - the SELinux type of the object affected by the process action
					</li><li class="listitem">
						<code class="literal">tclass=dir</code> - the target object class
					</li></ul></div><p>
				The previous log entry can be translated to:
			</p><p>
				<span class="emphasis"><em>SELinux denied the <code class="literal">httpd</code> process with PID 6591 and the <code class="literal">httpd_t</code> type to read from a directory with the <code class="literal">nfs_t</code> type.</em></span>
			</p><p>
				The following SELinux denial message occurs when the Apache HTTP Server attempts to access a directory labeled with a type for the Samba suite:
			</p><pre class="screen">type=AVC msg=audit(1226874073.147:96): avc:  denied  { getattr } for  pid=2465 comm="httpd" path="/var/www/html/file1" dev=dm-0 ino=284133 scontext=unconfined_u:system_r:httpd_t:s0 tcontext=unconfined_u:object_r:samba_share_t:s0 tclass=file</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">{ getattr }</code> - the <code class="literal">getattr</code> entry indicates the source process was trying to read the target file’s status information. This occurs before reading files. SELinux denies this action because the process accesses the file and it does not have an appropriate label. Commonly seen permissions include <code class="literal">getattr</code>, <code class="literal">read</code>, and <code class="literal">write</code>.
					</li><li class="listitem">
						<code class="literal">path="/var/www/html/file1"</code> - the path to the object (target) the process attempted to access.
					</li><li class="listitem">
						<code class="literal">scontext="unconfined_u:system_r:httpd_t:s0"</code> - the SELinux context of the process (source) that attempted the denied action. In this case, it is the SELinux context of the Apache HTTP Server, which is running with the <code class="literal">httpd_t</code> type.
					</li><li class="listitem">
						<code class="literal">tcontext="unconfined_u:object_r:samba_share_t:s0"</code> - the SELinux context of the object (target) the process attempted to access. In this case, it is the SELinux context of <code class="literal">file1</code>.
					</li></ul></div><p>
				This SELinux denial can be translated to:
			</p><p>
				<span class="emphasis"><em>SELinux denied the <code class="literal">httpd</code> process with PID 2465 to access the <code class="literal">/var/www/html/file1</code> file with the <code class="literal">samba_share_t</code> type, which is not accessible to processes running in the <code class="literal">httpd_t</code> domain unless configured otherwise.</em></span>
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">auditd(8)</code> and <code class="literal">ausearch(8)</code> man pages on your system
					</li></ul></div></section><section class="section _additional-resources" id="additional-resources-troubleshooting-problems-related-to-selinux"><div class="titlepage"><div><div><h3 class="title">5.6. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/2191331">Basic SELinux Troubleshooting in CLI</a>
					</li><li class="listitem">
						<a class="link" href="https://fedorapeople.org/~dwalsh/SELinux/Presentations/selinux_four_things.pdf">What is SELinux trying to tell me? The 4 key causes of SELinux errors</a>
					</li></ul></div></section></section><section class="chapter" id="using-multi-level-security-mls_using-selinux"><div class="titlepage"><div><div><h2 class="title">Chapter 6. Using Multi-Level Security (MLS)</h2></div></div></div><p class="_abstract _abstract">
			The Multi-Level Security (MLS) policy uses <span class="emphasis"><em>levels</em></span> of clearance as originally designed by the US defense community. MLS meets a very narrow set of security requirements based on information management in rigidly controlled environments such as the military.
		</p><p>
			Using MLS is complex and does not map well to general use-case scenarios.
		</p><section class="section" id="multi-level-security-mls_using-multi-level-security-mls"><div class="titlepage"><div><div><h3 class="title">6.1. Multi-Level Security (MLS)</h3></div></div></div><p class="_abstract _abstract">
				The Multi-Level Security (MLS) technology classifies data in a hierarchical classification using information security levels, for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						[lowest] Unclassified
					</li><li class="listitem">
						[low] Confidential
					</li><li class="listitem">
						[high] Secret
					</li><li class="listitem">
						[highest] Top secret
					</li></ul></div><p>
				By default, the MLS SELinux policy uses 16 sensitivity levels:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">s0</code> is the least sensitive.
					</li><li class="listitem">
						<code class="literal">s15</code> is the most sensitive.
					</li></ul></div><p>
				MLS uses specific terminology to address sensitivity levels:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Users and processes are called <span class="strong strong"><strong>subjects</strong></span>, whose sensitivity level is called <span class="strong strong"><strong>clearance</strong></span>.
					</li><li class="listitem">
						Files, devices, and other passive components of the system are called <span class="strong strong"><strong>objects</strong></span>, whose sensitivity level is called <span class="strong strong"><strong>classification</strong></span>.
					</li></ul></div><p>
				To implement MLS, SELinux uses the <span class="strong strong"><strong>Bell-La Padula Model</strong></span> (BLP) model. This model specifies how information can flow within the system based on labels attached to each subject and object.
			</p><p>
				The basic principle of BLP is “<span class="strong strong"><strong>No read up, no write down.</strong></span>” This means that users can only read files at their own sensitivity level and lower, and data can flow only from lower levels to higher levels, and never the reverse.
			</p><p>
				The MLS SELinux policy, which is the implementation of MLS on RHEL, applies a modified principle called <span class="strong strong"><strong>Bell-La Padula with write equality</strong></span>. This means that users can read files at their own sensitivity level and lower, but can write only at exactly their own level. This prevents, for example, low-clearance users from writing content into top-secret files.
			</p><p>
				For example, by default, a user with clearance level <code class="literal">s2</code>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Can read files with sensitivity levels <code class="literal">s0</code>, <code class="literal">s1</code>, and <code class="literal">s2</code>.
					</li><li class="listitem">
						Cannot read files with sensitivity level <code class="literal">s3</code> and higher.
					</li><li class="listitem">
						Can modify files with sensitivity level of exactly <code class="literal">s2</code>.
					</li><li class="listitem">
						Cannot modify files with sensitivity level other than <code class="literal">s2</code>.
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Security administrators can adjust this behavior by modifying the system’s SELinux policy. For example, they can allow users to modify files at lower levels, which increases the file’s sensitivity level to the user’s clearance level.
				</p></div></rh-alert><p>
				In practice, users are typically assigned to a range of clearance levels, for example <code class="literal">s1-s2</code>. A user can read files with sensitivity levels lower than the user’s maximum level, and write to any files within that range.
			</p><p>
				For example, by default, a user with a clearance range <code class="literal">s1-s2</code>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Can read files with sensitivity levels <code class="literal">s0</code> and <code class="literal">s1</code>.
					</li><li class="listitem">
						Cannot read files with sensitivity level <code class="literal">s2</code> and higher.
					</li><li class="listitem">
						Can modify files with sensitivity level <code class="literal">s1</code>.
					</li><li class="listitem">
						Cannot modify files with sensitivity level other than <code class="literal">s1</code>.
					</li><li class="listitem">
						Can change own clearance level to <code class="literal">s2</code>.
					</li></ul></div><p>
				The security context for a non-privileged user in an MLS environment is, for example:
			</p><pre class="screen">user_u:user_r:user_t:s1</pre><p>
				Where:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">user_u</code></span></dt><dd>
							Is the SELinux user.
						</dd><dt><span class="term"><code class="literal">user_r</code></span></dt><dd>
							Is the SELinux role.
						</dd><dt><span class="term"><code class="literal">user_t</code></span></dt><dd>
							Is the SELinux type.
						</dd><dt><span class="term"><code class="literal">s1</code></span></dt><dd>
							Is the range of MLS sensitivity levels.
						</dd></dl></div><p>
				The system always combines MLS access rules with conventional file access permissions. For example, if a user with a security level of "Secret" uses Discretionary Access Control (DAC) to block access to a file by other users, even “Top Secret” users cannot access that file. A high security clearance does not automatically permit a user to browse the entire file system.
			</p><p>
				Users with top-level clearances do not automatically acquire administrative rights on multi-level systems. While they might have access to all sensitive information about the system, this is different from having administrative rights.
			</p><p>
				In addition, administrative rights do not provide access to sensitive information. For example, even when someone logs in as <code class="literal">root</code>, they still cannot read top-secret information.
			</p><p>
				You can further adjust access within an MLS system by using categories. With Multi-Category Security (MCS), you can define categories such as projects or departments, and users will only be allowed to access files in the categories to which they are assigned. For additional information, see <a class="link" href="#assembly_using-multi-category-security-mcs-for-data-confidentiality_using-selinux" title="Chapter 7. Using Multi-Category Security (MCS) for data confidentiality">Using Multi-Category Security (MCS) for data confidentiality</a> .
			</p></section><section class="section" id="ref_selinux-roles-in-mls_using-multi-level-security-mls"><div class="titlepage"><div><div><h3 class="title">6.2. SELinux roles in MLS</h3></div></div></div><p class="_abstract _abstract">
				The SELinux policy maps each Linux user to an SELinux user. This allows Linux users to inherit the restrictions of SELinux users.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					The MLS policy does not contain the <code class="literal">unconfined</code> module, including unconfined users, types, and roles. As a result, users that would be unconfined, including <code class="literal">root</code>, cannot access every object and perform every action they could in the targeted policy.
				</p></div></rh-alert><p>
				You can customize the permissions for confined users in your SELinux policy according to specific needs by adjusting the booleans in policy. You can determine the current state of these booleans by using the <code class="literal">semanage boolean -l</code> command. To list all SELinux users, their SELinux roles, and MLS/MCS levels and ranges, use the <code class="literal">semanage user -l</code> command as <code class="literal">root</code>.
			</p><rh-table id="idm139843078835632"><table class="lt-4-cols lt-7-rows"><caption>Table 6.1. Roles of SELinux users in MLS</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm139843081627072" scope="col">User</th><th align="left" valign="top" id="idm139843081625984" scope="col">Default role</th><th align="left" valign="top" id="idm139843081624896" scope="col">Additional roles</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139843081627072"> <p>
								<code class="literal">guest_u</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081625984"> <p>
								<code class="literal">guest_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081624896"> </td></tr><tr><td align="left" valign="top" headers="idm139843081627072"> <p>
								<code class="literal">xguest_u</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081625984"> <p>
								<code class="literal">xguest_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081624896"> </td></tr><tr><td align="left" valign="top" headers="idm139843081627072"> <p>
								<code class="literal">user_u</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081625984"> <p>
								<code class="literal">user_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081624896"> </td></tr><tr><td rowspan="4" align="left" valign="top" headers="idm139843081627072"> <p>
								<code class="literal">staff_u</code>
							</p>
							 </td><td rowspan="4" align="left" valign="top" headers="idm139843081625984"> <p>
								<code class="literal">staff_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081624896"> <p>
								<code class="literal">auditadm_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081624896"> <p>
								<code class="literal">secadm_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081624896"> <p>
								<code class="literal">sysadm_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081624896"> <p>
								<code class="literal">staff_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081627072"> <p>
								<code class="literal">sysadm_u</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081625984"> <p>
								<code class="literal">sysadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081624896"> </td></tr><tr><td rowspan="4" align="left" valign="top" headers="idm139843081627072"> <p>
								<code class="literal">root</code>
							</p>
							 </td><td rowspan="4" align="left" valign="top" headers="idm139843081625984"> <p>
								<code class="literal">staff_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081624896"> <p>
								<code class="literal">auditadm_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081624896"> <p>
								<code class="literal">secadm_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081624896"> <p>
								<code class="literal">sysadm_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081624896"> <p>
								<code class="literal">system_r</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081627072"> <p>
								<code class="literal">system_u</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081625984"> <p>
								<code class="literal">system_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081624896"> </td></tr></tbody></table></rh-table><p>
				Note that <code class="literal">system_u</code> is a special user identity for system processes and objects, and <code class="literal">system_r</code> is the associated role. Administrators must never associate this <code class="literal">system_u</code> user and the <code class="literal">system_r</code> role to a Linux user. Also, <code class="literal">unconfined_u</code> and <code class="literal">root</code> are unconfined users. For these reasons, the roles associated to these SELinux users are not included in the following table Types and access of SELinux roles.
			</p><p>
				Each SELinux role corresponds to an SELinux type and provides specific access rights.
			</p><rh-table id="idm139843081141232"><table class="gt-4-cols lt-7-rows"><caption>Table 6.2. Types and access of SELinux roles in MLS</caption><colgroup><col style="width: 17%; " class="col_1"><!--Empty--><col style="width: 17%; " class="col_2"><!--Empty--><col style="width: 17%; " class="col_3"><!--Empty--><col style="width: 17%; " class="col_4"><!--Empty--><col style="width: 17%; " class="col_5"><!--Empty--><col style="width: 17%; " class="col_6"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm139843081132656" scope="col">Role</th><th align="left" valign="top" id="idm139843081131568" scope="col">Type</th><th align="left" valign="top" id="idm139843081130480" scope="col">Login using X Window System</th><th align="left" valign="top" id="idm139843081129424" scope="col"><code class="literal">su</code> and <code class="literal">sudo</code></th><th align="left" valign="top" id="idm139843081127696" scope="col">Execute in home directory and <code class="literal">/tmp</code> (default)</th><th align="left" valign="top" id="idm139843081126112" scope="col">Networking</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139843081132656"> <p>
								<code class="literal">guest_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081131568"> <p>
								<code class="literal">guest_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081130480"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm139843081129424"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm139843081127696"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081126112"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081132656"> <p>
								<code class="literal">xguest_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081131568"> <p>
								<code class="literal">xguest_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081130480"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081129424"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm139843081127696"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081126112"> <p>
								web browsers only (Firefox, GNOME Web)
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081132656"> <p>
								<code class="literal">user_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081131568"> <p>
								<code class="literal">user_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081130480"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081129424"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm139843081127696"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081126112"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081132656"> <p>
								<code class="literal">staff_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081131568"> <p>
								<code class="literal">staff_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081130480"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081129424"> <p>
								only <code class="literal">sudo</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081127696"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081126112"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081132656"> <p>
								<code class="literal">auditadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081131568"> <p>
								<code class="literal">auditadm_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081130480"> </td><td align="left" valign="top" headers="idm139843081129424"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081127696"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081126112"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081132656"> <p>
								<code class="literal">secadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081131568"> <p>
								<code class="literal">secadm_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081130480"> </td><td align="left" valign="top" headers="idm139843081129424"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081127696"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081126112"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139843081132656"> <p>
								<code class="literal">sysadm_r</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081131568"> <p>
								<code class="literal">sysadm_t</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081130480"> <p>
								only when the <code class="literal">xdm_sysadm_login</code> boolean is <code class="literal">on</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139843081129424"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081127696"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm139843081126112"> <p>
								yes
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						By default, the <code class="literal">sysadm_r</code> role has the rights of the <code class="literal">secadm_r</code> role, which means a user with the <code class="literal">sysadm_r</code> role can manage the security policy. If this does not correspond to your use case, you can separate the two roles by disabling the <code class="literal">sysadm_secadm</code> module in the policy. For additional information, see <a class="link" href="#proc_separating-system-administration-from-security-administration-in-mls_using-multi-level-security-mls" title="6.8. Separating system administration from security administration in MLS">Separating system administration from security administration in MLS</a>.
					</li><li class="listitem">
						Non-login roles <code class="literal">dbadm_r</code>, <code class="literal">logadm_r</code>, and <code class="literal">webadm_r</code> can be used for a subset of administrative tasks. By default, these roles are not associated with any SELinux user.
					</li></ul></div></section><section class="section" id="switching-the-selinux-policy-to-mls_using-multi-level-security-mls"><div class="titlepage"><div><div><h3 class="title">6.3. Switching the SELinux policy to MLS</h3></div></div></div><p>
				Use the following steps to switch the SELinux policy from targeted to Multi-Level Security (MLS).
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Do not use the MLS policy on a system that is running the X Window System. Furthermore, when you relabel the file system with MLS labels, the system may prevent confined domains from access, which prevents your system from starting correctly. Therefore ensure that you switch SELinux to permissive mode before you relabel the files. On most systems, you see a lot of SELinux denials after switching to MLS, and many of them are not trivial to fix.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">selinux-policy-mls</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install selinux-policy-mls</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">/etc/selinux/config</code> file in a text editor of your choice, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/selinux/config</strong></span></pre></li><li class="listitem"><p class="simpara">
						Change SELinux mode from enforcing to permissive and switch from the targeted policy to MLS:
					</p><pre class="screen">SELINUX=permissive
SELINUXTYPE=mls</pre><p class="simpara">
						Save the changes, and quit the editor.
					</p></li><li class="listitem"><p class="simpara">
						Before you enable the MLS policy, you must relabel each file on the file system with an MLS label:
					</p><pre class="screen"># <span class="strong strong"><strong>fixfiles -F onboot</strong></span>
System will relabel on next boot</pre></li><li class="listitem"><p class="simpara">
						Restart the system:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li><li class="listitem"><p class="simpara">
						Check for SELinux denials:
					</p><pre class="screen"># <span class="strong strong"><strong>ausearch -m AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR -ts recent -i</strong></span></pre><p class="simpara">
						Because the previous command does not cover all scenarios, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/troubleshooting-problems-related-to-selinux_using-selinux">Troubleshooting problems related to SELinux</a> for guidance on identifying, analyzing, and fixing SELinux denials.
					</p></li><li class="listitem"><p class="simpara">
						After you ensure that there are no problems related to SELinux on your system, switch SELinux back to enforcing mode by changing the corresponding option in <code class="literal">/etc/selinux/config</code>:
					</p><pre class="screen">SELINUX=enforcing</pre></li><li class="listitem"><p class="simpara">
						Restart the system:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					If your system does not start or you are not able to log in after you switch to MLS, add the <code class="literal">enforcing=0</code> parameter to your kernel command line. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/changing-selinux-states-and-modes_using-selinux#changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes">Changing SELinux modes at boot time</a> for more information.
				</p><p>
					Also note that in MLS, SSH logins as the <code class="literal">root</code> user mapped to the <code class="literal">sysadm_r</code> SELinux role differ from logging in as <code class="literal">root</code> in <code class="literal">staff_r</code>. Before you start your system in MLS for the first time, consider allowing SSH logins as <code class="literal">sysadm_r</code> by setting the <code class="literal">ssh_sysadm_login</code> SELinux boolean to <code class="literal">1</code>. To enable <code class="literal">ssh_sysadm_login</code> later, already in MLS, you must log in as <code class="literal">root</code> in <code class="literal">staff_r</code>, switch to <code class="literal">root</code> in <code class="literal">sysadm_r</code> using the <code class="literal">newrole -r sysadm_r</code> command, and then set the boolean to <code class="literal">1</code>.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that SELinux runs in enforcing mode:
					</p><pre class="screen"># <span class="strong strong"><strong>getenforce</strong></span>
Enforcing</pre></li><li class="listitem"><p class="simpara">
						Check that the status of SELinux returns the <code class="literal">mls</code> value:
					</p><pre class="screen"># <span class="strong strong"><strong>sestatus | grep mls</strong></span>
Loaded policy name:             mls</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">fixfiles(8)</code>, <code class="literal">setsebool(8)</code>, and <code class="literal">ssh_selinux(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="establishing-user-clearance-in-mls_using-multi-level-security-mls"><div class="titlepage"><div><div><h3 class="title">6.4. Establishing user clearance in MLS</h3></div></div></div><p class="_abstract _abstract">
				After you switch SELinux policy to MLS, you must assign security clearance levels to users by mapping them to confined SELinux users. By default, a user with a given security clearance:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Cannot read objects that have a higher sensitivity level.
					</li><li class="listitem">
						Cannot write to objects at a different sensitivity level.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The SELinux policy is set to <code class="literal">mls</code>.
					</li><li class="listitem">
						The SELinux mode is set to <code class="literal">enforcing</code>.
					</li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package is installed.
					</li><li class="listitem"><p class="simpara">
						A user assigned to an SELinux confined user:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								For a non-privileged user, assigned to <code class="literal">user_u</code> (<span class="emphasis"><em>example_user</em></span> in the following procedure).
							</li><li class="listitem">
								For a privileged user, assigned to <code class="literal">staff_u</code> (<span class="emphasis"><em>staff</em></span> in the following procedure) .
							</li></ul></div></li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Make sure that the users have been created when the MLS policy was active. Users created in other SELinux policies cannot be used in MLS.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: To prevent adding errors to your SELinux policy, switch to the <code class="literal">permissive</code> SELinux mode, which facilitates troubleshooting:
					</p><pre class="screen"># <span class="strong strong"><strong>setenforce 0</strong></span></pre><p class="simpara">
						Note that <span class="strong strong"><strong>in permissive mode, SELinux does not enforce the active policy</strong></span> but only logs Access Vector Cache (AVC) messages, which can be then used for troubleshooting and debugging.
					</p></li><li class="listitem"><p class="simpara">
						Define a clearance range for the <code class="literal">staff_u</code> SELinux user. For example, this command sets the clearance range from <code class="literal">s1</code> to <code class="literal">s15</code> with <code class="literal">s1</code> being the default clearance level:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage user -m -L <span class="emphasis"><em>s1</em></span> -r <span class="emphasis"><em>s1-s15</em></span> <span class="emphasis"><em>staff_u</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Generate SELinux file context configuration entries for user home directories:
					</p><pre class="screen"># <span class="strong strong"><strong>genhomedircon</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restore file security contexts to default:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>restorecon -R -F -v /home/</strong></span>
Relabeled /home/staff from staff_u:object_r:user_home_dir_t:s0 to staff_u:object_r:user_home_dir_t:s1
Relabeled /home/staff/.bash_logout from staff_u:object_r:user_home_t:s0 to staff_u:object_r:user_home_t:s1
Relabeled /home/staff/.bash_profile from staff_u:object_r:user_home_t:s0 to staff_u:object_r:user_home_t:s1
Relabeled /home/staff/.bashrc from staff_u:object_r:user_home_t:s0 to staff_u:object_r:user_home_t:s1</pre></li><li class="listitem"><p class="simpara">
						Assign a clearance level to the user:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage login -m -r <span class="emphasis"><em>s1</em></span> <span class="emphasis"><em>example_user</em></span></strong></span></pre><p class="simpara">
						Where <code class="literal"><span class="emphasis"><em>s1</em></span></code> is the clearance level assigned to the user.
					</p></li><li class="listitem"><p class="simpara">
						Relabel the user’s home directory to the user’s clearance level:
					</p><pre class="screen"># <span class="strong strong"><strong>chcon -R -l <span class="emphasis"><em>s1</em></span> /home/<span class="emphasis"><em>example_user</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: If you previously switched to the <code class="literal">permissive</code> SELinux mode, and after you verify that everything works as expected, switch back to the <code class="literal">enforcing</code> SELinux mode:
					</p><pre class="screen"># <span class="strong strong"><strong>setenforce 1</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the user is mapped to the correct SELinux user and has the correct clearance level assigned:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>semanage login -l</strong></span>
Login Name      SELinux User         MLS/MCS Range        Service
__default__     user_u               s0-s0                *
example_user    user_u               <span class="strong strong"><strong><span class="emphasis"><em>s1</em></span></strong></span>                   *
…</pre></li><li class="listitem">
						Log in as the user within MLS.
					</li><li class="listitem"><p class="simpara">
						Verify that the user’s security level works correctly:
					</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
							The files you use for verification should not contain any sensitive information in case the configuration is incorrect and the user actually can access the files without authorization.
						</p></div></rh-alert><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Verify that the user cannot read a file with a higher-level sensitivity.
							</li><li class="listitem">
								Verify that the user can write to a file with the same sensitivity.
							</li><li class="listitem">
								Verify that the user can read a file with a lower-level sensitivity.
							</li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#switching-the-selinux-policy-to-mls_using-multi-level-security-mls" title="6.3. Switching the SELinux policy to MLS">Switching the SELinux policy to MLS</a>
					</li><li class="listitem">
						<a class="link" href="#adding-a-new-user-as-an-selinux-confined-user_managing-confined-and-unconfined-users" title="3.6. Adding a new user as an SELinux-confined user">Adding a new user as an SELinux-confined user</a>
					</li><li class="listitem">
						<a class="link" href="#changing-selinux-states-and-modes_using-selinux" title="Chapter 2. Changing SELinux states and modes">Permanent changes in SELinux states and modes</a>
					</li><li class="listitem">
						<a class="link" href="#troubleshooting-problems-related-to-selinux_using-selinux" title="Chapter 5. Troubleshooting problems related to SELinux">Troubleshooting problems related to SELinux</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/2191331">Basic SELinux Troubleshooting in CLI</a> Knowledgebase article
					</li></ul></div></section><section class="section" id="proc_changing-a-users-clearance-level-within-the-defined-security-range-in-mls_using-multi-level-security-mls"><div class="titlepage"><div><div><h3 class="title">6.5. Changing a user’s clearance level within the defined security range in MLS</h3></div></div></div><p>
				As a user in Multi-Level Security (MLS), you can change your current clearance level within the range the administrator assigned to you. You can never exceed the upper limit of your range or reduce your level below the lower limit of your range. This allows you, for example, to modify lower-sensitivity files without increasing their sensitivity level to your highest clearance level.
			</p><p>
				For example, as a user assigned to range <code class="literal">s1-s3</code>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You can switch to levels <code class="literal">s1</code>, <code class="literal">s2</code>, and <code class="literal">s3</code>.
					</li><li class="listitem">
						You can switch to ranges <code class="literal">s1-s2</code>, and <code class="literal">s2-s3</code>.
					</li><li class="listitem">
						You cannot switch to ranges <code class="literal">s0-s3</code> or <code class="literal">s1-s4</code>.
					</li></ul></div><p>
				Switching to a different level opens a new shell with the different clearance. This means you cannot return to your original clearance level in the same way as decreasing it. However, you can always return to the previous shell by entering <code class="literal">exit</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The SELinux policy is set to <code class="literal">mls</code>.
					</li><li class="listitem">
						SELinux mode is set to <code class="literal">enforcing</code>.
					</li><li class="listitem">
						You can log in as a user assigned to a range of MLS clearance levels.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in as the user from a secure terminal.
					</p><p class="simpara">
						Secure terminals are defined in the <code class="literal">/etc/selinux/mls/contexts/securetty_types</code> file. By default, the console is a secure terminal, but SSH is not.
					</p></li><li class="listitem"><p class="simpara">
						Check the current user’s security context:
					</p><pre class="screen">$ <span class="strong strong"><strong>id -Z</strong></span>
user_u:user_r:user_t:<span class="emphasis"><em>s0-s2</em></span></pre><p class="simpara">
						In this example, the user is assigned to the <code class="literal">user_u</code> SELinux user, <code class="literal">user_r</code> role, <code class="literal">user_t</code> type, and the MLS security range <code class="literal">s0-s2</code>.
					</p></li><li class="listitem"><p class="simpara">
						Check the current user’s security context:
					</p><pre class="screen">$ <span class="strong strong"><strong>id -Z</strong></span>
user_u:user_r:user_t:<span class="emphasis"><em>s1-s2</em></span></pre></li><li class="listitem"><p class="simpara">
						Switch to a different security clearance range within the user’s clearance range:
					</p><pre class="screen">$ <span class="strong strong"><strong>newrole -l <span class="emphasis"><em>s1</em></span></strong></span></pre><p class="simpara">
						You can switch to any range whose maximum is lower or equal to your assigned range. Entering a single-level range changes the lower limit of the assigned range. For example, entering <code class="literal">newrole -l s1</code> as a user with a <code class="literal">s0-s2</code> range is equivalent to entering <code class="literal">newrole -l s1-s2</code>.
					</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the current user’s security context:
					</p><pre class="screen">$ <span class="strong strong"><strong>id -Z</strong></span>
user_u:user_r:user_t:<span class="emphasis"><em>s1-s2</em></span></pre></li><li class="listitem"><p class="simpara">
						Return to the previous shell with the original range by terminating the current shell:
					</p><pre class="screen">$ <span class="strong strong"><strong>exit</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#establishing-user-clearance-in-mls_using-multi-level-security-mls" title="6.4. Establishing user clearance in MLS">Establishing user clearance in MLS</a>
					</li><li class="listitem">
						<code class="literal">newrole(1)</code> and <code class="literal">securetty_types(5)</code> man pages on your system
					</li></ul></div></section><section class="section" id="proc_increasing-file-sensitivity-levels-in-mls_using-multi-level-security-mls"><div class="titlepage"><div><div><h3 class="title">6.6. Increasing file sensitivity levels in MLS</h3></div></div></div><p>
				By default, Multi-Level Security (MLS) users cannot increase file sensitivity levels. However, the security administrator (<code class="literal">secadm_r</code>) can change this default behavior to allow users to increase the sensitivity of files by adding the local module <code class="literal">mlsfilewrite</code> to the system’s SELinux policy. Then, users assigned to the SELinux type defined in the policy module can increase file classification levels by modifying the file. Any time a user modifies a file, the file’s sensitivity level increases to the lower value of the user’s current security range.
			</p><p>
				The security administrator, when logged in as a user assigned to the <code class="literal">secadm_r</code> role, can change the security levels of files by using the <code class="literal">chcon -l <span class="emphasis"><em>s0</em></span> <span class="emphasis"><em>/path/to/file</em></span></code> command. For more information, see <a class="link" href="#proc_changing-file-sensitivity-in-mls_using-multi-level-security-mls" title="6.7. Changing file sensitivity in MLS">Changing file sensitivity in MLS</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The SELinux policy is set to <code class="literal">mls</code>.
					</li><li class="listitem">
						SELinux mode is set to <code class="literal">enforcing</code>.
					</li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">mlsfilewrite</code> local module is installed in the SELinux MLS policy.
					</li><li class="listitem"><p class="simpara">
						You are logged in as a user in MLS which is:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Assigned to a defined security range. This example shows a user with a security range <code class="literal">s0-s2</code>.
							</li><li class="listitem">
								Assigned to the same SELinux type defined in the <code class="literal">mlsfilewrite</code> module. This example requires the <code class="literal">(typeattributeset mlsfilewrite (user_t))</code> module.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Display the security context of the current user:
					</p><pre class="screen">$ <span class="strong strong"><strong>id -Z</strong></span>
user_u:user_r:user_t:<span class="emphasis"><em><span class="strong strong"><strong>s0-s2</strong></span></em></span></pre></li><li class="listitem"><p class="simpara">
						Change the lower level of the user’s MLS clearance range to the level which you want to assign to the file:
					</p><pre class="screen">$ <span class="strong strong"><strong>newrole -l <span class="emphasis"><em>s1-s2</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Display the security context of the current user:
					</p><pre class="screen">$ <span class="strong strong"><strong>id -Z</strong></span>
user_u:user_r:user_t:<span class="emphasis"><em><span class="strong strong"><strong>s1-s2</strong></span></em></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Display the security context of the file:
					</p><pre class="screen">$ <span class="strong strong"><strong>ls -Z <span class="emphasis"><em>/path/to/file</em></span></strong></span>
user_u:object_r:user_home_t:<span class="emphasis"><em><span class="strong strong"><strong>s0</strong></span></em></span> <span class="emphasis"><em>/path/to/file</em></span></pre></li><li class="listitem"><p class="simpara">
						Change the file’s sensitivity level to the lower level of the user’s clearance range by modifying the file:
					</p><pre class="screen">$ <span class="strong strong"><strong>touch <span class="emphasis"><em>/path/to/file</em></span></strong></span></pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							The classification level reverts to the default value if the <code class="literal">restorecon</code> command is used on the system.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Optional: Exit the shell to return to the user’s previous security range:
					</p><pre class="screen">$ <span class="strong strong"><strong>exit</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display the security context of the file:
					</p><pre class="screen">$ <span class="strong strong"><strong>ls -Z <span class="emphasis"><em>/path/to/file</em></span></strong></span>
user_u:object_r:user_home_t:<span class="emphasis"><em><span class="strong strong"><strong>s1</strong></span></em></span> <span class="emphasis"><em>/path/to/file</em></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#proc_allowing-mls-users-to-edit-files-on-lower-levels_using-multi-level-security-mls" title="6.10. Allowing MLS users to edit files on lower levels">Allowing MLS users to edit files on lower levels</a>.
					</li></ul></div></section><section class="section" id="proc_changing-file-sensitivity-in-mls_using-multi-level-security-mls"><div class="titlepage"><div><div><h3 class="title">6.7. Changing file sensitivity in MLS</h3></div></div></div><p class="_abstract _abstract">
				In the MLS SELinux policy, users can only modify files at their own sensitivity level. This is intended to prevent any highly sensitive information to be exposed to users at lower clearance levels, and also prevent low-clearance users creating high-sensitivity documents. Administrators, however, can manually increase a file’s classification, for example for the file to be processed at the higher level.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						SELinux policy is set to <code class="literal">mls</code>.
					</li><li class="listitem">
						SELinux mode is set to enforcing.
					</li><li class="listitem"><p class="simpara">
						You have security administration rights, which means that you are assigned to either:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">secadm_r</code> role.
							</li><li class="listitem">
								If the <code class="literal">sysadm_secadm</code> module is enabled, to the <code class="literal">sysadm_r</code> role. The <code class="literal">sysadm_secadm</code> module is enabled by default.
							</li></ul></div></li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package is installed.
					</li><li class="listitem"><p class="simpara">
						A user assigned to any clearance level. For additional information, see <a class="link" href="#establishing-user-clearance-in-mls_using-multi-level-security-mls" title="6.4. Establishing user clearance in MLS">Establishing user clearance levels in MLS</a> .
					</p><p class="simpara">
						In this example, <code class="literal"><span class="emphasis"><em>User1</em></span></code> has clearance level <code class="literal">s1</code>.
					</p></li><li class="listitem"><p class="simpara">
						A file with a classification level assigned and to which you have access.
					</p><p class="simpara">
						In this example, <code class="literal"><span class="emphasis"><em>/path/to/file</em></span></code> has classification level <code class="literal">s1</code>.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the file’s classification level:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>ls -lZ <span class="emphasis"><em>/path/to/file</em></span></strong></span>
-rw-r-----. 1 User1 User1 user_u:object_r:user_home_t:<span class="emphasis"><em><span class="strong strong"><strong>s1</strong></span></em></span> 0 12. Feb 10:43 <span class="emphasis"><em>/path/to/file</em></span></pre></li><li class="listitem"><p class="simpara">
						Change the file’s default classification level:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>semanage fcontext -a -r <span class="emphasis"><em>s2</em></span> <span class="emphasis"><em>/path/to/file</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Force the relabeling of the file’s SELinux context:
					</p><pre class="screen"># <span class="strong strong"><strong>restorecon -F -v <span class="emphasis"><em>/path/to/file</em></span></strong></span>
Relabeled <span class="emphasis"><em>/path/to/file</em></span> from user_u:object_r:user_home_t:<span class="emphasis"><em><span class="strong strong"><strong>s1</strong></span></em></span> to user_u:object_r:user_home_t:s2</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the file’s classification level:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>ls -lZ <span class="emphasis"><em>/path/to/file</em></span></strong></span>
-rw-r-----. 1 User1 User1 user_u:object_r:user_home_t:<span class="emphasis"><em><span class="strong strong"><strong>s2</strong></span></em></span> 0 12. Feb 10:53 <span class="emphasis"><em>/path/to/file</em></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Verify that the lower-clearance user cannot read the file:
					</p><pre class="screen">$ <span class="strong strong"><strong>cat <span class="emphasis"><em>/path/to/file</em></span></strong></span>
cat: file: Permission denied</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#establishing-user-clearance-in-mls_using-multi-level-security-mls" title="6.4. Establishing user clearance in MLS">Establishing user clearance levels in MLS</a> .
					</li></ul></div></section><section class="section" id="proc_separating-system-administration-from-security-administration-in-mls_using-multi-level-security-mls"><div class="titlepage"><div><div><h3 class="title">6.8. Separating system administration from security administration in MLS</h3></div></div></div><p>
				By default, the <code class="literal">sysadm_r</code> role has the rights of the <code class="literal">secadm_r</code> role, which means a user with the <code class="literal">sysadm_r</code> role can manage the security policy. If you need more control over security authorizations, you can separate system administration from security administration by assigning a Linux user to the <code class="literal">secadm_r</code> role and disabling the <code class="literal">sysadm_secadm</code> module in the SELinux policy.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The SELinux policy is set to <code class="literal">mls</code>.
					</li><li class="listitem">
						The SELinux mode is set to <code class="literal">enforcing</code>.
					</li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package is installed.
					</li><li class="listitem"><p class="simpara">
						A Linux user which will be assigned to the <code class="literal">secadm_r</code> role:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The user is assigned to the <code class="literal">staff_u</code> SELinux user
							</li><li class="listitem">
								A password for this user has been defined.
							</li></ul></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
							Make sure you can log in as the user which will be assigned to the <code class="literal">secadm</code> role. If not, you can prevent any future modifications of the system’s SELinux policy.
						</p></div></rh-alert></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal">sudoers</code> file in the <code class="literal">/etc/sudoers.d</code> directory for the user:
					</p><pre class="screen"># <span class="strong strong"><strong>visudo -f /etc/sudoers.d/<span class="emphasis"><em>&lt;sec_adm_user&gt;</em></span></strong></span></pre><p class="simpara">
						To keep the <code class="literal">sudoers</code> files organized, replace <code class="literal"><span class="emphasis"><em>&lt;sec_adm_user&gt;</em></span></code> with the Linux user which will be assigned to the <code class="literal">secadm</code> role.
					</p></li><li class="listitem"><p class="simpara">
						Add the following content into the <code class="literal">/etc/sudoers.d/<span class="emphasis"><em>&lt;sec_adm_user&gt;</em></span></code> file:
					</p><pre class="screen"><span class="emphasis"><em>&lt;sec_adm_user&gt;</em></span> ALL=(ALL) TYPE=secadm_t ROLE=secadm_r ALL</pre><p class="simpara">
						This line authorizes <code class="literal"><span class="emphasis"><em>&lt;secadmuser&gt;</em></span></code> on all hosts to perform all commands, and maps the user to the <code class="literal">secadm</code> SELinux type and role by default.
					</p></li><li class="listitem"><p class="simpara">
						Log in as the <span class="emphasis"><em>&lt;sec_adm_user&gt;</em></span> user.
					</p><p class="simpara">
						To make sure that the SELinux context (which consists of SELinux user, role, and type) is changed, <span class="strong strong"><strong>log in using <code class="literal">ssh</code>, the console, or <code class="literal">xdm</code></strong></span>. Other ways, such as <code class="literal">su</code> and <code class="literal">sudo</code>, cannot change the entire SELinux context.
					</p></li><li class="listitem"><p class="simpara">
						Verify the user’s security context:
					</p><pre class="screen">$ <span class="strong strong"><strong>id</strong></span>
uid=1000(<span class="emphasis"><em>&lt;sec_adm_user&gt;</em></span>) gid=1000(<span class="emphasis"><em>&lt;sec_adm_user&gt;</em></span>) groups=1000(<span class="emphasis"><em>&lt;sec_adm_user&gt;</em></span>) context=staff_u:staff_r:staff_t:s0-s15:c0.c1023</pre></li><li class="listitem"><p class="simpara">
						Run the interactive shell for the root user:
					</p><pre class="screen">$ <span class="strong strong"><strong>sudo -i</strong></span>
[sudo] password for <span class="emphasis"><em>&lt;sec_adm_user&gt;</em></span>:</pre></li><li class="listitem"><p class="simpara">
						Verify the current user’s security context:
					</p><pre class="screen"># <span class="strong strong"><strong>id</strong></span>
uid=0(root) gid=0(root) groups=0(root) context=staff_u:secadm_r:secadm_t:s0-s15:c0.c1023</pre></li><li class="listitem"><p class="simpara">
						Disable the <code class="literal">sysadm_secadm</code> module from the policy:
					</p><pre class="screen"># <span class="strong strong"><strong>semodule -d sysadm_secadm</strong></span></pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							Use the <code class="literal">semodule -d</code> command instead of removing the system policy module by using the <code class="literal">semodule -r</code> command. The <code class="literal">semodule -r</code> command deletes the module from your system’s storage, which means it cannot be loaded again without reinstalling the <code class="literal">selinux-policy-mls</code> package.
						</p></div></rh-alert></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						As the user assigned to the <code class="literal">secadm</code> role, and in the interactive shell for the root user, verify that you can access the security policy data:
					</p><pre class="screen"># <span class="strong strong"><strong>seinfo -xt secadm_t</strong></span>

Types: 1
   type secadm_t, can_relabelto_shadow_passwords, (…) userdomain;</pre></li><li class="listitem"><p class="simpara">
						Log out from the root shell:
					</p><pre class="screen"># <span class="strong strong"><strong>logout</strong></span></pre></li><li class="listitem"><p class="simpara">
						Log out from the <code class="literal"><span class="emphasis"><em>&lt;sec_adm_user&gt;</em></span></code> user:
					</p><pre class="screen">$ <span class="strong strong"><strong>logout</strong></span>
Connection to localhost closed.</pre></li><li class="listitem"><p class="simpara">
						Display the current security context:
					</p><pre class="screen"># <span class="strong strong"><strong>id</strong></span>
uid=0(root) gid=0(root) groups=0(root) context=root:sysadm_r:sysadm_t:s0-s15:c0.c1023</pre></li><li class="listitem"><p class="simpara">
						Attempt to enable the <code class="literal">sysadm_secadm</code> module. The command should fail:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>semodule -e sysadm_secadm</strong></span>
SELinux:  Could not load policy file /etc/selinux/mls/policy/policy.31:  Permission denied
/sbin/load_policy:  Can't load policy:  Permission denied
libsemanage.semanage_reload_policy: load_policy returned error code 2. (No such file or directory).
SELinux:  Could not load policy file /etc/selinux/mls/policy/policy.31:  Permission denied
/sbin/load_policy:  Can't load policy:  Permission denied
libsemanage.semanage_reload_policy: load_policy returned error code 2. (No such file or directory).
semodule:  Failed!</pre></li><li class="listitem"><p class="simpara">
						Attempt to display the details about the <code class="literal">sysadm_t</code> SELinux type. The command should fail:
					</p><pre class="screen"># <span class="strong strong"><strong>seinfo -xt sysadm_t</strong></span>
[Errno 13] Permission denied: '/sys/fs/selinux/policy'</pre></li></ol></div></section><section class="section" id="proc_defining-a-secure-terminal-in-mls_using-multi-level-security-mls"><div class="titlepage"><div><div><h3 class="title">6.9. Defining a secure terminal in MLS</h3></div></div></div><p>
				The SELinux policy checks the type of the terminal from which a user is connected, and allows running of certain SELinux applications, for example <code class="literal">newrole</code>, only from secure terminals. Attempting this from a non-secure terminal produces an error: <code class="literal">Error: you are not allowed to change levels on a non secure terminal;</code>.
			</p><p>
				The <code class="literal">/etc/selinux/mls/contexts/securetty_types</code> file defines secure terminals for the Multi-Level Security (MLS) policy.
			</p><p>
				Default contents of the file:
			</p><pre class="screen">console_device_t
sysadm_tty_device_t
user_tty_device_t
staff_tty_device_t
auditadm_tty_device_t
secureadm_tty_device_t</pre><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Adding terminal types to the list of secure terminals can expose your system to security risks.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						SELinux policy is set to <code class="literal">mls</code>.
					</li><li class="listitem">
						You are connected from an already secure terminal, or SELinux is in permissive mode.
					</li><li class="listitem"><p class="simpara">
						You have security administration rights, which means that you are assigned to either:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">secadm_r</code> role.
							</li><li class="listitem">
								If the <code class="literal">sysadm_secadm</code> module is enabled, to the <code class="literal">sysadm_r</code> role. The <code class="literal">sysadm_secadm</code> module is enabled by default.
							</li></ul></div></li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Determine the current terminal type:
					</p><pre class="screen"># <span class="strong strong"><strong>ls -Z `tty`</strong></span>
root:object_r:<span class="strong strong"><strong>user_devpts_t</strong></span>:s0 /dev/pts/0</pre><p class="simpara">
						In this example output, <code class="literal">user_devpts_t</code> is the current terminal type.
					</p></li><li class="listitem">
						Add the relevant SELinux type on a new line in the <code class="literal">/etc/selinux/mls/contexts/securetty_types</code> file.
					</li><li class="listitem"><p class="simpara">
						Optional: Switch SELinux to enforcing mode:
					</p><pre class="screen"># <span class="strong strong"><strong>setenforce 1</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Log in from the previously insecure terminal you have added to the <code class="literal">/etc/selinux/mls/contexts/securetty_types</code> file.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">securetty_types(5)</code> man page on your system
					</li></ul></div></section><section class="section" id="proc_allowing-mls-users-to-edit-files-on-lower-levels_using-multi-level-security-mls"><div class="titlepage"><div><div><h3 class="title">6.10. Allowing MLS users to edit files on lower levels</h3></div></div></div><p>
				By default, MLS users cannot write to files which have a sensitivity level below the lower value of the clearance range. If your scenario requires allowing users to edit files on lower levels, you can do so by creating a local SELinux module. However, writing to a file will increase its sensitivity level to the lower value of the user’s current range.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The SELinux policy is set to <code class="literal">mls</code>.
					</li><li class="listitem">
						The SELinux mode is set to <code class="literal">enforcing</code>.
					</li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">setools-console</code> and <code class="literal">audit</code> packages for verification.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Switch to permissive mode for easier troubleshooting.
					</p><pre class="screen"># <span class="strong strong"><strong>setenforce 0</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open a new <code class="literal">.cil</code> file with a text editor, for example <code class="literal">~/local_mlsfilewrite.cil</code>, and insert the following custom rule:
					</p><pre class="screen">(typeattributeset mlsfilewrite (_staff_t_))</pre><p class="simpara">
						You can replace <code class="literal"><span class="emphasis"><em>staff_t</em></span></code> with a different SELinux type. By specifying SELinux type here, you can control which SELinux roles can edit lower-level files.
					</p><p class="simpara">
						To keep your local modules better organized, use the <code class="literal">local_</code> prefix in the names of local SELinux policy modules.
					</p></li><li class="listitem"><p class="simpara">
						Install the policy module:
					</p><pre class="screen"># <span class="strong strong"><strong>semodule -i ~/<span class="emphasis"><em>local_mlsfilewrite</em></span>.cil</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							To remove the local policy module, use <code class="literal">semodule -r ~/<span class="emphasis"><em>local_mlsfilewrite</em></span></code>. Note that you must refer to the module name without the <code class="literal">.cil</code> suffix.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Optional: If you previously switched back to permissive mode, return to enforcing mode:
					</p><pre class="screen"># <span class="strong strong"><strong>setenforce 1</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Find the local module in the list of installed SELinux modules:
					</p><pre class="screen"># <span class="strong strong"><strong>semodule -lfull | grep "local_mls"</strong></span>
400 local_mlsfilewrite  cil</pre><p class="simpara">
						Because local modules have priority <code class="literal">400</code>, you can list them also by using the <code class="literal">semodule -lfull | grep -v ^100</code> command.
					</p></li><li class="listitem">
						Log in as a user assigned to the type defined in the custom rule, for example, <code class="literal"><span class="emphasis"><em>staff_t</em></span></code>.
					</li><li class="listitem"><p class="simpara">
						Attempt to write to a file with a lower sensitivity level. This increases the file’s classification level to the user’s clearance level.
					</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							The files you use for verification should not contain any sensitive information in case the configuration is incorrect and the user actually can access the files without authorization.
						</p></div></rh-alert></li></ol></div></section></section><section class="chapter" id="assembly_using-multi-category-security-mcs-for-data-confidentiality_using-selinux"><div class="titlepage"><div><div><h2 class="title">Chapter 7. Using Multi-Category Security (MCS) for data confidentiality</h2></div></div></div><p class="_abstract _abstract">
			You can use MCS to enhance the data confidentiality of your system by categorizing data, and then granting certain processes and users access to specific categories
		</p><section class="section" id="con_multi-category-security-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality"><div class="titlepage"><div><div><h3 class="title">7.1. Multi-Category Security (MCS)</h3></div></div></div><p class="_abstract _abstract">
				Multi-Category Security (MCS) is an access control mechanism that uses categories assigned to processes and files. Files can then be accessed only by processes that are assigned to the same categories. The purpose of MCS is to maintain data confidentiality on your system.
			</p><p>
				MCS categories are defined by the values <code class="literal">c0</code> to <code class="literal">c1023</code>, but you can also define a text label for each category or combination of categories, such as “Personnel”, “ProjectX”, or “ProjectX.Personnel”. The MCS Translation service (<code class="literal">mcstrans</code>) then replaces the category values with the appropriate labels in system inputs and outputs, so that users can use these labels instead of the category values.
			</p><p>
				When users are assigned to categories, they can label any of their files with any of the categories to which they have been assigned.
			</p><p>
				MCS works on a simple principle: to access a file, a user must be assigned to all of the categories that have been assigned to the file. The MCS check is applied after normal Linux Discretionary Access Control (DAC) and SELinux Type Enforcement (TE) rules, so it can only further restrict existing security configuration.
			</p><h5 id="mcs_within_multi_level_security">MCS within Multi-Level Security</h5><p>
				You can use MCS on its own as a non-hierarchical system, or you can use it in combination with Multi-Level Security (MLS) as a non-hierarchical layer within a hierarchical system.
			</p><p>
				An example of MCS within MLS could be a secretive research organization, where files are classified like this:
			</p><rh-table id="idm139843084367920"><table class="gt-4-cols lt-7-rows"><caption>Table 7.1. Example of combinations of security levels and categories</caption><colgroup><col style="width: 20%; " class="col_1"><!--Empty--><col style="width: 20%; " class="col_2"><!--Empty--><col style="width: 20%; " class="col_3"><!--Empty--><col style="width: 20%; " class="col_4"><!--Empty--><col style="width: 20%; " class="col_5"><!--Empty--></colgroup><tbody><tr><td rowspan="2" align="left" valign="bottom"> <p>
								<span class="strong strong"><strong>Security level</strong></span>
							</p>
							 </td><td colspan="4" align="center" valign="middle"> <p>
								<span class="strong strong"><strong>Category</strong></span>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								Not specified
							</p>
							 </td><td align="left" valign="top"> <p>
								Project X
							</p>
							 </td><td align="left" valign="top"> <p>
								Project Y
							</p>
							 </td><td align="left" valign="top"> <p>
								Project Z
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								Unclassified
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s0</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s0:c0</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s0:c1</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s0:c2</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								Confidential
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s1</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s1:c0</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s1:c1</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s1:c2</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								Secret
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s2</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s2:c0</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s2:c1</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s2:c2</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								Top secret
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s3</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s3:c0</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s3:c1</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">s3:c2</code>
							</p>
							 </td></tr></tbody></table></rh-table><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					A user with a range <code class="literal">s0:c0.1023</code> would be able to access all files assigned to all categories on level <code class="literal">s0</code>, unless the access is prohibited by other security mechanisms, such as DAC or type enforcement policy rules.
				</p></div></rh-alert><p>
				The resulting security context of a file or process is a combination of:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						SELinux user
					</li><li class="listitem">
						SELinux role
					</li><li class="listitem">
						SELinux type
					</li><li class="listitem">
						MLS sensitivity level
					</li><li class="listitem">
						MCS category
					</li></ul></div><p>
				For example, a non-privileged user with access to sensitivity level 1 and category 2 in an MLS/MCS environment could have the following SELinux context:
			</p><pre class="screen">user_u:user_r:user_t:s1:c2</pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/using_selinux/index#using-multi-level-security-mls_using-selinux">Using Multi-Level Security (MLS)</a>
					</li></ul></div></section><section class="section" id="proc_configuring-multi-category-security-for-data-confidentiality_assembly_using-multi-category-security-mcs-for-data-confidentiality"><div class="titlepage"><div><div><h3 class="title">7.2. Configuring Multi-Category Security for data confidentiality</h3></div></div></div><p>
				By default, Multi-Category Security (MCS) is active in the <code class="literal">targeted</code> and <code class="literal">mls</code> SELinux policies but is not configured for users. In the <code class="literal">targeted</code> policy, MCS is configured only for:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						OpenShift
					</li><li class="listitem">
						virt
					</li><li class="listitem">
						sandbox
					</li><li class="listitem">
						network labeling
					</li><li class="listitem">
						containers (<code class="literal">container-selinux</code>)
					</li></ul></div><p>
				You can configure MCS to categorize users by creating a local SELinux module with a rule that constrains the <code class="literal">user_t</code> SELinux type by MCS rules in addition to type enforcement.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Changing the categories of certain files may render some services non-operational. If you are not an expert, contact your Red Hat sales representative and request consulting services.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						SELinux mode is set to <code class="literal">enforcing</code>.
					</li><li class="listitem">
						The SELinux policy is set to <code class="literal">targeted</code> or <code class="literal">mls</code>.
					</li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> and <code class="literal">setools-console</code> packages are installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new file named, for example, <code class="literal">local_mcs_user.cil</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>vim local_mcs_user.cil</strong></span></pre></li><li class="listitem"><p class="simpara">
						Insert the following rule:
					</p><pre class="screen">(typeattributeset mcs_constrained_type (user_t))</pre></li><li class="listitem"><p class="simpara">
						Install the policy module:
					</p><pre class="screen"># <span class="strong strong"><strong>semodule -i local_mcs_user.cil</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						For each user domain, display additional details for all the components:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>seinfo -xt user_t</strong></span>

Types: 1
type user_t, application_domain_type, nsswitch_domain, corenet_unlabeled_type, domain, kernel_system_state_reader, <span class="strong strong"><strong>mcs_constrained_type</strong></span>, netlabel_peer_type, privfd, process_user_target, scsi_generic_read, scsi_generic_write, syslog_client_type, pcmcia_typeattr_1, user_usertype, login_userdomain, userdomain, unpriv_userdomain, userdom_home_reader_type, userdom_filetrans_type, xdmhomewriter, x_userdomain, x_domain, dridomain, xdrawable_type, xcolormap_type;</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/troubleshooting-problems-related-to-selinux_using-selinux#proc_creating-a-local-selinux-policy-module_troubleshooting-problems-related-to-selinux">Creating a local SELinux policy module</a>
					</li><li class="listitem">
						For more information about MCS in the context of containers, see the blog posts <a class="link" href="https://www.redhat.com/en/blog/how-selinux-separates-containers-using-multi-level-security">How SELinux separates containers using Multi-Level Security</a> and <a class="link" href="https://www.redhat.com/en/blog/why-you-should-be-using-multi-category-security-your-linux-containers">Why you should be using Multi-Category Security for your Linux containers</a>.
					</li></ul></div></section><section class="section" id="proc_defining-category-labels-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality"><div class="titlepage"><div><div><h3 class="title">7.3. Defining category labels in MCS</h3></div></div></div><p class="_abstract _abstract">
				You can manage and maintain labels for MCS categories, or combinations of MCS categories with MLS levels, on your system by editing the <code class="literal">setrans.conf</code> file. In this file, SELinux maintains a mapping between internal sensitivity and category levels and their human-readable labels.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Category labels only make it easier for users to use the categories. MCS works the same whether you define labels or not.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The SELinux mode is set to <code class="literal">enforcing</code>.
					</li><li class="listitem">
						The SELinux policy is set to <code class="literal">targeted</code> or <code class="literal">mls</code>.
					</li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> and <code class="literal">mcstrans</code> packages are installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Modify existing categories or create new categories by editing the <code class="literal">/etc/selinux/<span class="emphasis"><em>&lt;selinuxpolicy&gt;</em></span>/setrans.conf</code> file in a text editor. Replace <span class="emphasis"><em>&lt;selinuxpolicy&gt;</em></span> with <code class="literal">targeted</code> or <code class="literal">mls</code> depending on the SELinux policy you use. For example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/selinux/targeted/setrans.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						In the <code class="literal">setrans.conf</code> file for your policy, define the combinations of categories required by your scenario using the syntax <code class="literal">s_&lt;security level&gt;_:c_&lt;category number&gt;_=<span class="emphasis"><em>&lt;category.name&gt;</em></span></code>, for example:
					</p><pre class="screen">s0:c0=Marketing
s0:c1=Finance
s0:c2=Payroll
s0:c3=Personnel</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								You can use category numbers from <code class="literal">c0</code> to <code class="literal">c1023</code>.
							</li><li class="listitem">
								In the <code class="literal">targeted</code> policy, use the <code class="literal">s0</code> security level.
							</li><li class="listitem">
								In the <code class="literal">mls</code> policy, you can label each combination of sensitivity levels and categories.
							</li></ul></div></li><li class="listitem">
						Optional: In the <code class="literal">setrans.conf</code> file, you can also label the MLS sensitivity levels.
					</li><li class="listitem">
						Save and exit the file.
					</li><li class="listitem"><p class="simpara">
						To make the changes effective, restart the MCS translation service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart mcstrans</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display the current categories:
					</p><pre class="screen"># <span class="strong strong"><strong>chcat -L</strong></span></pre><p class="simpara">
						The example above produces the following output:
					</p><pre class="screen">s0:c0                          Marketing
s0:c1                          Finance
s0:c2                          Payroll
s0:c3                          Personnel
s0
s0-s0:c0.c1023                 SystemLow-SystemHigh
s0:c0.c1023                    SystemHigh</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">setrans.conf(5)</code> man page on your system
					</li></ul></div></section><section class="section" id="proc_assigning-categories-to-users-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality"><div class="titlepage"><div><div><h3 class="title">7.4. Assigning categories to users in MCS</h3></div></div></div><p>
				You can define user authorizations by assigning categories to Linux users. A user with assigned categories can access and modify files that have a subset of the user’s categories. Users can also assign files they own to categories they have been assigned to.
			</p><p>
				A Linux user cannot be assigned to a category that is outside of the security range defined for the relevant SELinux user.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Category access is assigned during login. Consequently, users do not have access to newly assigned categories until they log in again. Similarly, if you revoke a user’s access to a category, this is effective only after the user logs in again.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The SELinux mode is set to <code class="literal">enforcing</code>.
					</li><li class="listitem">
						The SELinux policy is set to <code class="literal">targeted</code> or <code class="literal">mls</code>.
					</li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package is installed.
					</li><li class="listitem"><p class="simpara">
						Linux users are assigned to SELinux confined users:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Non-privileged users are assigned to <code class="literal">user_u</code>.
							</li><li class="listitem">
								Privileged users are assigned to <code class="literal">staff_u</code>.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Define the security range for the SELinux user.
					</p><pre class="screen"># <span class="strong strong"><strong>semanage user -m -rs0:c0,c1-s0:c0.c9 <span class="emphasis"><em>&lt;user_u&gt;</em></span></strong></span></pre><p class="simpara">
						Use category numbers <code class="literal">c0</code> to <code class="literal">c1023</code> or category labels as defined in the <code class="literal">setrans.conf</code> file. For additional information, see <a class="link" href="#proc_defining-category-labels-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality" title="7.3. Defining category labels in MCS">Defining category labels in MCS</a> .
					</p></li><li class="listitem"><p class="simpara">
						Assign MCS categories to a Linux user. You can specify only a range within the range defined to the relevant SELinux user:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage login -m -rs0:c1 <span class="emphasis"><em>&lt;Linux.user1&gt;</em></span></strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							You can add or remove categories from Linux users by using the <code class="literal">chcat</code> command. The following example adds <code class="literal"><span class="emphasis"><em>&lt;category1&gt;</em></span></code> and removes <code class="literal"><span class="emphasis"><em>&lt;category2&gt;</em></span></code> from <code class="literal"><span class="emphasis"><em>&lt;Linux.user1&gt;</em></span></code> and <code class="literal"><span class="emphasis"><em>&lt;Linux.user2&gt;</em></span></code>:
						</p><pre class="screen"># <span class="strong strong"><strong>chcat -l -- +<span class="emphasis"><em>&lt;category1&gt;</em></span>,-<span class="emphasis"><em>&lt;category2&gt;</em></span> <span class="emphasis"><em>&lt;Linux.user1&gt;</em></span>,<span class="emphasis"><em>&lt;Linux.user2&gt;</em></span></strong></span></pre><p>
							You must specify <code class="literal">--</code> on the command line before using the <code class="literal">-<span class="emphasis"><em>&lt;category&gt;</em></span></code> syntax. Otherwise, the <code class="literal">chcat</code> command misinterprets the category removal as a command option.
						</p></div></rh-alert></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						List the categories assigned to Linux users:
					</p><pre class="screen"># <span class="strong strong"><strong>chcat -L -l <span class="emphasis"><em>&lt;Linux.user1&gt;</em></span>,<span class="emphasis"><em>&lt;Linux.user2&gt;</em></span></strong></span>
<span class="emphasis"><em>&lt;Linux.user1&gt;</em></span>: <span class="emphasis"><em>&lt;category1&gt;</em></span>,<span class="emphasis"><em>&lt;category2&gt;</em></span>
<span class="emphasis"><em>&lt;Linux.user2&gt;</em></span>: <span class="emphasis"><em>&lt;category1&gt;</em></span>,<span class="emphasis"><em>&lt;category2&gt;</em></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">chcat(8)</code> man page on your system
					</li></ul></div></section><section class="section" id="proc_assigning-categories-to-files-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality"><div class="titlepage"><div><div><h3 class="title">7.5. Assigning categories to files in MCS</h3></div></div></div><p>
				You need administrative privileges to assign categories to users. Users can then assign categories to files. To modify the categories of a file, users must have access rights to that file. Users can only assign a file to a category that is assigned to them.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The system combines category access rules with conventional file access permissions. For example, if a user with a category of <code class="literal">bigfoot</code> uses Discretionary Access Control (DAC) to block access to a file by other users, other <code class="literal">bigfoot</code> users cannot access that file. A user assigned to all available categories still may not be able to access the entire file system.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The SELinux mode is set to <code class="literal">enforcing</code>.
					</li><li class="listitem">
						The SELinux policy is set to <code class="literal">targeted</code> or <code class="literal">mls</code>.
					</li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package is installed.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a Linux user that is:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Assigned to an SELinux user.
							</li><li class="listitem">
								Assigned to the category to which you want to assign the file. For additional information, see <a class="link" href="#proc_assigning-categories-to-users-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality" title="7.4. Assigning categories to users in MCS">Assigning categories to users in MCS</a> .
							</li></ul></div></li><li class="listitem">
						Access and permissions to the file you want to add to the category.
					</li><li class="listitem">
						For verification purposes: Access and permissions to a Linux user not assigned to this category
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Add categories to a file:
					</p><pre class="screen">$ <span class="strong strong"><strong>chcat -- +<span class="emphasis"><em>&lt;category1&gt;</em></span>,+<span class="emphasis"><em>&lt;category2&gt;</em></span> <span class="emphasis"><em>&lt;path/to/file1&gt;</em></span></strong></span></pre><p class="simpara">
						Use category numbers <code class="literal">c0</code> to <code class="literal">c1023</code> or category labels as defined in the <code class="literal">setrans.conf</code> file. For additional information, see <a class="link" href="#proc_defining-category-labels-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality" title="7.3. Defining category labels in MCS">Defining category labels in MCS</a> .
					</p><p class="simpara">
						You can remove categories from a file by using the same syntax:
					</p><pre class="screen">$ <span class="strong strong"><strong>chcat -- -<span class="emphasis"><em>&lt;category1&gt;</em></span>,-<span class="emphasis"><em>&lt;category2&gt;</em></span> <span class="emphasis"><em>&lt;path/to/file1&gt;</em></span></strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							When removing a category, you must specify <code class="literal">--</code> on the command line before using the <code class="literal">-<span class="emphasis"><em>&lt;category&gt;</em></span></code> syntax. Otherwise, the <code class="literal">chcat</code> command misinterprets the category removal as a command option.
						</p></div></rh-alert></li></ul></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the security context of the file to verify that it has the correct categories:
					</p><pre class="screen">$ <span class="strong strong"><strong>ls -lZ <span class="emphasis"><em>&lt;path/to/file&gt;</em></span></strong></span>
-rw-r--r--  <span class="emphasis"><em>&lt;LinuxUser1&gt;</em></span> <span class="emphasis"><em>&lt;Group1&gt;</em></span> root:object_r:user_home_t:_&lt;sensitivity&gt;_:_&lt;category&gt;_ <span class="emphasis"><em>&lt;path/to/file&gt;</em></span></pre><p class="simpara">
						The specific security context of the file may differ.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Attempt to access the file when logged in as a Linux user not assigned to the same category as the file:
					</p><pre class="screen">$ <span class="strong strong"><strong>cat <span class="emphasis"><em>&lt;path/to/file&gt;</em></span></strong></span>
cat: <span class="emphasis"><em>&lt;path/to/file&gt;</em></span>: Permission Denied</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">semanage(8)</code> and <code class="literal">chcat(8)</code> man pages on your system
					</li></ul></div></section></section><section class="chapter" id="writing-a-custom-selinux-policy_using-selinux"><div class="titlepage"><div><div><h2 class="title">Chapter 8. Writing a custom SELinux policy</h2></div></div></div><p>
			To run your applications confined by SELinux, you must write and use a custom policy.
		</p><section class="section" id="custom-selinux-policies-and-related-tools_writing-a-custom-selinux-policy"><div class="titlepage"><div><div><h3 class="title">8.1. Custom SELinux policies and related tools</h3></div></div></div><p>
				An SELinux security policy is a collection of SELinux rules. A policy is a core component of SELinux and is loaded into the kernel by SELinux user-space tools. The kernel enforces the use of an SELinux policy to evaluate access requests on the system. By default, SELinux denies all requests except for requests that correspond to the rules specified in the loaded policy.
			</p><p>
				Each SELinux policy rule describes an interaction between a process and a system resource:
			</p><pre class="screen">ALLOW apache_process apache_log:FILE READ;</pre><p>
				You can read this example rule as: <span class="emphasis"><em>The <span class="strong strong"><strong>Apache</strong></span> process can <span class="strong strong"><strong>read</strong></span> its <span class="strong strong"><strong>logging file</strong></span>.</em></span> In this rule, <code class="literal">apache_process</code> and <code class="literal">apache_log</code> are <span class="strong strong"><strong>labels</strong></span>. An SELinux security policy assigns labels to processes and defines relations to system resources. This way, a policy maps operating-system entities to the SELinux layer.
			</p><p>
				SELinux labels are stored as extended attributes of file systems, such as <code class="literal">ext2</code>. You can list them using the <code class="literal">getfattr</code> utility or a <code class="literal">ls -Z</code> command, for example:
			</p><pre class="screen">$ <span class="strong strong"><strong>ls -Z /etc/passwd</strong></span>
system_u:object_r:passwd_file_t:s0 /etc/passwd</pre><p>
				Where <code class="literal">system_u</code> is an SELinux user, <code class="literal">object_r</code> is an example of the SELinux role, and <code class="literal">passwd_file_t</code> is an SELinux domain.
			</p><p>
				The default SELinux policy provided by the <code class="literal">selinux-policy</code> packages contains rules for applications and daemons that are parts of Red Hat Enterprise Linux 9 and are provided by packages in its repositories. Applications not described in this distribution policy are not confined by SELinux. To change this, you have to modify the policy using a policy module, which contains additional definitions and rules.
			</p><p>
				In Red Hat Enterprise Linux 9, you can query the installed SELinux policy and generate new policy modules using the <code class="literal">sepolicy</code> tool. Scripts that <code class="literal">sepolicy</code> generates together with the policy modules always contain a command using the <code class="literal">restorecon</code> utility. This utility is a basic tool for fixing labeling problems in a selected part of a file system.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">sepolicy(8)</code> and <code class="literal">getfattr(1)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/6999267">Quick start to write a custom SELinux policy</a> Knowledgebase article
					</li></ul></div></section><section class="section" id="creating-and-enforcing-an-selinux-policy-for-a-custom-application_writing-a-custom-selinux-policy"><div class="titlepage"><div><div><h3 class="title">8.2. Creating and enforcing an SELinux policy for a custom application</h3></div></div></div><p>
				You can confine applications by SELinux to increase the security of host systems and users' data. Because each application has specific requirements, modify this example procedure for creating an SELinux policy that confines a simple daemon according to your use case.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">selinux-policy-devel</code> package and its dependencies are installed on your system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						For this example procedure, prepare a simple daemon that opens the <code class="literal">/var/log/messages</code> file for writing:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a new file, and open it in a text editor of your choice:
							</p><pre class="screen">$ <span class="strong strong"><strong>vi mydaemon.c</strong></span></pre></li><li class="listitem"><p class="simpara">
								Insert the following code:
							</p><pre class="programlisting language-c">#include &lt;unistd.h&gt;
#include &lt;stdio.h&gt;

FILE *f;

int main(void)
{
while(1) {
f = fopen("/var/log/messages","w");
        sleep(5);
        fclose(f);
    }
}</pre></li><li class="listitem"><p class="simpara">
								Compile the file:
							</p><pre class="screen">$ <span class="strong strong"><strong>gcc -o mydaemon mydaemon.c</strong></span></pre></li><li class="listitem"><p class="simpara">
								Create a <code class="literal">systemd</code> unit file for your daemon:
							</p><pre class="screen">$ <span class="strong strong"><strong>vi mydaemon.service</strong></span>
[Unit]
Description=Simple testing daemon

[Service]
Type=simple
ExecStart=/usr/local/bin/mydaemon

[Install]
WantedBy=multi-user.target</pre></li><li class="listitem"><p class="simpara">
								Install and start the daemon:
							</p><pre class="screen"># <span class="strong strong"><strong>cp mydaemon /usr/local/bin/</strong></span>
# <span class="strong strong"><strong>cp mydaemon.service /usr/lib/systemd/system</strong></span>
# <span class="strong strong"><strong>systemctl start mydaemon</strong></span>
# <span class="strong strong"><strong>systemctl status mydaemon</strong></span>
● mydaemon.service - Simple testing daemon
   Loaded: loaded (/usr/lib/systemd/system/mydaemon.service; disabled; vendor preset: disabled)
   Active: active (running) since Sat 2020-05-23 16:56:01 CEST; 19s ago
 Main PID: 4117 (mydaemon)
    Tasks: 1
   Memory: 148.0K
   CGroup: /system.slice/mydaemon.service
           └─4117 /usr/local/bin/mydaemon

May 23 16:56:01 localhost.localdomain systemd[1]: Started Simple testing daemon.</pre></li><li class="listitem"><p class="simpara">
								Check that the new daemon is not confined by SELinux:
							</p><pre class="screen">$ <span class="strong strong"><strong>ps -efZ | grep mydaemon</strong></span>
system_u:system_r:unconfined_service_t:s0 root 4117    1  0 16:56 ?        00:00:00 /usr/local/bin/mydaemon</pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Generate a custom policy for the daemon:
					</p><pre class="screen">$ <span class="strong strong"><strong>sepolicy generate --init /usr/local/bin/mydaemon</strong></span>
Created the following files:
/home/example.user/mysepol/mydaemon.te # Type Enforcement file
/home/example.user/mysepol/mydaemon.if # Interface file
/home/example.user/mysepol/mydaemon.fc # File Contexts file
/home/example.user/mysepol/mydaemon_selinux.spec # Spec file
/home/example.user/mysepol/mydaemon.sh # Setup Script</pre></li><li class="listitem"><p class="simpara">
						Rebuild the system policy with the new policy module using the setup script created by the previous command:
					</p><pre class="screen"># <span class="strong strong"><strong>./mydaemon.sh</strong></span>
Building and Loading Policy
+ make -f /usr/share/selinux/devel/Makefile mydaemon.pp
Compiling targeted mydaemon module
Creating targeted mydaemon.pp policy package
rm tmp/mydaemon.mod.fc tmp/mydaemon.mod
+ /usr/sbin/semodule -i mydaemon.pp
...</pre><p class="simpara">
						Note that the setup script relabels the corresponding part of the file system using the <code class="literal">restorecon</code> command:
					</p><pre class="screen">restorecon -v /usr/local/bin/mydaemon /usr/lib/systemd/system</pre></li><li class="listitem"><p class="simpara">
						Restart the daemon, and check that it now runs confined by SELinux:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart mydaemon</strong></span>
$ <span class="strong strong"><strong>ps -efZ | grep mydaemon</strong></span>
system_u:system_r:mydaemon_t:s0 root        8150       1  0 17:18 ?        00:00:00 /usr/local/bin/mydaemon</pre></li><li class="listitem"><p class="simpara">
						Because the daemon is now confined by SELinux, SELinux also prevents it from accessing <code class="literal">/var/log/messages</code>. Display the corresponding denial message:
					</p><pre class="screen"># <span class="strong strong"><strong>ausearch -m AVC -ts recent</strong></span>
...
type=AVC msg=audit(1590247112.719:5935): avc:  denied  { open } for  pid=8150 comm="mydaemon" path="/var/log/messages" dev="dm-0" ino=2430831 scontext=system_u:system_r:mydaemon_t:s0 tcontext=unconfined_u:object_r:var_log_t:s0 tclass=file permissive=1
...</pre></li><li class="listitem"><p class="simpara">
						You can get additional information also using the <code class="literal">sealert</code> tool:
					</p><pre class="screen">$ <span class="strong strong"><strong>sealert -l "*"</strong></span>
SELinux is preventing mydaemon from open access on the file /var/log/messages.

*****  Plugin catchall (100. confidence) suggests   **************************

If you believe that mydaemon should be allowed open access on the messages file by default.
Then you should report this as a bug.
You can generate a local policy module to allow this access.
Do allow this access for now by executing:
# ausearch -c 'mydaemon' --raw | audit2allow -M my-mydaemon
# semodule -X 300 -i my-mydaemon.pp

Additional Information:
Source Context                system_u:system_r:mydaemon_t:s0
Target Context                unconfined_u:object_r:var_log_t:s0
Target Objects                /var/log/messages [ file ]
Source                        mydaemon
…</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">audit2allow</code> tool to suggest changes:
					</p><pre class="screen">$ <span class="strong strong"><strong>ausearch -m AVC -ts recent | audit2allow -R</strong></span>

require {
	type mydaemon_t;
}

#============= mydaemon_t ==============
logging_write_generic_logs(mydaemon_t)</pre></li><li class="listitem"><p class="simpara">
						Because rules suggested by <code class="literal">audit2allow</code> can be incorrect for certain cases, use only a part of its output to find the corresponding policy interface. Inspect the <code class="literal">logging_write_generic_logs(mydaemon_t)</code> macro with the <code class="literal">macro-expander</code> tool, to see all allow rules the macro provides:
					</p><pre class="screen">$ <span class="strong strong"><strong>macro-expander "logging_write_generic_logs(mydaemon_t)"</strong></span>
allow mydaemon_t var_t:dir { getattr search open };
allow mydaemon_t var_log_t:dir { getattr search open read lock ioctl };
allow mydaemon_t var_log_t:dir { getattr search open };
allow mydaemon_t var_log_t:file { open { getattr write append lock ioctl } };
allow mydaemon_t var_log_t:dir { getattr search open };
allow mydaemon_t var_log_t:lnk_file { getattr read };</pre></li><li class="listitem"><p class="simpara">
						In this case, you can use the suggested interface, because it only provides read and write access to log files and their parent directories. Add the corresponding rule to your type enforcement file:
					</p><pre class="screen">$ <span class="strong strong"><strong>echo "logging_write_generic_logs(mydaemon_t)" &gt;&gt; mydaemon.te</strong></span></pre><p class="simpara">
						Alternatively, you can add this rule instead of using the interface:
					</p><pre class="screen">$ <span class="strong strong"><strong>echo "allow mydaemon_t var_log_t:file { open write getattr };" &gt;&gt; mydaemon.te</strong></span></pre></li><li class="listitem"><p class="simpara">
						Reinstall the policy:
					</p><pre class="screen"># <span class="strong strong"><strong>./mydaemon.sh</strong></span>
Building and Loading Policy
+ make -f /usr/share/selinux/devel/Makefile mydaemon.pp
Compiling targeted mydaemon module
Creating targeted mydaemon.pp policy package
rm tmp/mydaemon.mod.fc tmp/mydaemon.mod
+ /usr/sbin/semodule -i mydaemon.pp
...</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that your application runs confined by SELinux, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>ps -efZ | grep mydaemon</strong></span>
system_u:system_r:mydaemon_t:s0 root        8150       1  0 17:18 ?        00:00:00 /usr/local/bin/mydaemon</pre></li><li class="listitem"><p class="simpara">
						Verify that your custom application does not cause any SELinux denials:
					</p><pre class="screen"># <span class="strong strong"><strong>ausearch -m AVC -ts recent</strong></span>
&lt;no matches&gt;</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">sepolgen(8)</code>, <code class="literal">ausearch(8)</code>, <code class="literal">audit2allow(1)</code>, <code class="literal">audit2why(1)</code>, <code class="literal">sealert(8)</code>, and <code class="literal">restorecon(8)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/6999267">Quick start to write a custom SELinux policy</a> Knowledgebase article
					</li></ul></div></section><section class="section _additional-resources" id="additional_resources_2"><div class="titlepage"><div><div><h3 class="title">8.3. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="http://redhatgov.io/workshops/selinux_policy/">SELinux Policy Workshop</a>
					</li></ul></div></section></section><section class="chapter" id="creating-selinux-policies-for-containers_using-selinux"><div class="titlepage"><div><div><h2 class="title">Chapter 9. Creating SELinux policies for containers</h2></div></div></div><p class="_abstract _abstract">
			Red Hat Enterprise Linux 9 provides a tool for generating SELinux policies for containers using the <code class="literal">udica</code> package. With <code class="literal">udica</code>, you can create a tailored security policy for better control of how a container accesses host system resources, such as storage, devices, and network. This enables you to harden your container deployments against security violations and it also simplifies achieving and maintaining regulatory compliance.
		</p><section class="section" id="introduction-to-udica_creating-selinux-policies-for-containers"><div class="titlepage"><div><div><h3 class="title">9.1. Introduction to the udica SELinux policy generator</h3></div></div></div><p class="_abstract _abstract">
				To simplify creating new SELinux policies for custom containers, RHEL 9 provides the <code class="literal">udica</code> utility. You can use this tool to create a policy based on an inspection of the container JavaScript Object Notation (JSON) file, which contains Linux-capabilities, mount-points, and ports definitions. The tool consequently combines rules generated using the results of the inspection with rules inherited from a specified SELinux Common Intermediate Language (CIL) block.
			</p><p>
				The process of generating SELinux policy for a container using <code class="literal">udica</code> has three main parts:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Parsing the container spec file in the JSON format
					</li><li class="listitem">
						Finding suitable allow rules based on the results of the first part
					</li><li class="listitem">
						Generating final SELinux policy
					</li></ol></div><p>
				During the parsing phase, <code class="literal">udica</code> looks for Linux capabilities, network ports, and mount points.
			</p><p>
				Based on the results, <code class="literal">udica</code> detects which Linux capabilities are required by the container and creates an SELinux rule allowing all these capabilities. If the container binds to a specific port, <code class="literal">udica</code> uses SELinux user-space libraries to get the correct SELinux label of a port that is used by the inspected container.
			</p><p>
				Afterward, <code class="literal">udica</code> detects which directories are mounted to the container file-system name space from the host.
			</p><p>
				The CIL’s block inheritance feature allows <code class="literal">udica</code> to create templates of SELinux <span class="emphasis"><em>allow rules</em></span> focusing on a specific action, for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="emphasis"><em>allow accessing home directories</em></span>
					</li><li class="listitem">
						<span class="emphasis"><em>allow accessing log files</em></span>
					</li><li class="listitem">
						<span class="emphasis"><em>allow accessing communication with Xserver</em></span>.
					</li></ul></div><p>
				These templates are called blocks and the final SELinux policy is created by merging the blocks.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://www.redhat.com/en/blog/generate-selinux-policies-containers-with-udica">Generate SELinux policies for containers with udica</a> Red Hat Blog article
					</li></ul></div></section><section class="section" id="creating-and-using-an-selinux-policy-for-a-custom-container_creating-selinux-policies-for-containers"><div class="titlepage"><div><div><h3 class="title">9.2. Creating and using an SELinux policy for a custom container</h3></div></div></div><p class="_abstract _abstract">
				To generate an SELinux security policy for a custom container, follow the steps in this procedure.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">podman</code> tool for managing containers is installed. If it is not, use the <code class="literal">dnf install podman</code> command.
					</li><li class="listitem">
						A custom Linux container - <span class="emphasis"><em>ubi8</em></span> in this example.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">udica</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install -y udica</strong></span></pre><p class="simpara">
						Alternatively, install the <code class="literal">container-tools</code> module, which provides a set of container software packages, including <code class="literal">udica</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf module install -y container-tools</strong></span></pre></li><li class="listitem"><p class="simpara">
						Start the <span class="emphasis"><em>ubi8</em></span> container that mounts the <code class="literal">/home</code> directory with read-only permissions and the <code class="literal">/var/spool</code> directory with permissions to read and write. The container exposes the port <span class="emphasis"><em>21</em></span>.
					</p><pre class="screen"># <span class="strong strong"><strong>podman run --env container=podman -v <span class="emphasis"><em>/home:/home:ro</em></span> -v <span class="emphasis"><em>/var/spool:/var/spool:rw</em></span> -p <span class="emphasis"><em>21:21</em></span> -it <span class="emphasis"><em>ubi8</em></span> <span class="emphasis"><em>bash</em></span></strong></span></pre><p class="simpara">
						Note that now the container runs with the <code class="literal">container_t</code> SELinux type. This type is a generic domain for all containers in the SELinux policy and it might be either too strict or too loose for your scenario.
					</p></li><li class="listitem"><p class="simpara">
						Open a new terminal, and enter the <code class="literal">podman ps</code> command to obtain the ID of the container:
					</p><pre class="screen"># <span class="strong strong"><strong>podman ps</strong></span>
CONTAINER ID   IMAGE                                   COMMAND   CREATED          STATUS              PORTS   NAMES
37a3635afb8f   registry.access.redhat.com/ubi8:latest  bash      15 minutes ago   Up 15 minutes ago           heuristic_lewin</pre></li><li class="listitem"><p class="simpara">
						Create a container JSON file, and use <code class="literal">udica</code> for creating a policy module based on the information in the JSON file:
					</p><pre class="screen"># <span class="strong strong"><strong>podman inspect <span class="emphasis"><em>37a3635afb8f</em></span> &gt; <span class="emphasis"><em>container.json</em></span></strong></span>
# <span class="strong strong"><strong>udica -j <span class="emphasis"><em>container.json</em></span> <span class="emphasis"><em>my_container</em></span></strong></span>
Policy my_container with container id 37a3635afb8f created!
[…]</pre><p class="simpara">
						Alternatively:
					</p><pre class="screen"># <span class="strong strong"><strong>podman inspect <span class="emphasis"><em>37a3635afb8f</em></span> | udica <span class="emphasis"><em>my_container</em></span></strong></span>
Policy my_container with container id 37a3635afb8f created!

Please load these modules using:
# semodule -i my_container.cil /usr/share/udica/templates/{base_container.cil,net_container.cil,home_container.cil}

Restart the container with: "--security-opt label=type:my_container.process" parameter</pre></li><li class="listitem"><p class="simpara">
						As suggested by the output of <code class="literal">udica</code> in the previous step, load the policy module:
					</p><pre class="screen"># <span class="strong strong"><strong>semodule -i <span class="emphasis"><em>my_container.cil</em></span> /usr/share/udica/templates/{base_container.cil,net_container.cil,home_container.cil}</strong></span></pre></li><li class="listitem"><p class="simpara">
						Stop the container and start it again with the <code class="literal">--security-opt label=type:my_container.process</code> option:
					</p><pre class="screen"># <span class="strong strong"><strong>podman stop <span class="emphasis"><em>37a3635afb8f</em></span></strong></span>
# <span class="strong strong"><strong>podman run --security-opt label=type:<span class="emphasis"><em>my_container</em></span>.process -v <span class="emphasis"><em>/home:/home:ro</em></span> -v <span class="emphasis"><em>/var/spool:/var/spool:rw</em></span> -p <span class="emphasis"><em>21:21</em></span> -it <span class="emphasis"><em>ubi8</em></span> <span class="emphasis"><em>bash</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that the container runs with the <code class="literal">my_container.process</code> type:
					</p><pre class="screen"># <span class="strong strong"><strong>ps -efZ | grep <span class="emphasis"><em>my_container</em></span>.process</strong></span>
unconfined_u:system_r:container_runtime_t:s0-s0:c0.c1023 root 2275 434  1 13:49 pts/1 00:00:00 podman run --security-opt label=type:my_container.process -v /home:/home:ro -v /var/spool:/var/spool:rw -p 21:21 -it ubi8 bash
system_u:system_r:my_container.process:s0:c270,c963 root 2317 2305  0 13:49 pts/0 00:00:00 bash</pre></li><li class="listitem"><p class="simpara">
						Verify that SELinux now allows access the <code class="literal">/home</code> and <code class="literal">/var/spool</code> mount points:
					</p><pre class="screen">[root@<span class="emphasis"><em>37a3635afb8f</em></span> /]# <span class="strong strong"><strong>cd /home</strong></span>
[root@37a3635afb8f home]# <span class="strong strong"><strong>ls</strong></span>
<span class="emphasis"><em>username</em></span>
[root@37a3635afb8f ~]# <span class="strong strong"><strong>cd /var/spool/</strong></span>
[root@37a3635afb8f spool]# <span class="strong strong"><strong>touch test</strong></span>
[root@37a3635afb8f spool]#</pre></li><li class="listitem"><p class="simpara">
						Check that SELinux allows binding only to the port 21:
					</p><pre class="screen">[root@37a3635afb8f /]# <span class="strong strong"><strong>dnf install nmap-ncat</strong></span>
[root@37a3635afb8f /]# <span class="strong strong"><strong>nc -lvp 21</strong></span>
…
Ncat: Listening on :::21
Ncat: Listening on 0.0.0.0:21
^C
[root@37a3635afb8f /]# <span class="strong strong"><strong>nc -lvp 80</strong></span>
…
Ncat: bind to :::80: Permission denied. QUITTING.</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">udica(8)</code> and <code class="literal">podman(1)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://github.com/containers/udica#creating-selinux-policy-for-container">udica - Generate SELinux policies for containers</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/building_running_and_managing_containers/">Building, running, and managing containers</a>
					</li></ul></div></section></section><section class="chapter" id="deploying-the-same-selinux-configuration-on-multiple-systems_using-selinux"><div class="titlepage"><div><div><h2 class="title">Chapter 10. Deploying the same SELinux configuration on multiple systems</h2></div></div></div><p class="_abstract _abstract">
			You can deploy your verified SELinux configuration on multiple systems by using one of the following methods:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Using RHEL system roles and Ansible
				</li><li class="listitem">
					Using the RHEL web console
				</li><li class="listitem">
					Using <code class="literal">semanage</code> export and import commands in your scripts
				</li></ul></div><section class="section" id="introduction-to-the-selinux-system-role_deploying-the-same-selinux-configuration-on-multiple-systems"><div class="titlepage"><div><div><h3 class="title">10.1. Introduction to the <code class="literal">selinux</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				RHEL system roles is a collection of Ansible roles and modules that provide a consistent configuration interface to remotely manage multiple RHEL systems. You can perform the following actions by using the <code class="literal">selinux</code> RHEL system role:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Cleaning local policy modifications related to SELinux booleans, file contexts, ports, and logins.
					</li><li class="listitem">
						Setting SELinux policy booleans, file contexts, ports, and logins.
					</li><li class="listitem">
						Restoring file contexts on specified files or directories.
					</li><li class="listitem">
						Managing SELinux modules.
					</li></ul></div><p>
				The <code class="literal">/usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml</code> example playbook installed by the <code class="literal">rhel-system-roles</code> package demonstrates how to set the targeted policy in enforcing mode. The playbook also applies several local policy modifications and restores file contexts in the <code class="literal">/tmp/test_dir/</code> directory.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/selinux/</code> directory
					</li></ul></div></section><section class="section" id="using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_deploying-the-same-selinux-configuration-on-multiple-systems"><div class="titlepage"><div><div><h3 class="title">10.2. Using the <code class="literal">selinux</code> RHEL system role to apply SELinux settings on multiple systems</h3></div></div></div><p>
				With the <code class="literal">selinux</code> RHEL system role, you can prepare and apply an Ansible playbook with your verified SELinux settings.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Prepare your playbook. You can either start from scratch or modify the example playbook installed as a part of the <code class="literal">rhel-system-roles</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>cp /usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml <span class="emphasis"><em>&lt;my-selinux-playbook.yml&gt;</em></span></strong></span>
# <span class="strong strong"><strong>vi <span class="emphasis"><em>&lt;my-selinux-playbook.yml&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Change the content of the playbook to fit your scenario. For example, the following part ensures that the system installs and enables the <code class="literal">selinux-local-1.pp</code> SELinux module:
					</p><pre class="screen">selinux_modules:
- { path: "selinux-local-1.pp", priority: "400" }</pre></li><li class="listitem">
						Save the changes, and exit the text editor.
					</li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>&lt;my-selinux-playbook.yml&gt;</em></span> --syntax-check</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run your playbook:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>&lt;my-selinux-playbook.yml&gt;</em></span></strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/selinux/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/7047896">SELinux hardening with Ansible</a> Knowledgebase article
					</li></ul></div></section><section class="section" id="managing-ports-by-using-the-selinux-rhel-system-role_deploying-the-same-selinux-configuration-on-multiple-systems"><div class="titlepage"><div><div><h3 class="title">10.3. Managing ports by using the <code class="literal">selinux</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				You can automate managing port access in SELinux consistently across multiple systems by using the <code class="literal">selinux</code> RHEL system role. This might be useful, for example, when configuring an Apache HTTP server to listen on a different port. You can do this by creating a playbook with the <code class="literal">selinux</code> RHEL system role that assigns the <code class="literal">http_port_t</code> SELinux type to a specific port number. After you run the playbook on the managed nodes, specific services defined in the SELinux policy can access this port.
			</p><p>
				You can automate managing port access in SELinux either by using the <code class="literal">seport</code> module, which is quicker than using the entire role, or by using the <code class="literal">selinux</code> RHEL system role, which is more useful when you also make other changes in SELinux configuration. The methods are equivalent, in fact the <code class="literal">selinux</code> RHEL system role uses the <code class="literal">seport</code> module when configuring ports. Each of the methods has the same effect as entering the command <code class="literal">semanage port -a -t http_port_t -p tcp <span class="emphasis"><em>&lt;port_number&gt;</em></span></code> on the managed node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						Optional: To verify port status by using the <code class="literal">semanage</code> command, the <code class="literal">policycoreutils-python-utils</code> package must be installed.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To configure just the port number without making other changes, use the <code class="literal">seport</code> module:
					</p><pre class="programlisting language-yaml">- name: Allow Apache to listen on tcp port <span class="emphasis"><em>&lt;port_number&gt;</em></span>
  community.general.seport:
    ports: <span class="emphasis"><em>&lt;port_number&gt;</em></span>
    proto: tcp
    setype: http_port_t
    state: present</pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;port_number&gt;</em></span></code> with the port number to which you want to assign the <code class="literal">http_port_t</code> type.
					</p></li><li class="listitem"><p class="simpara">
						For more complex configuration of the managed nodes that involves other customizations of SELinux, use the <code class="literal">selinux</code> RHEL system role. Create a playbook file, for example, <code class="literal">~/playbook.yml</code>, and add the following content:
					</p><pre class="programlisting language-yaml">---
- name: Modify SELinux port mapping example
  hosts: all
  vars:
    # Map tcp port <span class="emphasis"><em>&lt;port_number&gt;</em></span> to the 'http_port_t' SELinux port type
    selinux_ports:
      - ports: <span class="emphasis"><em>&lt;port_number&gt;</em></span>
        proto: tcp
        setype: http_port_t
        state: present

  tasks:
    - name: Include selinux role
      ansible.builtin.include_role:
        name: rhel-system-roles.selinux</pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;port_number&gt;</em></span></code> with the port number to which you want to assign the <code class="literal">http_port_t</code> type.
					</p></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the port is assigned to the <code class="literal">http_port_t</code> type:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage port --list | grep http_port_t</strong></span>
http_port_t                	tcp  	<span class="emphasis"><em>&lt;port_number&gt;</em></span>, 80, 81, 443, 488, 8008, 8009, 8443, 9000</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/selinux/</code> directory
					</li></ul></div></section><section class="section" id="applying-a-generated-ansible-playbook_deploying-the-same-selinux-configuration-on-multiple-systems"><div class="titlepage"><div><div><h3 class="title">10.4. Creating an SELinux configuration Ansible playbook in the web console</h3></div></div></div><p class="_abstract _abstract">
				In the web console, you can generate a shell script or an Ansible playbook of your SELinux configuration. In case of the Ansible playbook, you can conveniently apply the configuration on multiple systems.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have installed the RHEL 9 web console.
					</p><p class="simpara">
						For instructions, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console">Installing and enabling the web console</a>.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the RHEL 9 web console.
					</p><p class="simpara">
						For details, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console">Logging in to the web console</a>.
					</p></li><li class="listitem">
						Click <span class="strong strong"><strong>SELinux</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">View the automation script</span>.
					</p><p class="simpara">
						A window with the generated script opens. You can navigate between a shell script and an Ansible playbook generation options tab.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_SELinux-en-US/images/574e330de771fb1ead38d319d32417f7/cockpit-ansible-playbook-generated.png" alt="Ansible playbook of your SELinux configuration"></span>

					</p></li><li class="listitem">
						Click the <span class="guibutton">Copy to clipboard</span> button to select the script or playbook and apply it.
					</li></ol></div><p>
				As a result, you have an automation script that you can apply to more machines.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/troubleshooting-problems-related-to-selinux_using-selinux">Troubleshooting problems related to SELinux</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/deploying-the-same-selinux-configuration-on-multiple-systems_using-selinux">Deploying the same SELinux configuration on multiple systems</a>
					</li><li class="listitem">
						<code class="literal">ansible-playbook(1)</code> man page on your system
					</li></ul></div></section><section class="section" id="transferring-selinux-settings-to-another-system-with-semanage_deploying-the-same-selinux-configuration-on-multiple-systems"><div class="titlepage"><div><div><h3 class="title">10.5. Transferring SELinux settings to another system with semanage</h3></div></div></div><p class="_abstract _abstract">
				Use the following steps for transferring your custom and verified SELinux settings between RHEL 9-based systems.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package is installed on your system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Export your verified SELinux settings:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage export -f ./<span class="emphasis"><em>my-selinux-settings.mod</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the file with the settings to the new system:
					</p><pre class="screen"># <span class="strong strong"><strong>scp ./<span class="emphasis"><em>my-selinux-settings.mod</em></span> <span class="emphasis"><em>new-system-hostname</em></span>:</strong></span></pre></li><li class="listitem"><p class="simpara">
						Log in on the new system:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh root@<span class="emphasis"><em>new-system-hostname</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Import the settings on the new system:
					</p><pre class="screen"><span class="emphasis"><em>new-system-hostname</em></span># <span class="strong strong"><strong>semanage import -f ./<span class="emphasis"><em>my-selinux-settings.mod</em></span></strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">semanage-export(8)</code> and <code class="literal">semanage-import(8)</code> man pages on your system
					</li></ul></div></section></section><section class="chapter" id="configuring-polyinstantiated-directories_using-selinux"><div class="titlepage"><div><div><h2 class="title">Chapter 11. Configuring polyinstantiated directories</h2></div></div></div><p>
			By default, all programs, services, and users use the <code class="literal">/tmp</code>, <code class="literal">/var/tmp</code>, and home directories for temporary storage. This makes these directories vulnerable to race condition attacks and information leaks based on file names. You can make <code class="literal">/tmp/</code>, <code class="literal">/var/tmp/</code>, and the home directory instantiated so that they are no longer shared between all users, and each user’s <code class="literal">/tmp-inst</code> and <code class="literal">/var/tmp/tmp-inst</code> is separately mounted to the <code class="literal">/tmp</code> and <code class="literal">/var/tmp</code> directory.
		</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
					Enable polyinstantiation in SELinux:
				</p><pre class="screen"># <span class="strong strong"><strong>setsebool -P allow_polyinstantiation 1</strong></span></pre><p class="simpara">
					You can verify that polyinstantiation is enabled in SELinux by entering the <code class="literal">getsebool allow_polyinstantiation</code> command.
				</p></li><li class="listitem"><p class="simpara">
					Create the directory structure for data persistence over reboot with the necessary permissions:
				</p><pre class="screen"># <span class="strong strong"><strong>mkdir /tmp-inst /var/tmp/tmp-inst --mode 000</strong></span></pre></li><li class="listitem"><p class="simpara">
					Restore the entire security context including the SELinux user part:
				</p><pre class="screen"># <span class="strong strong"><strong>restorecon -Fv /tmp-inst /var/tmp/tmp-inst</strong></span>
Relabeled /tmp-inst from unconfined_u:object_r:default_t:s0 to system_u:object_r:tmp_t:s0
Relabeled /var/tmp/tmp-inst from unconfined_u:object_r:tmp_t:s0 to system_u:object_r:tmp_t:s0</pre></li><li class="listitem"><p class="simpara">
					If your system uses the <code class="literal">fapolicyd</code> application control framework, allow <code class="literal">fapolicyd</code> to monitor file access events on the underlying file system when they are bind mounted by enabling the <code class="literal">allow_filesystem_mark</code> option in the <code class="literal">/etc/fapolicyd/fapolicyd.conf</code> configuration file.
				</p><pre class="screen">allow_filesystem_mark = 1</pre></li><li class="listitem"><p class="simpara">
					Enable instantiation of the <code class="literal">/tmp</code>, <code class="literal">/var/tmp/</code>, and users' home directories:
				</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
						Use <code class="literal">/etc/security/namespace.conf</code> instead of a separate file in the <code class="literal">/etc/security/namespace.d/</code> directory because the <code class="literal">pam_namespace_helper</code> program does not read additional files in <code class="literal">/etc/security/namespace.d</code>.
					</p></div></rh-alert><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
							On a system with multi-level security (MLS), uncomment the last three lines in the <code class="literal">/etc/security/namespace.conf</code> file:
						</p><pre class="screen">/tmp     /tmp-inst/   		   level 	 root,adm
/var/tmp /var/tmp/tmp-inst/    level 	 root,adm
$HOME    $HOME/$USER.inst/     level</pre></li><li class="listitem"><p class="simpara">
							On a system without multi-level security (MLS), add the following lines in the <code class="literal">/etc/security/namespace.conf</code> file:
						</p><pre class="screen">/tmp     /tmp-inst/            user 	 root,adm
/var/tmp /var/tmp/tmp-inst/    user 	 root,adm
$HOME    $HOME/$USER.inst/     user</pre></li></ol></div></li><li class="listitem"><p class="simpara">
					Verify that the <code class="literal">pam_namespace.so</code> module is configured for the session:
				</p><pre class="screen">$ <span class="strong strong"><strong>grep namespace /etc/pam.d/login</strong></span>
session    required     pam_namespace.so</pre></li><li class="listitem"><p class="simpara">
					Optional: Enable cloud users to access the system with SSH keys:
				</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
							Install the <code class="literal">openssh-keycat</code> package.
						</li><li class="listitem"><p class="simpara">
							Create a file in the <code class="literal">/etc/ssh/sshd_config.d/</code> directory with the following content:
						</p><pre class="screen">AuthorizedKeysCommand /usr/libexec/openssh/ssh-keycat
AuthorizedKeysCommandRunAs root</pre></li><li class="listitem"><p class="simpara">
							Verify that public key authentication is enabled by checking that the <code class="literal">PubkeyAuthentication</code> variable in <code class="literal">sshd_config</code> is set to <code class="literal">yes</code>. By default, <code class="literal">PubkeyAuthentication</code> is set to yes, even though the line in <code class="literal">sshd_config</code> is commented out.
						</p><pre class="screen">$ <span class="strong strong"><strong>grep -r PubkeyAuthentication /etc/ssh/</strong></span>
/etc/ssh/sshd_config:#PubkeyAuthentication yes</pre></li></ol></div></li><li class="listitem"><p class="simpara">
					Add the <code class="literal">session required pam_namespace.so unmnt_remnt</code> entry into the module for each service for which polyinstantiation should apply, after the <code class="literal">session include system-auth</code> line. For example, in <code class="literal">/etc/pam.d/su</code>, <code class="literal">/etc/pam.d/sudo</code>, <code class="literal">/etc/pam.d/ssh</code>, and <code class="literal">/etc/pam.d/sshd</code>:
				</p><pre class="screen">[...]
session        include        system-auth
session        required    pam_namespace.so unmnt_remnt
[...]</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					Log in as a non-root user. Users that were logged in before polyinstantiation was configured must log out and log in before the changes take effect for them.
				</li><li class="listitem"><p class="simpara">
					Check that the <code class="literal">/tmp/</code> directory is mounted under <code class="literal">/tmp-inst/</code>:
				</p><pre class="screen">$ <span class="strong strong"><strong>findmnt --mountpoint /tmp/</strong></span>
TARGET SOURCE                 	FSTYPE OPTIONS
/tmp   /dev/vda1[/tmp-inst/<span class="emphasis"><em>&lt;user&gt;</em></span>] xfs	rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota</pre><p class="simpara">
					The <code class="literal">SOURCE</code> output differs based on your environment. * On virutal systems, it shows <code class="literal">/dev/vda_&lt;number&gt;_</code>. * On bare-metal systems it shows <code class="literal">/dev/sda_&lt;number&gt;_</code> or <code class="literal">/dev/nvme*</code>
				</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					<code class="literal">/usr/share/doc/pam-docs/txts/README.pam_namespace</code> readme file installed with the <code class="literal">pam-docs</code> package.
				</li></ul></div></section><div><div xml:lang="en-US" class="legalnotice" id="idm139843088056768"><h2 class="legalnotice">Legal Notice</h2><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2024 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></body></section><!----></div></article><aside id="layout" class="span-xs-12 span-sm-2 span-md-2 content-format-selectors" aria-label="Select page format" data-v-8589d091><div class="sticky-top page-layout-options" data-v-8589d091><label for="page-format" data-v-8589d091>Format</label><select id="page-format" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div><!----></aside></div><div class="btn-container hidden" data-v-8589d091><pf-button class="top-scroll-btn" icon="angle-up" icon-set="fas" icon-position="right" data-v-8589d091>Back to top</pf-button></div><!--]--><!--]--></main><rh-footer data-analytics-region="page-footer" data-v-97dd2752><a slot="logo" href="/en" data-analytics-category="Footer" data-analytics-text="Logo" data-v-97dd2752><img alt="Red Hat logo" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" loading="lazy" width="222" height="40" data-v-97dd2752></a><rh-footer-social-link slot="social-links" icon="github" data-v-97dd2752><a href="https://github.com/redhat-documentation" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="LinkedIn" data-v-97dd2752>Github</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="reddit" data-v-97dd2752><a href="https://www.reddit.com/r/redhat/" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="YouTube" data-v-97dd2752>Reddit</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="youtube" data-v-97dd2752><a href="https://www.youtube.com/@redhat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Facebook" data-v-97dd2752>Youtube</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="twitter" data-v-97dd2752><a href="https://twitter.com/RedHat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Twitter" data-v-97dd2752>Twitter</a></rh-footer-social-link><h3 slot="links" data-analytics-text="Learn" data-v-97dd2752>Learn</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://developers.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Developer resources" data-v-97dd2752>Developer resources</a></li><li data-v-97dd2752><a href="https://cloud.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Cloud learning hub" data-v-97dd2752>Cloud learning hub</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="Footer|Learn" data-analytics-text="Interactive labs" data-v-97dd2752>Interactive labs</a></li><li data-v-97dd2752><a href="https://www.redhat.com/services/training-and-certification" data-analytics-category="Footer|Learn" data-analytics-text="Training and certification" data-v-97dd2752>Training and certification</a></li><li data-v-97dd2752><a href="https://access.redhat.com/support" data-analytics-category="Footer|Learn" data-analytics-text="Customer support" data-v-97dd2752>Customer support</a></li><li data-v-97dd2752><a href="/products" data-analytics-category="Footer|Learn" data-analytics-text="See all documentation" data-v-97dd2752>See all documentation</a></li></ul><h3 slot="links" data-analytics-text="Try buy sell" data-v-97dd2752>Try, buy, &amp; sell</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/products/trials" data-analytics-category="Footer|Try buy sell" data-analytics-text="Product trial center" data-v-97dd2752>Product trial center</a></li><li data-v-97dd2752><a href="https://marketplace.redhat.com" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Marketplace" data-v-97dd2752>Red Hat Marketplace</a></li><li data-v-97dd2752><a href="https://catalog.redhat.com/" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Ecosystem Catalog" data-v-97dd2752>Red Hat Ecosystem Catalog</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/store" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Store" data-v-97dd2752>Red Hat Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/japan-buy" data-analytics-category="Footer|Try buy sell" data-analytics-text="Buy online (Japan)" data-v-97dd2752>Buy online (Japan)</a></li></ul><h3 slot="links" data-analytics-text="Communities" data-v-97dd2752>Communities</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://access.redhat.com/community" data-analytics-category="Footer|Communities" data-analytics-text="Customer Portal Community" data-v-97dd2752>Customer Portal Community</a></li><li data-v-97dd2752><a href="https://www.redhat.com/events" data-analytics-category="Footer|Communities" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/our-community-contributions" data-analytics-category="Footer|Communities" data-analytics-text="How we contribute" data-v-97dd2752>How we contribute</a></li></ul><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat Documentation" data-v-97dd2752>About Red Hat Documentation</h3><p data-v-97dd2752>We help Red Hat users innovate and achieve their goals with our products and services with content they can trust.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="Making open source more inclusive" data-v-97dd2752>Making open source more inclusive</h3><p data-v-97dd2752>Red Hat is committed to replacing problematic language in our code, documentation, and web properties. For more details, see the <a href=" https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language" data-analytics-category="Footer|Making open source more inclusive" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a>.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</h3><p data-v-97dd2752>We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.</p></rh-footer-block><rh-footer-universal slot="universal" data-v-97dd2752><h3 slot="links-primary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-primary" data-analytics-region="page-footer-bottom-primary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/company" data-analytics-category="Footer|Corporate" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/jobs" data-analytics-category="Footer|Corporate" data-analytics-text="Jobs" data-v-97dd2752>Jobs</a></li><li data-v-97dd2752><a href="https://redhat.com/en/events" data-analytics-category="Footer|Corporate" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/office-locations" data-analytics-category="Footer|Corporate" data-analytics-text="Locations" data-v-97dd2752>Locations</a></li><li data-v-97dd2752><a href="https://redhat.com/en/contact" data-analytics-category="Footer|Corporate" data-analytics-text="Contact Red Hat" data-v-97dd2752>Contact Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/blog" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/our-culture/diversity-equity-inclusion" data-analytics-category="Footer|Corporate" data-analytics-text="Diversity equity and inclusion" data-v-97dd2752>Diversity, equity, and inclusion</a></li><li data-v-97dd2752><a href="https://coolstuff.redhat.com/" data-analytics-category="Footer|Corporate" data-analytics-text="Cool Stuff Store" data-v-97dd2752>Cool Stuff Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/summit" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Summit" data-v-97dd2752>Red Hat Summit</a></li></ul><span data-v-97dd2752 data-v-5f538988></span><rh-footer-copyright slot="links-secondary" data-v-97dd2752>© 2024 Red Hat, Inc.</rh-footer-copyright><h3 slot="links-secondary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-secondary" data-analytics-region="page-footer-bottom-secondary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/privacy-policy" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Privacy statement" data-v-97dd2752>Privacy statement</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/terms-use" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Terms of use" data-v-97dd2752>Terms of use</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/all-policies-guidelines" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="All policies and guidelines" data-v-97dd2752>All policies and guidelines</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/digital-accessibility" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Digital accessibility" class="active" data-v-97dd2752>Digital accessibility</a></li><li data-v-97dd2752><span id="teconsent" data-v-97dd2752></span></li></ul></rh-footer-universal></rh-footer><div id="consent_blackbar" style="position:fixed;bottom:0;width:100%;z-index:5;padding:10px;"></div><!--]--><!--]--></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true">[["ShallowReactive",1],{"data":2,"state":473,"once":477,"_errors":478,"serverRendered":15,"path":480},["ShallowReactive",3],{"s8LoCEfG4A":4,"uUstF4AIyn":10,"Pn02PlJOas":401,"rFVLKcOK8e":472},[5,6,7,8,9],"fr-fr","en-us","zh-cn","ko-kr","ja-jp",{"name":11,"html":12,"type":-1,"toc":13,"breadcrumbs":321,"error":18,"title":329,"productName":323,"productVersions":338,"pagination":367,"redirect":382,"canonicalLinks":383,"openShiftProducts":385,"tocFromVolume":-1,"jumpLinks":400},"Using SELinux","\u003Cbody>\u003Cdiv xml:lang=\"en-US\" class=\"book\" id=\"idm139843084842528\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv class=\"producttitle\">\u003Cspan class=\"productname\">Red Hat Enterprise Linux\u003C/span> \u003Cspan class=\"productnumber\">9\u003C/span>\u003C/div>\u003Cdiv>\u003Ch3 class=\"subtitle\">Prevent users and processes from performing unauthorized interactions with files and devices by using Security-Enhanced Linux (SELinux)\u003C/h3>\u003C/div>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"authorgroup\">\u003Cspan class=\"orgname\">Red Hat\u003C/span> \u003Cspan class=\"orgdiv\">Customer Content Services\u003C/span>\u003C/div>\u003C/div>\u003Cdiv>\u003Ca href=\"#idm139843088056768\">Legal Notice\u003C/a>\u003C/div>\u003Cdiv>\u003Cdiv class=\"abstract\">\u003Cp class=\"title\">\u003Cstrong>Abstract\u003C/strong>\u003C/p>\u003Cdiv class=\"para\">\n\t\t\t\tBy configuring SELinux, you can enhance your system’s security. SELinux is an implementation of Mandatory Access Control (MAC), and provides an additional layer of security. The SELinux policy defines how users and processes can interact with the files on the system. You can control which users can perform which actions by mapping them to specific SELinux confined users.\n\t\t\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003Chr/>\u003C/div>\u003Csection class=\"preface\" id=\"proc_providing-feedback-on-red-hat-documentation_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Providing feedback on Red Hat documentation\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tWe appreciate your feedback on our documentation. Let us know how we can improve it.\n\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Submitting feedback through Jira (account required)\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\tLog in to the \u003Ca class=\"link\" href=\"https://issues.redhat.com/projects/RHELDOCS/issues\">Jira\u003C/a> website.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> in the top navigation bar\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter a descriptive title in the \u003Cspan class=\"strong strong\">\u003Cstrong>Summary\u003C/strong>\u003C/span> field.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter your suggestion for improvement in the \u003Cspan class=\"strong strong\">\u003Cstrong>Description\u003C/strong>\u003C/span> field. Include links to the relevant parts of the documentation.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> at the bottom of the dialogue.\n\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"getting-started-with-selinux_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 1. Getting started with SELinux\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tSecurity Enhanced Linux (SELinux) provides an additional layer of system security. SELinux fundamentally answers the question: \u003Cspan class=\"emphasis\">\u003Cem>May &lt;subject&gt; do &lt;action&gt; to &lt;object&gt;?\u003C/em>\u003C/span>, for example: \u003Cspan class=\"emphasis\">\u003Cem>May a web server access files in users' home directories?\u003C/em>\u003C/span>\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"introduction-to-selinux_getting-started-with-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.1. Introduction to SELinux\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe standard access policy based on the user, group, and other permissions, known as Discretionary Access Control (DAC), does not enable system administrators to create comprehensive and fine-grained security policies, such as restricting specific applications to only viewing log files, while allowing other applications to append new data to the log files.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSecurity Enhanced Linux (SELinux) implements Mandatory Access Control (MAC). Every process and system resource has a special security label called an \u003Cspan class=\"emphasis\">\u003Cem>SELinux context\u003C/em>\u003C/span>. A SELinux context, sometimes referred to as an \u003Cspan class=\"emphasis\">\u003Cem>SELinux label\u003C/em>\u003C/span>, is an identifier which abstracts away the system-level details and focuses on the security properties of the entity. Not only does this provide a consistent way of referencing objects in the SELinux policy, but it also removes any ambiguity that can be found in other identification methods. For example, a file can have multiple valid path names on a system that makes use of bind mounts.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe SELinux policy uses these contexts in a series of rules which define how processes can interact with each other and the various system resources. By default, the policy does not allow any interaction unless a rule explicitly grants access.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tRemember that SELinux policy rules are checked after DAC rules. SELinux policy rules are not used if DAC rules deny access first, which means that no SELinux denial is logged if the traditional DAC rules prevent the access.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tSELinux contexts have several fields: user, role, type, and security level. The SELinux type information is perhaps the most important when it comes to the SELinux policy, as the most common policy rule which defines the allowed interactions between processes and system resources uses SELinux types and not the full SELinux context. SELinux types end with \u003Ccode class=\"literal\">_t\u003C/code>. For example, the type name for the web server is \u003Ccode class=\"literal\">httpd_t\u003C/code>. The type context for files and directories normally found in \u003Ccode class=\"literal\">/var/www/html/\u003C/code> is \u003Ccode class=\"literal\">httpd_sys_content_t\u003C/code>. The type contexts for files and directories normally found in \u003Ccode class=\"literal\">/tmp\u003C/code> and \u003Ccode class=\"literal\">/var/tmp/\u003C/code> is \u003Ccode class=\"literal\">tmp_t\u003C/code>. The type context for web server ports is \u003Ccode class=\"literal\">http_port_t\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThere is a policy rule that permits Apache (the web server process running as \u003Ccode class=\"literal\">httpd_t\u003C/code>) to access files and directories with a context normally found in \u003Ccode class=\"literal\">/var/www/html/\u003C/code> and other web server directories (\u003Ccode class=\"literal\">httpd_sys_content_t\u003C/code>). There is no allow rule in the policy for files normally found in \u003Ccode class=\"literal\">/tmp\u003C/code> and \u003Ccode class=\"literal\">/var/tmp/\u003C/code>, so access is not permitted. With SELinux, even if Apache is compromised, and a malicious script gains access, it is still not able to access the \u003Ccode class=\"literal\">/tmp\u003C/code> directory.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"fig-intro-httpd-mysqld\">\u003Cp class=\"title\">\u003Cstrong>Figure 1.1. An example how can SELinux help to run Apache and MariaDB in a secure way.\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_SELinux-en-US/images/f7b4d4a7ee54ec0153a3422060470895/selinux-intro-apache-mariadb.png\" alt=\"SELinux_Apache_MariaDB_example\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAs the previous scheme shows, SELinux allows the Apache process running as \u003Ccode class=\"literal\">httpd_t\u003C/code> to access the \u003Ccode class=\"literal\">/var/www/html/\u003C/code> directory and it denies the same process to access the \u003Ccode class=\"literal\">/data/mysql/\u003C/code> directory because there is no allow rule for the \u003Ccode class=\"literal\">httpd_t\u003C/code> and \u003Ccode class=\"literal\">mysqld_db_t\u003C/code> type contexts. On the other hand, the MariaDB process running as \u003Ccode class=\"literal\">mysqld_t\u003C/code> is able to access the \u003Ccode class=\"literal\">/data/mysql/\u003C/code> directory and SELinux also correctly denies the process with the \u003Ccode class=\"literal\">mysqld_t\u003C/code> type to access the \u003Ccode class=\"literal\">/var/www/html/\u003C/code> directory labeled as \u003Ccode class=\"literal\">httpd_sys_content_t\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">selinux(8)\u003C/code> man page and man pages listed by the \u003Ccode class=\"literal\">apropos selinux\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMan pages listed by the \u003Ccode class=\"literal\">man -k _selinux\u003C/code> command when the \u003Ccode class=\"literal\">selinux-policy-doc\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://people.redhat.com/duffy/selinux/selinux-coloring-book_A4-Stapled.pdf\">The SELinux Coloring Book\u003C/a> helps you to better understand SELinux basic concepts.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"http://selinuxproject.org/page/FAQ\">SELinux Wiki FAQ\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"benefits-of-selinux_getting-started-with-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.2. Benefits of running SELinux\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tSELinux provides the following benefits:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAll processes and files are labeled. SELinux policy rules define how processes interact with files, as well as how processes interact with each other. Access is only allowed if an SELinux policy rule exists that specifically allows it.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux provides fine-grained access control. Stepping beyond traditional UNIX permissions that are controlled at user discretion and based on Linux user and group IDs, SELinux access decisions are based on all available information, such as an SELinux user, role, type, and, optionally, a security level.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux policy is administratively-defined and enforced system-wide.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux can mitigate privilege escalation attacks. Processes run in domains, and are therefore separated from each other. SELinux policy rules define how processes access files and other processes. If a process is compromised, the attacker only has access to the normal functions of that process, and to files the process has been configured to have access to. For example, if the Apache HTTP Server is compromised, an attacker cannot use that process to read files in user home directories, unless a specific SELinux policy rule was added or configured to allow such access.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux can enforce data confidentiality and integrity, and can protect processes from untrusted inputs.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tSELinux is designed to enhance existing security solutions, not replace antivirus software, secure passwords, firewalls, or other security systems. Even when running SELinux, it is important to continue to follow good security practices, such as keeping software up-to-date, using hard-to-guess passwords, and firewalls.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"selinux-examples_getting-started-with-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.3. SELinux examples\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe following examples demonstrate how SELinux increases security:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe default action is deny. If an SELinux policy rule does not exist to allow access, such as for a process opening a file, access is denied.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux can confine Linux users. A number of confined SELinux users exist in the SELinux policy. Linux users can be mapped to confined SELinux users to take advantage of the security rules and mechanisms applied to them. For example, mapping a Linux user to the SELinux \u003Ccode class=\"literal\">user_u\u003C/code> user, results in a Linux user that is not able to run unless configured otherwise set user ID (setuid) applications, such as \u003Ccode class=\"literal command\">sudo\u003C/code> and \u003Ccode class=\"literal command\">su\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIncreased process and data separation. The concept of SELinux \u003Cspan class=\"emphasis\">\u003Cem>domains\u003C/em>\u003C/span> allows defining which processes can access certain files and directories. For example, when running SELinux, unless otherwise configured, an attacker cannot compromise a Samba server, and then use that Samba server as an attack vector to read and write to files used by other processes, such as MariaDB databases.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux helps mitigate the damage made by configuration mistakes. Domain Name System (DNS) servers often replicate information between each other in a zone transfer. Attackers can use zone transfers to update DNS servers with false information. When running the Berkeley Internet Name Domain (BIND) as a DNS server in RHEL, even if an administrator forgets to limit which servers can perform a zone transfer, the default SELinux policy prevent updates for zone files \u003Ca href=\"#ftn.idm139843084959872\" class=\"footnote\">\u003Csup class=\"footnote\" id=\"idm139843084959872\">[1]\u003C/sup>\u003C/a> that use zone transfers, by the BIND \u003Ccode class=\"literal\">named\u003C/code> daemon itself, and by other processes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tWithout SELinux, an attacker can misuse a vulnerability to path traversal on an Apache web server and access files and directories stored on the file system by using special elements such as \u003Ccode class=\"literal\">../\u003C/code>. If an attacker attempts an attack on a server running with SELinux in enforcing mode, SELinux denies access to files that the \u003Ccode class=\"literal\">httpd\u003C/code> process must not access. SELinux cannot block this type of attack completely but it effectively mitigates it.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux in enforcing mode successfully prevents exploitation of kernel NULL pointer dereference operators on non-SMAP platforms (CVE-2019-9213). Attackers use a vulnerability in the \u003Ccode class=\"literal\">mmap\u003C/code> function, which does not check mapping of a null page, for placing arbitrary code on this page.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">deny_ptrace\u003C/code> SELinux boolean and SELinux in enforcing mode protect systems from the \u003Cspan class=\"strong strong\">\u003Cstrong>PTRACE_TRACEME\u003C/strong>\u003C/span> vulnerability (CVE-2019-13272). Such configuration prevents scenarios when an attacker can get \u003Ccode class=\"literal\">root\u003C/code> privileges.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">nfs_export_all_rw\u003C/code> and \u003Ccode class=\"literal\">nfs_export_all_ro\u003C/code> SELinux booleans provide an easy-to-use tool to prevent misconfigurations of Network File System (NFS) such as accidental sharing \u003Ccode class=\"literal\">/home\u003C/code> directories.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6964380\">SELinux as a security pillar of an operating system - Real-world benefits and examples\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/7047896\">SELinux hardening with Ansible\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/fedora-selinux/selinux-playbooks\">selinux-playbooks\u003C/a> Github repository with Ansible playbooks for SELinux hardening\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"footnotes\">\u003Cbr/>\u003Chr width=\"100\" align=\"left\"/>\u003Cdiv id=\"ftn.idm139843084959872\" class=\"footnote\">\u003Cdiv class=\"para\">\u003Ca href=\"#idm139843084959872\" class=\"simpara\">\u003Csup class=\"simpara\">[1] \u003C/sup>\u003C/a>\n\t\t\t\t\t\t\tText files that include DNS information, such as hostname to IP address mappings.\n\t\t\t\t\t\t\u003C/div>\u003C/div>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"selinux-architecture_getting-started-with-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.4. SELinux architecture and packages\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tSELinux is a Linux Security Module (LSM) that is built into the Linux kernel. The SELinux subsystem in the kernel is driven by a security policy which is controlled by the administrator and loaded at boot. All security-relevant, kernel-level access operations on the system are intercepted by SELinux and examined in the context of the loaded security policy. If the loaded policy allows the operation, it continues. Otherwise, the operation is blocked and the process receives an error.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSELinux decisions, such as allowing or disallowing access, are cached. This cache is known as the Access Vector Cache (AVC). When using these cached decisions, SELinux policy rules need to be checked less, which increases performance. Remember that SELinux policy rules have no effect if DAC rules deny access first. Raw audit messages are logged to the \u003Ccode class=\"literal\">/var/log/audit/audit.log\u003C/code> and they start with the \u003Ccode class=\"literal\">type=AVC\u003C/code> string.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn RHEL 9, system services are controlled by the \u003Ccode class=\"literal\">systemd\u003C/code> daemon; \u003Ccode class=\"literal\">systemd\u003C/code> starts and stops all services, and users and processes communicate with \u003Ccode class=\"literal\">systemd\u003C/code> using the \u003Ccode class=\"literal\">systemctl\u003C/code> utility. The \u003Ccode class=\"literal\">systemd\u003C/code> daemon can consult the SELinux policy and check the label of the calling process and the label of the unit file that the caller tries to manage, and then ask SELinux whether or not the caller is allowed the access. This approach strengthens access control to critical system capabilities, which include starting and stopping system services.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">systemd\u003C/code> daemon also works as an SELinux Access Manager. It retrieves the label of the process running \u003Ccode class=\"literal\">systemctl\u003C/code> or the process that sent a \u003Ccode class=\"literal\">D-Bus\u003C/code> message to \u003Ccode class=\"literal\">systemd\u003C/code>. The daemon then looks up the label of the unit file that the process wanted to configure. Finally, \u003Ccode class=\"literal\">systemd\u003C/code> can retrieve information from the kernel if the SELinux policy allows the specific access between the process label and the unit file label. This means a compromised application that needs to interact with \u003Ccode class=\"literal\">systemd\u003C/code> for a specific service can now be confined by SELinux. Policy writers can also use these fine-grained controls to confine administrators.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf a process is sending a \u003Ccode class=\"literal\">D-Bus\u003C/code> message to another process and if the SELinux policy does not allow the \u003Ccode class=\"literal\">D-Bus\u003C/code> communication of these two processes, then the system prints a \u003Ccode class=\"literal\">USER_AVC\u003C/code> denial message, and the D-Bus communication times out. Note that the D-Bus communication between two processes works bidirectionally.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo avoid incorrect SELinux labeling and subsequent problems, ensure that you start services using a \u003Ccode class=\"literal\">systemctl start\u003C/code> command.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tRHEL 9 provides the following packages for working with SELinux:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tpolicies: \u003Ccode class=\"literal package\">selinux-policy-targeted\u003C/code>, \u003Ccode class=\"literal package\">selinux-policy-mls\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\ttools: \u003Ccode class=\"literal package\">policycoreutils\u003C/code>, \u003Ccode class=\"literal package\">policycoreutils-gui\u003C/code>, \u003Ccode class=\"literal package\">libselinux-utils\u003C/code>, \u003Ccode class=\"literal package\">policycoreutils-python-utils\u003C/code>, \u003Ccode class=\"literal package\">setools-console\u003C/code>, \u003Ccode class=\"literal package\">checkpolicy\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"selinux-states-and-modes_getting-started-with-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.5. SELinux states and modes\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tSELinux can run in one of three modes: enforcing, permissive, or disabled.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnforcing mode is the default, and recommended, mode of operation; in enforcing mode SELinux operates normally, enforcing the loaded security policy on the entire system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn permissive mode, the system acts as if SELinux is enforcing the loaded security policy, including labeling objects and emitting access denial entries in the logs, but it does not actually deny any operations. While not recommended for production systems, permissive mode can be helpful for SELinux policy development and debugging.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDisabled mode is strongly discouraged; not only does the system avoid enforcing the SELinux policy, it also avoids labeling any persistent objects such as files, making it difficult to enable SELinux in the future.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tUse the \u003Ccode class=\"literal command\">setenforce\u003C/code> utility to change between enforcing and permissive mode. Changes made with \u003Ccode class=\"literal command\">setenforce\u003C/code> do not persist across reboots. To change to enforcing mode, enter the \u003Ccode class=\"literal command\">setenforce 1\u003C/code> command as the Linux root user. To change to permissive mode, enter the \u003Ccode class=\"literal command\">setenforce 0\u003C/code> command. Use the \u003Ccode class=\"literal command\">getenforce\u003C/code> utility to view the current SELinux mode:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>getenforce\u003C/strong>\u003C/span>\nEnforcing\u003C/pre>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setenforce 0\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>getenforce\u003C/strong>\u003C/span>\nPermissive\u003C/pre>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setenforce 1\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>getenforce\u003C/strong>\u003C/span>\nEnforcing\u003C/pre>\u003Cp>\n\t\t\t\tIn Red Hat Enterprise Linux, you can set individual domains to permissive mode while the system runs in enforcing mode. For example, to make the \u003Cspan class=\"emphasis\">\u003Cem>httpd_t\u003C/em>\u003C/span> domain permissive:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage permissive -a \u003Cspan class=\"emphasis\">\u003Cem>httpd_t\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tNote that permissive domains are a powerful tool that can compromise security of your system. Red Hat recommends to use permissive domains with caution, for example, when debugging a specific scenario.\n\t\t\t\u003C/p>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"changing-selinux-states-and-modes_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 2. Changing SELinux states and modes\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tWhen enabled, SELinux can run in one of two modes: enforcing or permissive. The following sections show how to permanently change into these modes.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"changing-selinux-modes_changing-selinux-states-and-modes\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.1. Permanent changes in SELinux states and modes\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs discussed in \u003Ca class=\"link\" href=\"#selinux-states-and-modes_getting-started-with-selinux\" title=\"1.5. SELinux states and modes\">SELinux states and modes\u003C/a>, SELinux can be enabled or disabled. When enabled, SELinux has two modes: enforcing and permissive.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUse the \u003Ccode class=\"literal command\">getenforce\u003C/code> or \u003Ccode class=\"literal command\">sestatus\u003C/code> commands to check in which mode SELinux is running. The \u003Ccode class=\"literal command\">getenforce\u003C/code> command returns \u003Ccode class=\"literal\">Enforcing\u003C/code>, \u003Ccode class=\"literal\">Permissive\u003C/code>, or \u003Ccode class=\"literal\">Disabled\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal command\">sestatus\u003C/code> command returns the SELinux status and the SELinux policy being used:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sestatus\u003C/strong>\u003C/span>\nSELinux status:                 enabled\nSELinuxfs mount:                /sys/fs/selinux\nSELinux root directory:         /etc/selinux\nLoaded policy name:             targeted\nCurrent mode:                   enforcing\nMode from config file:          enforcing\nPolicy MLS status:              enabled\nPolicy deny_unknown status:     allowed\nMemory protection checking:     actual (secure)\nMax kernel policy version:      31\u003C/pre>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tWhen systems run SELinux in permissive mode, users and processes might label various file-system objects incorrectly. File-system objects created while SELinux is disabled are not labeled at all. This behavior causes problems when changing to enforcing mode because SELinux relies on correct labels of file-system objects.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tTo prevent incorrectly labeled and unlabeled files from causing problems, SELinux automatically relabels file systems when changing from the disabled state to permissive or enforcing mode. Use the \u003Ccode class=\"literal command\">fixfiles -F onboot\u003C/code> command as root to create the \u003Ccode class=\"literal filename\">/.autorelabel\u003C/code> file containing the \u003Ccode class=\"literal option\">-F\u003C/code> option to ensure that files are relabeled upon next reboot.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tBefore rebooting the system for relabeling, make sure the system will boot in permissive mode, for example by using the \u003Ccode class=\"literal\">enforcing=0\u003C/code> kernel option. This prevents the system from failing to boot in case the system contains unlabeled files required by \u003Ccode class=\"literal\">systemd\u003C/code> before launching the \u003Ccode class=\"literal\">selinux-autorelabel\u003C/code> service. For more information, see \u003Ca class=\"link\" href=\"https://bugzilla.redhat.com/show_bug.cgi?id=2021835\">RHBZ#2021835\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"changing-to-permissive-mode_changing-selinux-states-and-modes\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.2. Changing SELinux to permissive mode\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen SELinux is running in permissive mode, SELinux policy is not enforced. The system remains operational and SELinux does not deny any operations but only logs AVC messages, which can be then used for troubleshooting, debugging, and SELinux policy improvements. Each AVC is logged only once in this case.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">selinux-policy-targeted\u003C/code>, \u003Ccode class=\"literal\">libselinux-utils\u003C/code>, and \u003Ccode class=\"literal\">policycoreutils\u003C/code> packages are installed on your system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">selinux=0\u003C/code> or \u003Ccode class=\"literal\">enforcing=0\u003C/code> kernel parameters are not used.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/etc/selinux/config\u003C/code> file in a text editor of your choice, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/selinux/config\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfigure the \u003Ccode class=\"literal\">SELINUX=permissive\u003C/code> option:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># This file controls the state of SELinux on the system.\n# SELINUX= can take one of these three values:\n#       enforcing - SELinux security policy is enforced.\n#       permissive - SELinux prints warnings instead of enforcing.\n#       disabled - No SELinux policy is loaded.\nSELINUX=\u003Cspan class=\"strong strong\">\u003Cstrong>permissive\u003C/strong>\u003C/span>\n# SELINUXTYPE= can take one of these two values:\n#       targeted - Targeted processes are protected,\n#       mls - Multi Level Security protection.\nSELINUXTYPE=targeted\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter the system restarts, confirm that the \u003Ccode class=\"literal\">getenforce\u003C/code> command returns \u003Ccode class=\"literal\">Permissive\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>getenforce\u003C/strong>\u003C/span>\nPermissive\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"changing-to-enforcing-mode_changing-selinux-states-and-modes\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.3. Changing SELinux to enforcing mode\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen SELinux is running in enforcing mode, it enforces the SELinux policy and denies access based on SELinux policy rules. In RHEL, enforcing mode is enabled by default when the system was initially installed with SELinux.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">selinux-policy-targeted\u003C/code>, \u003Ccode class=\"literal\">libselinux-utils\u003C/code>, and \u003Ccode class=\"literal\">policycoreutils\u003C/code> packages are installed on your system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">selinux=0\u003C/code> or \u003Ccode class=\"literal\">enforcing=0\u003C/code> kernel parameters are not used.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/etc/selinux/config\u003C/code> file in a text editor of your choice, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/selinux/config\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfigure the \u003Ccode class=\"literal option\">SELINUX=enforcing\u003C/code> option:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># This file controls the state of SELinux on the system.\n# SELINUX= can take one of these three values:\n#       enforcing - SELinux security policy is enforced.\n#       permissive - SELinux prints warnings instead of enforcing.\n#       disabled - No SELinux policy is loaded.\nSELINUX=\u003Cspan class=\"strong strong\">\u003Cstrong>enforcing\u003C/strong>\u003C/span>\n# SELINUXTYPE= can take one of these two values:\n#       targeted - Targeted processes are protected,\n#       mls - Multi Level Security protection.\nSELINUXTYPE=targeted\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSave the change, and restart the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the next boot, SELinux relabels all the files and directories within the system and adds SELinux context for files and directories that were created when SELinux was disabled.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter the system restarts, confirm that the \u003Ccode class=\"literal\">getenforce\u003C/code> command returns \u003Ccode class=\"literal\">Enforcing\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>getenforce\u003C/strong>\u003C/span>\nEnforcing\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Troubleshooting\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tAfter changing to enforcing mode, SELinux may deny some actions because of incorrect or missing SELinux policy rules.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo view what actions SELinux denies, enter the following command as root:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -m AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR -ts today\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, with the \u003Ccode class=\"literal\">setroubleshoot-server\u003C/code> package installed, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>grep \"SELinux is preventing\" /var/log/messages\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf SELinux is active and the Audit daemon (\u003Ccode class=\"literal\">auditd\u003C/code>) is not running on your system, then search for certain SELinux messages in the output of the \u003Ccode class=\"literal\">dmesg\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dmesg | grep -i -e type=1300 -e type=1400\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tSee \u003Ca class=\"link\" href=\"#troubleshooting-problems-related-to-selinux_using-selinux\" title=\"Chapter 5. Troubleshooting problems related to SELinux\">Troubleshooting problems related to SELinux\u003C/a> for more information.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"enabling-selinux-on-systems-that-previously-had-it-disabled_changing-selinux-states-and-modes\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.4. Enabling SELinux on systems that previously had it disabled\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp id=\"enabling-selinux_changing-selinux-states-and-modes\">\n\t\t\t\tTo avoid problems, such as systems unable to boot or process failures, when enabling SELinux on systems that previously had it disabled, resolve Access Vector Cache (AVC) messages in permissive mode first.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tWhen systems run SELinux in permissive mode, users and processes might label various file-system objects incorrectly. File-system objects created while SELinux is disabled are not labeled at all. This behavior causes problems when changing to enforcing mode because SELinux relies on correct labels of file-system objects.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo prevent incorrectly labeled and unlabeled files from causing problems, SELinux automatically relabels file systems when changing from the disabled state to permissive or enforcing mode.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tBefore rebooting the system for relabeling, make sure the system will boot in permissive mode, for example by using the \u003Ccode class=\"literal\">enforcing=0\u003C/code> kernel option. This prevents the system from failing to boot in case the system contains unlabeled files required by \u003Ccode class=\"literal\">systemd\u003C/code> before launching the \u003Ccode class=\"literal\">selinux-autorelabel\u003C/code> service. For more information, see \u003Ca class=\"link\" href=\"https://bugzilla.redhat.com/show_bug.cgi?id=2021835\">RHBZ#2021835\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnable SELinux in permissive mode. For more information, see \u003Ca class=\"link\" href=\"#changing-to-permissive-mode_changing-selinux-states-and-modes\" title=\"2.2. Changing SELinux to permissive mode\">Changing to permissive mode\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart your system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCheck for SELinux denial messages. For more information, see \u003Ca class=\"link\" href=\"#identifying-selinux-denials_troubleshooting-problems-related-to-selinux\" title=\"5.1. Identifying SELinux denials\">Identifying SELinux denials\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnsure that files are relabeled upon the next reboot:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fixfiles -F onboot\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis creates the \u003Ccode class=\"literal filename\">/.autorelabel\u003C/code> file containing the \u003Ccode class=\"literal option\">-F\u003C/code> option.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tAlways switch to permissive mode before entering the \u003Ccode class=\"literal\">fixfiles -F onboot\u003C/code> command.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBy default, \u003Ccode class=\"literal\">autorelabel\u003C/code> uses as many threads in parallel as the system has available CPU cores. To use only a single thread during automatic relabeling, use the \u003Ccode class=\"literal\">fixfiles -T 1 onboot\u003C/code> command.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf there are no denials, switch to enforcing mode. For more information, see \u003Ca class=\"link\" href=\"#changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes\" title=\"2.6. Changing SELinux modes at boot time\">Changing SELinux modes at boot time\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter the system restarts, confirm that the \u003Ccode class=\"literal\">getenforce\u003C/code> command returns \u003Ccode class=\"literal\">Enforcing\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>getenforce\u003C/strong>\u003C/span>\nEnforcing\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tTo run custom applications with SELinux in enforcing mode, choose one of the following scenarios:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRun your application in the \u003Ccode class=\"literal\">unconfined_service_t\u003C/code> domain.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tWrite a new policy for your application. See the \u003Ca class=\"link\" href=\"#writing-a-custom-selinux-policy_using-selinux\" title=\"Chapter 8. Writing a custom SELinux policy\">Writing a custom SELinux policy\u003C/a> section for more information.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#selinux-states-and-modes_getting-started-with-selinux\" title=\"1.5. SELinux states and modes\">SELinux states and modes\u003C/a> section covers temporary changes in modes.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"Enabling_and_Disabling_SELinux-Disabling_SELinux_changing-selinux-states-and-modes\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.5. Disabling SELinux\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen you disable SELinux, your system does not load your SELinux policy. As a result, the system does not enforce the SELinux policy and does not log Access Vector Cache (AVC) messages. Therefore, all \u003Ca class=\"link\" href=\"#benefits-of-selinux_getting-started-with-selinux\" title=\"1.2. Benefits of running SELinux\">benefits of running SELinux\u003C/a> are lost.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDo not disable SELinux except in specific scenarios, such as performance-sensitive systems where the weakened security does not impose significant risks.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf your scenario requires to perform debugging in a production environment, temporarily use permissive mode instead of permanently disabling SELinux. See \u003Ca class=\"link\" href=\"#changing-to-permissive-mode_changing-selinux-states-and-modes\" title=\"2.2. Changing SELinux to permissive mode\">Changing to permissive mode\u003C/a> for more information about permissive mode.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal package\">grubby\u003C/code> package is installed:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>rpm -q grubby\u003C/strong>\u003C/span>\ngrubby-\u003Cspan class=\"emphasis\">\u003Cem>&lt;version&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfigure your boot loader to add \u003Ccode class=\"literal\">selinux=0\u003C/code> to the kernel command line:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo grubby --update-kernel ALL --args selinux=0\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart your system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter the reboot, confirm that the \u003Ccode class=\"literal command\">getenforce\u003C/code> command returns \u003Ccode class=\"literal\">Disabled\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>getenforce\u003C/strong>\u003C/span>\nDisabled\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.6. Changing SELinux modes at boot time\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tOn boot, you can set the following kernel parameters to change the way SELinux runs:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">enforcing=0\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tSetting this parameter causes the system to start in permissive mode, which is useful when troubleshooting issues. Using permissive mode might be the only option to detect a problem if your file system is too corrupted. Moreover, in permissive mode, the system continues to create the labels correctly. The AVC messages that are created in this mode can be different than in enforcing mode.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIn permissive mode, only the first denial from a series of the same denials is reported. However, in enforcing mode, you might get a denial related to reading a directory, and an application stops. In permissive mode, you get the same AVC message, but the application continues reading files in the directory and you get an AVC for each denial in addition.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">selinux=0\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis parameter causes the kernel to not load any part of the SELinux infrastructure. The init scripts notice that the system booted with the \u003Ccode class=\"literal option\">selinux=0\u003C/code> parameter and touch the \u003Ccode class=\"literal\">/.autorelabel\u003C/code> file. This causes the system to automatically relabel the next time you boot with SELinux enabled.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tDo not use the \u003Ccode class=\"literal option\">selinux=0\u003C/code> parameter in a production environment. To debug your system, temporarily use permissive mode instead of disabling SELinux.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">autorelabel=1\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis parameter forces the system to relabel similarly to the following commands:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>touch /.autorelabel\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf a file system contains a large amount of mislabeled objects, start the system in permissive mode to make the autorelabel process successful.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor additional SELinux-related kernel boot parameters, such as \u003Ccode class=\"literal\">checkreqprot\u003C/code>, see the \u003Ccode class=\"literal\">/usr/share/doc/kernel-doc-\u003Cspan class=\"emphasis\">\u003Cem>&lt;KERNEL_VER&gt;\u003C/em>\u003C/span>/Documentation/admin-guide/kernel-parameters.txt\u003C/code> file installed with the \u003Ccode class=\"literal\">kernel-doc\u003C/code> package. Replace the \u003Cspan class=\"emphasis\">\u003Cem>&lt;KERNEL_VER&gt;\u003C/em>\u003C/span> string with the version number of the installed kernel, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install kernel-doc\u003C/strong>\u003C/span>\n$ \u003Cspan class=\"strong strong\">\u003Cstrong>less /usr/share/doc/kernel-doc-\u003Cspan class=\"emphasis\">\u003Cem>4.18.0\u003C/em>\u003C/span>/Documentation/admin-guide/kernel-parameters.txt\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-confined-and-unconfined-users_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 3. Managing confined and unconfined users\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tEach Linux user is mapped to an SELinux user according to the rules in the SELinux policy. Administrators can modify these rules by using the \u003Ccode class=\"literal\">semanage login\u003C/code> utility or by assigning Linux users directly to specific SELinux users. Therefore, a Linux user has the restrictions of the SELinux user to which it is assigned. When a Linux user that is assigned to an SELinux user launches a process, this process inherits the SELinux user’s restrictions, unless other rules specify a different role or type.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"confined-and-unconfined-users_managing-confined-and-unconfined-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.1. Confined and unconfined users in SELinux\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBy default, all Linux users in Red Hat Enterprise Linux, including users with administrative privileges, are mapped to the unconfined SELinux user \u003Ccode class=\"literal\">unconfined_u\u003C/code>. You can improve the security of the system by assigning users to SELinux confined users.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe security context for a Linux user consists of the SELinux user, the SELinux role, and the SELinux type. For example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">user_u:user_r:user_t\u003C/pre>\u003Cp>\n\t\t\t\tWhere:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">user_u\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tIs the SELinux user.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">user_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tIs the SELinux role.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">user_t\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tIs the SELinux type.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tAfter a Linux user logs in, its SELinux user cannot change. However, its type and role can change, for example, during transitions.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo see the SELinux user mapping on your system, use the \u003Ccode class=\"literal\">semanage login -l\u003C/code> command as root:\n\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage login -l\u003C/strong>\u003C/span>\nLogin Name           SELinux User         MLS/MCS Range        Service\n\n__default__          unconfined_u         s0-s0:c0.c1023       *\nroot                 unconfined_u         s0-s0:c0.c1023       *\u003C/pre>\u003Cp>\n\t\t\t\tIn Red Hat Enterprise Linux, Linux users are mapped to the SELinux \u003Ccode class=\"literal\">__default__\u003C/code> login by default, which is mapped to the SELinux \u003Ccode class=\"literal\">unconfined_u\u003C/code> user. The following line defines the default mapping:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">\u003Cspan class=\"emphasis\">\u003Cem>default\u003C/em>\u003C/span>          unconfined_u         s0-s0:c0.c1023       *\u003C/pre>\u003Cp>\n\t\t\t\tConfined users are restricted by SELinux rules explicitly defined in the current SELinux policy. Unconfined users are subject to only minimal restrictions by SELinux.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tConfined and unconfined Linux users are subject to executable and writable memory checks, and are also restricted by MCS or MLS.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo list the available SELinux users, enter the following command:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>seinfo -u\u003C/strong>\u003C/span>\nUsers: 8\n   guest_u\n   root\n   staff_u\n   sysadm_u\n   system_u\n   unconfined_u\n   user_u\n   xguest_u\u003C/pre>\u003Cp>\n\t\t\t\tNote that the \u003Ccode class=\"literal\">seinfo\u003C/code> command is provided by the \u003Ccode class=\"literal\">setools-console\u003C/code> package, which is not installed by default.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf an unconfined Linux user executes an application that SELinux policy defines as one that can transition from the \u003Ccode class=\"literal\">unconfined_t\u003C/code> domain to its own confined domain, the unconfined Linux user is still subject to the restrictions of that confined domain. The security benefit of this is that, even though a Linux user is running unconfined, the application remains confined. Therefore, the exploitation of a flaw in the application can be limited by the policy.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSimilarly, we can apply these checks to confined users. Each confined user is restricted by a confined user domain. The SELinux policy can also define a transition from a confined user domain to its own target confined domain. In such a case, confined users are subject to the restrictions of that target confined domain. The main point is that special privileges are associated with the confined users according to their role.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"roles-and-access-rights-of-selinux-users_managing-confined-and-unconfined-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.2. Roles and access rights of SELinux users\u003Cspan id=\"selinux-user-capabilities\">\u003C!--Empty-->\u003C/span>\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe SELinux policy maps each Linux user to an SELinux user. This allows Linux users to inherit the restrictions of SELinux users.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can customize the permissions for confined users in your SELinux policy according to specific needs by adjusting booleans in the policy. You can determine the current state of these booleans by using the \u003Ccode class=\"literal\">semanage boolean -l\u003C/code> command. To list all SELinux users, their SELinux roles, and levels and ranges for MLS and MCS, use the \u003Ccode class=\"literal\">semanage user -l\u003C/code> command as \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\u003C/p>\u003Crh-table id=\"idm139843088198080\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 3.1. Roles of SELinux users\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843085706656\" scope=\"col\">User\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843085705568\" scope=\"col\">Default role\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843085704480\" scope=\"col\">Additional roles\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085706656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">unconfined_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085705568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">unconfined_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">system_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085706656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">guest_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085705568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">guest_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085706656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xguest_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085705568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xguest_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085706656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">user_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085705568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">user_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd rowspan=\"3\" align=\"left\" valign=\"top\" headers=\"idm139843085706656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">staff_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd rowspan=\"3\" align=\"left\" valign=\"top\" headers=\"idm139843085705568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">staff_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">unconfined_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">system_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085706656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085705568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd rowspan=\"3\" align=\"left\" valign=\"top\" headers=\"idm139843085706656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">root\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd rowspan=\"3\" align=\"left\" valign=\"top\" headers=\"idm139843085705568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">staff_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">unconfined_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">system_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085706656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">system_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085705568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">system_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843085704480\"> \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cp>\n\t\t\t\tNote that \u003Ccode class=\"literal\">system_u\u003C/code> is a special user identity for system processes and objects, and \u003Ccode class=\"literal\">system_r\u003C/code> is the associated role. Administrators must never associate this \u003Ccode class=\"literal\">system_u\u003C/code> user and the \u003Ccode class=\"literal\">system_r\u003C/code> role to a Linux user. Also, \u003Ccode class=\"literal\">unconfined_u\u003C/code> and \u003Ccode class=\"literal\">root\u003C/code> are unconfined users. For these reasons, the roles associated to these SELinux users are not included in the following table \u003Cspan class=\"emphasis\">\u003Cem>Types and access rights of SELinux roles\u003C/em>\u003C/span>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tEach SELinux role corresponds to an SELinux type and provides specific access rights.\n\t\t\t\u003C/p>\u003Crh-table id=\"idm139843076681376\">\u003Ctable class=\"gt-4-cols lt-7-rows\">\u003Ccaption>Table 3.2. Types and access rights of SELinux roles\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 17%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_4\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_5\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_6\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843084869888\" scope=\"col\">Role\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843084868800\" scope=\"col\">Type\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843084867712\" scope=\"col\">Log in using X Window System\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843084866608\" scope=\"col\">\u003Ccode class=\"literal\">su\u003C/code> and \u003Ccode class=\"literal\">sudo\u003C/code>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843086216320\" scope=\"col\">Execute in home directory and \u003Ccode class=\"literal\">/tmp\u003C/code> (default)\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843086214848\" scope=\"col\">Networking\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084869888\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">unconfined_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084868800\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">unconfined_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084867712\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084866608\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086216320\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086214848\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084869888\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">guest_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084868800\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">guest_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084867712\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084866608\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086216320\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086214848\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084869888\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xguest_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084868800\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xguest_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084867712\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084866608\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086216320\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086214848\"> \u003Cp>\n\t\t\t\t\t\t\t\tweb browsers only (Mozilla Firefox, GNOME Web)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084869888\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">user_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084868800\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">user_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084867712\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084866608\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086216320\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086214848\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084869888\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">staff_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084868800\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">staff_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084867712\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084866608\"> \u003Cp>\n\t\t\t\t\t\t\t\tonly \u003Ccode class=\"literal\">sudo\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086216320\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086214848\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084869888\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auditadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084868800\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auditadm_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084867712\"> \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084866608\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086216320\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086214848\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084869888\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">dbadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084868800\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">dbadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084867712\"> \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084866608\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086216320\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086214848\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084869888\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">logadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084868800\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">logadm_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084867712\"> \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084866608\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086216320\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086214848\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084869888\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">webadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084868800\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">webadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084867712\"> \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084866608\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086216320\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086214848\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084869888\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">secadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084868800\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">secadm_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084867712\"> \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084866608\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086216320\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086214848\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084869888\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084868800\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084867712\"> \u003Cp>\n\t\t\t\t\t\t\t\tonly when the \u003Ccode class=\"literal\">xdm_sysadm_login\u003C/code> boolean is \u003Ccode class=\"literal\">on\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843084866608\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086216320\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843086214848\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cp>\n\t\t\t\tFor more detailed descriptions of the non-administrator roles, see \u003Ca class=\"link\" href=\"#confined-non-administrator-roles-in-selinux_managing-confined-and-unconfined-users\" title=\"3.3. Confined non-administrator roles in SELinux\">Confined non-administrator roles in SELinux\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor more detailed descriptions of the administrator roles, see \u003Ca class=\"link\" href=\"#confined-administrator-roles-in-selinux_managing-confined-and-unconfined-users\" title=\"3.4. Confined administrator roles in SELinux\">Confined administrator roles in SELinux\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo list all available roles, enter the \u003Ccode class=\"literal\">seinfo -r\u003C/code> command:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>seinfo -r\u003C/strong>\u003C/span>\nRoles: 14\n   auditadm_r\n   dbadm_r\n   guest_r\n   logadm_r\n   nx_server_r\n   object_r\n   secadm_r\n   staff_r\n   sysadm_r\n   system_r\n   unconfined_r\n   user_r\n   webadm_r\n   xguest_r\u003C/pre>\u003Cp>\n\t\t\t\tNote that the \u003Ccode class=\"literal\">seinfo\u003C/code> command is provided by the \u003Ccode class=\"literal\">setools-console\u003C/code> package, which is not installed by default.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">seinfo(1)\u003C/code>, \u003Ccode class=\"literal\">semanage-login(8)\u003C/code>, and \u003Ccode class=\"literal\">xguest_selinux(8)\u003C/code> man pages installed with the \u003Ccode class=\"literal\">selinux-policy-doc\u003C/code> package\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/sysadmin/change-selinux-settings-boolean\">How to modify SELinux settings with booleans\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"confined-non-administrator-roles-in-selinux_managing-confined-and-unconfined-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.3. Confined non-administrator roles in SELinux\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIn SELinux, confined non-administrator roles grant specific sets of privileges and permissions for performing specific tasks to the Linux users assigned to them. By assigning separate confined non-administrator roles, you can assign specific privileges to individual users. This is useful in scenarios with multiple users who each have a different level of authorizations.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can also customize the permissions of SELinux roles by changing the related SELinux booleans on your system. To see the SELinux booleans and their current state, use the \u003Ccode class=\"literal\">semanage boolean -l\u003C/code> command as root. You can get more detailed descriptions if you install the \u003Ccode class=\"literal\">selinux-policy-devel\u003C/code> package.\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage boolean -l\u003C/strong>\u003C/span>\nSELinux boolean                State  Default Description\n…\nxguest_connect_network         (on   ,   on)  Allow xguest users to configure Network Manager and connect to apache ports\nxguest_exec_content            (on   ,   on)  Allow xguest to exec content\n…\u003C/pre>\u003Cp>\n\t\t\t\tLinux users in the \u003Ccode class=\"literal\">user_t\u003C/code>, \u003Ccode class=\"literal\">guest_t\u003C/code>, and \u003Ccode class=\"literal\">xguest_t\u003C/code> domains can only run set user ID (\u003Ccode class=\"literal\">setuid\u003C/code>) applications if SELinux policy permits it (for example, \u003Ccode class=\"literal\">passwd\u003C/code>). These users cannot run the \u003Ccode class=\"literal\">setuid\u003C/code> applications \u003Ccode class=\"literal\">su\u003C/code> and \u003Ccode class=\"literal\">sudo\u003C/code>, and therefore cannot use these applications to become root.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy default, Linux users in the \u003Ccode class=\"literal\">staff_t\u003C/code>, \u003Ccode class=\"literal\">user_t\u003C/code>, \u003Ccode class=\"literal\">guest_t\u003C/code>, and \u003Ccode class=\"literal\">xguest_t\u003C/code> domains can execute applications in their home directories and \u003Ccode class=\"literal\">/tmp\u003C/code>. Applications inherit the permissions of the user that executed them.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo prevent \u003Ccode class=\"literal\">guest_t\u003C/code>, and \u003Ccode class=\"literal\">xguest_t\u003C/code> users from executing applications in directories in which they have write access, set the \u003Ccode class=\"literal\">guest_exec_content\u003C/code> and \u003Ccode class=\"literal\">xguest_exec_content\u003C/code> booleans to \u003Ccode class=\"literal\">off\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSELinux has the following confined non-administrator roles, each with specific privileges and limitations:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">guest_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tHas very limited permissions. Users assigned to this role cannot access the network, but can execute files in the \u003Ccode class=\"literal\">/tmp\u003C/code> and \u003Ccode class=\"literal\">/home\u003C/code> directories.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRelated boolean:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELinux boolean                State  Default Description\nguest_exec_content             (on   ,   on)  Allow guest to exec content\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">xguest_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tHas limited permissions. Users assigned to this role can log into X Window, access web pages by using network browsers, and access media. They can also execute files in the \u003Ccode class=\"literal\">/tmp\u003C/code> and \u003Ccode class=\"literal\">/home\u003C/code> directories.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRelated booleans:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELinux boolean                State  Default Description\nxguest_connect_network         (on   ,   on)  Allow xguest users to configure Network Manager and connect to apache ports\nxguest_exec_content            (on   ,   on)  Allow xguest to exec content\nxguest_mount_media             (on   ,   on)  Allow xguest users to mount removable media\nxguest_use_bluetooth           (on   ,   on)  Allow xguest to use blue tooth devices\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">user_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tHas non-privileged access with full user permissions. Users assigned to this role can perform most actions that do not require administrative privileges.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRelated booleans:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELinux boolean                State  Default Description\nunprivuser_use_svirt           (off  ,  off)  Allow unprivileged user to create and transition to svirt domains.\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">staff_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tHas permissions similar to \u003Ccode class=\"literal\">user_r\u003C/code> and additional privileges. In particular, users assigned to this role are allowed to run \u003Ccode class=\"literal\">sudo\u003C/code> to execute administrative commands that are normally reserved for the \u003Ccode class=\"literal\">root\u003C/code> user. This changes roles and the effective user ID (EUID) but does not change the SELinux user.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRelated booleans:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELinux boolean                State  Default Description\nstaff_exec_content             (on   ,   on)  Allow staff to exec content\nstaff_use_svirt                (on   ,   on)  allow staff user to create and transition to svirt domains.\u003C/pre>\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo map a Linux user to \u003Ccode class=\"literal\">staff_u\u003C/code> and configure \u003Ccode class=\"literal\">sudo\u003C/code>, see \u003Ca class=\"link\" href=\"#confining-an-administrator-using-sudo-and-the-sysadm_r-role_managing-confined-and-unconfined-users\" title=\"3.9. Confining an administrator by using sudo and the sysadm_r role\">Confining an administrator using sudo and the sysadm_r role\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor additional information about each role and the associated types, see the relevant man pages installed with the \u003Ccode class=\"literal\">selinux-policy-doc\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">guest_selinux(8)\u003C/code>, \u003Ccode class=\"literal\">xguest_selinux(8)\u003C/code>, \u003Ccode class=\"literal\">user_selinux(8)\u003C/code>, and \u003Ccode class=\"literal\">staff_selinux(8)\u003C/code>\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"confined-administrator-roles-in-selinux_managing-confined-and-unconfined-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.4. Confined administrator roles in SELinux\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIn SELinux, confined administrator roles grant specific sets of privileges and permissions for performing specific tasks to the Linux users assigned to them. By assigning separate confined administrator roles, you can divide the privileges over various domains of system administration to individual users. This is useful in scenarios with multiple administrators, each with a separate domain.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can assign these roles to SELinux users by using the \u003Ccode class=\"literal\">semanage user\u003C/code> command.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSELinux has the following confined administrator roles:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">auditadm_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe audit administrator role allows managing processes related to the Audit subsystem.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRelated boolean:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELinux boolean                State  Default Description\nauditadm_exec_content          (on   ,   on)  Allow auditadm to exec content\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">dbadm_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe database administrator role allows managing MariaDB and PostgreSQL databases.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRelated booleans:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELinux boolean                State  Default Description\ndbadm_exec_content             (on   ,   on)  Allow dbadm to exec content\ndbadm_manage_user_files        (off  ,  off)  Determine whether dbadm can manage generic user files.\ndbadm_read_user_files          (off  ,  off)  Determine whether dbadm can read generic user files.\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logadm_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe log administrator role allows managing logs, specifically, SELinux types related to the Rsyslog logging service and the Audit subsystem.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRelated boolean:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELinux boolean                State  Default Description\nlogadm_exec_content            (on   ,   on)  Allow logadm to exec content\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">webadm_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe web administrator allows managing the Apache HTTP Server.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRelated booleans:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELinux boolean                State  Default Description\nwebadm_manage_user_files       (off  ,  off)  Determine whether webadm can manage generic user files.\nwebadm_read_user_files         (off  ,  off)  Determine whether webadm can read generic user files.\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">secadm_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe security administrator role allows managing the SELinux database.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRelated booleans:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELinux boolean                State  Default Description\nsecadm_exec_content            (on   ,   on)  Allow secadm to exec content\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sysadm_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe system administrator role allows doing everything of the previously listed roles and has additional privileges. In non-default configurations, security administration can be separated from system administration by disabling the \u003Ccode class=\"literal\">sysadm_secadm\u003C/code> module in the SELinux policy. For detailed instructions, see \u003Ca class=\"link\" href=\"#proc_separating-system-administration-from-security-administration-in-mls_using-multi-level-security-mls\" title=\"6.8. Separating system administration from security administration in MLS\">Separating system administration from security administration in MLS\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">sysadm_u\u003C/code> user cannot log in directly using SSH. To enable SSH logins for \u003Ccode class=\"literal\">sysadm_u\u003C/code>, set the \u003Ccode class=\"literal\">ssh_sysadm_login\u003C/code> boolean to \u003Ccode class=\"literal\">on\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setsebool -P ssh_sysadm_login on\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRelated booleans:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELinux boolean                State  Default Description\nssh_sysadm_login               (on   ,   on)  Allow ssh logins as sysadm_r:sysadm_t\nsysadm_exec_content            (on   ,   on)  Allow sysadm to exec content\nxdm_sysadm_login               (on   ,   on)  Allow the graphical login program to login directly as sysadm_r:sysadm_t\u003C/pre>\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo assign a Linux user to a confined administrator role, see \u003Ca class=\"link\" href=\"#confining-an-administrator-by-mapping-to-sysadm_u_managing-confined-and-unconfined-users\" title=\"3.8. Confining an administrator by mapping to sysadm_u\">Confining an administrator by mapping to sysadm_u\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor additional information about each role, and the associated types, see the relevant man pages installed with the \u003Ccode class=\"literal\">selinux-policy-doc\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">auditadm_selinux(8)\u003C/code>, \u003Ccode class=\"literal\">dbadm_selinux (8)\u003C/code>, \u003Ccode class=\"literal\">logadm_selinux(8)\u003C/code>, \u003Ccode class=\"literal\">webadm_selinux(8)\u003C/code>, \u003Ccode class=\"literal\">secadm_selinux(8)\u003C/code>, and \u003Ccode class=\"literal\">sysadm_selinux(8)\u003C/code>\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adding-a-new-user-automatically-mapped-to-the-selinux-unconfined_u-user_managing-confined-and-unconfined-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.5. Adding a new user automatically mapped to the SELinux unconfined_u user\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure demonstrates how to add a new Linux user to the system. The user is automatically mapped to the SELinux \u003Ccode class=\"literal\">unconfined_u\u003C/code> user.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">root\u003C/code> user is running unconfined, as it does by default in Red Hat Enterprise Linux.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnter the following command to create a new Linux user named \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>useradd \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo assign a password to the Linux \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code> user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>passwd \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nChanging password for user \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>.\nNew password:\nRetype new password:\npasswd: all authentication tokens updated successfully.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog out of your current session.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in as the Linux \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code> user. When you log in, the \u003Ccode class=\"literal\">pam_selinux\u003C/code> PAM module automatically maps the Linux user to an SELinux user (in this case, \u003Ccode class=\"literal\">unconfined_u\u003C/code>), and sets up the resulting SELinux context. The Linux user’s shell is then launched with this context.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhen logged in as the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code> user, check the context of a Linux user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>id -Z\u003C/strong>\u003C/span>\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">pam_selinux(8)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adding-a-new-user-as-an-selinux-confined-user_managing-confined-and-unconfined-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.6. Adding a new user as an SELinux-confined user\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse the following steps to add a new SELinux-confined user to the system. This example procedure maps the user to the SELinux \u003Ccode class=\"literal\">staff_u\u003C/code> user right with the command for creating the user account.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">root\u003C/code> user is running unconfined, as it does by default in Red Hat Enterprise Linux.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnter the following command to create a new Linux user named \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code> and map it to the SELinux \u003Ccode class=\"literal\">staff_u\u003C/code> user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>useradd -Z staff_u \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo assign a password to the Linux \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code> user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>passwd \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nChanging password for user \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>.\nNew password:\nRetype new password:\npasswd: all authentication tokens updated successfully.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog out of your current session.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in as the Linux \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code> user. The user’s shell launches with the \u003Ccode class=\"literal\">staff_u\u003C/code> context.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhen logged in as the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code> user, check the context of a Linux user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>id -Z\u003C/strong>\u003C/span>\nuid=1000(\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>) gid=1000(\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>) groups=1000(\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>) context=staff_u:staff_r:staff_t:s0-s0:c0.c1023\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">pam_selinux(8)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"confining-regular-users_managing-confined-and-unconfined-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.7. Confining regular users in SELinux\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can confine all regular users on your system by mapping them to the \u003Ccode class=\"literal\">user_u\u003C/code> SELinux user.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy default, all Linux users in Red Hat Enterprise Linux, including users with administrative privileges, are mapped to the unconfined SELinux user \u003Ccode class=\"literal\">unconfined_u\u003C/code>. You can improve the security of the system by assigning users to SELinux confined users. This is useful to conform with the \u003Ca class=\"link\" href=\"https://rhel7stig.readthedocs.io/en/latest/medium.html#v-71971-the-operating-system-must-prevent-non-privileged-users-from-executing-privileged-functions-to-include-disabling-circumventing-or-altering-implemented-security-safeguards-countermeasures-rhel-07-020020\">V-71971 Security Technical Implementation Guide\u003C/a>.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the list of SELinux login records. The list displays the mappings of Linux users to SELinux users:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage login -l\u003C/strong>\u003C/span>\n\nLogin Name    SELinux User  MLS/MCS Range   Service\n\n__default__   unconfined_u  s0-s0:c0.c1023       *\nroot          unconfined_u  s0-s0:c0.c1023       *\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMap the \u003Ccode class=\"literal\">__default__\u003C/code> user, which represents all users without an explicit mapping, to the \u003Ccode class=\"literal\">user_u\u003C/code> SELinux user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage login -m -s user_u -r s0 __default__\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the \u003Ccode class=\"literal\">__default__\u003C/code> user is mapped to the \u003Ccode class=\"literal\">user_u\u003C/code> SELinux user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage login -l\u003C/strong>\u003C/span>\n\nLogin Name    SELinux User   MLS/MCS Range    Service\n\n__default__   user_u         s0               *\nroot          unconfined_u   s0-s0:c0.c1023   *\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the processes of a new user run in the \u003Ccode class=\"literal\">user_u:user_r:user_t:s0\u003C/code> SELinux context.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate a new user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>adduser \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDefine a password for \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>passwd \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tLog out as \u003Ccode class=\"literal\">root\u003C/code> and log in as the new user.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tShow the security context for the user’s ID:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>@localhost ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>id -Z\u003C/strong>\u003C/span>\nuser_u:user_r:user_t:s0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tShow the security context of the user’s current processes:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\">[\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>@localhost ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ps axZ\u003C/strong>\u003C/span>\nLABEL                           PID TTY      STAT   TIME COMMAND\n-                                 1 ?        Ss     0:05 /usr/lib/systemd/systemd --switched-root --system --deserialize 18\n-                              3729 ?        S      0:00 (sd-pam)\nuser_u:user_r:user_t:s0        3907 ?        Ss     0:00 /usr/lib/systemd/systemd --user\n-                              3911 ?        S      0:00 (sd-pam)\nuser_u:user_r:user_t:s0        3918 ?        S      0:00 sshd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>@pts/0\nuser_u:user_r:user_t:s0        3922 pts/0    Ss     0:00 -bash\nuser_u:user_r:user_dbusd_t:s0  3969 ?        Ssl    0:00 /usr/bin/dbus-daemon --session --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only\nuser_u:user_r:user_t:s0        3971 pts/0    R+     0:00 ps axZ\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"confining-an-administrator-by-mapping-to-sysadm_u_managing-confined-and-unconfined-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.8. Confining an administrator by mapping to \u003Ccode class=\"literal\">sysadm_u\u003C/code>\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can confine a user with administrative privileges by mapping the user directly to the \u003Ccode class=\"literal\">sysadm_u\u003C/code> SELinux user. When the user logs in, the session runs in the \u003Ccode class=\"literal\">sysadm_u:sysadm_r:sysadm_t\u003C/code> SELinux context.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy default, all Linux users in Red Hat Enterprise Linux, including users with administrative privileges, are mapped to the unconfined SELinux user \u003Ccode class=\"literal\">unconfined_u\u003C/code>. You can improve the security of the system by assigning users to SELinux confined users. This is useful to conform with the \u003Ca class=\"link\" href=\"https://rhel7stig.readthedocs.io/en/latest/medium.html#v-71971-the-operating-system-must-prevent-non-privileged-users-from-executing-privileged-functions-to-include-disabling-circumventing-or-altering-implemented-security-safeguards-countermeasures-rhel-07-020020\">V-71971 Security Technical Implementation Guide\u003C/a>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">root\u003C/code> user runs unconfined. This is the Red Hat Enterprise Linux default.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To allow \u003Ccode class=\"literal\">sysadm_u\u003C/code> users to connect to the system by using SSH:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setsebool -P ssh_sysadm_login on\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMap a new or existing user to the \u003Ccode class=\"literal\">sysadm_u\u003C/code> SELinux user:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo map a new user, add a new user to the \u003Ccode class=\"literal\">wheel\u003C/code> user group and map the user to the \u003Ccode class=\"literal\">sysadm_u\u003C/code> SELinux user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>adduser -G wheel -Z sysadm_u \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo map an existing user, add the user to the \u003Ccode class=\"literal\">wheel\u003C/code> user group and map the user to the \u003Ccode class=\"literal\">sysadm_u\u003C/code> SELinux user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usermod -G wheel -Z sysadm_u \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestore the context of the user’s home directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>restorecon -R -F -v /home/\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code> is mapped to the \u003Ccode class=\"literal\">sysadm_u\u003C/code> SELinux user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage login -l | grep \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>     sysadm_u    s0-s0:c0.c1023   *\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in as \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code>, for example, by using SSH, and show the user’s security context:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>@localhost ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>id -Z\u003C/strong>\u003C/span>\nsysadm_u:sysadm_r:sysadm_t:s0-s0:c0.c1023\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSwitch to the \u003Ccode class=\"literal\">root\u003C/code> user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo -i\u003C/strong>\u003C/span>\n[sudo] password for \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the security context remains unchanged:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>id -Z\u003C/strong>\u003C/span>\nsysadm_u:sysadm_r:sysadm_t:s0-s0:c0.c1023\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTry an administrative task, for example, restarting the \u003Ccode class=\"literal\">sshd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sshd\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf there is no output, the command finished successfully.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the command does not finish successfully, it prints the following message:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Failed to restart sshd.service: Access denied\nSee system logs and 'systemctl status sshd.service' for details.\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"confining-an-administrator-using-sudo-and-the-sysadm_r-role_managing-confined-and-unconfined-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.9. Confining an administrator by using sudo and the sysadm_r role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can map a specific user with administrative privileges to the \u003Ccode class=\"literal\">staff_u\u003C/code> SELinux user, and configure \u003Ccode class=\"literal\">sudo\u003C/code> so that the user can gain the \u003Ccode class=\"literal\">sysadm_r\u003C/code> SELinux administrator role. This role allows the user to perform administrative tasks without SELinux denials. When the user logs in, the session runs in the \u003Ccode class=\"literal\">staff_u:staff_r:staff_t\u003C/code> SELinux context, but when the user enters a command by using \u003Ccode class=\"literal\">sudo\u003C/code>, the session changes to the \u003Ccode class=\"literal\">staff_u:sysadm_r:sysadm_t\u003C/code> context.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy default, all Linux users in Red Hat Enterprise Linux, including users with administrative privileges, are mapped to the unconfined SELinux user \u003Ccode class=\"literal\">unconfined_u\u003C/code>. You can improve the security of the system by assigning users to SELinux confined users. This is useful to conform with the \u003Ca class=\"link\" href=\"https://rhel7stig.readthedocs.io/en/latest/medium.html#v-71971-the-operating-system-must-prevent-non-privileged-users-from-executing-privileged-functions-to-include-disabling-circumventing-or-altering-implemented-security-safeguards-countermeasures-rhel-07-020020\">V-71971 Security Technical Implementation Guide\u003C/a>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">root\u003C/code> user runs unconfined. This is the Red Hat Enterprise Linux default.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMap a new or existing user to the \u003Ccode class=\"literal\">staff_u\u003C/code> SELinux user:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo map a new user, add a new user to the \u003Ccode class=\"literal\">wheel\u003C/code> user group and map the user to the \u003Ccode class=\"literal\">staff_u\u003C/code> SELinux user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>adduser -G wheel -Z staff_u \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo map an existing user, add the user to the \u003Ccode class=\"literal\">wheel\u003C/code> user group and map the user to the \u003Ccode class=\"literal\">staff_u\u003C/code> SELinux user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usermod -G wheel -Z staff_u \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestore the context of the user’s home directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>restorecon -R -F -v /home/\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo allow \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code> to gain the SELinux administrator role, create a new file in the \u003Ccode class=\"literal\">/etc/sudoers.d/\u003C/code> directory, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>visudo -f /etc/sudoers.d/\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the following line to the new file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\">\u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span> ALL=(ALL) TYPE=sysadm_t ROLE=sysadm_r ALL\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code> is mapped to the \u003Ccode class=\"literal\">staff_u\u003C/code> SELinux user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage login -l | grep \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>     staff_u    s0-s0:c0.c1023   *\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in as \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>\u003C/code>, for example, using SSH, and switch to the \u003Ccode class=\"literal\">root\u003C/code> user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[\u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>@localhost ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo -i\u003C/strong>\u003C/span>\n[sudo] password for \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_user&gt;\u003C/em>\u003C/span>:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tShow the \u003Ccode class=\"literal\">root\u003C/code> security context:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>id -Z\u003C/strong>\u003C/span>\nstaff_u:sysadm_r:sysadm_t:s0-s0:c0.c1023\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTry an administrative task, for example, restarting the \u003Ccode class=\"literal\">sshd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sshd\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf there is no output, the command finished successfully.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the command does not finish successfully, it prints the following message:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Failed to restart sshd.service: Access denied\nSee system logs and 'systemctl status sshd.service' for details.\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.10. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">unconfined_selinux(8)\u003C/code>, \u003Ccode class=\"literal\">user_selinux(8)\u003C/code>, \u003Ccode class=\"literal\">staff_selinux(8)\u003C/code>, and \u003Ccode class=\"literal\">sysadm_selinux(8)\u003C/code> man pages installed with the \u003Ccode class=\"literal\">selinux-policy-doc\u003C/code> package.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/3263671\">How to set up a system with SELinux confined users\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/sysadmin/change-selinux-settings-boolean\">How to modify SELinux settings with booleans\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 4. Configuring SELinux for applications and services with non-standard configurations\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tWhen SELinux is in enforcing mode, the default policy is the targeted policy. The following sections provide information about setting up and configuring the SELinux policy for various services after you change configuration defaults, such as ports, database locations, or file-system permissions for processes.\n\t\t\u003C/p>\u003Cp>\n\t\t\tYou learn to change SELinux types for non-standard ports, to identify and fix incorrect labels for changes of default directories, and to adjust the policy using SELinux booleans.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.1. Customizing the SELinux policy for the Apache HTTP server in a non-standard configuration\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can configure the Apache HTTP server to listen on a different port and to provide content in a non-default directory. To prevent consequent SELinux denials, follow the steps in this procedure to adjust your system’s SELinux policy.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">httpd\u003C/code> package is installed and the Apache HTTP server is configured to listen on TCP port 3131 and to use the \u003Ccode class=\"literal\">/var/test_www/\u003C/code> directory instead of the default \u003Ccode class=\"literal\">/var/www/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal package\">policycoreutils-python-utils\u003C/code> and \u003Ccode class=\"literal package\">setroubleshoot-server\u003C/code> packages are installed on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the \u003Ccode class=\"literal\">httpd\u003C/code> service and check the status:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl start httpd\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status httpd\u003C/strong>\u003C/span>\n...\nhttpd[14523]: (13)Permission denied: AH00072: make_sock: could not bind to address [::]:3131\n...\nsystemd[1]: Failed to start The Apache HTTP Server.\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe SELinux policy assumes that \u003Ccode class=\"literal\">httpd\u003C/code> runs on port 80:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage port -l | grep http\u003C/strong>\u003C/span>\nhttp_cache_port_t              tcp      8080, 8118, 8123, 10001-10010\nhttp_cache_port_t              udp      3130\nhttp_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, 9000\npegasus_http_port_t            tcp      5988\npegasus_https_port_t           tcp      5989\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the SELinux type of port 3131 to match port 80:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage port -a -t http_port_t -p tcp 3131\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart \u003Ccode class=\"literal\">httpd\u003C/code> again:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl start httpd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tHowever, the content remains inaccessible:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>wget localhost:3131/index.html\u003C/strong>\u003C/span>\n...\nHTTP request sent, awaiting response... 403 Forbidden\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFind the reason with the \u003Ccode class=\"literal\">sealert\u003C/code> tool:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>sealert -l \"*\"\u003C/strong>\u003C/span>\n...\nSELinux is preventing httpd from getattr access on the file /var/test_www/html/index.html.\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCompare SELinux types for the standard and the new path using the \u003Ccode class=\"literal\">matchpathcon\u003C/code> tool:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>matchpathcon /var/www/html /var/test_www/html\u003C/strong>\u003C/span>\n/var/www/html       system_u:object_r:httpd_sys_content_t:s0\n/var/test_www/html  system_u:object_r:var_t:s0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the SELinux type of the new \u003Ccode class=\"literal\">/var/test_www/html/\u003C/code> content directory to the type of the default \u003Ccode class=\"literal\">/var/www/html\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage fcontext -a -e /var/www /var/test_www\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRelabel the \u003Ccode class=\"literal\">/var\u003C/code> directory recursively:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>restorecon -Rv /var/\u003C/strong>\u003C/span>\n...\nRelabeled /var/test_www/html from unconfined_u:object_r:var_t:s0 to unconfined_u:object_r:httpd_sys_content_t:s0\nRelabeled /var/test_www/html/index.html from unconfined_u:object_r:var_t:s0 to unconfined_u:object_r:httpd_sys_content_t:s0\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the \u003Ccode class=\"literal\">httpd\u003C/code> service is running:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status httpd\u003C/strong>\u003C/span>\n...\nActive: active (running)\n...\nsystemd[1]: Started The Apache HTTP Server.\nhttpd[14888]: Server configured, listening on: port 3131\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the content provided by the Apache HTTP server is accessible:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>wget localhost:3131/index.html\u003C/strong>\u003C/span>\n...\nHTTP request sent, awaiting response... 200 OK\nLength: 0 [text/html]\nSaving to: ‘index.html’\n...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">semanage(8)\u003C/code>, \u003Ccode class=\"literal\">matchpathcon(8)\u003C/code>, and \u003Ccode class=\"literal\">sealert(8)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adjusting-the-policy-for-sharing-nfs-and-cifs-volumes-using-selinux-booleans_configuring-selinux-for-applications-and-services-with-non-standard-configurations\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.2. Adjusting the policy for sharing NFS and CIFS volumes by using SELinux booleans\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can change parts of SELinux policy at runtime using booleans, even without any knowledge of SELinux policy writing. This enables changes, such as allowing services access to NFS volumes, without reloading or recompiling SELinux policy. The following procedure demonstrates listing SELinux booleans and configuring them to achieve the required changes in the policy.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tNFS mounts on the client side are labeled with a default context defined by a policy for NFS volumes. In RHEL, this default context uses the \u003Ccode class=\"literal\">nfs_t\u003C/code> type. Also, Samba shares mounted on the client side are labeled with a default context defined by the policy. This default context uses the \u003Ccode class=\"literal\">cifs_t\u003C/code> type. You can enable or disable booleans to control which services are allowed to access the \u003Ccode class=\"literal\">nfs_t\u003C/code> and \u003Ccode class=\"literal\">cifs_t\u003C/code> types.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo allow the Apache HTTP server service (\u003Ccode class=\"literal\">httpd\u003C/code>) to access and share NFS and CIFS volumes, perform the following steps:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptionally, install the \u003Ccode class=\"literal\">selinux-policy-devel\u003C/code> package to obtain clearer and more detailed descriptions of SELinux booleans in the output of the \u003Ccode class=\"literal\">semanage boolean -l\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIdentify SELinux booleans relevant for NFS, CIFS, and Apache:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage boolean -l | grep 'nfs\\|cifs' | grep httpd\u003C/strong>\u003C/span>\nhttpd_use_cifs                 (off  ,  off)  Allow httpd to access cifs file systems\nhttpd_use_nfs                  (off  ,  off)  Allow httpd to access nfs file systems\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList the current state of the booleans:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>getsebool -a | grep 'nfs\\|cifs' | grep httpd\u003C/strong>\u003C/span>\nhttpd_use_cifs --&gt; off\nhttpd_use_nfs --&gt; off\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnable the identified booleans:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setsebool httpd_use_nfs on\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>setsebool httpd_use_cifs on\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tUse \u003Ccode class=\"literal\">setsebool\u003C/code> with the \u003Ccode class=\"literal\">-P\u003C/code> option to make the changes persistent across restarts. A \u003Ccode class=\"literal\">setsebool -P\u003C/code> command requires a rebuild of the entire policy, and it might take some time depending on your configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the booleans are \u003Ccode class=\"literal\">on\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>getsebool -a | grep 'nfs\\|cifs' | grep httpd\u003C/strong>\u003C/span>\nhttpd_use_cifs --&gt; on\nhttpd_use_nfs --&gt; on\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">semanage-boolean(8)\u003C/code>, \u003Ccode class=\"literal\">sepolicy-booleans(8)\u003C/code>, \u003Ccode class=\"literal\">getsebool(8)\u003C/code>, \u003Ccode class=\"literal\">setsebool(8)\u003C/code>, \u003Ccode class=\"literal\">booleans(5)\u003C/code>, and \u003Ccode class=\"literal\">booleans(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"finding-the-correct-selinux-type-for-managing-access-to-non-standard-directories_configuring-selinux-for-applications-and-services-with-non-standard-configurations\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.3. Finding the correct SELinux type for managing access to non-standard directories\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIf you need to set access-control rules that the default SELinux policy does not cover, start by searching for a boolean that matches your use case. If you cannot find a suitable boolean, you can use a matching SELinux type or even create a local policy module.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">selinux-policy-doc\u003C/code> and \u003Ccode class=\"literal\">setools-console\u003C/code> packages are installed on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList all SELinux-related topics and limit the results to a component you want to configure. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>man -k selinux | grep samba\u003C/strong>\u003C/span>\nsamba_net_selinux (8) - Security Enhanced Linux Policy for the samba_net processes\nsamba_selinux (8)    - Security Enhanced Linux Policy for the smbd processes\n…\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the man page that corresponds to your scenario, find the related SELinux booleans, port types, and file types.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that the \u003Ccode class=\"literal\">man -k selinux\u003C/code> or \u003Ccode class=\"literal\">apropos selinux\u003C/code> commands are available only after you install the \u003Ccode class=\"literal\">selinux-policy-doc\u003C/code> package.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: You can display the default mapping of processes on default locations by using the \u003Ccode class=\"literal\">semanage fcontext -l\u003C/code> command, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage fcontext -l | grep samba\u003C/strong>\u003C/span>\n…\n/var/cache/samba(/.*)?                             all files          system_u:object_r:samba_var_t:s0\n…\n/var/spool/samba(/.*)?                             all files          system_u:object_r:samba_spool_t:s0\n…\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">sesearch\u003C/code> command to display rules in the default SELinux policy. You can find the type and boolean to use by listing the corresponding rule, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sesearch -A | grep samba | grep httpd\u003C/strong>\u003C/span>\n…\nallow httpd_t cifs_t:dir { getattr open search }; [ use_samba_home_dirs &amp;&amp; httpd_enable_homedirs ]:True\n…\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAn SELinux boolean might be the most straightforward solution for your configuration problem. You can display all available booleans and their values by using the \u003Ccode class=\"literal\">getsebool -a\u003C/code> command, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>getsebool -a | grep homedirs\u003C/strong>\u003C/span>\ngit_cgi_enable_homedirs --&gt; off\ngit_system_enable_homedirs --&gt; off\nhttpd_enable_homedirs --&gt; off\nmock_enable_homedirs --&gt; off\nmpd_enable_homedirs --&gt; off\nopenvpn_enable_homedirs --&gt; on\nssh_chroot_rw_homedirs --&gt; off\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can verify that the selected boolean does exactly what you want by using the \u003Ccode class=\"literal\">sesearch\u003C/code> command, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sesearch -A | grep httpd_enable_homedirs\u003C/strong>\u003C/span>\n…\nallow httpd_suexec_t autofs_t:dir { getattr open search }; [ use_nfs_home_dirs &amp;&amp; httpd_enable_homedirs ]:True\nallow httpd_suexec_t autofs_t:dir { getattr open search }; [ use_samba_home_dirs &amp;&amp; httpd_enable_homedirs ]:True\n…\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf no boolean matches your scenario, find an SELinux type that suits your case. You can find a type for your files by querying a corresponding rule from the default policy by using \u003Ccode class=\"literal\">sesearch\u003C/code>, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sesearch -A -s httpd_t -c file -p read\u003C/strong>\u003C/span>\n…\nallow httpd_t httpd_t:file { append getattr ioctl lock open read write };\nallow httpd_t httpd_tmp_t:file { append create getattr ioctl link lock map open read rename setattr unlink write };\n…\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf none of the previous solutions cover your scenario, you can add a custom rule to the SELinux policy. See the \u003Ca class=\"link\" href=\"#proc_creating-a-local-selinux-policy-module_troubleshooting-problems-related-to-selinux\" title=\"5.4. Creating a local SELinux policy module\">Creating a local SELinux policy module\u003C/a> section for more information.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux-related man pages provided by the \u003Ccode class=\"literal\">man -k selinux\u003C/code> command\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sesearch(1)\u003C/code>, \u003Ccode class=\"literal\">semanage-fcontext(8)\u003C/code>, \u003Ccode class=\"literal\">semanage-boolean(8)\u003C/code>, and \u003Ccode class=\"literal\">getsebool(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"managing-access-to-non-standard-shared-directories-for-selinux-unprivileged-users_configuring-selinux-for-applications-and-services-with-non-standard-configurations\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.4. Managing access to non-standard shared directories for unprivileged SELinux users\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can configure access to a non-standard shared directory for the generic unprivileged SELinux user \u003Ccode class=\"literal\">user_u\u003C/code> by finding and mapping the corresponding SELinux file type. The \u003Ccode class=\"literal\">user_u\u003C/code> user has the default role \u003Ccode class=\"literal\">user_r\u003C/code> and the default domain \u003Ccode class=\"literal\">user_t\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">selinux-policy-doc\u003C/code> and \u003Ccode class=\"literal\">setools-console\u003C/code> packages are installed on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">user_selinux(8)\u003C/code> man page in your terminal:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>man user_selinux\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">MANAGED FILES\u003C/code> section, find an attribute or a type that corresponds with your scenario. For example, the \u003Ccode class=\"literal\">user_home_type\u003C/code> attribute.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To list all types assigned to an attribute, use the \u003Ccode class=\"literal\">seinfo\u003C/code> command with the \u003Ccode class=\"literal\">-x\u003C/code> and \u003Ccode class=\"literal\">-a\u003C/code> options, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>seinfo -x -a user_home_type\u003C/strong>\u003C/span>\n\nType Attributes: 1\n   attribute user_home_type;\n…\n\tchrome_sandbox_home_t\n\tconfig_home_t\n\tcvs_home_t\n\tdata_home_t\n\tdbus_home_t\n\tfetchmail_home_t\n\tgconf_home_t\n\tgit_user_content_t\n…\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter you identify a candidate for the corresponding type, the \u003Ccode class=\"literal\">data_home_t\u003C/code> type in this example, check its SELinux mapping:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>semanage fcontext -l | grep data_home_t\u003C/strong>\u003C/span>\n…\n/root/\\.local/share(/.*)?                          all files          system_u:object_r:data_home_t:s0\n…\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMap the corresponding type to a directory that you want to make accessible for \u003Ccode class=\"literal\">user_u\u003C/code>, for example, \u003Ccode class=\"literal\">/shared-data\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>semanage fcontext -a -t data_home_t '/shared-data(/.*)?'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the mapping of the directory you configured:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage fcontext -l | grep \"shared-data\"\u003C/strong>\u003C/span>\n/shared-data(/.*)?                             \tall files      \tsystem_u:object_r:data_home_t:s0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in as a Linux user mapped to the \u003Ccode class=\"literal\">user_u\u003C/code> SELinux user, and verify you can access the directory.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#managing-confined-and-unconfined-users_using-selinux\" title=\"Chapter 3. Managing confined and unconfined users\">Managing confined and unconfined users\u003C/a>\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">seinfo(1)\u003C/code>, \u003Ccode class=\"literal\">semanage-fcontext(8)\u003C/code>, and \u003Ccode class=\"literal\">user_selinux(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"troubleshooting-problems-related-to-selinux_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 5. Troubleshooting problems related to SELinux\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tIf you plan to enable SELinux on systems where it has been previously disabled or if you run a service in a non-standard configuration, you might need to troubleshoot situations potentially blocked by SELinux. Note that in most cases, SELinux denials are signs of misconfiguration.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"identifying-selinux-denials_troubleshooting-problems-related-to-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.1. Identifying SELinux denials\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow only the necessary steps from this procedure; in most cases, you need to perform just step 1.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhen your scenario is blocked by SELinux, the \u003Ccode class=\"literal\">/var/log/audit/audit.log\u003C/code> file is the first place to check for more information about a denial. To query Audit logs, use the \u003Ccode class=\"literal\">ausearch\u003C/code> tool. Because the SELinux decisions, such as allowing or disallowing access, are cached and this cache is known as the Access Vector Cache (AVC), use the \u003Ccode class=\"literal\">AVC\u003C/code> and \u003Ccode class=\"literal\">USER_AVC\u003C/code> values for the message type parameter, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -m AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR -ts recent\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf there are no matches, check if the Audit daemon is running. If it does not, repeat the denied scenario after you start \u003Ccode class=\"literal\">auditd\u003C/code> and check the Audit log again.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn case \u003Ccode class=\"literal\">auditd\u003C/code> is running, but there are no matches in the output of \u003Ccode class=\"literal\">ausearch\u003C/code>, check messages provided by the \u003Ccode class=\"literal\">systemd\u003C/code> Journal:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl -t setroubleshoot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf SELinux is active and the Audit daemon is not running on your system, then search for certain SELinux messages in the output of the \u003Ccode class=\"literal\">dmesg\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dmesg | grep -i -e type=1300 -e type=1400\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEven after the previous three checks, it is still possible that you have not found anything. In this case, AVC denials can be silenced because of \u003Ccode class=\"literal\">dontaudit\u003C/code> rules.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo temporarily disable \u003Ccode class=\"literal\">dontaudit\u003C/code> rules, allowing all denials to be logged:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semodule -DB\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter re-running your denied scenario and finding denial messages using the previous steps, the following command enables \u003Ccode class=\"literal\">dontaudit\u003C/code> rules in the policy again:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semodule -B\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you apply all four previous steps, and the problem still remains unidentified, consider if SELinux really blocks your scenario:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSwitch to permissive mode:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setenforce 0\u003C/strong>\u003C/span>\n$ \u003Cspan class=\"strong strong\">\u003Cstrong>getenforce\u003C/strong>\u003C/span>\nPermissive\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tRepeat your scenario.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the problem still occurs, something different than SELinux is blocking your scenario.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"analyzing-an-already-found-selinux-denial_troubleshooting-problems-related-to-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.2. Analyzing SELinux denial messages\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAfter \u003Ca class=\"link\" href=\"#identifying-selinux-denials_troubleshooting-problems-related-to-selinux\" title=\"5.1. Identifying SELinux denials\">identifying\u003C/a> that SELinux is blocking your scenario, you might need to analyze the root cause before you choose a fix.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal package\">policycoreutils-python-utils\u003C/code> and \u003Ccode class=\"literal package\">setroubleshoot-server\u003C/code> packages are installed on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList more details about a logged denial using the \u003Ccode class=\"literal command\">sealert\u003C/code> command, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sealert -l \"*\"\u003C/strong>\u003C/span>\nSELinux is preventing /usr/bin/passwd from write access on the file\n/root/test.\n\n*****  Plugin leaks (86.2 confidence) suggests *****************************\n\nIf you want to ignore passwd trying to write access the test file,\nbecause you believe it should not need this access.\nThen you should report this as a bug.\nYou can generate a local policy module to dontaudit this access.\nDo\n# ausearch -x /usr/bin/passwd --raw | audit2allow -D -M my-passwd\n# semodule -X 300 -i my-passwd.pp\n\n*****  Plugin catchall (14.7 confidence) suggests **************************\n\n...\n\nRaw Audit Messages\ntype=AVC msg=audit(1553609555.619:127): avc:  denied  { write } for\npid=4097 comm=\"passwd\" path=\"/root/test\" dev=\"dm-0\" ino=17142697\nscontext=unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023\ntcontext=unconfined_u:object_r:admin_home_t:s0 tclass=file permissive=0\n\n...\n\nHash: passwd,passwd_t,admin_home_t,file,write\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the output obtained in the previous step does not contain clear suggestions:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnable full-path auditing to see full paths to accessed objects and to make additional Linux Audit event fields visible:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>auditctl -w /etc/shadow -p w -k shadow-write\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tClear the \u003Ccode class=\"literal\">setroubleshoot\u003C/code> cache:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>rm -f /var/lib/setroubleshoot/setroubleshoot.xml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReproduce the problem.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRepeat step 1.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter you finish the process, disable full-path auditing:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>auditctl -W /etc/shadow -p w -k shadow-write\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf \u003Ccode class=\"literal\">sealert\u003C/code> returns only \u003Ccode class=\"literal\">catchall\u003C/code> suggestions or suggests adding a new rule using the \u003Ccode class=\"literal\">audit2allow\u003C/code> tool, match your problem with examples listed and explained in \u003Ca class=\"link\" href=\"#selinux-denials-in-the-audit-log_troubleshooting-problems-related-to-selinux\" title=\"5.5. SELinux denials in the Audit log\">SELinux denials in the Audit log\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sealert(8)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"fixing-an-analyzed-selinux-denial_troubleshooting-problems-related-to-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.3. Fixing analyzed SELinux denials\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn most cases, suggestions provided by the \u003Ccode class=\"literal\">sealert\u003C/code> tool give you the right guidance about how to fix problems related to the SELinux policy. See \u003Ca class=\"link\" href=\"#analyzing-an-already-found-selinux-denial_troubleshooting-problems-related-to-selinux\" title=\"5.2. Analyzing SELinux denial messages\">Analyzing SELinux denial messages\u003C/a> for information how to use \u003Ccode class=\"literal\">sealert\u003C/code> to analyze SELinux denials.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBe careful when the tool suggests using the \u003Ccode class=\"literal\">audit2allow\u003C/code> tool for configuration changes. You should not use \u003Ccode class=\"literal\">audit2allow\u003C/code> to generate a local policy module as your first option when you see an SELinux denial. Troubleshooting should start with a check if there is a labeling problem. The second most often case is that you have changed a process configuration, and you forgot to tell SELinux about it.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Labeling problems\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tA common cause of labeling problems is when a non-standard directory is used for a service. For example, instead of using \u003Ccode class=\"literal\">/var/www/html/\u003C/code> for a website, an administrator might want to use \u003Ccode class=\"literal\">/srv/myweb/\u003C/code>. On Red Hat Enterprise Linux, the \u003Ccode class=\"literal\">/srv\u003C/code> directory is labeled with the \u003Ccode class=\"literal\">var_t\u003C/code> type. Files and directories created in \u003Ccode class=\"literal\">/srv\u003C/code> inherit this type. Also, newly-created objects in top-level directories, such as \u003Ccode class=\"literal\">/myserver\u003C/code>, can be labeled with the \u003Ccode class=\"literal\">default_t\u003C/code> type. SELinux prevents the Apache HTTP Server (\u003Ccode class=\"literal\">httpd\u003C/code>) from accessing both of these types. To allow access, SELinux must know that the files in \u003Ccode class=\"literal\">/srv/myweb/\u003C/code> are to be accessible by \u003Ccode class=\"literal\">httpd\u003C/code>:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage fcontext -a -t httpd_sys_content_t \"/srv/myweb(/.*)?\"\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tThis \u003Ccode class=\"literal\">semanage\u003C/code> command adds the context for the \u003Ccode class=\"literal\">/srv/myweb/\u003C/code> directory and all files and directories under it to the SELinux file-context configuration. The \u003Ccode class=\"literal\">semanage\u003C/code> utility does not change the context. As root, use the \u003Ccode class=\"literal\">restorecon\u003C/code> utility to apply the changes:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>restorecon -R -v /srv/myweb\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Incorrect context\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">matchpathcon\u003C/code> utility checks the context of a file path and compares it to the default label for that path. The following example demonstrates the use of \u003Ccode class=\"literal\">matchpathcon\u003C/code> on a directory that contains incorrectly labeled files:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"screen white-space-pre white-space-pre\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>matchpathcon -V /var/www/html/*\u003C/strong>\u003C/span>\n/var/www/html/index.html has context unconfined_u:object_r:user_home_t:s0, should be system_u:object_r:httpd_sys_content_t:s0\n/var/www/html/page1.html has context unconfined_u:object_r:user_home_t:s0, should be system_u:object_r:httpd_sys_content_t:s0\u003C/pre>\u003Cp>\n\t\t\t\tIn this example, the \u003Ccode class=\"literal\">index.html\u003C/code> and \u003Ccode class=\"literal\">page1.html\u003C/code> files are labeled with the \u003Ccode class=\"literal\">user_home_t\u003C/code> type. This type is used for files in user home directories. Using the \u003Ccode class=\"literal command\">mv\u003C/code> command to move files from your home directory may result in files being labeled with the \u003Ccode class=\"literal\">user_home_t\u003C/code> type. This type should not exist outside of home directories. Use the \u003Ccode class=\"literal\">restorecon\u003C/code> utility to restore such files to their correct type:\n\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>restorecon -v /var/www/html/index.html\u003C/strong>\u003C/span>\nrestorecon reset /var/www/html/index.html context unconfined_u:object_r:user_home_t:s0-&gt;system_u:object_r:httpd_sys_content_t:s0\u003C/pre>\u003Cp>\n\t\t\t\tTo restore the context for all files under a directory, use the \u003Ccode class=\"literal option\">-R\u003C/code> option:\n\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>restorecon -R -v /var/www/html/\u003C/strong>\u003C/span>\nrestorecon reset /var/www/html/page1.html context unconfined_u:object_r:samba_share_t:s0-&gt;system_u:object_r:httpd_sys_content_t:s0\nrestorecon reset /var/www/html/index.html context unconfined_u:object_r:samba_share_t:s0-&gt;system_u:object_r:httpd_sys_content_t:s0\u003C/pre>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Confined applications configured in non-standard ways\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tServices can be run in a variety of ways. To account for that, you need to specify how you run your services. You can achieve this through SELinux booleans that allow parts of SELinux policy to be changed at runtime. This enables changes, such as allowing services access to NFS volumes, without reloading or recompiling SELinux policy. Also, running services on non-default port numbers requires policy configuration to be updated using the \u003Ccode class=\"literal command\">semanage\u003C/code> command.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tFor example, to allow the Apache HTTP Server to communicate with MariaDB, enable the \u003Ccode class=\"literal\">httpd_can_network_connect_db\u003C/code> boolean:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setsebool -P httpd_can_network_connect_db on\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tNote that the \u003Ccode class=\"literal option\">-P\u003C/code> option makes the setting persistent across reboots of the system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf access is denied for a particular service, use the \u003Ccode class=\"literal\">getsebool\u003C/code> and \u003Ccode class=\"literal\">grep\u003C/code> utilities to see if any booleans are available to allow access. For example, use the \u003Ccode class=\"literal command\">getsebool -a | grep ftp\u003C/code> command to search for FTP related booleans:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>getsebool -a | grep ftp\u003C/strong>\u003C/span>\nftpd_anon_write --&gt; off\nftpd_full_access --&gt; off\nftpd_use_cifs --&gt; off\nftpd_use_nfs --&gt; off\n\nftpd_connect_db --&gt; off\nhttpd_enable_ftp_server --&gt; off\ntftp_anon_write --&gt; off\u003C/pre>\u003Cp>\n\t\t\t\tTo get a list of booleans and to find out if they are enabled or disabled, use the \u003Ccode class=\"literal command\">getsebool -a\u003C/code> command. To get a list of booleans including their meaning, and to find out if they are enabled or disabled, install the \u003Ccode class=\"literal package\">selinux-policy-devel\u003C/code> package and use the \u003Ccode class=\"literal command\">semanage boolean -l\u003C/code> command as root.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Port numbers\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tDepending on policy configuration, services can only be allowed to run on certain port numbers. Attempting to change the port a service runs on without changing policy may result in the service failing to start. For example, run the \u003Ccode class=\"literal command\">semanage port -l | grep http\u003C/code> command as root to list \u003Ccode class=\"literal\">http\u003C/code> related ports:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage port -l | grep http\u003C/strong>\u003C/span>\nhttp_cache_port_t              tcp      3128, 8080, 8118\nhttp_cache_port_t              udp      3130\nhttp_port_t                    tcp      80, 443, 488, 8008, 8009, 8443\npegasus_http_port_t            tcp      5988\npegasus_https_port_t           tcp      5989\u003C/pre>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">http_port_t\u003C/code> port type defines the ports Apache HTTP Server can listen on, which in this case, are TCP ports 80, 443, 488, 8008, 8009, and 8443. If an administrator configures \u003Ccode class=\"literal\">httpd.conf\u003C/code> so that \u003Ccode class=\"literal\">httpd\u003C/code> listens on port 9876 (\u003Ccode class=\"literal option\">Listen 9876\u003C/code>), but policy is not updated to reflect this, the following command fails:\n\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl start httpd.service\u003C/strong>\u003C/span>\nJob for httpd.service failed. See 'systemctl status httpd.service' and 'journalctl -xn' for details.\n\n# \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status httpd.service\u003C/strong>\u003C/span>\nhttpd.service - The Apache HTTP Server\n   Loaded: loaded (/usr/lib/systemd/system/httpd.service; disabled)\n   Active: failed (Result: exit-code) since Thu 2013-08-15 09:57:05 CEST; 59s ago\n  Process: 16874 ExecStop=/usr/sbin/httpd $OPTIONS -k graceful-stop (code=exited, status=0/SUCCESS)\n  Process: 16870 ExecStart=/usr/sbin/httpd $OPTIONS -DFOREGROUND (code=exited, status=1/FAILURE)\u003C/pre>\u003Cp>\n\t\t\t\tAn SELinux denial message similar to the following is logged to \u003Ccode class=\"literal\">/var/log/audit/audit.log\u003C/code>:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">type=AVC msg=audit(1225948455.061:294): avc:  denied  { name_bind } for  pid=4997 comm=\"httpd\" src=9876 scontext=unconfined_u:system_r:httpd_t:s0 tcontext=system_u:object_r:port_t:s0 tclass=tcp_socket\u003C/pre>\u003Cp>\n\t\t\t\tTo allow \u003Ccode class=\"literal\">httpd\u003C/code> to listen on a port that is not listed for the \u003Ccode class=\"literal\">http_port_t\u003C/code> port type, use the \u003Ccode class=\"literal command\">semanage port\u003C/code> command to assign a different label to the port:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage port -a -t http_port_t -p tcp 9876\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal option\">-a\u003C/code> option adds a new record; the \u003Ccode class=\"literal option\">-t\u003C/code> option defines a type; and the \u003Ccode class=\"literal option\">-p\u003C/code> option defines a protocol. The last argument is the port number to add.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Corner cases, evolving or broken applications, and compromised systems\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tApplications may contain bugs, causing SELinux to deny access. Also, SELinux rules are evolving – SELinux may not have seen an application running in a certain way, possibly causing it to deny access, even though the application is working as expected. For example, if a new version of PostgreSQL is released, it may perform actions the current policy does not account for, causing access to be denied, even though access should be allowed.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tFor these situations, after access is denied, use the \u003Ccode class=\"literal\">audit2allow\u003C/code> utility to create a custom policy module to allow access. You can report missing rules in the SELinux policy in \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Ca class=\"link\" href=\"https://bugzilla.redhat.com/\">Red Hat Bugzilla\u003C/a>\u003C/strong>\u003C/span>. For Red Hat Enterprise Linux 9, create bugs against the \u003Ccode class=\"literal\">Red Hat Enterprise Linux 9\u003C/code> product, and select the \u003Ccode class=\"literal\">selinux-policy\u003C/code> component. Include the output of the \u003Ccode class=\"literal command\">audit2allow -w -a\u003C/code> and \u003Ccode class=\"literal command\">audit2allow -a\u003C/code> commands in such bug reports.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf an application asks for major security privileges, it could be a signal that the application is compromised. Use intrusion detection tools to inspect such suspicious behavior.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Ca class=\"link\" href=\"https://access.redhat.com/solution-engine/\">Solution Engine\u003C/a>\u003C/strong>\u003C/span> on the \u003Ca class=\"link\" href=\"https://access.redhat.com/\">Red Hat Customer Portal\u003C/a> can also provide guidance in the form of an article containing a possible solution for the same or very similar problem you have. Select the relevant product and version and use SELinux-related keywords, such as \u003Cspan class=\"emphasis\">\u003Cem>selinux\u003C/em>\u003C/span> or \u003Cspan class=\"emphasis\">\u003Cem>avc\u003C/em>\u003C/span>, together with the name of your blocked service or application, for example: \u003Ccode class=\"literal\">selinux samba\u003C/code>.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"proc_creating-a-local-selinux-policy-module_troubleshooting-problems-related-to-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.4. Creating a local SELinux policy module\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAdding specific SELinux policy modules to an active SELinux policy can fix certain problems with the SELinux policy. You can use this procedure to fix a specific Known Issue described in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/\">Red Hat release notes\u003C/a>, or to implement a specific \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions\">Red Hat Solution\u003C/a>.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tUse only rules provided by Red Hat. Red Hat does not support creating SELinux policy modules with custom rules, because this falls outside of the \u003Ca class=\"link\" href=\"https://access.redhat.com/support/offerings/production/soc/\">Production Support Scope of Coverage\u003C/a>. If you are not an expert, contact your Red Hat sales representative and request consulting services.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">setools-console\u003C/code> and \u003Ccode class=\"literal\">audit\u003C/code> packages for verification.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen a new \u003Ccode class=\"literal\">.cil\u003C/code> file with a text editor, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vim \u003Cspan class=\"emphasis\">\u003Cem>&lt;local_module&gt;\u003C/em>\u003C/span>.cil\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo keep your local modules better organized, use the \u003Ccode class=\"literal\">local_\u003C/code> prefix in the names of local SELinux policy modules.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInsert the custom rules from a Known Issue or a Red Hat Solution.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tDo not write your own rules. Use only the rules provided in a specific Known Issue or Red Hat Solution.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFor example, to implement the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/5729251\">SELinux denies cups-lpd read access to cups.sock in RHEL\u003C/a> solution, insert the following rule:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">(allow cupsd_lpd_t cupsd_var_run_t (sock_file (read)))\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe example solution has been fixed permanently for RHEL in \u003Ca class=\"link\" href=\"https://access.redhat.com/errata/RHBA-2021:4420\">RHBA-2021:4420\u003C/a>. Therefore, the parts of this procedure specific to this solution have no effect on updated RHEL 8 and 9 systems, and are included only as examples of syntax.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tYou can use either of the two SELinux rule syntaxes, Common Intermediate Language (CIL) and m4. For example, \u003Ccode class=\"literal\">(allow cupsd_lpd_t cupsd_var_run_t (sock_file (read)))\u003C/code> in CIL is equivalent to the following in m4:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">module local_cupslpd-read-cupssock 1.0;\n\nrequire {\n    type cupsd_var_run_t;\n    type cupsd_lpd_t;\n    class sock_file read;\n}\n\n#============= cupsd_lpd_t ==============\nallow cupsd_lpd_t cupsd_var_run_t:sock_file read;\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave and close the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the policy module:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semodule -i \u003Cspan class=\"emphasis\">\u003Cem>&lt;local_module&gt;\u003C/em>\u003C/span>.cil\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you want to remove a local policy module which you created by using \u003Ccode class=\"literal\">semodule -i\u003C/code>, refer to the module name without the \u003Ccode class=\"literal\">.cil\u003C/code> suffix. To remove a local policy module, use \u003Ccode class=\"literal\">semodule -r \u003Cspan class=\"emphasis\">\u003Cem>&lt;local_module&gt;\u003C/em>\u003C/span>\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart any services related to the rules:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart \u003Cspan class=\"emphasis\">\u003Cem>&lt;service-name&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList the local modules installed in your SELinux policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semodule -lfull | grep \"local_\"\u003C/strong>\u003C/span>\n400 local_module  cil\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBecause local modules have priority \u003Ccode class=\"literal\">400\u003C/code>, you can filter them from the list also by using that value, for example, by using the \u003Ccode class=\"literal\">semodule -lfull | grep -v ^100\u003C/code> command.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSearch the SELinux policy for the relevant allow rules:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>sesearch -A --source=\u003Cspan class=\"emphasis\">\u003Cem>&lt;SOURCENAME&gt;\u003C/em>\u003C/span> --target=\u003Cspan class=\"emphasis\">\u003Cem>&lt;TARGETNAME&gt;\u003C/em>\u003C/span> --class=\u003Cspan class=\"emphasis\">\u003Cem>&lt;CLASSNAME&gt;\u003C/em>\u003C/span> --perm=\u003Cspan class=\"emphasis\">\u003Cem>&lt;P1&gt;\u003C/em>\u003C/span>,\u003Cspan class=\"emphasis\">\u003Cem>&lt;P2&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhere \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;SOURCENAME&gt;\u003C/em>\u003C/span>\u003C/code> is the source SELinux type, \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;TARGETNAME&gt;\u003C/em>\u003C/span>\u003C/code> is the target SELinux type, \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;CLASSNAME&gt;\u003C/em>\u003C/span>\u003C/code> is the security class or object class name, and \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;P1&gt;\u003C/em>\u003C/span>\u003C/code> and \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;P2&gt;\u003C/em>\u003C/span>\u003C/code> are the specific permissions of the rule.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor example, for the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/5729251\">SELinux denies cups-lpd read access to cups.sock in RHEL\u003C/a> solution:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>sesearch -A --source=cupsd_lpd_t --target=cupsd_var_run_t --class=sock_file --perm=read\u003C/strong>\u003C/span>\nallow cupsd_lpd_t cupsd_var_run_t:sock_file { append getattr open read write };\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe last line should now include the \u003Ccode class=\"literal\">read\u003C/code> operation.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the relevant service runs confined by SELinux:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIdentify the process related to the relevant service:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status \u003Cspan class=\"emphasis\">\u003Cem>&lt;service-name&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCheck the SELinux context of the process listed in the output of the previous command:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ps -efZ | grep \u003Cspan class=\"emphasis\">\u003Cem>&lt;process-name&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the service does not cause any SELinux denials:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -m AVC -i -ts recent\u003C/strong>\u003C/span>\n&lt;no matches&gt;\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-i\u003C/code> option interprets the numeric values into human-readable text.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/5494701\">How to create custom SELinux policy module wisely\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"selinux-denials-in-the-audit-log_troubleshooting-problems-related-to-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.5. SELinux denials in the Audit log\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Linux Audit system stores log entries in the \u003Ccode class=\"literal filename\">/var/log/audit/audit.log\u003C/code> file by default.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo list only SELinux-related records, use the \u003Ccode class=\"literal command\">ausearch\u003C/code> command with the message type parameter set to \u003Ccode class=\"literal\">AVC\u003C/code> and \u003Ccode class=\"literal\">AVC_USER\u003C/code> at a minimum, for example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -m\u003C/strong>\u003C/span> AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR\u003C/pre>\u003Cp>\n\t\t\t\tAn SELinux denial entry in the Audit log file can look as follows:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">type=AVC msg=audit(1395177286.929:1638): avc:  denied  { read } for  pid=6591 comm=\"httpd\" name=\"webpages\" dev=\"0:37\" ino=2112 scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:nfs_t:s0 tclass=dir\u003C/pre>\u003Cp>\n\t\t\t\tThe most important parts of this entry are:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">avc: denied\u003C/code> - the action performed by SELinux and recorded in Access Vector Cache (AVC)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">{ read }\u003C/code> - the denied action\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">pid=6591\u003C/code> - the process identifier of the subject that tried to perform the denied action\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">comm=\"httpd\"\u003C/code> - the name of the command that was used to invoke the analyzed process\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">httpd_t\u003C/code> - the SELinux type of the process\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">nfs_t\u003C/code> - the SELinux type of the object affected by the process action\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">tclass=dir\u003C/code> - the target object class\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe previous log entry can be translated to:\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>SELinux denied the \u003Ccode class=\"literal\">httpd\u003C/code> process with PID 6591 and the \u003Ccode class=\"literal\">httpd_t\u003C/code> type to read from a directory with the \u003Ccode class=\"literal\">nfs_t\u003C/code> type.\u003C/em>\u003C/span>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following SELinux denial message occurs when the Apache HTTP Server attempts to access a directory labeled with a type for the Samba suite:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">type=AVC msg=audit(1226874073.147:96): avc:  denied  { getattr } for  pid=2465 comm=\"httpd\" path=\"/var/www/html/file1\" dev=dm-0 ino=284133 scontext=unconfined_u:system_r:httpd_t:s0 tcontext=unconfined_u:object_r:samba_share_t:s0 tclass=file\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">{ getattr }\u003C/code> - the \u003Ccode class=\"literal\">getattr\u003C/code> entry indicates the source process was trying to read the target file’s status information. This occurs before reading files. SELinux denies this action because the process accesses the file and it does not have an appropriate label. Commonly seen permissions include \u003Ccode class=\"literal\">getattr\u003C/code>, \u003Ccode class=\"literal\">read\u003C/code>, and \u003Ccode class=\"literal\">write\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">path=\"/var/www/html/file1\"\u003C/code> - the path to the object (target) the process attempted to access.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">scontext=\"unconfined_u:system_r:httpd_t:s0\"\u003C/code> - the SELinux context of the process (source) that attempted the denied action. In this case, it is the SELinux context of the Apache HTTP Server, which is running with the \u003Ccode class=\"literal\">httpd_t\u003C/code> type.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">tcontext=\"unconfined_u:object_r:samba_share_t:s0\"\u003C/code> - the SELinux context of the object (target) the process attempted to access. In this case, it is the SELinux context of \u003Ccode class=\"literal\">file1\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThis SELinux denial can be translated to:\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>SELinux denied the \u003Ccode class=\"literal\">httpd\u003C/code> process with PID 2465 to access the \u003Ccode class=\"literal\">/var/www/html/file1\u003C/code> file with the \u003Ccode class=\"literal\">samba_share_t\u003C/code> type, which is not accessible to processes running in the \u003Ccode class=\"literal\">httpd_t\u003C/code> domain unless configured otherwise.\u003C/em>\u003C/span>\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">auditd(8)\u003C/code> and \u003Ccode class=\"literal\">ausearch(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional-resources-troubleshooting-problems-related-to-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.6. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2191331\">Basic SELinux Troubleshooting in CLI\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://fedorapeople.org/~dwalsh/SELinux/Presentations/selinux_four_things.pdf\">What is SELinux trying to tell me? The 4 key causes of SELinux errors\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-multi-level-security-mls_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 6. Using Multi-Level Security (MLS)\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tThe Multi-Level Security (MLS) policy uses \u003Cspan class=\"emphasis\">\u003Cem>levels\u003C/em>\u003C/span> of clearance as originally designed by the US defense community. MLS meets a very narrow set of security requirements based on information management in rigidly controlled environments such as the military.\n\t\t\u003C/p>\u003Cp>\n\t\t\tUsing MLS is complex and does not map well to general use-case scenarios.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"multi-level-security-mls_using-multi-level-security-mls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.1. Multi-Level Security (MLS)\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Multi-Level Security (MLS) technology classifies data in a hierarchical classification using information security levels, for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t[lowest] Unclassified\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t[low] Confidential\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t[high] Secret\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t[highest] Top secret\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tBy default, the MLS SELinux policy uses 16 sensitivity levels:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">s0\u003C/code> is the least sensitive.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">s15\u003C/code> is the most sensitive.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tMLS uses specific terminology to address sensitivity levels:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUsers and processes are called \u003Cspan class=\"strong strong\">\u003Cstrong>subjects\u003C/strong>\u003C/span>, whose sensitivity level is called \u003Cspan class=\"strong strong\">\u003Cstrong>clearance\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFiles, devices, and other passive components of the system are called \u003Cspan class=\"strong strong\">\u003Cstrong>objects\u003C/strong>\u003C/span>, whose sensitivity level is called \u003Cspan class=\"strong strong\">\u003Cstrong>classification\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tTo implement MLS, SELinux uses the \u003Cspan class=\"strong strong\">\u003Cstrong>Bell-La Padula Model\u003C/strong>\u003C/span> (BLP) model. This model specifies how information can flow within the system based on labels attached to each subject and object.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe basic principle of BLP is “\u003Cspan class=\"strong strong\">\u003Cstrong>No read up, no write down.\u003C/strong>\u003C/span>” This means that users can only read files at their own sensitivity level and lower, and data can flow only from lower levels to higher levels, and never the reverse.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe MLS SELinux policy, which is the implementation of MLS on RHEL, applies a modified principle called \u003Cspan class=\"strong strong\">\u003Cstrong>Bell-La Padula with write equality\u003C/strong>\u003C/span>. This means that users can read files at their own sensitivity level and lower, but can write only at exactly their own level. This prevents, for example, low-clearance users from writing content into top-secret files.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor example, by default, a user with clearance level \u003Ccode class=\"literal\">s2\u003C/code>:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCan read files with sensitivity levels \u003Ccode class=\"literal\">s0\u003C/code>, \u003Ccode class=\"literal\">s1\u003C/code>, and \u003Ccode class=\"literal\">s2\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCannot read files with sensitivity level \u003Ccode class=\"literal\">s3\u003C/code> and higher.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCan modify files with sensitivity level of exactly \u003Ccode class=\"literal\">s2\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCannot modify files with sensitivity level other than \u003Ccode class=\"literal\">s2\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tSecurity administrators can adjust this behavior by modifying the system’s SELinux policy. For example, they can allow users to modify files at lower levels, which increases the file’s sensitivity level to the user’s clearance level.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tIn practice, users are typically assigned to a range of clearance levels, for example \u003Ccode class=\"literal\">s1-s2\u003C/code>. A user can read files with sensitivity levels lower than the user’s maximum level, and write to any files within that range.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor example, by default, a user with a clearance range \u003Ccode class=\"literal\">s1-s2\u003C/code>:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCan read files with sensitivity levels \u003Ccode class=\"literal\">s0\u003C/code> and \u003Ccode class=\"literal\">s1\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCannot read files with sensitivity level \u003Ccode class=\"literal\">s2\u003C/code> and higher.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCan modify files with sensitivity level \u003Ccode class=\"literal\">s1\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCannot modify files with sensitivity level other than \u003Ccode class=\"literal\">s1\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCan change own clearance level to \u003Ccode class=\"literal\">s2\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe security context for a non-privileged user in an MLS environment is, for example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">user_u:user_r:user_t:s1\u003C/pre>\u003Cp>\n\t\t\t\tWhere:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">user_u\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tIs the SELinux user.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">user_r\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tIs the SELinux role.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">user_t\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tIs the SELinux type.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">s1\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tIs the range of MLS sensitivity levels.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tThe system always combines MLS access rules with conventional file access permissions. For example, if a user with a security level of \"Secret\" uses Discretionary Access Control (DAC) to block access to a file by other users, even “Top Secret” users cannot access that file. A high security clearance does not automatically permit a user to browse the entire file system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUsers with top-level clearances do not automatically acquire administrative rights on multi-level systems. While they might have access to all sensitive information about the system, this is different from having administrative rights.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn addition, administrative rights do not provide access to sensitive information. For example, even when someone logs in as \u003Ccode class=\"literal\">root\u003C/code>, they still cannot read top-secret information.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can further adjust access within an MLS system by using categories. With Multi-Category Security (MCS), you can define categories such as projects or departments, and users will only be allowed to access files in the categories to which they are assigned. For additional information, see \u003Ca class=\"link\" href=\"#assembly_using-multi-category-security-mcs-for-data-confidentiality_using-selinux\" title=\"Chapter 7. Using Multi-Category Security (MCS) for data confidentiality\">Using Multi-Category Security (MCS) for data confidentiality\u003C/a> .\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ref_selinux-roles-in-mls_using-multi-level-security-mls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.2. SELinux roles in MLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe SELinux policy maps each Linux user to an SELinux user. This allows Linux users to inherit the restrictions of SELinux users.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe MLS policy does not contain the \u003Ccode class=\"literal\">unconfined\u003C/code> module, including unconfined users, types, and roles. As a result, users that would be unconfined, including \u003Ccode class=\"literal\">root\u003C/code>, cannot access every object and perform every action they could in the targeted policy.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tYou can customize the permissions for confined users in your SELinux policy according to specific needs by adjusting the booleans in policy. You can determine the current state of these booleans by using the \u003Ccode class=\"literal\">semanage boolean -l\u003C/code> command. To list all SELinux users, their SELinux roles, and MLS/MCS levels and ranges, use the \u003Ccode class=\"literal\">semanage user -l\u003C/code> command as \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\u003C/p>\u003Crh-table id=\"idm139843078835632\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 6.1. Roles of SELinux users in MLS\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843081627072\" scope=\"col\">User\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843081625984\" scope=\"col\">Default role\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843081624896\" scope=\"col\">Additional roles\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081627072\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">guest_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081625984\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">guest_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081627072\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xguest_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081625984\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xguest_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081627072\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">user_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081625984\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">user_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd rowspan=\"4\" align=\"left\" valign=\"top\" headers=\"idm139843081627072\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">staff_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd rowspan=\"4\" align=\"left\" valign=\"top\" headers=\"idm139843081625984\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">staff_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auditadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">secadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">staff_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081627072\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081625984\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd rowspan=\"4\" align=\"left\" valign=\"top\" headers=\"idm139843081627072\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">root\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd rowspan=\"4\" align=\"left\" valign=\"top\" headers=\"idm139843081625984\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">staff_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auditadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">secadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">system_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081627072\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">system_u\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081625984\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">system_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081624896\"> \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cp>\n\t\t\t\tNote that \u003Ccode class=\"literal\">system_u\u003C/code> is a special user identity for system processes and objects, and \u003Ccode class=\"literal\">system_r\u003C/code> is the associated role. Administrators must never associate this \u003Ccode class=\"literal\">system_u\u003C/code> user and the \u003Ccode class=\"literal\">system_r\u003C/code> role to a Linux user. Also, \u003Ccode class=\"literal\">unconfined_u\u003C/code> and \u003Ccode class=\"literal\">root\u003C/code> are unconfined users. For these reasons, the roles associated to these SELinux users are not included in the following table Types and access of SELinux roles.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tEach SELinux role corresponds to an SELinux type and provides specific access rights.\n\t\t\t\u003C/p>\u003Crh-table id=\"idm139843081141232\">\u003Ctable class=\"gt-4-cols lt-7-rows\">\u003Ccaption>Table 6.2. Types and access of SELinux roles in MLS\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 17%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_4\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_5\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_6\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843081132656\" scope=\"col\">Role\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843081131568\" scope=\"col\">Type\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843081130480\" scope=\"col\">Login using X Window System\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843081129424\" scope=\"col\">\u003Ccode class=\"literal\">su\u003C/code> and \u003Ccode class=\"literal\">sudo\u003C/code>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843081127696\" scope=\"col\">Execute in home directory and \u003Ccode class=\"literal\">/tmp\u003C/code> (default)\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm139843081126112\" scope=\"col\">Networking\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081132656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">guest_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081131568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">guest_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081130480\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081129424\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081127696\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081126112\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081132656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xguest_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081131568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xguest_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081130480\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081129424\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081127696\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081126112\"> \u003Cp>\n\t\t\t\t\t\t\t\tweb browsers only (Firefox, GNOME Web)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081132656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">user_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081131568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">user_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081130480\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081129424\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081127696\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081126112\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081132656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">staff_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081131568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">staff_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081130480\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081129424\"> \u003Cp>\n\t\t\t\t\t\t\t\tonly \u003Ccode class=\"literal\">sudo\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081127696\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081126112\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081132656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auditadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081131568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auditadm_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081130480\"> \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081129424\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081127696\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081126112\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081132656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">secadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081131568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">secadm_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081130480\"> \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081129424\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081127696\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081126112\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081132656\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_r\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081131568\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sysadm_t\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081130480\"> \u003Cp>\n\t\t\t\t\t\t\t\tonly when the \u003Ccode class=\"literal\">xdm_sysadm_login\u003C/code> boolean is \u003Ccode class=\"literal\">on\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081129424\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081127696\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm139843081126112\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tBy default, the \u003Ccode class=\"literal\">sysadm_r\u003C/code> role has the rights of the \u003Ccode class=\"literal\">secadm_r\u003C/code> role, which means a user with the \u003Ccode class=\"literal\">sysadm_r\u003C/code> role can manage the security policy. If this does not correspond to your use case, you can separate the two roles by disabling the \u003Ccode class=\"literal\">sysadm_secadm\u003C/code> module in the policy. For additional information, see \u003Ca class=\"link\" href=\"#proc_separating-system-administration-from-security-administration-in-mls_using-multi-level-security-mls\" title=\"6.8. Separating system administration from security administration in MLS\">Separating system administration from security administration in MLS\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNon-login roles \u003Ccode class=\"literal\">dbadm_r\u003C/code>, \u003Ccode class=\"literal\">logadm_r\u003C/code>, and \u003Ccode class=\"literal\">webadm_r\u003C/code> can be used for a subset of administrative tasks. By default, these roles are not associated with any SELinux user.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"switching-the-selinux-policy-to-mls_using-multi-level-security-mls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.3. Switching the SELinux policy to MLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tUse the following steps to switch the SELinux policy from targeted to Multi-Level Security (MLS).\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDo not use the MLS policy on a system that is running the X Window System. Furthermore, when you relabel the file system with MLS labels, the system may prevent confined domains from access, which prevents your system from starting correctly. Therefore ensure that you switch SELinux to permissive mode before you relabel the files. On most systems, you see a lot of SELinux denials after switching to MLS, and many of them are not trivial to fix.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">selinux-policy-mls\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install selinux-policy-mls\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/etc/selinux/config\u003C/code> file in a text editor of your choice, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/selinux/config\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange SELinux mode from enforcing to permissive and switch from the targeted policy to MLS:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELINUX=permissive\nSELINUXTYPE=mls\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSave the changes, and quit the editor.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBefore you enable the MLS policy, you must relabel each file on the file system with an MLS label:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fixfiles -F onboot\u003C/strong>\u003C/span>\nSystem will relabel on next boot\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck for SELinux denials:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -m AVC,USER_AVC,SELINUX_ERR,USER_SELINUX_ERR -ts recent -i\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBecause the previous command does not cover all scenarios, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/troubleshooting-problems-related-to-selinux_using-selinux\">Troubleshooting problems related to SELinux\u003C/a> for guidance on identifying, analyzing, and fixing SELinux denials.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter you ensure that there are no problems related to SELinux on your system, switch SELinux back to enforcing mode by changing the corresponding option in \u003Ccode class=\"literal\">/etc/selinux/config\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SELINUX=enforcing\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf your system does not start or you are not able to log in after you switch to MLS, add the \u003Ccode class=\"literal\">enforcing=0\u003C/code> parameter to your kernel command line. See \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/changing-selinux-states-and-modes_using-selinux#changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes\">Changing SELinux modes at boot time\u003C/a> for more information.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tAlso note that in MLS, SSH logins as the \u003Ccode class=\"literal\">root\u003C/code> user mapped to the \u003Ccode class=\"literal\">sysadm_r\u003C/code> SELinux role differ from logging in as \u003Ccode class=\"literal\">root\u003C/code> in \u003Ccode class=\"literal\">staff_r\u003C/code>. Before you start your system in MLS for the first time, consider allowing SSH logins as \u003Ccode class=\"literal\">sysadm_r\u003C/code> by setting the \u003Ccode class=\"literal\">ssh_sysadm_login\u003C/code> SELinux boolean to \u003Ccode class=\"literal\">1\u003C/code>. To enable \u003Ccode class=\"literal\">ssh_sysadm_login\u003C/code> later, already in MLS, you must log in as \u003Ccode class=\"literal\">root\u003C/code> in \u003Ccode class=\"literal\">staff_r\u003C/code>, switch to \u003Ccode class=\"literal\">root\u003C/code> in \u003Ccode class=\"literal\">sysadm_r\u003C/code> using the \u003Ccode class=\"literal\">newrole -r sysadm_r\u003C/code> command, and then set the boolean to \u003Ccode class=\"literal\">1\u003C/code>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that SELinux runs in enforcing mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>getenforce\u003C/strong>\u003C/span>\nEnforcing\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the status of SELinux returns the \u003Ccode class=\"literal\">mls\u003C/code> value:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>sestatus | grep mls\u003C/strong>\u003C/span>\nLoaded policy name:             mls\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fixfiles(8)\u003C/code>, \u003Ccode class=\"literal\">setsebool(8)\u003C/code>, and \u003Ccode class=\"literal\">ssh_selinux(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"establishing-user-clearance-in-mls_using-multi-level-security-mls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.4. Establishing user clearance in MLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAfter you switch SELinux policy to MLS, you must assign security clearance levels to users by mapping them to confined SELinux users. By default, a user with a given security clearance:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCannot read objects that have a higher sensitivity level.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCannot write to objects at a different sensitivity level.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux policy is set to \u003Ccode class=\"literal\">mls\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux mode is set to \u003Ccode class=\"literal\">enforcing\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tA user assigned to an SELinux confined user:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tFor a non-privileged user, assigned to \u003Ccode class=\"literal\">user_u\u003C/code> (\u003Cspan class=\"emphasis\">\u003Cem>example_user\u003C/em>\u003C/span> in the following procedure).\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tFor a privileged user, assigned to \u003Ccode class=\"literal\">staff_u\u003C/code> (\u003Cspan class=\"emphasis\">\u003Cem>staff\u003C/em>\u003C/span> in the following procedure) .\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tMake sure that the users have been created when the MLS policy was active. Users created in other SELinux policies cannot be used in MLS.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To prevent adding errors to your SELinux policy, switch to the \u003Ccode class=\"literal\">permissive\u003C/code> SELinux mode, which facilitates troubleshooting:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setenforce 0\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that \u003Cspan class=\"strong strong\">\u003Cstrong>in permissive mode, SELinux does not enforce the active policy\u003C/strong>\u003C/span> but only logs Access Vector Cache (AVC) messages, which can be then used for troubleshooting and debugging.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDefine a clearance range for the \u003Ccode class=\"literal\">staff_u\u003C/code> SELinux user. For example, this command sets the clearance range from \u003Ccode class=\"literal\">s1\u003C/code> to \u003Ccode class=\"literal\">s15\u003C/code> with \u003Ccode class=\"literal\">s1\u003C/code> being the default clearance level:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage user -m -L \u003Cspan class=\"emphasis\">\u003Cem>s1\u003C/em>\u003C/span> -r \u003Cspan class=\"emphasis\">\u003Cem>s1-s15\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>staff_u\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate SELinux file context configuration entries for user home directories:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>genhomedircon\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestore file security contexts to default:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>restorecon -R -F -v /home/\u003C/strong>\u003C/span>\nRelabeled /home/staff from staff_u:object_r:user_home_dir_t:s0 to staff_u:object_r:user_home_dir_t:s1\nRelabeled /home/staff/.bash_logout from staff_u:object_r:user_home_t:s0 to staff_u:object_r:user_home_t:s1\nRelabeled /home/staff/.bash_profile from staff_u:object_r:user_home_t:s0 to staff_u:object_r:user_home_t:s1\nRelabeled /home/staff/.bashrc from staff_u:object_r:user_home_t:s0 to staff_u:object_r:user_home_t:s1\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAssign a clearance level to the user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage login -m -r \u003Cspan class=\"emphasis\">\u003Cem>s1\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>example_user\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhere \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>s1\u003C/em>\u003C/span>\u003C/code> is the clearance level assigned to the user.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRelabel the user’s home directory to the user’s clearance level:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>chcon -R -l \u003Cspan class=\"emphasis\">\u003Cem>s1\u003C/em>\u003C/span> /home/\u003Cspan class=\"emphasis\">\u003Cem>example_user\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: If you previously switched to the \u003Ccode class=\"literal\">permissive\u003C/code> SELinux mode, and after you verify that everything works as expected, switch back to the \u003Ccode class=\"literal\">enforcing\u003C/code> SELinux mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setenforce 1\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the user is mapped to the correct SELinux user and has the correct clearance level assigned:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage login -l\u003C/strong>\u003C/span>\nLogin Name      SELinux User         MLS/MCS Range        Service\n__default__     user_u               s0-s0                *\nexample_user    user_u               \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>s1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>                   *\n…\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in as the user within MLS.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the user’s security level works correctly:\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe files you use for verification should not contain any sensitive information in case the configuration is incorrect and the user actually can access the files without authorization.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tVerify that the user cannot read a file with a higher-level sensitivity.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tVerify that the user can write to a file with the same sensitivity.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tVerify that the user can read a file with a lower-level sensitivity.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#switching-the-selinux-policy-to-mls_using-multi-level-security-mls\" title=\"6.3. Switching the SELinux policy to MLS\">Switching the SELinux policy to MLS\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#adding-a-new-user-as-an-selinux-confined-user_managing-confined-and-unconfined-users\" title=\"3.6. Adding a new user as an SELinux-confined user\">Adding a new user as an SELinux-confined user\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#changing-selinux-states-and-modes_using-selinux\" title=\"Chapter 2. Changing SELinux states and modes\">Permanent changes in SELinux states and modes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#troubleshooting-problems-related-to-selinux_using-selinux\" title=\"Chapter 5. Troubleshooting problems related to SELinux\">Troubleshooting problems related to SELinux\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2191331\">Basic SELinux Troubleshooting in CLI\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_changing-a-users-clearance-level-within-the-defined-security-range-in-mls_using-multi-level-security-mls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.5. Changing a user’s clearance level within the defined security range in MLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAs a user in Multi-Level Security (MLS), you can change your current clearance level within the range the administrator assigned to you. You can never exceed the upper limit of your range or reduce your level below the lower limit of your range. This allows you, for example, to modify lower-sensitivity files without increasing their sensitivity level to your highest clearance level.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor example, as a user assigned to range \u003Ccode class=\"literal\">s1-s3\u003C/code>:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can switch to levels \u003Ccode class=\"literal\">s1\u003C/code>, \u003Ccode class=\"literal\">s2\u003C/code>, and \u003Ccode class=\"literal\">s3\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can switch to ranges \u003Ccode class=\"literal\">s1-s2\u003C/code>, and \u003Ccode class=\"literal\">s2-s3\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou cannot switch to ranges \u003Ccode class=\"literal\">s0-s3\u003C/code> or \u003Ccode class=\"literal\">s1-s4\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tSwitching to a different level opens a new shell with the different clearance. This means you cannot return to your original clearance level in the same way as decreasing it. However, you can always return to the previous shell by entering \u003Ccode class=\"literal\">exit\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux policy is set to \u003Ccode class=\"literal\">mls\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux mode is set to \u003Ccode class=\"literal\">enforcing\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can log in as a user assigned to a range of MLS clearance levels.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in as the user from a secure terminal.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSecure terminals are defined in the \u003Ccode class=\"literal\">/etc/selinux/mls/contexts/securetty_types\u003C/code> file. By default, the console is a secure terminal, but SSH is not.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the current user’s security context:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>id -Z\u003C/strong>\u003C/span>\nuser_u:user_r:user_t:\u003Cspan class=\"emphasis\">\u003Cem>s0-s2\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn this example, the user is assigned to the \u003Ccode class=\"literal\">user_u\u003C/code> SELinux user, \u003Ccode class=\"literal\">user_r\u003C/code> role, \u003Ccode class=\"literal\">user_t\u003C/code> type, and the MLS security range \u003Ccode class=\"literal\">s0-s2\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the current user’s security context:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>id -Z\u003C/strong>\u003C/span>\nuser_u:user_r:user_t:\u003Cspan class=\"emphasis\">\u003Cem>s1-s2\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSwitch to a different security clearance range within the user’s clearance range:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>newrole -l \u003Cspan class=\"emphasis\">\u003Cem>s1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can switch to any range whose maximum is lower or equal to your assigned range. Entering a single-level range changes the lower limit of the assigned range. For example, entering \u003Ccode class=\"literal\">newrole -l s1\u003C/code> as a user with a \u003Ccode class=\"literal\">s0-s2\u003C/code> range is equivalent to entering \u003Ccode class=\"literal\">newrole -l s1-s2\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the current user’s security context:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>id -Z\u003C/strong>\u003C/span>\nuser_u:user_r:user_t:\u003Cspan class=\"emphasis\">\u003Cem>s1-s2\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReturn to the previous shell with the original range by terminating the current shell:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>exit\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#establishing-user-clearance-in-mls_using-multi-level-security-mls\" title=\"6.4. Establishing user clearance in MLS\">Establishing user clearance in MLS\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">newrole(1)\u003C/code> and \u003Ccode class=\"literal\">securetty_types(5)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_increasing-file-sensitivity-levels-in-mls_using-multi-level-security-mls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.6. Increasing file sensitivity levels in MLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBy default, Multi-Level Security (MLS) users cannot increase file sensitivity levels. However, the security administrator (\u003Ccode class=\"literal\">secadm_r\u003C/code>) can change this default behavior to allow users to increase the sensitivity of files by adding the local module \u003Ccode class=\"literal\">mlsfilewrite\u003C/code> to the system’s SELinux policy. Then, users assigned to the SELinux type defined in the policy module can increase file classification levels by modifying the file. Any time a user modifies a file, the file’s sensitivity level increases to the lower value of the user’s current security range.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe security administrator, when logged in as a user assigned to the \u003Ccode class=\"literal\">secadm_r\u003C/code> role, can change the security levels of files by using the \u003Ccode class=\"literal\">chcon -l \u003Cspan class=\"emphasis\">\u003Cem>s0\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/code> command. For more information, see \u003Ca class=\"link\" href=\"#proc_changing-file-sensitivity-in-mls_using-multi-level-security-mls\" title=\"6.7. Changing file sensitivity in MLS\">Changing file sensitivity in MLS\u003C/a>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux policy is set to \u003Ccode class=\"literal\">mls\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux mode is set to \u003Ccode class=\"literal\">enforcing\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">mlsfilewrite\u003C/code> local module is installed in the SELinux MLS policy.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou are logged in as a user in MLS which is:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAssigned to a defined security range. This example shows a user with a security range \u003Ccode class=\"literal\">s0-s2\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAssigned to the same SELinux type defined in the \u003Ccode class=\"literal\">mlsfilewrite\u003C/code> module. This example requires the \u003Ccode class=\"literal\">(typeattributeset mlsfilewrite (user_t))\u003C/code> module.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Display the security context of the current user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>id -Z\u003C/strong>\u003C/span>\nuser_u:user_r:user_t:\u003Cspan class=\"emphasis\">\u003Cem>\u003Cspan class=\"strong strong\">\u003Cstrong>s0-s2\u003C/strong>\u003C/span>\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the lower level of the user’s MLS clearance range to the level which you want to assign to the file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>newrole -l \u003Cspan class=\"emphasis\">\u003Cem>s1-s2\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Display the security context of the current user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>id -Z\u003C/strong>\u003C/span>\nuser_u:user_r:user_t:\u003Cspan class=\"emphasis\">\u003Cem>\u003Cspan class=\"strong strong\">\u003Cstrong>s1-s2\u003C/strong>\u003C/span>\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Display the security context of the file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ls -Z \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nuser_u:object_r:user_home_t:\u003Cspan class=\"emphasis\">\u003Cem>\u003Cspan class=\"strong strong\">\u003Cstrong>s0\u003C/strong>\u003C/span>\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the file’s sensitivity level to the lower level of the user’s clearance range by modifying the file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe classification level reverts to the default value if the \u003Ccode class=\"literal\">restorecon\u003C/code> command is used on the system.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Exit the shell to return to the user’s previous security range:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>exit\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the security context of the file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ls -Z \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nuser_u:object_r:user_home_t:\u003Cspan class=\"emphasis\">\u003Cem>\u003Cspan class=\"strong strong\">\u003Cstrong>s1\u003C/strong>\u003C/span>\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_allowing-mls-users-to-edit-files-on-lower-levels_using-multi-level-security-mls\" title=\"6.10. Allowing MLS users to edit files on lower levels\">Allowing MLS users to edit files on lower levels\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_changing-file-sensitivity-in-mls_using-multi-level-security-mls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.7. Changing file sensitivity in MLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn the MLS SELinux policy, users can only modify files at their own sensitivity level. This is intended to prevent any highly sensitive information to be exposed to users at lower clearance levels, and also prevent low-clearance users creating high-sensitivity documents. Administrators, however, can manually increase a file’s classification, for example for the file to be processed at the higher level.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux policy is set to \u003Ccode class=\"literal\">mls\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux mode is set to enforcing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have security administration rights, which means that you are assigned to either:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">secadm_r\u003C/code> role.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIf the \u003Ccode class=\"literal\">sysadm_secadm\u003C/code> module is enabled, to the \u003Ccode class=\"literal\">sysadm_r\u003C/code> role. The \u003Ccode class=\"literal\">sysadm_secadm\u003C/code> module is enabled by default.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tA user assigned to any clearance level. For additional information, see \u003Ca class=\"link\" href=\"#establishing-user-clearance-in-mls_using-multi-level-security-mls\" title=\"6.4. Establishing user clearance in MLS\">Establishing user clearance levels in MLS\u003C/a> .\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn this example, \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>User1\u003C/em>\u003C/span>\u003C/code> has clearance level \u003Ccode class=\"literal\">s1\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tA file with a classification level assigned and to which you have access.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn this example, \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/code> has classification level \u003Ccode class=\"literal\">s1\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the file’s classification level:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ls -lZ \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n-rw-r-----. 1 User1 User1 user_u:object_r:user_home_t:\u003Cspan class=\"emphasis\">\u003Cem>\u003Cspan class=\"strong strong\">\u003Cstrong>s1\u003C/strong>\u003C/span>\u003C/em>\u003C/span> 0 12. Feb 10:43 \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the file’s default classification level:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage fcontext -a -r \u003Cspan class=\"emphasis\">\u003Cem>s2\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tForce the relabeling of the file’s SELinux context:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>restorecon -F -v \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nRelabeled \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span> from user_u:object_r:user_home_t:\u003Cspan class=\"emphasis\">\u003Cem>\u003Cspan class=\"strong strong\">\u003Cstrong>s1\u003C/strong>\u003C/span>\u003C/em>\u003C/span> to user_u:object_r:user_home_t:s2\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the file’s classification level:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ls -lZ \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n-rw-r-----. 1 User1 User1 user_u:object_r:user_home_t:\u003Cspan class=\"emphasis\">\u003Cem>\u003Cspan class=\"strong strong\">\u003Cstrong>s2\u003C/strong>\u003C/span>\u003C/em>\u003C/span> 0 12. Feb 10:53 \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Verify that the lower-clearance user cannot read the file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat \u003Cspan class=\"emphasis\">\u003Cem>/path/to/file\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\ncat: file: Permission denied\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#establishing-user-clearance-in-mls_using-multi-level-security-mls\" title=\"6.4. Establishing user clearance in MLS\">Establishing user clearance levels in MLS\u003C/a> .\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_separating-system-administration-from-security-administration-in-mls_using-multi-level-security-mls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.8. Separating system administration from security administration in MLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBy default, the \u003Ccode class=\"literal\">sysadm_r\u003C/code> role has the rights of the \u003Ccode class=\"literal\">secadm_r\u003C/code> role, which means a user with the \u003Ccode class=\"literal\">sysadm_r\u003C/code> role can manage the security policy. If you need more control over security authorizations, you can separate system administration from security administration by assigning a Linux user to the \u003Ccode class=\"literal\">secadm_r\u003C/code> role and disabling the \u003Ccode class=\"literal\">sysadm_secadm\u003C/code> module in the SELinux policy.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux policy is set to \u003Ccode class=\"literal\">mls\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux mode is set to \u003Ccode class=\"literal\">enforcing\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tA Linux user which will be assigned to the \u003Ccode class=\"literal\">secadm_r\u003C/code> role:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe user is assigned to the \u003Ccode class=\"literal\">staff_u\u003C/code> SELinux user\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tA password for this user has been defined.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tMake sure you can log in as the user which will be assigned to the \u003Ccode class=\"literal\">secadm\u003C/code> role. If not, you can prevent any future modifications of the system’s SELinux policy.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a new \u003Ccode class=\"literal\">sudoers\u003C/code> file in the \u003Ccode class=\"literal\">/etc/sudoers.d\u003C/code> directory for the user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>visudo -f /etc/sudoers.d/\u003Cspan class=\"emphasis\">\u003Cem>&lt;sec_adm_user&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo keep the \u003Ccode class=\"literal\">sudoers\u003C/code> files organized, replace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;sec_adm_user&gt;\u003C/em>\u003C/span>\u003C/code> with the Linux user which will be assigned to the \u003Ccode class=\"literal\">secadm\u003C/code> role.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the following content into the \u003Ccode class=\"literal\">/etc/sudoers.d/\u003Cspan class=\"emphasis\">\u003Cem>&lt;sec_adm_user&gt;\u003C/em>\u003C/span>\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;sec_adm_user&gt;\u003C/em>\u003C/span> ALL=(ALL) TYPE=secadm_t ROLE=secadm_r ALL\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis line authorizes \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;secadmuser&gt;\u003C/em>\u003C/span>\u003C/code> on all hosts to perform all commands, and maps the user to the \u003Ccode class=\"literal\">secadm\u003C/code> SELinux type and role by default.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in as the \u003Cspan class=\"emphasis\">\u003Cem>&lt;sec_adm_user&gt;\u003C/em>\u003C/span> user.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo make sure that the SELinux context (which consists of SELinux user, role, and type) is changed, \u003Cspan class=\"strong strong\">\u003Cstrong>log in using \u003Ccode class=\"literal\">ssh\u003C/code>, the console, or \u003Ccode class=\"literal\">xdm\u003C/code>\u003C/strong>\u003C/span>. Other ways, such as \u003Ccode class=\"literal\">su\u003C/code> and \u003Ccode class=\"literal\">sudo\u003C/code>, cannot change the entire SELinux context.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the user’s security context:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>id\u003C/strong>\u003C/span>\nuid=1000(\u003Cspan class=\"emphasis\">\u003Cem>&lt;sec_adm_user&gt;\u003C/em>\u003C/span>) gid=1000(\u003Cspan class=\"emphasis\">\u003Cem>&lt;sec_adm_user&gt;\u003C/em>\u003C/span>) groups=1000(\u003Cspan class=\"emphasis\">\u003Cem>&lt;sec_adm_user&gt;\u003C/em>\u003C/span>) context=staff_u:staff_r:staff_t:s0-s15:c0.c1023\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the interactive shell for the root user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo -i\u003C/strong>\u003C/span>\n[sudo] password for \u003Cspan class=\"emphasis\">\u003Cem>&lt;sec_adm_user&gt;\u003C/em>\u003C/span>:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the current user’s security context:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>id\u003C/strong>\u003C/span>\nuid=0(root) gid=0(root) groups=0(root) context=staff_u:secadm_r:secadm_t:s0-s15:c0.c1023\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisable the \u003Ccode class=\"literal\">sysadm_secadm\u003C/code> module from the policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semodule -d sysadm_secadm\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">semodule -d\u003C/code> command instead of removing the system policy module by using the \u003Ccode class=\"literal\">semodule -r\u003C/code> command. The \u003Ccode class=\"literal\">semodule -r\u003C/code> command deletes the module from your system’s storage, which means it cannot be loaded again without reinstalling the \u003Ccode class=\"literal\">selinux-policy-mls\u003C/code> package.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAs the user assigned to the \u003Ccode class=\"literal\">secadm\u003C/code> role, and in the interactive shell for the root user, verify that you can access the security policy data:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>seinfo -xt secadm_t\u003C/strong>\u003C/span>\n\nTypes: 1\n   type secadm_t, can_relabelto_shadow_passwords, (…) userdomain;\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog out from the root shell:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>logout\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog out from the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;sec_adm_user&gt;\u003C/em>\u003C/span>\u003C/code> user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>logout\u003C/strong>\u003C/span>\nConnection to localhost closed.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the current security context:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>id\u003C/strong>\u003C/span>\nuid=0(root) gid=0(root) groups=0(root) context=root:sysadm_r:sysadm_t:s0-s15:c0.c1023\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAttempt to enable the \u003Ccode class=\"literal\">sysadm_secadm\u003C/code> module. The command should fail:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semodule -e sysadm_secadm\u003C/strong>\u003C/span>\nSELinux:  Could not load policy file /etc/selinux/mls/policy/policy.31:  Permission denied\n/sbin/load_policy:  Can't load policy:  Permission denied\nlibsemanage.semanage_reload_policy: load_policy returned error code 2. (No such file or directory).\nSELinux:  Could not load policy file /etc/selinux/mls/policy/policy.31:  Permission denied\n/sbin/load_policy:  Can't load policy:  Permission denied\nlibsemanage.semanage_reload_policy: load_policy returned error code 2. (No such file or directory).\nsemodule:  Failed!\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAttempt to display the details about the \u003Ccode class=\"literal\">sysadm_t\u003C/code> SELinux type. The command should fail:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>seinfo -xt sysadm_t\u003C/strong>\u003C/span>\n[Errno 13] Permission denied: '/sys/fs/selinux/policy'\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_defining-a-secure-terminal-in-mls_using-multi-level-security-mls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.9. Defining a secure terminal in MLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe SELinux policy checks the type of the terminal from which a user is connected, and allows running of certain SELinux applications, for example \u003Ccode class=\"literal\">newrole\u003C/code>, only from secure terminals. Attempting this from a non-secure terminal produces an error: \u003Ccode class=\"literal\">Error: you are not allowed to change levels on a non secure terminal;\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">/etc/selinux/mls/contexts/securetty_types\u003C/code> file defines secure terminals for the Multi-Level Security (MLS) policy.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDefault contents of the file:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">console_device_t\nsysadm_tty_device_t\nuser_tty_device_t\nstaff_tty_device_t\nauditadm_tty_device_t\nsecureadm_tty_device_t\u003C/pre>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tAdding terminal types to the list of secure terminals can expose your system to security risks.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux policy is set to \u003Ccode class=\"literal\">mls\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are connected from an already secure terminal, or SELinux is in permissive mode.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have security administration rights, which means that you are assigned to either:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">secadm_r\u003C/code> role.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIf the \u003Ccode class=\"literal\">sysadm_secadm\u003C/code> module is enabled, to the \u003Ccode class=\"literal\">sysadm_r\u003C/code> role. The \u003Ccode class=\"literal\">sysadm_secadm\u003C/code> module is enabled by default.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDetermine the current terminal type:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ls -Z `tty`\u003C/strong>\u003C/span>\nroot:object_r:\u003Cspan class=\"strong strong\">\u003Cstrong>user_devpts_t\u003C/strong>\u003C/span>:s0 /dev/pts/0\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn this example output, \u003Ccode class=\"literal\">user_devpts_t\u003C/code> is the current terminal type.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdd the relevant SELinux type on a new line in the \u003Ccode class=\"literal\">/etc/selinux/mls/contexts/securetty_types\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Switch SELinux to enforcing mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setenforce 1\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in from the previously insecure terminal you have added to the \u003Ccode class=\"literal\">/etc/selinux/mls/contexts/securetty_types\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">securetty_types(5)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_allowing-mls-users-to-edit-files-on-lower-levels_using-multi-level-security-mls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.10. Allowing MLS users to edit files on lower levels\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBy default, MLS users cannot write to files which have a sensitivity level below the lower value of the clearance range. If your scenario requires allowing users to edit files on lower levels, you can do so by creating a local SELinux module. However, writing to a file will increase its sensitivity level to the lower value of the user’s current range.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux policy is set to \u003Ccode class=\"literal\">mls\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux mode is set to \u003Ccode class=\"literal\">enforcing\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">setools-console\u003C/code> and \u003Ccode class=\"literal\">audit\u003C/code> packages for verification.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Switch to permissive mode for easier troubleshooting.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setenforce 0\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen a new \u003Ccode class=\"literal\">.cil\u003C/code> file with a text editor, for example \u003Ccode class=\"literal\">~/local_mlsfilewrite.cil\u003C/code>, and insert the following custom rule:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">(typeattributeset mlsfilewrite (_staff_t_))\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can replace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>staff_t\u003C/em>\u003C/span>\u003C/code> with a different SELinux type. By specifying SELinux type here, you can control which SELinux roles can edit lower-level files.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo keep your local modules better organized, use the \u003Ccode class=\"literal\">local_\u003C/code> prefix in the names of local SELinux policy modules.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the policy module:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semodule -i ~/\u003Cspan class=\"emphasis\">\u003Cem>local_mlsfilewrite\u003C/em>\u003C/span>.cil\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tTo remove the local policy module, use \u003Ccode class=\"literal\">semodule -r ~/\u003Cspan class=\"emphasis\">\u003Cem>local_mlsfilewrite\u003C/em>\u003C/span>\u003C/code>. Note that you must refer to the module name without the \u003Ccode class=\"literal\">.cil\u003C/code> suffix.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: If you previously switched back to permissive mode, return to enforcing mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setenforce 1\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFind the local module in the list of installed SELinux modules:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semodule -lfull | grep \"local_mls\"\u003C/strong>\u003C/span>\n400 local_mlsfilewrite  cil\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBecause local modules have priority \u003Ccode class=\"literal\">400\u003C/code>, you can list them also by using the \u003Ccode class=\"literal\">semodule -lfull | grep -v ^100\u003C/code> command.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in as a user assigned to the type defined in the custom rule, for example, \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>staff_t\u003C/em>\u003C/span>\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAttempt to write to a file with a lower sensitivity level. This increases the file’s classification level to the user’s clearance level.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe files you use for verification should not contain any sensitive information in case the configuration is incorrect and the user actually can access the files without authorization.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_using-multi-category-security-mcs-for-data-confidentiality_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 7. Using Multi-Category Security (MCS) for data confidentiality\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tYou can use MCS to enhance the data confidentiality of your system by categorizing data, and then granting certain processes and users access to specific categories\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"con_multi-category-security-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.1. Multi-Category Security (MCS)\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tMulti-Category Security (MCS) is an access control mechanism that uses categories assigned to processes and files. Files can then be accessed only by processes that are assigned to the same categories. The purpose of MCS is to maintain data confidentiality on your system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tMCS categories are defined by the values \u003Ccode class=\"literal\">c0\u003C/code> to \u003Ccode class=\"literal\">c1023\u003C/code>, but you can also define a text label for each category or combination of categories, such as “Personnel”, “ProjectX”, or “ProjectX.Personnel”. The MCS Translation service (\u003Ccode class=\"literal\">mcstrans\u003C/code>) then replaces the category values with the appropriate labels in system inputs and outputs, so that users can use these labels instead of the category values.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tWhen users are assigned to categories, they can label any of their files with any of the categories to which they have been assigned.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tMCS works on a simple principle: to access a file, a user must be assigned to all of the categories that have been assigned to the file. The MCS check is applied after normal Linux Discretionary Access Control (DAC) and SELinux Type Enforcement (TE) rules, so it can only further restrict existing security configuration.\n\t\t\t\u003C/p>\u003Ch5 id=\"mcs_within_multi_level_security\">MCS within Multi-Level Security\u003C/h5>\u003Cp>\n\t\t\t\tYou can use MCS on its own as a non-hierarchical system, or you can use it in combination with Multi-Level Security (MLS) as a non-hierarchical layer within a hierarchical system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAn example of MCS within MLS could be a secretive research organization, where files are classified like this:\n\t\t\t\u003C/p>\u003Crh-table id=\"idm139843084367920\">\u003Ctable class=\"gt-4-cols lt-7-rows\">\u003Ccaption>Table 7.1. Example of combinations of security levels and categories\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 20%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_4\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_5\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd rowspan=\"2\" align=\"left\" valign=\"bottom\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Security level\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd colspan=\"4\" align=\"center\" valign=\"middle\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Category\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tNot specified\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tProject X\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tProject Y\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tProject Z\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tUnclassified\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s0:c0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s0:c1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s0:c2\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfidential\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s1:c0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s1:c1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s1:c2\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tSecret\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s2\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s2:c0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s2:c1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s2:c2\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tTop secret\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s3\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s3:c0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s3:c1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">s3:c2\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tA user with a range \u003Ccode class=\"literal\">s0:c0.1023\u003C/code> would be able to access all files assigned to all categories on level \u003Ccode class=\"literal\">s0\u003C/code>, unless the access is prohibited by other security mechanisms, such as DAC or type enforcement policy rules.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tThe resulting security context of a file or process is a combination of:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux user\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux role\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux type\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMLS sensitivity level\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMCS category\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tFor example, a non-privileged user with access to sensitivity level 1 and category 2 in an MLS/MCS environment could have the following SELinux context:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">user_u:user_r:user_t:s1:c2\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/using_selinux/index#using-multi-level-security-mls_using-selinux\">Using Multi-Level Security (MLS)\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-multi-category-security-for-data-confidentiality_assembly_using-multi-category-security-mcs-for-data-confidentiality\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.2. Configuring Multi-Category Security for data confidentiality\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBy default, Multi-Category Security (MCS) is active in the \u003Ccode class=\"literal\">targeted\u003C/code> and \u003Ccode class=\"literal\">mls\u003C/code> SELinux policies but is not configured for users. In the \u003Ccode class=\"literal\">targeted\u003C/code> policy, MCS is configured only for:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpenShift\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tvirt\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tsandbox\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tnetwork labeling\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tcontainers (\u003Ccode class=\"literal\">container-selinux\u003C/code>)\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tYou can configure MCS to categorize users by creating a local SELinux module with a rule that constrains the \u003Ccode class=\"literal\">user_t\u003C/code> SELinux type by MCS rules in addition to type enforcement.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tChanging the categories of certain files may render some services non-operational. If you are not an expert, contact your Red Hat sales representative and request consulting services.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSELinux mode is set to \u003Ccode class=\"literal\">enforcing\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux policy is set to \u003Ccode class=\"literal\">targeted\u003C/code> or \u003Ccode class=\"literal\">mls\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> and \u003Ccode class=\"literal\">setools-console\u003C/code> packages are installed.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a new file named, for example, \u003Ccode class=\"literal\">local_mcs_user.cil\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vim local_mcs_user.cil\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInsert the following rule:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">(typeattributeset mcs_constrained_type (user_t))\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the policy module:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semodule -i local_mcs_user.cil\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor each user domain, display additional details for all the components:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>seinfo -xt user_t\u003C/strong>\u003C/span>\n\nTypes: 1\ntype user_t, application_domain_type, nsswitch_domain, corenet_unlabeled_type, domain, kernel_system_state_reader, \u003Cspan class=\"strong strong\">\u003Cstrong>mcs_constrained_type\u003C/strong>\u003C/span>, netlabel_peer_type, privfd, process_user_target, scsi_generic_read, scsi_generic_write, syslog_client_type, pcmcia_typeattr_1, user_usertype, login_userdomain, userdomain, unpriv_userdomain, userdom_home_reader_type, userdom_filetrans_type, xdmhomewriter, x_userdomain, x_domain, dridomain, xdrawable_type, xcolormap_type;\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/troubleshooting-problems-related-to-selinux_using-selinux#proc_creating-a-local-selinux-policy-module_troubleshooting-problems-related-to-selinux\">Creating a local SELinux policy module\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about MCS in the context of containers, see the blog posts \u003Ca class=\"link\" href=\"https://www.redhat.com/en/blog/how-selinux-separates-containers-using-multi-level-security\">How SELinux separates containers using Multi-Level Security\u003C/a> and \u003Ca class=\"link\" href=\"https://www.redhat.com/en/blog/why-you-should-be-using-multi-category-security-your-linux-containers\">Why you should be using Multi-Category Security for your Linux containers\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_defining-category-labels-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.3. Defining category labels in MCS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can manage and maintain labels for MCS categories, or combinations of MCS categories with MLS levels, on your system by editing the \u003Ccode class=\"literal\">setrans.conf\u003C/code> file. In this file, SELinux maintains a mapping between internal sensitivity and category levels and their human-readable labels.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tCategory labels only make it easier for users to use the categories. MCS works the same whether you define labels or not.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux mode is set to \u003Ccode class=\"literal\">enforcing\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux policy is set to \u003Ccode class=\"literal\">targeted\u003C/code> or \u003Ccode class=\"literal\">mls\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> and \u003Ccode class=\"literal\">mcstrans\u003C/code> packages are installed.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tModify existing categories or create new categories by editing the \u003Ccode class=\"literal\">/etc/selinux/\u003Cspan class=\"emphasis\">\u003Cem>&lt;selinuxpolicy&gt;\u003C/em>\u003C/span>/setrans.conf\u003C/code> file in a text editor. Replace \u003Cspan class=\"emphasis\">\u003Cem>&lt;selinuxpolicy&gt;\u003C/em>\u003C/span> with \u003Ccode class=\"literal\">targeted\u003C/code> or \u003Ccode class=\"literal\">mls\u003C/code> depending on the SELinux policy you use. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/selinux/targeted/setrans.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">setrans.conf\u003C/code> file for your policy, define the combinations of categories required by your scenario using the syntax \u003Ccode class=\"literal\">s_&lt;security level&gt;_:c_&lt;category number&gt;_=\u003Cspan class=\"emphasis\">\u003Cem>&lt;category.name&gt;\u003C/em>\u003C/span>\u003C/code>, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">s0:c0=Marketing\ns0:c1=Finance\ns0:c2=Payroll\ns0:c3=Personnel\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou can use category numbers from \u003Ccode class=\"literal\">c0\u003C/code> to \u003Ccode class=\"literal\">c1023\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">targeted\u003C/code> policy, use the \u003Ccode class=\"literal\">s0\u003C/code> security level.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">mls\u003C/code> policy, you can label each combination of sensitivity levels and categories.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: In the \u003Ccode class=\"literal\">setrans.conf\u003C/code> file, you can also label the MLS sensitivity levels.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave and exit the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo make the changes effective, restart the MCS translation service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart mcstrans\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the current categories:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>chcat -L\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe example above produces the following output:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">s0:c0                          Marketing\ns0:c1                          Finance\ns0:c2                          Payroll\ns0:c3                          Personnel\ns0\ns0-s0:c0.c1023                 SystemLow-SystemHigh\ns0:c0.c1023                    SystemHigh\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">setrans.conf(5)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_assigning-categories-to-users-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.4. Assigning categories to users in MCS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can define user authorizations by assigning categories to Linux users. A user with assigned categories can access and modify files that have a subset of the user’s categories. Users can also assign files they own to categories they have been assigned to.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tA Linux user cannot be assigned to a category that is outside of the security range defined for the relevant SELinux user.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tCategory access is assigned during login. Consequently, users do not have access to newly assigned categories until they log in again. Similarly, if you revoke a user’s access to a category, this is effective only after the user logs in again.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux mode is set to \u003Ccode class=\"literal\">enforcing\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux policy is set to \u003Ccode class=\"literal\">targeted\u003C/code> or \u003Ccode class=\"literal\">mls\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLinux users are assigned to SELinux confined users:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tNon-privileged users are assigned to \u003Ccode class=\"literal\">user_u\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tPrivileged users are assigned to \u003Ccode class=\"literal\">staff_u\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDefine the security range for the SELinux user.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage user -m -rs0:c0,c1-s0:c0.c9 \u003Cspan class=\"emphasis\">\u003Cem>&lt;user_u&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse category numbers \u003Ccode class=\"literal\">c0\u003C/code> to \u003Ccode class=\"literal\">c1023\u003C/code> or category labels as defined in the \u003Ccode class=\"literal\">setrans.conf\u003C/code> file. For additional information, see \u003Ca class=\"link\" href=\"#proc_defining-category-labels-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality\" title=\"7.3. Defining category labels in MCS\">Defining category labels in MCS\u003C/a> .\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAssign MCS categories to a Linux user. You can specify only a range within the range defined to the relevant SELinux user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage login -m -rs0:c1 \u003Cspan class=\"emphasis\">\u003Cem>&lt;Linux.user1&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tYou can add or remove categories from Linux users by using the \u003Ccode class=\"literal\">chcat\u003C/code> command. The following example adds \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;category1&gt;\u003C/em>\u003C/span>\u003C/code> and removes \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;category2&gt;\u003C/em>\u003C/span>\u003C/code> from \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;Linux.user1&gt;\u003C/em>\u003C/span>\u003C/code> and \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;Linux.user2&gt;\u003C/em>\u003C/span>\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>chcat -l -- +\u003Cspan class=\"emphasis\">\u003Cem>&lt;category1&gt;\u003C/em>\u003C/span>,-\u003Cspan class=\"emphasis\">\u003Cem>&lt;category2&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;Linux.user1&gt;\u003C/em>\u003C/span>,\u003Cspan class=\"emphasis\">\u003Cem>&lt;Linux.user2&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\t\t\t\tYou must specify \u003Ccode class=\"literal\">--\u003C/code> on the command line before using the \u003Ccode class=\"literal\">-\u003Cspan class=\"emphasis\">\u003Cem>&lt;category&gt;\u003C/em>\u003C/span>\u003C/code> syntax. Otherwise, the \u003Ccode class=\"literal\">chcat\u003C/code> command misinterprets the category removal as a command option.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList the categories assigned to Linux users:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>chcat -L -l \u003Cspan class=\"emphasis\">\u003Cem>&lt;Linux.user1&gt;\u003C/em>\u003C/span>,\u003Cspan class=\"emphasis\">\u003Cem>&lt;Linux.user2&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\u003Cspan class=\"emphasis\">\u003Cem>&lt;Linux.user1&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;category1&gt;\u003C/em>\u003C/span>,\u003Cspan class=\"emphasis\">\u003Cem>&lt;category2&gt;\u003C/em>\u003C/span>\n\u003Cspan class=\"emphasis\">\u003Cem>&lt;Linux.user2&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;category1&gt;\u003C/em>\u003C/span>,\u003Cspan class=\"emphasis\">\u003Cem>&lt;category2&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">chcat(8)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_assigning-categories-to-files-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.5. Assigning categories to files in MCS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou need administrative privileges to assign categories to users. Users can then assign categories to files. To modify the categories of a file, users must have access rights to that file. Users can only assign a file to a category that is assigned to them.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe system combines category access rules with conventional file access permissions. For example, if a user with a category of \u003Ccode class=\"literal\">bigfoot\u003C/code> uses Discretionary Access Control (DAC) to block access to a file by other users, other \u003Ccode class=\"literal\">bigfoot\u003C/code> users cannot access that file. A user assigned to all available categories still may not be able to access the entire file system.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux mode is set to \u003Ccode class=\"literal\">enforcing\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe SELinux policy is set to \u003Ccode class=\"literal\">targeted\u003C/code> or \u003Ccode class=\"literal\">mls\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAccess and permissions to a Linux user that is:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAssigned to an SELinux user.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAssigned to the category to which you want to assign the file. For additional information, see \u003Ca class=\"link\" href=\"#proc_assigning-categories-to-users-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality\" title=\"7.4. Assigning categories to users in MCS\">Assigning categories to users in MCS\u003C/a> .\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAccess and permissions to the file you want to add to the category.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor verification purposes: Access and permissions to a Linux user not assigned to this category\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd categories to a file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>chcat -- +\u003Cspan class=\"emphasis\">\u003Cem>&lt;category1&gt;\u003C/em>\u003C/span>,+\u003Cspan class=\"emphasis\">\u003Cem>&lt;category2&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;path/to/file1&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse category numbers \u003Ccode class=\"literal\">c0\u003C/code> to \u003Ccode class=\"literal\">c1023\u003C/code> or category labels as defined in the \u003Ccode class=\"literal\">setrans.conf\u003C/code> file. For additional information, see \u003Ca class=\"link\" href=\"#proc_defining-category-labels-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality\" title=\"7.3. Defining category labels in MCS\">Defining category labels in MCS\u003C/a> .\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can remove categories from a file by using the same syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>chcat -- -\u003Cspan class=\"emphasis\">\u003Cem>&lt;category1&gt;\u003C/em>\u003C/span>,-\u003Cspan class=\"emphasis\">\u003Cem>&lt;category2&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;path/to/file1&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tWhen removing a category, you must specify \u003Ccode class=\"literal\">--\u003C/code> on the command line before using the \u003Ccode class=\"literal\">-\u003Cspan class=\"emphasis\">\u003Cem>&lt;category&gt;\u003C/em>\u003C/span>\u003C/code> syntax. Otherwise, the \u003Ccode class=\"literal\">chcat\u003C/code> command misinterprets the category removal as a command option.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the security context of the file to verify that it has the correct categories:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ls -lZ \u003Cspan class=\"emphasis\">\u003Cem>&lt;path/to/file&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n-rw-r--r--  \u003Cspan class=\"emphasis\">\u003Cem>&lt;LinuxUser1&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;Group1&gt;\u003C/em>\u003C/span> root:object_r:user_home_t:_&lt;sensitivity&gt;_:_&lt;category&gt;_ \u003Cspan class=\"emphasis\">\u003Cem>&lt;path/to/file&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe specific security context of the file may differ.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Attempt to access the file when logged in as a Linux user not assigned to the same category as the file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat \u003Cspan class=\"emphasis\">\u003Cem>&lt;path/to/file&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\ncat: \u003Cspan class=\"emphasis\">\u003Cem>&lt;path/to/file&gt;\u003C/em>\u003C/span>: Permission Denied\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">semanage(8)\u003C/code> and \u003Ccode class=\"literal\">chcat(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"writing-a-custom-selinux-policy_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 8. Writing a custom SELinux policy\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tTo run your applications confined by SELinux, you must write and use a custom policy.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"custom-selinux-policies-and-related-tools_writing-a-custom-selinux-policy\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.1. Custom SELinux policies and related tools\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAn SELinux security policy is a collection of SELinux rules. A policy is a core component of SELinux and is loaded into the kernel by SELinux user-space tools. The kernel enforces the use of an SELinux policy to evaluate access requests on the system. By default, SELinux denies all requests except for requests that correspond to the rules specified in the loaded policy.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tEach SELinux policy rule describes an interaction between a process and a system resource:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">ALLOW apache_process apache_log:FILE READ;\u003C/pre>\u003Cp>\n\t\t\t\tYou can read this example rule as: \u003Cspan class=\"emphasis\">\u003Cem>The \u003Cspan class=\"strong strong\">\u003Cstrong>Apache\u003C/strong>\u003C/span> process can \u003Cspan class=\"strong strong\">\u003Cstrong>read\u003C/strong>\u003C/span> its \u003Cspan class=\"strong strong\">\u003Cstrong>logging file\u003C/strong>\u003C/span>.\u003C/em>\u003C/span> In this rule, \u003Ccode class=\"literal\">apache_process\u003C/code> and \u003Ccode class=\"literal\">apache_log\u003C/code> are \u003Cspan class=\"strong strong\">\u003Cstrong>labels\u003C/strong>\u003C/span>. An SELinux security policy assigns labels to processes and defines relations to system resources. This way, a policy maps operating-system entities to the SELinux layer.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSELinux labels are stored as extended attributes of file systems, such as \u003Ccode class=\"literal\">ext2\u003C/code>. You can list them using the \u003Ccode class=\"literal\">getfattr\u003C/code> utility or a \u003Ccode class=\"literal\">ls -Z\u003C/code> command, for example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ls -Z /etc/passwd\u003C/strong>\u003C/span>\nsystem_u:object_r:passwd_file_t:s0 /etc/passwd\u003C/pre>\u003Cp>\n\t\t\t\tWhere \u003Ccode class=\"literal\">system_u\u003C/code> is an SELinux user, \u003Ccode class=\"literal\">object_r\u003C/code> is an example of the SELinux role, and \u003Ccode class=\"literal\">passwd_file_t\u003C/code> is an SELinux domain.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe default SELinux policy provided by the \u003Ccode class=\"literal\">selinux-policy\u003C/code> packages contains rules for applications and daemons that are parts of Red Hat Enterprise Linux 9 and are provided by packages in its repositories. Applications not described in this distribution policy are not confined by SELinux. To change this, you have to modify the policy using a policy module, which contains additional definitions and rules.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn Red Hat Enterprise Linux 9, you can query the installed SELinux policy and generate new policy modules using the \u003Ccode class=\"literal\">sepolicy\u003C/code> tool. Scripts that \u003Ccode class=\"literal\">sepolicy\u003C/code> generates together with the policy modules always contain a command using the \u003Ccode class=\"literal\">restorecon\u003C/code> utility. This utility is a basic tool for fixing labeling problems in a selected part of a file system.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sepolicy(8)\u003C/code> and \u003Ccode class=\"literal\">getfattr(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6999267\">Quick start to write a custom SELinux policy\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-and-enforcing-an-selinux-policy-for-a-custom-application_writing-a-custom-selinux-policy\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.2. Creating and enforcing an SELinux policy for a custom application\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can confine applications by SELinux to increase the security of host systems and users' data. Because each application has specific requirements, modify this example procedure for creating an SELinux policy that confines a simple daemon according to your use case.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">selinux-policy-devel\u003C/code> package and its dependencies are installed on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor this example procedure, prepare a simple daemon that opens the \u003Ccode class=\"literal\">/var/log/messages\u003C/code> file for writing:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate a new file, and open it in a text editor of your choice:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vi mydaemon.c\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tInsert the following code:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-c\">#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n\nFILE *f;\n\nint main(void)\n{\nwhile(1) {\nf = fopen(\"/var/log/messages\",\"w\");\n        sleep(5);\n        fclose(f);\n    }\n}\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCompile the file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>gcc -o mydaemon mydaemon.c\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">systemd\u003C/code> unit file for your daemon:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vi mydaemon.service\u003C/strong>\u003C/span>\n[Unit]\nDescription=Simple testing daemon\n\n[Service]\nType=simple\nExecStart=/usr/local/bin/mydaemon\n\n[Install]\nWantedBy=multi-user.target\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tInstall and start the daemon:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp mydaemon /usr/local/bin/\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>cp mydaemon.service /usr/lib/systemd/system\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl start mydaemon\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status mydaemon\u003C/strong>\u003C/span>\n● mydaemon.service - Simple testing daemon\n   Loaded: loaded (/usr/lib/systemd/system/mydaemon.service; disabled; vendor preset: disabled)\n   Active: active (running) since Sat 2020-05-23 16:56:01 CEST; 19s ago\n Main PID: 4117 (mydaemon)\n    Tasks: 1\n   Memory: 148.0K\n   CGroup: /system.slice/mydaemon.service\n           └─4117 /usr/local/bin/mydaemon\n\nMay 23 16:56:01 localhost.localdomain systemd[1]: Started Simple testing daemon.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCheck that the new daemon is not confined by SELinux:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ps -efZ | grep mydaemon\u003C/strong>\u003C/span>\nsystem_u:system_r:unconfined_service_t:s0 root 4117    1  0 16:56 ?        00:00:00 /usr/local/bin/mydaemon\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a custom policy for the daemon:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sepolicy generate --init /usr/local/bin/mydaemon\u003C/strong>\u003C/span>\nCreated the following files:\n/home/example.user/mysepol/mydaemon.te # Type Enforcement file\n/home/example.user/mysepol/mydaemon.if # Interface file\n/home/example.user/mysepol/mydaemon.fc # File Contexts file\n/home/example.user/mysepol/mydaemon_selinux.spec # Spec file\n/home/example.user/mysepol/mydaemon.sh # Setup Script\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRebuild the system policy with the new policy module using the setup script created by the previous command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>./mydaemon.sh\u003C/strong>\u003C/span>\nBuilding and Loading Policy\n+ make -f /usr/share/selinux/devel/Makefile mydaemon.pp\nCompiling targeted mydaemon module\nCreating targeted mydaemon.pp policy package\nrm tmp/mydaemon.mod.fc tmp/mydaemon.mod\n+ /usr/sbin/semodule -i mydaemon.pp\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that the setup script relabels the corresponding part of the file system using the \u003Ccode class=\"literal\">restorecon\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">restorecon -v /usr/local/bin/mydaemon /usr/lib/systemd/system\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the daemon, and check that it now runs confined by SELinux:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart mydaemon\u003C/strong>\u003C/span>\n$ \u003Cspan class=\"strong strong\">\u003Cstrong>ps -efZ | grep mydaemon\u003C/strong>\u003C/span>\nsystem_u:system_r:mydaemon_t:s0 root        8150       1  0 17:18 ?        00:00:00 /usr/local/bin/mydaemon\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBecause the daemon is now confined by SELinux, SELinux also prevents it from accessing \u003Ccode class=\"literal\">/var/log/messages\u003C/code>. Display the corresponding denial message:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -m AVC -ts recent\u003C/strong>\u003C/span>\n...\ntype=AVC msg=audit(1590247112.719:5935): avc:  denied  { open } for  pid=8150 comm=\"mydaemon\" path=\"/var/log/messages\" dev=\"dm-0\" ino=2430831 scontext=system_u:system_r:mydaemon_t:s0 tcontext=unconfined_u:object_r:var_log_t:s0 tclass=file permissive=1\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can get additional information also using the \u003Ccode class=\"literal\">sealert\u003C/code> tool:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sealert -l \"*\"\u003C/strong>\u003C/span>\nSELinux is preventing mydaemon from open access on the file /var/log/messages.\n\n*****  Plugin catchall (100. confidence) suggests   **************************\n\nIf you believe that mydaemon should be allowed open access on the messages file by default.\nThen you should report this as a bug.\nYou can generate a local policy module to allow this access.\nDo allow this access for now by executing:\n# ausearch -c 'mydaemon' --raw | audit2allow -M my-mydaemon\n# semodule -X 300 -i my-mydaemon.pp\n\nAdditional Information:\nSource Context                system_u:system_r:mydaemon_t:s0\nTarget Context                unconfined_u:object_r:var_log_t:s0\nTarget Objects                /var/log/messages [ file ]\nSource                        mydaemon\n…\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">audit2allow\u003C/code> tool to suggest changes:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -m AVC -ts recent | audit2allow -R\u003C/strong>\u003C/span>\n\nrequire {\n\ttype mydaemon_t;\n}\n\n#============= mydaemon_t ==============\nlogging_write_generic_logs(mydaemon_t)\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBecause rules suggested by \u003Ccode class=\"literal\">audit2allow\u003C/code> can be incorrect for certain cases, use only a part of its output to find the corresponding policy interface. Inspect the \u003Ccode class=\"literal\">logging_write_generic_logs(mydaemon_t)\u003C/code> macro with the \u003Ccode class=\"literal\">macro-expander\u003C/code> tool, to see all allow rules the macro provides:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>macro-expander \"logging_write_generic_logs(mydaemon_t)\"\u003C/strong>\u003C/span>\nallow mydaemon_t var_t:dir { getattr search open };\nallow mydaemon_t var_log_t:dir { getattr search open read lock ioctl };\nallow mydaemon_t var_log_t:dir { getattr search open };\nallow mydaemon_t var_log_t:file { open { getattr write append lock ioctl } };\nallow mydaemon_t var_log_t:dir { getattr search open };\nallow mydaemon_t var_log_t:lnk_file { getattr read };\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn this case, you can use the suggested interface, because it only provides read and write access to log files and their parent directories. Add the corresponding rule to your type enforcement file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>echo \"logging_write_generic_logs(mydaemon_t)\" &gt;&gt; mydaemon.te\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, you can add this rule instead of using the interface:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>echo \"allow mydaemon_t var_log_t:file { open write getattr };\" &gt;&gt; mydaemon.te\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReinstall the policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>./mydaemon.sh\u003C/strong>\u003C/span>\nBuilding and Loading Policy\n+ make -f /usr/share/selinux/devel/Makefile mydaemon.pp\nCompiling targeted mydaemon module\nCreating targeted mydaemon.pp policy package\nrm tmp/mydaemon.mod.fc tmp/mydaemon.mod\n+ /usr/sbin/semodule -i mydaemon.pp\n...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that your application runs confined by SELinux, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ps -efZ | grep mydaemon\u003C/strong>\u003C/span>\nsystem_u:system_r:mydaemon_t:s0 root        8150       1  0 17:18 ?        00:00:00 /usr/local/bin/mydaemon\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that your custom application does not cause any SELinux denials:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -m AVC -ts recent\u003C/strong>\u003C/span>\n&lt;no matches&gt;\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sepolgen(8)\u003C/code>, \u003Ccode class=\"literal\">ausearch(8)\u003C/code>, \u003Ccode class=\"literal\">audit2allow(1)\u003C/code>, \u003Ccode class=\"literal\">audit2why(1)\u003C/code>, \u003Ccode class=\"literal\">sealert(8)\u003C/code>, and \u003Ccode class=\"literal\">restorecon(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6999267\">Quick start to write a custom SELinux policy\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_2\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.3. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"http://redhatgov.io/workshops/selinux_policy/\">SELinux Policy Workshop\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"creating-selinux-policies-for-containers_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 9. Creating SELinux policies for containers\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tRed Hat Enterprise Linux 9 provides a tool for generating SELinux policies for containers using the \u003Ccode class=\"literal\">udica\u003C/code> package. With \u003Ccode class=\"literal\">udica\u003C/code>, you can create a tailored security policy for better control of how a container accesses host system resources, such as storage, devices, and network. This enables you to harden your container deployments against security violations and it also simplifies achieving and maintaining regulatory compliance.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"introduction-to-udica_creating-selinux-policies-for-containers\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.1. Introduction to the udica SELinux policy generator\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo simplify creating new SELinux policies for custom containers, RHEL 9 provides the \u003Ccode class=\"literal\">udica\u003C/code> utility. You can use this tool to create a policy based on an inspection of the container JavaScript Object Notation (JSON) file, which contains Linux-capabilities, mount-points, and ports definitions. The tool consequently combines rules generated using the results of the inspection with rules inherited from a specified SELinux Common Intermediate Language (CIL) block.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe process of generating SELinux policy for a container using \u003Ccode class=\"literal\">udica\u003C/code> has three main parts:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tParsing the container spec file in the JSON format\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFinding suitable allow rules based on the results of the first part\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tGenerating final SELinux policy\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tDuring the parsing phase, \u003Ccode class=\"literal\">udica\u003C/code> looks for Linux capabilities, network ports, and mount points.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBased on the results, \u003Ccode class=\"literal\">udica\u003C/code> detects which Linux capabilities are required by the container and creates an SELinux rule allowing all these capabilities. If the container binds to a specific port, \u003Ccode class=\"literal\">udica\u003C/code> uses SELinux user-space libraries to get the correct SELinux label of a port that is used by the inspected container.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAfterward, \u003Ccode class=\"literal\">udica\u003C/code> detects which directories are mounted to the container file-system name space from the host.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe CIL’s block inheritance feature allows \u003Ccode class=\"literal\">udica\u003C/code> to create templates of SELinux \u003Cspan class=\"emphasis\">\u003Cem>allow rules\u003C/em>\u003C/span> focusing on a specific action, for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>allow accessing home directories\u003C/em>\u003C/span>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>allow accessing log files\u003C/em>\u003C/span>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>allow accessing communication with Xserver\u003C/em>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThese templates are called blocks and the final SELinux policy is created by merging the blocks.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/en/blog/generate-selinux-policies-containers-with-udica\">Generate SELinux policies for containers with udica\u003C/a> Red Hat Blog article\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-and-using-an-selinux-policy-for-a-custom-container_creating-selinux-policies-for-containers\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.2. Creating and using an SELinux policy for a custom container\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo generate an SELinux security policy for a custom container, follow the steps in this procedure.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">podman\u003C/code> tool for managing containers is installed. If it is not, use the \u003Ccode class=\"literal\">dnf install podman\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA custom Linux container - \u003Cspan class=\"emphasis\">\u003Cem>ubi8\u003C/em>\u003C/span> in this example.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">udica\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install -y udica\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, install the \u003Ccode class=\"literal\">container-tools\u003C/code> module, which provides a set of container software packages, including \u003Ccode class=\"literal\">udica\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf module install -y container-tools\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the \u003Cspan class=\"emphasis\">\u003Cem>ubi8\u003C/em>\u003C/span> container that mounts the \u003Ccode class=\"literal\">/home\u003C/code> directory with read-only permissions and the \u003Ccode class=\"literal\">/var/spool\u003C/code> directory with permissions to read and write. The container exposes the port \u003Cspan class=\"emphasis\">\u003Cem>21\u003C/em>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>podman run --env container=podman -v \u003Cspan class=\"emphasis\">\u003Cem>/home:/home:ro\u003C/em>\u003C/span> -v \u003Cspan class=\"emphasis\">\u003Cem>/var/spool:/var/spool:rw\u003C/em>\u003C/span> -p \u003Cspan class=\"emphasis\">\u003Cem>21:21\u003C/em>\u003C/span> -it \u003Cspan class=\"emphasis\">\u003Cem>ubi8\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>bash\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that now the container runs with the \u003Ccode class=\"literal\">container_t\u003C/code> SELinux type. This type is a generic domain for all containers in the SELinux policy and it might be either too strict or too loose for your scenario.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen a new terminal, and enter the \u003Ccode class=\"literal\">podman ps\u003C/code> command to obtain the ID of the container:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>podman ps\u003C/strong>\u003C/span>\nCONTAINER ID   IMAGE                                   COMMAND   CREATED          STATUS              PORTS   NAMES\n37a3635afb8f   registry.access.redhat.com/ubi8:latest  bash      15 minutes ago   Up 15 minutes ago           heuristic_lewin\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a container JSON file, and use \u003Ccode class=\"literal\">udica\u003C/code> for creating a policy module based on the information in the JSON file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>podman inspect \u003Cspan class=\"emphasis\">\u003Cem>37a3635afb8f\u003C/em>\u003C/span> &gt; \u003Cspan class=\"emphasis\">\u003Cem>container.json\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>udica -j \u003Cspan class=\"emphasis\">\u003Cem>container.json\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>my_container\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nPolicy my_container with container id 37a3635afb8f created!\n[…]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>podman inspect \u003Cspan class=\"emphasis\">\u003Cem>37a3635afb8f\u003C/em>\u003C/span> | udica \u003Cspan class=\"emphasis\">\u003Cem>my_container\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nPolicy my_container with container id 37a3635afb8f created!\n\nPlease load these modules using:\n# semodule -i my_container.cil /usr/share/udica/templates/{base_container.cil,net_container.cil,home_container.cil}\n\nRestart the container with: \"--security-opt label=type:my_container.process\" parameter\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAs suggested by the output of \u003Ccode class=\"literal\">udica\u003C/code> in the previous step, load the policy module:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semodule -i \u003Cspan class=\"emphasis\">\u003Cem>my_container.cil\u003C/em>\u003C/span> /usr/share/udica/templates/{base_container.cil,net_container.cil,home_container.cil}\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStop the container and start it again with the \u003Ccode class=\"literal\">--security-opt label=type:my_container.process\u003C/code> option:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>podman stop \u003Cspan class=\"emphasis\">\u003Cem>37a3635afb8f\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>podman run --security-opt label=type:\u003Cspan class=\"emphasis\">\u003Cem>my_container\u003C/em>\u003C/span>.process -v \u003Cspan class=\"emphasis\">\u003Cem>/home:/home:ro\u003C/em>\u003C/span> -v \u003Cspan class=\"emphasis\">\u003Cem>/var/spool:/var/spool:rw\u003C/em>\u003C/span> -p \u003Cspan class=\"emphasis\">\u003Cem>21:21\u003C/em>\u003C/span> -it \u003Cspan class=\"emphasis\">\u003Cem>ubi8\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>bash\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the container runs with the \u003Ccode class=\"literal\">my_container.process\u003C/code> type:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ps -efZ | grep \u003Cspan class=\"emphasis\">\u003Cem>my_container\u003C/em>\u003C/span>.process\u003C/strong>\u003C/span>\nunconfined_u:system_r:container_runtime_t:s0-s0:c0.c1023 root 2275 434  1 13:49 pts/1 00:00:00 podman run --security-opt label=type:my_container.process -v /home:/home:ro -v /var/spool:/var/spool:rw -p 21:21 -it ubi8 bash\nsystem_u:system_r:my_container.process:s0:c270,c963 root 2317 2305  0 13:49 pts/0 00:00:00 bash\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that SELinux now allows access the \u003Ccode class=\"literal\">/home\u003C/code> and \u003Ccode class=\"literal\">/var/spool\u003C/code> mount points:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[root@\u003Cspan class=\"emphasis\">\u003Cem>37a3635afb8f\u003C/em>\u003C/span> /]# \u003Cspan class=\"strong strong\">\u003Cstrong>cd /home\u003C/strong>\u003C/span>\n[root@37a3635afb8f home]# \u003Cspan class=\"strong strong\">\u003Cstrong>ls\u003C/strong>\u003C/span>\n\u003Cspan class=\"emphasis\">\u003Cem>username\u003C/em>\u003C/span>\n[root@37a3635afb8f ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>cd /var/spool/\u003C/strong>\u003C/span>\n[root@37a3635afb8f spool]# \u003Cspan class=\"strong strong\">\u003Cstrong>touch test\u003C/strong>\u003C/span>\n[root@37a3635afb8f spool]#\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that SELinux allows binding only to the port 21:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[root@37a3635afb8f /]# \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install nmap-ncat\u003C/strong>\u003C/span>\n[root@37a3635afb8f /]# \u003Cspan class=\"strong strong\">\u003Cstrong>nc -lvp 21\u003C/strong>\u003C/span>\n…\nNcat: Listening on :::21\nNcat: Listening on 0.0.0.0:21\n^C\n[root@37a3635afb8f /]# \u003Cspan class=\"strong strong\">\u003Cstrong>nc -lvp 80\u003C/strong>\u003C/span>\n…\nNcat: bind to :::80: Permission denied. QUITTING.\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">udica(8)\u003C/code> and \u003Ccode class=\"literal\">podman(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/containers/udica#creating-selinux-policy-for-container\">udica - Generate SELinux policies for containers\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/building_running_and_managing_containers/\">Building, running, and managing containers\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"deploying-the-same-selinux-configuration-on-multiple-systems_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 10. Deploying the same SELinux configuration on multiple systems\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tYou can deploy your verified SELinux configuration on multiple systems by using one of the following methods:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tUsing RHEL system roles and Ansible\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tUsing the RHEL web console\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tUsing \u003Ccode class=\"literal\">semanage\u003C/code> export and import commands in your scripts\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"introduction-to-the-selinux-system-role_deploying-the-same-selinux-configuration-on-multiple-systems\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.1. Introduction to the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tRHEL system roles is a collection of Ansible roles and modules that provide a consistent configuration interface to remotely manage multiple RHEL systems. You can perform the following actions by using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCleaning local policy modifications related to SELinux booleans, file contexts, ports, and logins.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSetting SELinux policy booleans, file contexts, ports, and logins.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRestoring file contexts on specified files or directories.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tManaging SELinux modules.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml\u003C/code> example playbook installed by the \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package demonstrates how to set the targeted policy in enforcing mode. The playbook also applies several local policy modifications and restores file contexts in the \u003Ccode class=\"literal\">/tmp/test_dir/\u003C/code> directory.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/selinux/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_deploying-the-same-selinux-configuration-on-multiple-systems\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.2. Using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role to apply SELinux settings on multiple systems\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWith the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role, you can prepare and apply an Ansible playbook with your verified SELinux settings.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tPrepare your playbook. You can either start from scratch or modify the example playbook installed as a part of the \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-selinux-playbook.yml&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>vi \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-selinux-playbook.yml&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the content of the playbook to fit your scenario. For example, the following part ensures that the system installs and enables the \u003Ccode class=\"literal\">selinux-local-1.pp\u003C/code> SELinux module:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">selinux_modules:\n- { path: \"selinux-local-1.pp\", priority: \"400\" }\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the changes, and exit the text editor.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-selinux-playbook.yml&gt;\u003C/em>\u003C/span> --syntax-check\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun your playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-selinux-playbook.yml&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/selinux/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/7047896\">SELinux hardening with Ansible\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"managing-ports-by-using-the-selinux-rhel-system-role_deploying-the-same-selinux-configuration-on-multiple-systems\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.3. Managing ports by using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can automate managing port access in SELinux consistently across multiple systems by using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role. This might be useful, for example, when configuring an Apache HTTP server to listen on a different port. You can do this by creating a playbook with the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role that assigns the \u003Ccode class=\"literal\">http_port_t\u003C/code> SELinux type to a specific port number. After you run the playbook on the managed nodes, specific services defined in the SELinux policy can access this port.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can automate managing port access in SELinux either by using the \u003Ccode class=\"literal\">seport\u003C/code> module, which is quicker than using the entire role, or by using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role, which is more useful when you also make other changes in SELinux configuration. The methods are equivalent, in fact the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role uses the \u003Ccode class=\"literal\">seport\u003C/code> module when configuring ports. Each of the methods has the same effect as entering the command \u003Ccode class=\"literal\">semanage port -a -t http_port_t -p tcp \u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\u003C/code> on the managed node.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: To verify port status by using the \u003Ccode class=\"literal\">semanage\u003C/code> command, the \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package must be installed.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo configure just the port number without making other changes, use the \u003Ccode class=\"literal\">seport\u003C/code> module:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Allow Apache to listen on tcp port \u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\n  community.general.seport:\n    ports: \u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\n    proto: tcp\n    setype: http_port_t\n    state: present\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\u003C/code> with the port number to which you want to assign the \u003Ccode class=\"literal\">http_port_t\u003C/code> type.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor more complex configuration of the managed nodes that involves other customizations of SELinux, use the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role. Create a playbook file, for example, \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, and add the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Modify SELinux port mapping example\n  hosts: all\n  vars:\n    # Map tcp port \u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span> to the 'http_port_t' SELinux port type\n    selinux_ports:\n      - ports: \u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\n        proto: tcp\n        setype: http_port_t\n        state: present\n\n  tasks:\n    - name: Include selinux role\n      ansible.builtin.include_role:\n        name: rhel-system-roles.selinux\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\u003C/code> with the port number to which you want to assign the \u003Ccode class=\"literal\">http_port_t\u003C/code> type.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the port is assigned to the \u003Ccode class=\"literal\">http_port_t\u003C/code> type:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage port --list | grep http_port_t\u003C/strong>\u003C/span>\nhttp_port_t                \ttcp  \t\u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>, 80, 81, 443, 488, 8008, 8009, 8443, 9000\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/selinux/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"applying-a-generated-ansible-playbook_deploying-the-same-selinux-configuration-on-multiple-systems\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.4. Creating an SELinux configuration Ansible playbook in the web console\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn the web console, you can generate a shell script or an Ansible playbook of your SELinux configuration. In case of the Ansible playbook, you can conveniently apply the configuration on multiple systems.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have installed the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor instructions, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console\">Installing and enabling the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console\">Logging in to the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>SELinux\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">View the automation script\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tA window with the generated script opens. You can navigate between a shell script and an Ansible playbook generation options tab.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"inlinemediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_SELinux-en-US/images/574e330de771fb1ead38d319d32417f7/cockpit-ansible-playbook-generated.png\" alt=\"Ansible playbook of your SELinux configuration\"/>\u003C/span>\n\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick the \u003Cspan class=\"guibutton\">Copy to clipboard\u003C/span> button to select the script or playbook and apply it.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tAs a result, you have an automation script that you can apply to more machines.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/troubleshooting-problems-related-to-selinux_using-selinux\">Troubleshooting problems related to SELinux\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/deploying-the-same-selinux-configuration-on-multiple-systems_using-selinux\">Deploying the same SELinux configuration on multiple systems\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ansible-playbook(1)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"transferring-selinux-settings-to-another-system-with-semanage_deploying-the-same-selinux-configuration-on-multiple-systems\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.5. Transferring SELinux settings to another system with semanage\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse the following steps for transferring your custom and verified SELinux settings between RHEL 9-based systems.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package is installed on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tExport your verified SELinux settings:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage export -f ./\u003Cspan class=\"emphasis\">\u003Cem>my-selinux-settings.mod\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the file with the settings to the new system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>scp ./\u003Cspan class=\"emphasis\">\u003Cem>my-selinux-settings.mod\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>new-system-hostname\u003C/em>\u003C/span>:\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in on the new system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh root@\u003Cspan class=\"emphasis\">\u003Cem>new-system-hostname\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tImport the settings on the new system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">\u003Cspan class=\"emphasis\">\u003Cem>new-system-hostname\u003C/em>\u003C/span># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage import -f ./\u003Cspan class=\"emphasis\">\u003Cem>my-selinux-settings.mod\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">semanage-export(8)\u003C/code> and \u003Ccode class=\"literal\">semanage-import(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-polyinstantiated-directories_using-selinux\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 11. Configuring polyinstantiated directories\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tBy default, all programs, services, and users use the \u003Ccode class=\"literal\">/tmp\u003C/code>, \u003Ccode class=\"literal\">/var/tmp\u003C/code>, and home directories for temporary storage. This makes these directories vulnerable to race condition attacks and information leaks based on file names. You can make \u003Ccode class=\"literal\">/tmp/\u003C/code>, \u003Ccode class=\"literal\">/var/tmp/\u003C/code>, and the home directory instantiated so that they are no longer shared between all users, and each user’s \u003Ccode class=\"literal\">/tmp-inst\u003C/code> and \u003Ccode class=\"literal\">/var/tmp/tmp-inst\u003C/code> is separately mounted to the \u003Ccode class=\"literal\">/tmp\u003C/code> and \u003Ccode class=\"literal\">/var/tmp\u003C/code> directory.\n\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tEnable polyinstantiation in SELinux:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setsebool -P allow_polyinstantiation 1\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\tYou can verify that polyinstantiation is enabled in SELinux by entering the \u003Ccode class=\"literal\">getsebool allow_polyinstantiation\u003C/code> command.\n\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tCreate the directory structure for data persistence over reboot with the necessary permissions:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>mkdir /tmp-inst /var/tmp/tmp-inst --mode 000\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tRestore the entire security context including the SELinux user part:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>restorecon -Fv /tmp-inst /var/tmp/tmp-inst\u003C/strong>\u003C/span>\nRelabeled /tmp-inst from unconfined_u:object_r:default_t:s0 to system_u:object_r:tmp_t:s0\nRelabeled /var/tmp/tmp-inst from unconfined_u:object_r:tmp_t:s0 to system_u:object_r:tmp_t:s0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tIf your system uses the \u003Ccode class=\"literal\">fapolicyd\u003C/code> application control framework, allow \u003Ccode class=\"literal\">fapolicyd\u003C/code> to monitor file access events on the underlying file system when they are bind mounted by enabling the \u003Ccode class=\"literal\">allow_filesystem_mark\u003C/code> option in the \u003Ccode class=\"literal\">/etc/fapolicyd/fapolicyd.conf\u003C/code> configuration file.\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">allow_filesystem_mark = 1\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tEnable instantiation of the \u003Ccode class=\"literal\">/tmp\u003C/code>, \u003Ccode class=\"literal\">/var/tmp/\u003C/code>, and users' home directories:\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tUse \u003Ccode class=\"literal\">/etc/security/namespace.conf\u003C/code> instead of a separate file in the \u003Ccode class=\"literal\">/etc/security/namespace.d/\u003C/code> directory because the \u003Ccode class=\"literal\">pam_namespace_helper\u003C/code> program does not read additional files in \u003Ccode class=\"literal\">/etc/security/namespace.d\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOn a system with multi-level security (MLS), uncomment the last three lines in the \u003Ccode class=\"literal\">/etc/security/namespace.conf\u003C/code> file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">/tmp     /tmp-inst/   \t\t   level \t root,adm\n/var/tmp /var/tmp/tmp-inst/    level \t root,adm\n$HOME    $HOME/$USER.inst/     level\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOn a system without multi-level security (MLS), add the following lines in the \u003Ccode class=\"literal\">/etc/security/namespace.conf\u003C/code> file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">/tmp     /tmp-inst/            user \t root,adm\n/var/tmp /var/tmp/tmp-inst/    user \t root,adm\n$HOME    $HOME/$USER.inst/     user\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tVerify that the \u003Ccode class=\"literal\">pam_namespace.so\u003C/code> module is configured for the session:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>grep namespace /etc/pam.d/login\u003C/strong>\u003C/span>\nsession    required     pam_namespace.so\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tOptional: Enable cloud users to access the system with SSH keys:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">openssh-keycat\u003C/code> package.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a file in the \u003Ccode class=\"literal\">/etc/ssh/sshd_config.d/\u003C/code> directory with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">AuthorizedKeysCommand /usr/libexec/openssh/ssh-keycat\nAuthorizedKeysCommandRunAs root\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify that public key authentication is enabled by checking that the \u003Ccode class=\"literal\">PubkeyAuthentication\u003C/code> variable in \u003Ccode class=\"literal\">sshd_config\u003C/code> is set to \u003Ccode class=\"literal\">yes\u003C/code>. By default, \u003Ccode class=\"literal\">PubkeyAuthentication\u003C/code> is set to yes, even though the line in \u003Ccode class=\"literal\">sshd_config\u003C/code> is commented out.\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>grep -r PubkeyAuthentication /etc/ssh/\u003C/strong>\u003C/span>\n/etc/ssh/sshd_config:#PubkeyAuthentication yes\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tAdd the \u003Ccode class=\"literal\">session required pam_namespace.so unmnt_remnt\u003C/code> entry into the module for each service for which polyinstantiation should apply, after the \u003Ccode class=\"literal\">session include system-auth\u003C/code> line. For example, in \u003Ccode class=\"literal\">/etc/pam.d/su\u003C/code>, \u003Ccode class=\"literal\">/etc/pam.d/sudo\u003C/code>, \u003Ccode class=\"literal\">/etc/pam.d/ssh\u003C/code>, and \u003Ccode class=\"literal\">/etc/pam.d/sshd\u003C/code>:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[...]\nsession        include        system-auth\nsession        required    pam_namespace.so unmnt_remnt\n[...]\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\tLog in as a non-root user. Users that were logged in before polyinstantiation was configured must log out and log in before the changes take effect for them.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tCheck that the \u003Ccode class=\"literal\">/tmp/\u003C/code> directory is mounted under \u003Ccode class=\"literal\">/tmp-inst/\u003C/code>:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>findmnt --mountpoint /tmp/\u003C/strong>\u003C/span>\nTARGET SOURCE                 \tFSTYPE OPTIONS\n/tmp   /dev/vda1[/tmp-inst/\u003Cspan class=\"emphasis\">\u003Cem>&lt;user&gt;\u003C/em>\u003C/span>] xfs\trw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\tThe \u003Ccode class=\"literal\">SOURCE\u003C/code> output differs based on your environment. * On virutal systems, it shows \u003Ccode class=\"literal\">/dev/vda_&lt;number&gt;_\u003C/code>. * On bare-metal systems it shows \u003Ccode class=\"literal\">/dev/sda_&lt;number&gt;_\u003C/code> or \u003Ccode class=\"literal\">/dev/nvme*\u003C/code>\n\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/pam-docs/txts/README.pam_namespace\u003C/code> readme file installed with the \u003Ccode class=\"literal\">pam-docs\u003C/code> package.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"legalnotice\" id=\"idm139843088056768\">\u003Ch2 class=\"legalnotice\">Legal Notice\u003C/h2>\u003Cdiv class=\"para\">\n\t\tCopyright \u003Cspan class=\"trademark\">\u003C!--Empty-->\u003C/span>© 2024 Red Hat, Inc.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license (\"CC-BY-SA\"). An explanation of CC-BY-SA is available at \u003Ca class=\"uri\" href=\"http://creativecommons.org/licenses/by-sa/3.0/\">http://creativecommons.org/licenses/by-sa/3.0/\u003C/a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Linux\u003C/span>® is the registered trademark of Linus Torvalds in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Java\u003C/span>® is a registered trademark of Oracle and/or its affiliates.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">XFS\u003C/span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">MySQL\u003C/span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Node.js\u003C/span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe \u003Cspan class=\"trademark\">OpenStack\u003C/span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tAll other trademarks are the property of their respective owners.\n\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003C/body>",[14,21,26,54,84,133,154,183,228,253,270,284,310,315],{"title":11,"visible":15,"weight":16,"urlFragment":17,"anchor":18,"singlePageAnchor":18,"docTitle":19,"url":20},true,1,"index",null,"using_selinux","#",{"title":22,"visible":15,"weight":23,"urlFragment":24,"anchor":18,"singlePageAnchor":24,"docTitle":19,"url":25},"Providing feedback on Red Hat documentation",2,"proc_providing-feedback-on-red-hat-documentation_using-selinux","#proc_providing-feedback-on-red-hat-documentation_using-selinux",{"title":27,"visible":15,"weight":28,"urlFragment":29,"anchor":18,"singlePageAnchor":29,"sections":30,"docTitle":19,"url":53},"1. Getting started with SELinux",3,"getting-started-with-selinux_using-selinux",[31,35,39,43,48],{"title":32,"visible":15,"weight":16,"urlFragment":29,"anchor":33,"singlePageAnchor":33,"docTitle":19,"url":34},"1.1. Introduction to SELinux","introduction-to-selinux_getting-started-with-selinux","#introduction-to-selinux_getting-started-with-selinux",{"title":36,"visible":15,"weight":23,"urlFragment":29,"anchor":37,"singlePageAnchor":37,"docTitle":19,"url":38},"1.2. Benefits of running SELinux","benefits-of-selinux_getting-started-with-selinux","#benefits-of-selinux_getting-started-with-selinux",{"title":40,"visible":15,"weight":28,"urlFragment":29,"anchor":41,"singlePageAnchor":41,"docTitle":19,"url":42},"1.3. SELinux examples","selinux-examples_getting-started-with-selinux","#selinux-examples_getting-started-with-selinux",{"title":44,"visible":15,"weight":45,"urlFragment":29,"anchor":46,"singlePageAnchor":46,"docTitle":19,"url":47},"1.4. SELinux architecture and packages",4,"selinux-architecture_getting-started-with-selinux","#selinux-architecture_getting-started-with-selinux",{"title":49,"visible":15,"weight":50,"urlFragment":29,"anchor":51,"singlePageAnchor":51,"docTitle":19,"url":52},"1.5. SELinux states and modes",5,"selinux-states-and-modes_getting-started-with-selinux","#selinux-states-and-modes_getting-started-with-selinux","#getting-started-with-selinux_using-selinux",{"title":55,"visible":15,"weight":45,"urlFragment":56,"anchor":18,"singlePageAnchor":56,"sections":57,"docTitle":19,"url":83},"2. Changing SELinux states and modes","changing-selinux-states-and-modes_using-selinux",[58,62,66,70,74,78],{"title":59,"visible":15,"weight":16,"urlFragment":56,"anchor":60,"singlePageAnchor":60,"docTitle":19,"url":61},"2.1. Permanent changes in SELinux states and modes","changing-selinux-modes_changing-selinux-states-and-modes","#changing-selinux-modes_changing-selinux-states-and-modes",{"title":63,"visible":15,"weight":23,"urlFragment":56,"anchor":64,"singlePageAnchor":64,"docTitle":19,"url":65},"2.2. Changing SELinux to permissive mode","changing-to-permissive-mode_changing-selinux-states-and-modes","#changing-to-permissive-mode_changing-selinux-states-and-modes",{"title":67,"visible":15,"weight":28,"urlFragment":56,"anchor":68,"singlePageAnchor":68,"docTitle":19,"url":69},"2.3. Changing SELinux to enforcing mode","changing-to-enforcing-mode_changing-selinux-states-and-modes","#changing-to-enforcing-mode_changing-selinux-states-and-modes",{"title":71,"visible":15,"weight":45,"urlFragment":56,"anchor":72,"singlePageAnchor":72,"docTitle":19,"url":73},"2.4. Enabling SELinux on systems that previously had it disabled","enabling-selinux-on-systems-that-previously-had-it-disabled_changing-selinux-states-and-modes","#enabling-selinux-on-systems-that-previously-had-it-disabled_changing-selinux-states-and-modes",{"title":75,"visible":15,"weight":50,"urlFragment":56,"anchor":76,"singlePageAnchor":76,"docTitle":19,"url":77},"2.5. Disabling SELinux","Enabling_and_Disabling_SELinux-Disabling_SELinux_changing-selinux-states-and-modes","#Enabling_and_Disabling_SELinux-Disabling_SELinux_changing-selinux-states-and-modes",{"title":79,"visible":15,"weight":80,"urlFragment":56,"anchor":81,"singlePageAnchor":81,"docTitle":19,"url":82},"2.6. Changing SELinux modes at boot time",6,"changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes","#changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes","#changing-selinux-states-and-modes_using-selinux",{"title":85,"visible":15,"weight":50,"urlFragment":86,"anchor":18,"singlePageAnchor":86,"sections":87,"docTitle":19,"url":132},"3. Managing confined and unconfined users","managing-confined-and-unconfined-users_using-selinux",[88,92,96,100,104,108,112,117,122,127],{"title":89,"visible":15,"weight":16,"urlFragment":86,"anchor":90,"singlePageAnchor":90,"docTitle":19,"url":91},"3.1. Confined and unconfined users in SELinux","confined-and-unconfined-users_managing-confined-and-unconfined-users","#confined-and-unconfined-users_managing-confined-and-unconfined-users",{"title":93,"visible":15,"weight":23,"urlFragment":86,"anchor":94,"singlePageAnchor":94,"docTitle":19,"url":95},"3.2. Roles and access rights of SELinux users","roles-and-access-rights-of-selinux-users_managing-confined-and-unconfined-users","#roles-and-access-rights-of-selinux-users_managing-confined-and-unconfined-users",{"title":97,"visible":15,"weight":28,"urlFragment":86,"anchor":98,"singlePageAnchor":98,"docTitle":19,"url":99},"3.3. Confined non-administrator roles in SELinux","confined-non-administrator-roles-in-selinux_managing-confined-and-unconfined-users","#confined-non-administrator-roles-in-selinux_managing-confined-and-unconfined-users",{"title":101,"visible":15,"weight":45,"urlFragment":86,"anchor":102,"singlePageAnchor":102,"docTitle":19,"url":103},"3.4. Confined administrator roles in SELinux","confined-administrator-roles-in-selinux_managing-confined-and-unconfined-users","#confined-administrator-roles-in-selinux_managing-confined-and-unconfined-users",{"title":105,"visible":15,"weight":50,"urlFragment":86,"anchor":106,"singlePageAnchor":106,"docTitle":19,"url":107},"3.5. Adding a new user automatically mapped to the SELinux unconfined_u user","adding-a-new-user-automatically-mapped-to-the-selinux-unconfined_u-user_managing-confined-and-unconfined-users","#adding-a-new-user-automatically-mapped-to-the-selinux-unconfined_u-user_managing-confined-and-unconfined-users",{"title":109,"visible":15,"weight":80,"urlFragment":86,"anchor":110,"singlePageAnchor":110,"docTitle":19,"url":111},"3.6. Adding a new user as an SELinux-confined user","adding-a-new-user-as-an-selinux-confined-user_managing-confined-and-unconfined-users","#adding-a-new-user-as-an-selinux-confined-user_managing-confined-and-unconfined-users",{"title":113,"visible":15,"weight":114,"urlFragment":86,"anchor":115,"singlePageAnchor":115,"docTitle":19,"url":116},"3.7. Confining regular users in SELinux",7,"confining-regular-users_managing-confined-and-unconfined-users","#confining-regular-users_managing-confined-and-unconfined-users",{"title":118,"visible":15,"weight":119,"urlFragment":86,"anchor":120,"singlePageAnchor":120,"docTitle":19,"url":121},"3.8. Confining an administrator by mapping to sysadm_u",8,"confining-an-administrator-by-mapping-to-sysadm_u_managing-confined-and-unconfined-users","#confining-an-administrator-by-mapping-to-sysadm_u_managing-confined-and-unconfined-users",{"title":123,"visible":15,"weight":124,"urlFragment":86,"anchor":125,"singlePageAnchor":125,"docTitle":19,"url":126},"3.9. Confining an administrator by using sudo and the sysadm_r role",9,"confining-an-administrator-using-sudo-and-the-sysadm_r-role_managing-confined-and-unconfined-users","#confining-an-administrator-using-sudo-and-the-sysadm_r-role_managing-confined-and-unconfined-users",{"title":128,"visible":15,"weight":129,"urlFragment":86,"anchor":130,"singlePageAnchor":130,"docTitle":19,"url":131},"3.10. Additional resources",10,"additional_resources","#additional_resources","#managing-confined-and-unconfined-users_using-selinux",{"title":134,"visible":15,"weight":80,"urlFragment":135,"anchor":18,"singlePageAnchor":135,"sections":136,"docTitle":19,"url":153},"4. Configuring SELinux for applications and services with non-standard configurations","configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux",[137,141,145,149],{"title":138,"visible":15,"weight":16,"urlFragment":135,"anchor":139,"singlePageAnchor":139,"docTitle":19,"url":140},"4.1. Customizing the SELinux policy for the Apache HTTP server in a non-standard configuration","customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations","#customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations",{"title":142,"visible":15,"weight":23,"urlFragment":135,"anchor":143,"singlePageAnchor":143,"docTitle":19,"url":144},"4.2. Adjusting the policy for sharing NFS and CIFS volumes by using SELinux booleans","adjusting-the-policy-for-sharing-nfs-and-cifs-volumes-using-selinux-booleans_configuring-selinux-for-applications-and-services-with-non-standard-configurations","#adjusting-the-policy-for-sharing-nfs-and-cifs-volumes-using-selinux-booleans_configuring-selinux-for-applications-and-services-with-non-standard-configurations",{"title":146,"visible":15,"weight":28,"urlFragment":135,"anchor":147,"singlePageAnchor":147,"docTitle":19,"url":148},"4.3. Finding the correct SELinux type for managing access to non-standard directories","finding-the-correct-selinux-type-for-managing-access-to-non-standard-directories_configuring-selinux-for-applications-and-services-with-non-standard-configurations","#finding-the-correct-selinux-type-for-managing-access-to-non-standard-directories_configuring-selinux-for-applications-and-services-with-non-standard-configurations",{"title":150,"visible":15,"weight":45,"urlFragment":135,"anchor":151,"singlePageAnchor":151,"docTitle":19,"url":152},"4.4. Managing access to non-standard shared directories for unprivileged SELinux users","managing-access-to-non-standard-shared-directories-for-selinux-unprivileged-users_configuring-selinux-for-applications-and-services-with-non-standard-configurations","#managing-access-to-non-standard-shared-directories-for-selinux-unprivileged-users_configuring-selinux-for-applications-and-services-with-non-standard-configurations","#configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux",{"title":155,"visible":15,"weight":114,"urlFragment":156,"anchor":18,"singlePageAnchor":156,"sections":157,"docTitle":19,"url":182},"5. Troubleshooting problems related to SELinux","troubleshooting-problems-related-to-selinux_using-selinux",[158,162,166,170,174,178],{"title":159,"visible":15,"weight":16,"urlFragment":156,"anchor":160,"singlePageAnchor":160,"docTitle":19,"url":161},"5.1. Identifying SELinux denials","identifying-selinux-denials_troubleshooting-problems-related-to-selinux","#identifying-selinux-denials_troubleshooting-problems-related-to-selinux",{"title":163,"visible":15,"weight":23,"urlFragment":156,"anchor":164,"singlePageAnchor":164,"docTitle":19,"url":165},"5.2. Analyzing SELinux denial messages","analyzing-an-already-found-selinux-denial_troubleshooting-problems-related-to-selinux","#analyzing-an-already-found-selinux-denial_troubleshooting-problems-related-to-selinux",{"title":167,"visible":15,"weight":28,"urlFragment":156,"anchor":168,"singlePageAnchor":168,"docTitle":19,"url":169},"5.3. Fixing analyzed SELinux denials","fixing-an-analyzed-selinux-denial_troubleshooting-problems-related-to-selinux","#fixing-an-analyzed-selinux-denial_troubleshooting-problems-related-to-selinux",{"title":171,"visible":15,"weight":45,"urlFragment":156,"anchor":172,"singlePageAnchor":172,"docTitle":19,"url":173},"5.4. Creating a local SELinux policy module","proc_creating-a-local-selinux-policy-module_troubleshooting-problems-related-to-selinux","#proc_creating-a-local-selinux-policy-module_troubleshooting-problems-related-to-selinux",{"title":175,"visible":15,"weight":50,"urlFragment":156,"anchor":176,"singlePageAnchor":176,"docTitle":19,"url":177},"5.5. SELinux denials in the Audit log","selinux-denials-in-the-audit-log_troubleshooting-problems-related-to-selinux","#selinux-denials-in-the-audit-log_troubleshooting-problems-related-to-selinux",{"title":179,"visible":15,"weight":80,"urlFragment":156,"anchor":180,"singlePageAnchor":180,"docTitle":19,"url":181},"5.6. Additional resources","additional-resources-troubleshooting-problems-related-to-selinux","#additional-resources-troubleshooting-problems-related-to-selinux","#troubleshooting-problems-related-to-selinux_using-selinux",{"title":184,"visible":15,"weight":119,"urlFragment":185,"anchor":18,"singlePageAnchor":185,"sections":186,"docTitle":19,"url":227},"6. Using Multi-Level Security (MLS)","using-multi-level-security-mls_using-selinux",[187,191,195,199,203,207,211,215,219,223],{"title":188,"visible":15,"weight":16,"urlFragment":185,"anchor":189,"singlePageAnchor":189,"docTitle":19,"url":190},"6.1. Multi-Level Security (MLS)","multi-level-security-mls_using-multi-level-security-mls","#multi-level-security-mls_using-multi-level-security-mls",{"title":192,"visible":15,"weight":23,"urlFragment":185,"anchor":193,"singlePageAnchor":193,"docTitle":19,"url":194},"6.2. SELinux roles in MLS","ref_selinux-roles-in-mls_using-multi-level-security-mls","#ref_selinux-roles-in-mls_using-multi-level-security-mls",{"title":196,"visible":15,"weight":28,"urlFragment":185,"anchor":197,"singlePageAnchor":197,"docTitle":19,"url":198},"6.3. Switching the SELinux policy to MLS","switching-the-selinux-policy-to-mls_using-multi-level-security-mls","#switching-the-selinux-policy-to-mls_using-multi-level-security-mls",{"title":200,"visible":15,"weight":45,"urlFragment":185,"anchor":201,"singlePageAnchor":201,"docTitle":19,"url":202},"6.4. Establishing user clearance in MLS","establishing-user-clearance-in-mls_using-multi-level-security-mls","#establishing-user-clearance-in-mls_using-multi-level-security-mls",{"title":204,"visible":15,"weight":50,"urlFragment":185,"anchor":205,"singlePageAnchor":205,"docTitle":19,"url":206},"6.5. Changing a user’s clearance level within the defined security range in MLS","proc_changing-a-users-clearance-level-within-the-defined-security-range-in-mls_using-multi-level-security-mls","#proc_changing-a-users-clearance-level-within-the-defined-security-range-in-mls_using-multi-level-security-mls",{"title":208,"visible":15,"weight":80,"urlFragment":185,"anchor":209,"singlePageAnchor":209,"docTitle":19,"url":210},"6.6. Increasing file sensitivity levels in MLS","proc_increasing-file-sensitivity-levels-in-mls_using-multi-level-security-mls","#proc_increasing-file-sensitivity-levels-in-mls_using-multi-level-security-mls",{"title":212,"visible":15,"weight":114,"urlFragment":185,"anchor":213,"singlePageAnchor":213,"docTitle":19,"url":214},"6.7. Changing file sensitivity in MLS","proc_changing-file-sensitivity-in-mls_using-multi-level-security-mls","#proc_changing-file-sensitivity-in-mls_using-multi-level-security-mls",{"title":216,"visible":15,"weight":119,"urlFragment":185,"anchor":217,"singlePageAnchor":217,"docTitle":19,"url":218},"6.8. Separating system administration from security administration in MLS","proc_separating-system-administration-from-security-administration-in-mls_using-multi-level-security-mls","#proc_separating-system-administration-from-security-administration-in-mls_using-multi-level-security-mls",{"title":220,"visible":15,"weight":124,"urlFragment":185,"anchor":221,"singlePageAnchor":221,"docTitle":19,"url":222},"6.9. Defining a secure terminal in MLS","proc_defining-a-secure-terminal-in-mls_using-multi-level-security-mls","#proc_defining-a-secure-terminal-in-mls_using-multi-level-security-mls",{"title":224,"visible":15,"weight":129,"urlFragment":185,"anchor":225,"singlePageAnchor":225,"docTitle":19,"url":226},"6.10. Allowing MLS users to edit files on lower levels","proc_allowing-mls-users-to-edit-files-on-lower-levels_using-multi-level-security-mls","#proc_allowing-mls-users-to-edit-files-on-lower-levels_using-multi-level-security-mls","#using-multi-level-security-mls_using-selinux",{"title":229,"visible":15,"weight":124,"urlFragment":230,"anchor":18,"singlePageAnchor":230,"sections":231,"docTitle":19,"url":252},"7. Using Multi-Category Security (MCS) for data confidentiality","assembly_using-multi-category-security-mcs-for-data-confidentiality_using-selinux",[232,236,240,244,248],{"title":233,"visible":15,"weight":16,"urlFragment":230,"anchor":234,"singlePageAnchor":234,"docTitle":19,"url":235},"7.1. Multi-Category Security (MCS)","con_multi-category-security-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality","#con_multi-category-security-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality",{"title":237,"visible":15,"weight":23,"urlFragment":230,"anchor":238,"singlePageAnchor":238,"docTitle":19,"url":239},"7.2. Configuring Multi-Category Security for data confidentiality","proc_configuring-multi-category-security-for-data-confidentiality_assembly_using-multi-category-security-mcs-for-data-confidentiality","#proc_configuring-multi-category-security-for-data-confidentiality_assembly_using-multi-category-security-mcs-for-data-confidentiality",{"title":241,"visible":15,"weight":28,"urlFragment":230,"anchor":242,"singlePageAnchor":242,"docTitle":19,"url":243},"7.3. Defining category labels in MCS","proc_defining-category-labels-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality","#proc_defining-category-labels-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality",{"title":245,"visible":15,"weight":45,"urlFragment":230,"anchor":246,"singlePageAnchor":246,"docTitle":19,"url":247},"7.4. Assigning categories to users in MCS","proc_assigning-categories-to-users-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality","#proc_assigning-categories-to-users-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality",{"title":249,"visible":15,"weight":50,"urlFragment":230,"anchor":250,"singlePageAnchor":250,"docTitle":19,"url":251},"7.5. Assigning categories to files in MCS","proc_assigning-categories-to-files-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality","#proc_assigning-categories-to-files-in-mcs_assembly_using-multi-category-security-mcs-for-data-confidentiality","#assembly_using-multi-category-security-mcs-for-data-confidentiality_using-selinux",{"title":254,"visible":15,"weight":129,"urlFragment":255,"anchor":18,"singlePageAnchor":255,"sections":256,"docTitle":19,"url":269},"8. Writing a custom SELinux policy","writing-a-custom-selinux-policy_using-selinux",[257,261,265],{"title":258,"visible":15,"weight":16,"urlFragment":255,"anchor":259,"singlePageAnchor":259,"docTitle":19,"url":260},"8.1. Custom SELinux policies and related tools","custom-selinux-policies-and-related-tools_writing-a-custom-selinux-policy","#custom-selinux-policies-and-related-tools_writing-a-custom-selinux-policy",{"title":262,"visible":15,"weight":23,"urlFragment":255,"anchor":263,"singlePageAnchor":263,"docTitle":19,"url":264},"8.2. Creating and enforcing an SELinux policy for a custom application","creating-and-enforcing-an-selinux-policy-for-a-custom-application_writing-a-custom-selinux-policy","#creating-and-enforcing-an-selinux-policy-for-a-custom-application_writing-a-custom-selinux-policy",{"title":266,"visible":15,"weight":28,"urlFragment":255,"anchor":267,"singlePageAnchor":267,"docTitle":19,"url":268},"8.3. Additional resources","additional_resources_2","#additional_resources_2","#writing-a-custom-selinux-policy_using-selinux",{"title":271,"visible":15,"weight":272,"urlFragment":273,"anchor":18,"singlePageAnchor":273,"sections":274,"docTitle":19,"url":283},"9. Creating SELinux policies for containers",11,"creating-selinux-policies-for-containers_using-selinux",[275,279],{"title":276,"visible":15,"weight":16,"urlFragment":273,"anchor":277,"singlePageAnchor":277,"docTitle":19,"url":278},"9.1. Introduction to the udica SELinux policy generator","introduction-to-udica_creating-selinux-policies-for-containers","#introduction-to-udica_creating-selinux-policies-for-containers",{"title":280,"visible":15,"weight":23,"urlFragment":273,"anchor":281,"singlePageAnchor":281,"docTitle":19,"url":282},"9.2. Creating and using an SELinux policy for a custom container","creating-and-using-an-selinux-policy-for-a-custom-container_creating-selinux-policies-for-containers","#creating-and-using-an-selinux-policy-for-a-custom-container_creating-selinux-policies-for-containers","#creating-selinux-policies-for-containers_using-selinux",{"title":285,"visible":15,"weight":286,"urlFragment":287,"anchor":18,"singlePageAnchor":287,"sections":288,"docTitle":19,"url":309},"10. Deploying the same SELinux configuration on multiple systems",12,"deploying-the-same-selinux-configuration-on-multiple-systems_using-selinux",[289,293,297,301,305],{"title":290,"visible":15,"weight":16,"urlFragment":287,"anchor":291,"singlePageAnchor":291,"docTitle":19,"url":292},"10.1. Introduction to the selinux RHEL system role","introduction-to-the-selinux-system-role_deploying-the-same-selinux-configuration-on-multiple-systems","#introduction-to-the-selinux-system-role_deploying-the-same-selinux-configuration-on-multiple-systems",{"title":294,"visible":15,"weight":23,"urlFragment":287,"anchor":295,"singlePageAnchor":295,"docTitle":19,"url":296},"10.2. Using the selinux RHEL system role to apply SELinux settings on multiple systems","using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_deploying-the-same-selinux-configuration-on-multiple-systems","#using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_deploying-the-same-selinux-configuration-on-multiple-systems",{"title":298,"visible":15,"weight":28,"urlFragment":287,"anchor":299,"singlePageAnchor":299,"docTitle":19,"url":300},"10.3. Managing ports by using the selinux RHEL system role","managing-ports-by-using-the-selinux-rhel-system-role_deploying-the-same-selinux-configuration-on-multiple-systems","#managing-ports-by-using-the-selinux-rhel-system-role_deploying-the-same-selinux-configuration-on-multiple-systems",{"title":302,"visible":15,"weight":45,"urlFragment":287,"anchor":303,"singlePageAnchor":303,"docTitle":19,"url":304},"10.4. Creating an SELinux configuration Ansible playbook in the web console","applying-a-generated-ansible-playbook_deploying-the-same-selinux-configuration-on-multiple-systems","#applying-a-generated-ansible-playbook_deploying-the-same-selinux-configuration-on-multiple-systems",{"title":306,"visible":15,"weight":50,"urlFragment":287,"anchor":307,"singlePageAnchor":307,"docTitle":19,"url":308},"10.5. Transferring SELinux settings to another system with semanage","transferring-selinux-settings-to-another-system-with-semanage_deploying-the-same-selinux-configuration-on-multiple-systems","#transferring-selinux-settings-to-another-system-with-semanage_deploying-the-same-selinux-configuration-on-multiple-systems","#deploying-the-same-selinux-configuration-on-multiple-systems_using-selinux",{"title":311,"visible":15,"weight":312,"urlFragment":313,"anchor":18,"singlePageAnchor":313,"docTitle":19,"url":314},"11. Configuring polyinstantiated directories",13,"configuring-polyinstantiated-directories_using-selinux","#configuring-polyinstantiated-directories_using-selinux",{"title":316,"visible":15,"weight":317,"urlFragment":318,"anchor":18,"singlePageAnchor":319,"docTitle":19,"url":320},"Legal Notice",14,"legal-notice","idm139843088056768","#idm139843088056768",[322,325,328],{"text":323,"link":324},"Red Hat Enterprise Linux","/documentation/red_hat_enterprise_linux/",{"text":326,"link":327},"9","/documentation/red_hat_enterprise_linux/9/",{"text":11},{"name":11,"translations":330,"productVersion":331,"singlePage":332,"pdf":335,"publishingStatus":337},[5,6,7,8,9],{"name":326},{"contentUrl":333,"name":11,"new":334,"url":19},"https://d2bhdhkti9t3uj.cloudfront.net/html/a5192ad2-db9b-4fec-bff4-570bad2dc62f/448ee2975876fc11f2036df5a16a6c83.html","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/using_selinux/index",{"url":336},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/pdf/using_selinux/Red_Hat_Enterprise_Linux-9-Using_SELinux-en-US.pdf","PUBLISHED",[339,344,347,351,355,359,363],{"name":340,"new":341,"url":342,"urlAliases":343},"10.0-Beta","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/10-beta","10-beta",[],{"name":326,"new":345,"url":326,"urlAliases":346},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9",[],{"name":348,"new":349,"url":348,"urlAliases":350},"8","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8",[],{"name":352,"new":353,"url":352,"urlAliases":354},"7","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7",[],{"name":356,"new":357,"url":356,"urlAliases":358},"6","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/6",[],{"name":360,"new":361,"url":360,"urlAliases":362},"5","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/5",[],{"name":364,"new":365,"url":364,"urlAliases":366},"4","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/4",[],{"using_selinux/index":368,"using_selinux/proc_providing-feedback-on-red-hat-documentation_using-selinux":369,"using_selinux/getting-started-with-selinux_using-selinux":370,"using_selinux/changing-selinux-states-and-modes_using-selinux":371,"using_selinux/managing-confined-and-unconfined-users_using-selinux":372,"using_selinux/configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux":373,"using_selinux/troubleshooting-problems-related-to-selinux_using-selinux":374,"using_selinux/using-multi-level-security-mls_using-selinux":375,"using_selinux/assembly_using-multi-category-security-mcs-for-data-confidentiality_using-selinux":376,"using_selinux/writing-a-custom-selinux-policy_using-selinux":377,"using_selinux/creating-selinux-policies-for-containers_using-selinux":378,"using_selinux/deploying-the-same-selinux-configuration-on-multiple-systems_using-selinux":379,"using_selinux/configuring-polyinstantiated-directories_using-selinux":380,"using_selinux/legal-notice":381},{"prevt":18,"next":24},{"prevt":17,"next":29},{"prevt":18,"next":29},{"prevt":18,"next":56},{"prevt":18,"next":86},{"prevt":18,"next":135},{"prevt":18,"next":156},{"prevt":18,"next":185},{"prevt":18,"next":230},{"prevt":18,"next":255},{"prevt":18,"next":273},{"prevt":18,"next":287},{"prevt":287,"next":318},{"prevt":313,"next":18},{"product":18,"version":18},{"using_selinux":384},[334],{"products":386},[387,388,389,390,391,392,393,394,395,396,397,398,399],"builds_for_red_hat_openshift","migration_toolkit_for_virtualization","openshift_container_platform","openshift_sandboxed_containers","red_hat_advanced_cluster_security_for_kubernetes","red_hat_advanced_cluster_management_for_kubernetes","red_hat_openshift_data_foundation","red_hat_openshift_dev_spaces","red_hat_openshift_gitops","red_hat_openshift_local","red_hat_openshift_pipelines","red_hat_openshift_serverless","workload_availability_for_red_hat_openshift",[],{"default":402},[403,412,418,427,435,443,450,458,465],{"nid":404,"type":405,"langcode":406,"Published":16,"title":407,"Created":408,"Updated":409,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":410,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":411},580,"rebrand banner","en","OpenShift Container Storage is now OpenShift Data Foundation starting with version 4.9.","2023-01-11 15:38:32","2023-01-11 15:40:04","/documentation/red_hat_openshift_container_storage\r\n/documentation/red_hat_openshift_container_storage/\r\n/documentation/red_hat_openshift_container_storage/*","internal:/documentation/red_hat_openshift_data_foundation/",{"nid":413,"type":405,"langcode":406,"Published":16,"title":407,"Created":414,"Updated":415,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":416,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":417},581,"2023-01-11 15:41:31","2023-01-11 15:42:04","/documentation/red_hat_openshift_data_foundation/4.9\r\n/documentation/red_hat_openshift_data_foundation/4.9/\r\n/documentation/red_hat_openshift_data_foundation/4.9/*\r\n/documentation/red_hat_openshift_data_foundation/4.10\r\n/documentation/red_hat_openshift_data_foundation/4.10/\r\n/documentation/red_hat_openshift_data_foundation/4.10/*\r\n/documentation/red_hat_openshift_data_foundation/4.11\r\n/documentation/red_hat_openshift_data_foundation/4.11/\r\n/documentation/red_hat_openshift_data_foundation/4.11/*","internal:/documentation/red_hat_openshift_container_storage/",{"nid":419,"type":420,"langcode":406,"Published":16,"title":421,"Created":422,"Updated":423,"body_value":18,"field_documentation banner_text_value":424,"field_documentation banner_text_format":425,"field_paths_value":426,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},582,"developer preview banner","MicroShift is Developer Preview software only","2023-01-11 15:50:24","2023-01-30 19:00:52","\u003Cp slot=header>MicroShift is Developer Preview software only.\u003C/p>For more information about the support scope of Red Hat Developer Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/devpreview/\">Developer Preview Support Scope\u003C/a>.","documentation banner","/documentation/microshift/4.12\r\n/documentation/microshift/4.12/*\r\n/documentation/red_hat_build_of_microshift/4.12\r\n/documentation/red_hat_build_of_microshift/4.12/*",{"nid":428,"type":429,"langcode":406,"Published":16,"title":430,"Created":431,"Updated":432,"body_value":18,"field_documentation banner_text_value":433,"field_documentation banner_text_format":425,"field_paths_value":434,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},583,"obsolete documentation banner","RHACS EOL - DAT-3433","2023-01-23 16:36:43","2023-01-23 16:39:14","\u003Cp slot=header>You are viewing documentation for a release that is no longer maintained. To view the documentation for the most recent version, see the \u003Ca href=\"/documentation/red_hat_advanced_cluster_security_for_kubernetes/\">latest RHACS docs\u003C/a>.\u003C/p>","/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71/*",{"nid":436,"type":437,"langcode":406,"Published":16,"title":438,"Created":439,"Updated":440,"body_value":18,"field_documentation banner_text_value":441,"field_documentation banner_text_format":425,"field_paths_value":442,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},584,"end of life banner","EOL banner for RHV","2023-05-23 14:58:05","2023-05-24 15:19:42","\u003Cp slot=header>The Red Hat Virtualization\u003C/p>Maintenance Phase runs until August 31, 2024, followed by the Extended Life Phase with no more software fixes through August 31, 2026. See \u003Ca href=\"https://access.redhat.com/articles/6975303\">Migration Paths for OpenShift Container Platform deployed on Red Hat Virtualization\u003C/a> for details.","/documentation/red_hat_virtualization/4.4",{"nid":444,"type":437,"langcode":406,"Published":16,"title":445,"Created":446,"Updated":447,"body_value":18,"field_documentation banner_text_value":448,"field_documentation banner_text_format":425,"field_paths_value":449,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},585,"RHHI-V EOL","2023-06-01 16:52:57","2023-06-01 17:03:44","\u003Cp slot=header>Red Hat Hyperconverged Infrastructure for Virtualization\u003C/p> is in the \u003Ca href=\"https://access.redhat.com/support/policy/updates/rhhiv\">Maintenance Support Phase\u003C/a> of its lifecycle until October 31, 2024. After that date, the product will be End of Life. See the \u003Ca href=\"https://access.redhat.com/announcements/6972521\">RHHI-V announcement\u003C/a> for next steps.","/documentation/red_hat_hyperconverged_infrastructure_for_virtualization/1.8",{"nid":451,"type":452,"langcode":406,"Published":16,"title":453,"Created":454,"Updated":455,"body_value":18,"field_documentation banner_text_value":456,"field_documentation banner_text_format":425,"field_paths_value":457,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},586,"preview banner","MicroShift is Technology Preview software only","2024-03-18 16:53:05","2024-03-18 16:54:56","\u003Cp slot=header>MicroShift is Technology Preview software only.\u003C/p>For more information about the support scope of Red Hat Technology Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/techpreview/\">Technology Preview Support Scope\u003C/a>.","/documentation/red_hat_build_of_microshift/4.13\r\n/documentation/red_hat_build_of_microshift/4.13/*",{"nid":459,"type":452,"langcode":406,"Published":16,"title":460,"Created":461,"Updated":462,"body_value":18,"field_documentation banner_text_value":463,"field_documentation banner_text_format":425,"field_paths_value":464,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},588,"Ansible 2.5 upgrade limitation","2024-09-30 16:53:05","2024-10-28 16:54:56","\u003Cp slot=\"header\">Support added for upgrades from 2.4\u003C/p>Ansible Automation Platform 2.5-3, released on October 28, 2024, adds support for upgrades from 2.4. See the upgrade documentation for more information.","",{"nid":466,"alertType":467,"type":468,"langcode":406,"Published":16,"title":469,"Created":464,"Updated":464,"body_value":18,"field_documentation banner_text_value":470,"field_documentation banner_text_format":425,"field_paths_value":471,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},587,"warning","Warning banner","Red Hat build of Apache Camel K","\u003Cp slot=header>Red Hat Camel K is deprecated\u003C/p>Red Hat Camel K is deprecated and the End of Life date for this product is June 30, 2025. For help migrating to the current go-to solution, \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel\">Red Hat build of Apache Camel\u003C/a>, see the \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel_k/1.10.7/html/migration_guide_camel_k_to_camel_extensions_for_quarkus/index\">Migration Guide\u003C/a>.","/documentation/red_hat_build_of_apache_camel_k/*",{"product":323},["Reactive",474],{"$snuxt-i18n-meta":475,"$sisLoading":476,"$sisSinglePage":15,"$sisInFocusMode":476,"$smobileTocOpen":476,"$sisLargeTOC":476,"$scurrentChapter":17,"$scurrentSection":17,"$scurrentSubSection":464},{},false,["Set"],["ShallowReactive",479],{"s8LoCEfG4A":18,"rFVLKcOK8e":18,"uUstF4AIyn":18,"MdHNSZP4nR":18,"Pn02PlJOas":18},"/en/documentation/red_hat_enterprise_linux/9/html-single/using_selinux/index"]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{contentEnv:"",collectFeedback:true,i18n:{baseUrl:"",defaultLocale:"en",defaultDirection:"ltr",strategy:"prefix",lazy:false,rootRedirect:"",routesNameSeparator:"___",defaultLocaleRouteNameSuffix:"default",skipSettingLocaleOnNavigate:false,differentDomains:false,trailingSlash:false,configLocales:[{code:"en",name:"English",iso:"en-US"},{code:"fr",name:"Français",iso:"fr-FR"},{code:"ko",name:"한국어",iso:"ko-KR"},{code:"ja",name:"日本語",iso:"ja-JP"},{code:"zh-cn",name:"中文 (中国)",iso:"zh-CN"},{code:"de",name:"Deutsch",iso:"de_DE"},{code:"it",name:"Italiano",iso:"it_IT"},{code:"pt-br",name:"Português",iso:"pt_BR"},{code:"es",name:"Español",iso:"es-ES"}],locales:{en:{domain:""},fr:{domain:""},ko:{domain:""},ja:{domain:""},"zh-cn":{domain:""},de:{domain:""},it:{domain:""},"pt-br":{domain:""},es:{domain:""}},detectBrowserLanguage:{alwaysRedirect:false,cookieCrossOrigin:false,cookieDomain:"",cookieKey:"i18n_redirected",cookieSecure:false,fallbackLocale:"",redirectOn:"root",useCookie:true},experimental:{localeDetector:"",switchLocalePathLinkSSR:false,autoImportTranslationFunctions:false}}},app:{baseURL:"/",buildId:"5ff82c51-785e-4a7d-aca6-77d6692e8c7a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>
